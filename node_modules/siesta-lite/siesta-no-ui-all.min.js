/*

Siesta 5.3.0
Copyright(c) 2009-2019 Bryntum AB
https://bryntum.com/contact
https://bryntum.com/products/siesta/license

*/
"undefined"==typeof Joose&&!function(){var a={};a.C="undefined"!=typeof JOOSE_CFG?JOOSE_CFG:{};a.is_IE="\v"=="v";a.is_NodeJS=!("undefined"==typeof process||!process.pid);a.top=a.is_NodeJS&&global||this;a.stub=function(){return function(){throw Error("Modules can not be instantiated");}};a.VERSION="3.50.1";"undefined"!=typeof module&&(module.exports=a);this.Joose=a;a.A={each:function(a,b,c){c=c||this;for(var d=0,e=a.length;d<e;d++)if(!1===b.call(c,a[d],d))return!1},eachR:function(a,b,c){c=c||this;
for(var d=a.length-1;0<=d;d--)if(!1===b.call(c,a[d],d))return!1},exists:function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]==b)return!0;return!1},map:function(a,b,c){c=c||this;for(var d=[],e=0,f=a.length;e<f;e++)d.push(b.call(c,a[e],e));return d},grep:function(b,c){var d=[];a.A.each(b,function(a){c(a)&&d.push(a)});return d},remove:function(b,c){var d=[];a.A.each(b,function(a){a!==c&&d.push(a)});return d}};a.S={saneSplit:function(a,b){var c=(a||"").split(b);1!=c.length||c[0]||c.shift();return c},
uppercaseFirst:function(a){return a.substr(0,1).toUpperCase()+a.substr(1,a.length-1)},strToClass:function(b,c){var d=c||a.top;a.A.each(b.split("."),function(a){if(d)d=d[a];else return!1});return d}};var b=function(){},c=["hasOwnProperty","valueOf","toString","constructor"],d=!0,e;for(e in{toString:1})d=!1;a.O={each:function(b,e,f){f=f||this;for(var g in b)if(!1===e.call(f,b[g],g))return!1;if(d)return a.A.each(c,function(a){if(b.hasOwnProperty(a))return e.call(f,b[a],a)})},eachOwn:function(b,c,d){d=
d||this;return a.O.each(b,function(a,e){if(b.hasOwnProperty(e))return c.call(d,a,e)},d)},copy:function(b,c){c=c||{};a.O.each(b,function(a,b){c[b]=a});return c},copyOwn:function(b,c){c=c||{};a.O.eachOwn(b,function(a,b){c[b]=a});return c},getMutableCopy:function(a){b.prototype=a;return new b},extend:function(b,c){return a.O.copy(c,b)},isEmpty:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},isInstance:function(a){return a&&a.meta&&a.constructor==a.meta.c},isClass:function(a){return a&&
a.meta&&a.meta.c==a},wantArray:function(a){return a instanceof Array?a:[a]},isFunction:function(a){return"function"==typeof a&&a.constructor!=/ /.constructor}};a.I={Array:function(){return[]},Object:function(){return{}},Function:function(){return arguments.callee},Now:function(){return new Date}};a.Proto=a.stub();a.Proto.Empty=a.stub();a.Proto.Empty.meta={};(function(){a.Proto.Object=a.stub();var b=function(){var a=b.caller;a==c&&(a=a.caller);if(!a.SUPER)throw"Invalid call to SUPER";return a.SUPER[a.methodName].apply(this,
arguments)},c=function(a){return this.SUPER.apply(this,a)};a.Proto.Object.prototype={SUPERARG:c,SUPER:b,INNER:function(){throw"Invalid call to INNER";},BUILD:function(a){return 1==arguments.length&&"object"==typeof a&&a||{}},initialize:function(){},toString:function(){return"a "+this.meta.name}};a.Proto.Object.meta={constructor:a.Proto.Object,methods:a.O.copy(a.Proto.Object.prototype),attributes:{}};a.Proto.Object.prototype.meta=a.Proto.Object.meta})();(function(){a.Proto.Class=function(){return this.initialize(this.BUILD.apply(this,
arguments))||this};var b={VERSION:null,AUTHORITY:null,constructor:a.Proto.Class,superClass:null,name:null,attributes:null,methods:null,meta:null,c:null,defaultSuperClass:a.Proto.Object,BUILD:function(a,b){this.name=a;return{__extend__:b||{}}},initialize:function(a){a=a.__extend__;this.VERSION=a.VERSION;this.AUTHORITY=a.AUTHORITY;delete a.VERSION;delete a.AUTHORITY;this.c=this.extractConstructor(a);this.adaptConstructor(this.c);a.constructorOnly?delete a.constructorOnly:this.construct(a)},construct:function(a){if(this.prepareProps(a)){var b=
this.superClass=this.extractSuperClass(a);this.processSuperClass(b);this.adaptPrototype(this.c.prototype);this.finalize(a)}},finalize:function(a){this.processStem(a);this.extend(a)},prepareProps:function(a){return!0},extractConstructor:function(a){var b=a.hasOwnProperty("constructor")?a.constructor:this.defaultConstructor();delete a.constructor;return b},extractSuperClass:function(a){if(a.hasOwnProperty("isa")&&!a.isa)throw Error("Attempt to inherit from undefined superclass ["+this.name+"]");var b=
a.isa||this.defaultSuperClass;delete a.isa;return b},processStem:function(){var b=this.superClass.meta;this.methods=a.O.getMutableCopy(b.methods||{});this.attributes=a.O.getMutableCopy(b.attributes||{})},initInstance:function(b,c){a.O.copyOwn(c,b)},defaultConstructor:function(){return function(a){var b=this.BUILD,b=b&&b.apply(this,arguments)||a||{},c=this.meta;c.initInstance(this,b);return c.hasMethod("initialize")&&this.initialize(b)||this}},processSuperClass:function(b){var c=b.prototype;if(!b.meta){var d=
a.O.copy(c);d.isa=a.Proto.Empty;delete d.constructor;d=new this.defaultSuperClass.meta.constructor(null,d);b.meta=c.meta=d;d.c=b}this.c.prototype=a.O.getMutableCopy(c);this.c.superClass=c},adaptConstructor:function(a){a.meta=this;a.hasOwnProperty("toString")||(a.toString=function(){return this.meta.name})},adaptPrototype:function(a){a.constructor=this.c;a.meta=this},addMethod:function(a,b){b.SUPER=this.superClass.prototype;b.methodName=a;this.methods[a]=b;this.c.prototype[a]=b},addAttribute:function(a,
b){this.attributes[a]=b;this.c.prototype[a]=b},removeMethod:function(a){delete this.methods[a];delete this.c.prototype[a]},removeAttribute:function(a){delete this.attributes[a];delete this.c.prototype[a]},hasMethod:function(a){return!!this.methods[a]},hasAttribute:function(a){return void 0!==this.attributes[a]},hasOwnMethod:function(a){return this.hasMethod(a)&&this.methods.hasOwnProperty(a)},hasOwnAttribute:function(a){return this.hasAttribute(a)&&this.attributes.hasOwnProperty(a)},extend:function(b){a.O.eachOwn(b,
function(b,c){"meta"!=c&&"constructor"!=c&&(a.O.isFunction(b)&&!b.meta?this.addMethod(c,b):this.addAttribute(c,b))},this)},subClassOf:function(a,b){return this.subClass(b,null,a)},subClass:function(a,b,c){a=a||{};a.isa=c||this.c;return(new this.constructor(b,a)).c},instantiate:function(){var a=function(){};a.prototype=this.c.prototype;a=new a;return this.c.apply(a,arguments)||a}};a.Proto.Class.prototype=a.O.getMutableCopy(a.Proto.Object.prototype);a.O.extend(a.Proto.Class.prototype,b);a.Proto.Class.prototype.meta=
new a.Proto.Class("Joose.Proto.Class",b);a.Proto.Class.meta.addMethod("isa",function(a){var b=function(){};b.prototype=this.c.prototype;return new b instanceof a})})();a.Managed=a.stub();a.Managed.Property=(new a.Proto.Class("Joose.Managed.Property",{name:null,init:null,value:null,definedIn:null,initialize:function(b){a.Managed.Property.superClass.initialize.call(this,b);this.computeValue()},computeValue:function(){this.value=this.init},preApply:function(a){},postUnApply:function(a){},apply:function(a){a[this.name]=
this.value},isAppliedTo:function(a){return a[this.name]==this.value},unapply:function(a){if(!this.isAppliedTo(a))throw"Unapply of property ["+this.name+"] from ["+a+"] failed";delete a[this.name]},cloneProps:function(){return{name:this.name,init:this.init,definedIn:this.definedIn}},clone:function(a){var b=this.cloneProps();b.name=a||b.name;return new this.constructor(b)}})).c;a.Managed.Property.ConflictMarker=(new a.Proto.Class("Joose.Managed.Property.ConflictMarker",{isa:a.Managed.Property,apply:function(a){throw Error("Attempt to apply ConflictMarker ["+
this.name+"] to ["+a+"]");}})).c;a.Managed.Property.Requirement=(new a.Proto.Class("Joose.Managed.Property.Requirement",{isa:a.Managed.Property,apply:function(a){if(!a.meta.hasMethod(this.name))throw Error("Requirement ["+this.name+"], defined in ["+this.definedIn.definedIn.name+"] is not satisfied for class ["+a+"]");},unapply:function(a){}})).c;a.Managed.Property.Attribute=(new a.Proto.Class("Joose.Managed.Property.Attribute",{isa:a.Managed.Property,slot:null,initialize:function(){a.Managed.Property.Attribute.superClass.initialize.apply(this,
arguments);this.slot=this.name},apply:function(a){a.prototype[this.slot]=this.value},isAppliedTo:function(a){return a.prototype[this.slot]==this.value},unapply:function(a){if(!this.isAppliedTo(a))throw"Unapply of property ["+this.name+"] from ["+a+"] failed";delete a.prototype[this.slot]},clearValue:function(a){delete a[this.slot]},hasValue:function(a){return a.hasOwnProperty(this.slot)},getRawValueFrom:function(a){return a[this.slot]},setRawValueTo:function(a,b){a[this.slot]=b;return this}})).c;
a.Managed.Property.MethodModifier=(new a.Proto.Class("Joose.Managed.Property.MethodModifier",{isa:a.Managed.Property,prepareWrapper:function(){throw"Abstract method [prepareWrapper] of "+this+" was called";},apply:function(a){var b=this.name,c=a.prototype,d=c.hasOwnProperty(b),e=c[b],f=a.meta.superClass.prototype,g=this.prepareWrapper({name:b,modifier:this.value,isOwn:d,originalCall:d?e:function(){return f[b].apply(this,arguments)},superProto:f,target:a});d&&(g.__ORIGINAL__=e);g.__CONTAIN__=this.value;
g.__METHOD__=this;this.value.displayName=this.getDisplayName(a);g.displayName="internal wrapper";c[b]=g},getDisplayName:function(a){return a.meta.name+"["+this.name+"]"},isAppliedTo:function(a){return(a=a.prototype[this.name])&&a.__CONTAIN__==this.value},unapply:function(a){var b=this.name,c=a.prototype,d=c[b].__ORIGINAL__;if(!this.isAppliedTo(a))throw"Unapply of method ["+b+"] from class ["+a+"] failed";d?c[b]=d:delete c[b]}})).c;a.Managed.Property.MethodModifier.Override=(new a.Proto.Class("Joose.Managed.Property.MethodModifier.Override",
{isa:a.Managed.Property.MethodModifier,prepareWrapper:function(b){var c=b.modifier,d=b.originalCall,e=b.superProto,f=e.meta.constructor,g=d;f!=a.Proto.Class&&f!=a.Proto.Object||b.isOwn&&d.IS_OVERRIDE||(g=function(){var a=this.SUPER;this.SUPER=e.SUPER;var b=d.apply(this,arguments);this.SUPER=a;return b});b=function(){var a=this.SUPER;this.SUPER=g;var b=c.apply(this,arguments);this.SUPER=a;return b};b.IS_OVERRIDE=!0;return b},getDisplayName:function(a){return a.meta.name+"[override "+this.name+"]"}})).c;
a.Managed.Property.MethodModifier.Put=(new a.Proto.Class("Joose.Managed.Property.MethodModifier.Put",{isa:a.Managed.Property.MethodModifier.Override,prepareWrapper:function(b){if(b.isOwn)throw"Method ["+b.name+"] is applying over something ["+b.originalCall+"] in class ["+b.target+"]";return a.Managed.Property.MethodModifier.Put.superClass.prepareWrapper.call(this,b)},getDisplayName:function(a){return a.meta.name+"["+this.name+"]"}})).c;a.Managed.Property.MethodModifier.After=(new a.Proto.Class("Joose.Managed.Property.MethodModifier.After",
{isa:a.Managed.Property.MethodModifier,prepareWrapper:function(a){var b=a.modifier,c=a.originalCall;return function(){var a=c.apply(this,arguments);b.apply(this,arguments);return a}},getDisplayName:function(a){return a.meta.name+"[after "+this.name+"]"}})).c;a.Managed.Property.MethodModifier.Before=(new a.Proto.Class("Joose.Managed.Property.MethodModifier.Before",{isa:a.Managed.Property.MethodModifier,prepareWrapper:function(a){var b=a.modifier,c=a.originalCall;return function(){b.apply(this,arguments);
return c.apply(this,arguments)}},getDisplayName:function(a){return a.meta.name+"[before "+this.name+"]"}})).c;a.Managed.Property.MethodModifier.Around=(new a.Proto.Class("Joose.Managed.Property.MethodModifier.Around",{isa:a.Managed.Property.MethodModifier,prepareWrapper:function(a){var b=a.modifier,c=a.originalCall,d,e=function(){return c.apply(d,arguments)};return function(){d=this;var a=[e];a.push.apply(a,arguments);return b.apply(this,a)}},getDisplayName:function(a){return a.meta.name+"[around "+
this.name+"]"}})).c;a.Managed.Property.MethodModifier.Augment=(new a.Proto.Class("Joose.Managed.Property.MethodModifier.Augment",{isa:a.Managed.Property.MethodModifier,prepareWrapper:function(a){var b=function(){var a=[],c=b;do a.push(c.IS_AUGMENT?c.__CONTAIN__:c),c=c.IS_AUGMENT&&(c.__ORIGINAL__||c.SUPER[c.methodName]);while(c);c=this.INNER;this.INNER=function(){var b=a.pop();return b?b.apply(this,arguments):void 0};var d=this.INNER.apply(this,arguments);this.INNER=c;return d};b.methodName=a.name;
b.SUPER=a.superProto;b.IS_AUGMENT=!0;return b},getDisplayName:function(a){return a.meta.name+"[augment "+this.name+"]"}})).c;a.Managed.PropertySet=(new a.Proto.Class("Joose.Managed.PropertySet",{isa:a.Managed.Property,properties:null,propertyMetaClass:a.Managed.Property,initialize:function(b){a.Managed.PropertySet.superClass.initialize.call(this,b);this.properties=b.properties||{}},addProperty:function(a,b){var c=b.meta||this.propertyMetaClass;delete b.meta;b.definedIn=this;b.name=a;return this.properties[a]=
new c(b)},addPropertyObject:function(a){return this.properties[a.name]=a},removeProperty:function(a){var b=this.properties[a];delete this.properties[a];return b},haveProperty:function(a){return null!=this.properties[a]},haveOwnProperty:function(a){return this.haveProperty(a)&&this.properties.hasOwnProperty(a)},getProperty:function(a){return this.properties[a]},each:function(b,c){a.O.each(this.properties,b,c||this)},eachOwn:function(b,c){a.O.eachOwn(this.properties,b,c||this)},eachAll:function(a,b){this.each(a,
b)},cloneProps:function(){var b=a.Managed.PropertySet.superClass.cloneProps.call(this);b.propertyMetaClass=this.propertyMetaClass;return b},clone:function(b){b=this.cleanClone(b);b.properties=a.O.copyOwn(this.properties);return b},cleanClone:function(a){var b=this.cloneProps();b.name=a||b.name;return new this.constructor(b)},alias:function(b){var c=this.properties;a.O.each(b,function(a,b){var d=c[b];d&&this.addPropertyObject(d.clone(a))},this)},exclude:function(b){var c=this.properties;a.A.each(b,
function(a){delete c[a]})},beforeConsumedBy:function(){},flattenTo:function(b){var c=b.properties;this.eachOwn(function(d,e){var f=c[e];f instanceof a.Managed.Property.ConflictMarker||(c.hasOwnProperty(e)&&null!=f?f!=d&&(b.removeProperty(e),b.addProperty(e,{meta:a.Managed.Property.ConflictMarker})):b.addPropertyObject(d))},this)},composeTo:function(a){this.eachOwn(function(b,c){a.haveOwnProperty(c)||a.addPropertyObject(b)})},composeFrom:function(){if(arguments.length){var b=this.cleanClone();a.A.each(arguments,
function(c){var d=!(c instanceof a.Managed.PropertySet),e=d?c.propertySet:c;e.beforeConsumedBy(this,b);if(d){if(c.alias||c.exclude)e=e.clone();c.alias&&e.alias(c.alias);c.exclude&&e.exclude(c.exclude)}e.flattenTo(b)},this);b.composeTo(this)}},preApply:function(a){this.eachOwn(function(b){b.preApply(a)})},apply:function(a){this.eachOwn(function(b){b.apply(a)})},unapply:function(a){this.eachOwn(function(b){b.unapply(a)})},postUnApply:function(a){this.eachOwn(function(b){b.postUnApply(a)})}})).c;var f=
1;a.Managed.PropertySet.Mutable=(new a.Proto.Class("Joose.Managed.PropertySet.Mutable",{isa:a.Managed.PropertySet,ID:null,derivatives:null,opened:null,composedFrom:null,initialize:function(b){a.Managed.PropertySet.Mutable.superClass.initialize.call(this,b);this.opened=1;this.derivatives={};this.ID=f++;this.composedFrom=[]},addComposeInfo:function(){this.ensureOpen();a.A.each(arguments,function(b){this.composedFrom.push(b);(b instanceof a.Managed.PropertySet?b:b.propertySet).derivatives[this.ID]=this},
this)},removeComposeInfo:function(){this.ensureOpen();a.A.each(arguments,function(b){for(var c=0;c<this.composedFrom.length;){var d=this.composedFrom[c],d=d instanceof a.Managed.PropertySet?d:d.propertySet;b==d?(delete d.derivatives[this.ID],this.composedFrom.splice(c,1)):c++}},this)},ensureOpen:function(){if(!this.opened)throw"Mutation of closed property set: ["+this.name+"]";},addProperty:function(b,c){this.ensureOpen();return a.Managed.PropertySet.Mutable.superClass.addProperty.call(this,b,c)},
addPropertyObject:function(b){this.ensureOpen();return a.Managed.PropertySet.Mutable.superClass.addPropertyObject.call(this,b)},removeProperty:function(b){this.ensureOpen();return a.Managed.PropertySet.Mutable.superClass.removeProperty.call(this,b)},composeFrom:function(){this.ensureOpen();return a.Managed.PropertySet.Mutable.superClass.composeFrom.apply(this,this.composedFrom)},open:function(){this.opened++;1==this.opened&&(a.O.each(this.derivatives,function(a){a.open()}),this.deCompose())},close:function(){if(!this.opened)throw"Unmatched 'close' operation on property set: ["+
this.name+"]";1==this.opened&&(this.reCompose(),a.O.each(this.derivatives,function(a){a.close()}));this.opened--},reCompose:function(){this.composeFrom()},deCompose:function(){this.eachOwn(function(a,b){a.definedIn!=this&&this.removeProperty(b)},this)}})).c;a.Managed.StemElement=function(){throw"Modules may not be instantiated.";};a.Managed.StemElement.Attributes=(new a.Proto.Class("Joose.Managed.StemElement.Attributes",{isa:a.Managed.PropertySet.Mutable,propertyMetaClass:a.Managed.Property.Attribute})).c;
a.Managed.StemElement.Methods=(new a.Proto.Class("Joose.Managed.StemElement.Methods",{isa:a.Managed.PropertySet.Mutable,propertyMetaClass:a.Managed.Property.MethodModifier.Put,preApply:function(){},postUnApply:function(){}})).c;a.Managed.StemElement.Requirements=(new a.Proto.Class("Joose.Managed.StemElement.Requirements",{isa:a.Managed.PropertySet.Mutable,propertyMetaClass:a.Managed.Property.Requirement,alias:function(){},exclude:function(){},flattenTo:function(a){this.each(function(b,c){a.haveProperty(c)||
a.addPropertyObject(b)})},composeTo:function(a){this.flattenTo(a)},preApply:function(){},postUnApply:function(){}})).c;a.Managed.StemElement.MethodModifiers=(new a.Proto.Class("Joose.Managed.StemElement.MethodModifiers",{isa:a.Managed.PropertySet.Mutable,propertyMetaClass:null,addProperty:function(a,b){var c=b.meta;delete b.meta;b.definedIn=this;b.name=a;var c=new c(b),d=this.properties;d[a]||(d[a]=[]);d[a].push(c);return c},addPropertyObject:function(a){var b=a.name,c=this.properties;c[b]||(c[b]=
[]);c[b].push(a);return a},removeProperty:function(b){if(this.haveProperty(b)){var c=this.properties,d=c[b].pop();c[b].length||a.Managed.StemElement.MethodModifiers.superClass.removeProperty.call(this,b);return d}},alias:function(){},exclude:function(){},flattenTo:function(b){var c=b.properties;this.each(function(b,d){var e=c[d];null==e&&(e=c[d]=[]);a.A.each(b,function(b){a.A.exists(e,b)||e.push(b)})})},composeTo:function(a){this.flattenTo(a)},deCompose:function(){this.each(function(a,b){for(var c=
0;c<a.length;)a[c].definedIn!=this?a.splice(c,1):c++})},preApply:function(a){},postUnApply:function(a){},apply:function(b){this.each(function(c,d){a.A.each(c,function(a){a.apply(b)})})},unapply:function(a){this.each(function(b,c){for(var d=b.length-1;0<=d;d--)b[d].unapply(a)})}})).c;a.Managed.PropertySet.Composition=(new a.Proto.Class("Joose.Managed.PropertySet.Composition",{isa:a.Managed.PropertySet.Mutable,propertyMetaClass:a.Managed.PropertySet.Mutable,processOrder:null,each:function(b,c){var d=
this.properties;c=c||this;a.A.each(this.processOrder,function(a){b.call(c,d[a],a)})},eachR:function(b,c){var d=this.properties;c=c||this;a.A.eachR(this.processOrder,function(a){b.call(c,d[a],a)})},clone:function(a){var b=this.cleanClone(a);this.each(function(a){b.addPropertyObject(a.clone())});return b},alias:function(a){this.each(function(b){b.alias(a)})},exclude:function(a){this.each(function(b){b.exclude(a)})},flattenTo:function(a){var b=a.properties;this.each(function(c,d){var e=b[d]||a.addProperty(d,
{meta:c.constructor});c.flattenTo(e)})},composeTo:function(a){var b=a.properties;this.each(function(c,d){var e=b[d]||a.addProperty(d,{meta:c.constructor});c.composeTo(e)})},deCompose:function(){this.eachR(function(a){a.open()});a.Managed.PropertySet.Composition.superClass.deCompose.call(this)},reCompose:function(){a.Managed.PropertySet.Composition.superClass.reCompose.call(this);this.each(function(a){a.close()})},unapply:function(a){this.eachR(function(b){b.unapply(a)})}})).c;a.Managed.Stem=(new a.Proto.Class("Joose.Managed.Stem",
{isa:a.Managed.PropertySet.Composition,targetMeta:null,attributesMC:a.Managed.StemElement.Attributes,methodsMC:a.Managed.StemElement.Methods,requirementsMC:a.Managed.StemElement.Requirements,methodsModifiersMC:a.Managed.StemElement.MethodModifiers,processOrder:["attributes","methods","requirements","methodsModifiers"],initialize:function(b){a.Managed.Stem.superClass.initialize.call(this,b);b=this.targetMeta;this.addProperty("attributes",{meta:this.attributesMC,properties:b?b.attributes:{}});this.addProperty("methods",
{meta:this.methodsMC,properties:b?b.methods:{}});this.addProperty("requirements",{meta:this.requirementsMC});this.addProperty("methodsModifiers",{meta:this.methodsModifiersMC})},reCompose:function(){var b=this.targetMeta.c;this.preApply(b);a.Managed.Stem.superClass.reCompose.call(this);this.apply(b)},deCompose:function(){var b=this.targetMeta.c;this.unapply(b);a.Managed.Stem.superClass.deCompose.call(this);this.postUnApply(b)}})).c;a.Managed.Builder=(new a.Proto.Class("Joose.Managed.Builder",{targetMeta:null,
_buildStart:function(b,c){b.stem.open();a.A.each("trait traits removeTrait removeTraits does doesnot doesnt".split(" "),function(a){c[a]&&(this[a](b,c[a]),delete c[a])},this)},_extend:function(b){if(!a.O.isEmpty(b)){var c=this.targetMeta;this._buildStart(c,b);a.O.eachOwn(b,function(a,b){var d=this[b];if(!d)throw Error("Unknown builder ["+b+"] was used during extending of ["+c.c+"]");d.call(this,c,a)},this);this._buildComplete(c,b)}},_buildComplete:function(a,b){a.stem.close()},methods:function(b,
c){a.O.eachOwn(c,function(a,c){b.addMethod(c,a)})},removeMethods:function(b,c){a.A.each(c,function(a){b.removeMethod(a)})},have:function(b,c){a.O.eachOwn(c,function(a,c){b.addAttribute(c,a)})},havenot:function(b,c){a.A.each(c,function(a){b.removeAttribute(a)})},havent:function(a,b){this.havenot(a,b)},after:function(b,c){a.O.each(c,function(c,d){b.addMethodModifier(d,c,a.Managed.Property.MethodModifier.After)})},before:function(b,c){a.O.each(c,function(c,d){b.addMethodModifier(d,c,a.Managed.Property.MethodModifier.Before)})},
override:function(b,c){a.O.each(c,function(c,d){b.addMethodModifier(d,c,a.Managed.Property.MethodModifier.Override)})},around:function(b,c){a.O.each(c,function(c,d){b.addMethodModifier(d,c,a.Managed.Property.MethodModifier.Around)})},augment:function(b,c){a.O.each(c,function(c,d){b.addMethodModifier(d,c,a.Managed.Property.MethodModifier.Augment)})},removeModifier:function(b,c){a.A.each(c,function(a){b.removeMethodModifier(a)})},does:function(b,c){a.A.each(a.O.wantArray(c),function(a){b.addRole(a)})},
doesnot:function(b,c){a.A.each(a.O.wantArray(c),function(a){b.removeRole(a)})},doesnt:function(a,b){this.doesnot(a,b)},trait:function(){this.traits.apply(this,arguments)},traits:function(a,b){if(!a.firstPass){if(!a.meta.isDetached)throw"Can't apply trait to not detached class";a.meta.extend({does:b})}},removeTrait:function(){this.removeTraits.apply(this,arguments)},removeTraits:function(a,b){if(!a.meta.isDetached)throw"Can't remove trait from not detached class";a.meta.extend({doesnot:b})},name:function(a,
b){a.name=b}})).c;a.Managed.Class=(new a.Proto.Class("Joose.Managed.Class",{isa:a.Proto.Class,stem:null,stemClass:a.Managed.Stem,stemClassCreated:!1,builder:null,builderClass:a.Managed.Builder,builderClassCreated:!1,isDetached:!1,firstPass:!0,skipTraitsAnchor:{},BUILD:function(){var b=a.Managed.Class.superClass.BUILD.apply(this,arguments),c=b.__extend__,d=a.O.wantArray(c.trait||c.traits||[]);delete c.trait;delete c.traits;a.A.each(a.O.wantArray(c.does||[]),function(b){b=b.meta instanceof a.Managed.Class?
b:b.role;b.meta.meta.isDetached&&d.push(b.meta.constructor)});d.length&&(c.traits=d);return b},initInstance:function(b,c){a.O.each(this.attributes,function(d,e){d instanceof a.Managed.Attribute?d.initFromConfig(b,c):c.hasOwnProperty(e)&&(b[e]=c[e])})},defaultConstructor:function(){return function(a,b){var c=this.meta,d=a==c.skipTraitsAnchor,e=this.BUILD,e=e&&e.apply(this,d?b:arguments)||(d?b[0]:a)||{},f=e.__extend__||e,g=f.trait||f.traits;if(g||f.detached)if(delete f.trait,delete f.traits,delete f.detached,
!d)return d=c.subClass({does:g||[]},c.name).meta,d.isDetached=!0,d.instantiate(c.skipTraitsAnchor,arguments);c.initInstance(this,e);return c.hasMethod("initialize")&&this.initialize(e)||this}},finalize:function(b){a.Managed.Class.superClass.finalize.call(this,b);this.stem.close();this.afterMutate()},processStem:function(){a.Managed.Class.superClass.processStem.call(this);this.builder=new this.builderClass({targetMeta:this});this.stem=new this.stemClass({name:this.name,targetMeta:this});var b=this.getClassInAttribute("builderClass");
b&&(this.builderClassCreated=!0,this.addAttribute("builderClass",this.subClassOf(b)));if(b=this.getClassInAttribute("stemClass"))this.stemClassCreated=!0,this.addAttribute("stemClass",this.subClassOf(b))},extend:function(a){a.builder&&(this.getBuilderTarget().meta.extend(a.builder),delete a.builder);a.stem&&(this.getStemTarget().meta.extend(a.stem),delete a.stem);this.builder._extend(a);this.firstPass=!1;this.stem.opened||this.afterMutate()},getBuilderTarget:function(){var a=this.getClassInAttribute("builderClass");
if(!a)throw"Attempt to extend a builder on non-meta class";return a},getStemTarget:function(){var a=this.getClassInAttribute("stemClass");if(!a)throw"Attempt to extend a stem on non-meta class";return a},getClassInAttribute:function(b){b=this.getAttribute(b);b instanceof a.Managed.Property.Attribute&&(b=b.value);return b},addMethodModifier:function(a,b,c){var d={};d.init=b;d.meta=c;return this.stem.properties.methodsModifiers.addProperty(a,d)},removeMethodModifier:function(a){return this.stem.properties.methodsModifiers.removeProperty(a)},
addMethod:function(a,b,c){c=c||{};c.init=b;return this.stem.properties.methods.addProperty(a,c)},addAttribute:function(a,b,c){c=c||{};c.init=b;return this.stem.properties.attributes.addProperty(a,c)},removeMethod:function(a){return this.stem.properties.methods.removeProperty(a)},removeAttribute:function(a){return this.stem.properties.attributes.removeProperty(a)},hasMethod:function(a){return this.stem.properties.methods.haveProperty(a)},hasAttribute:function(a){return this.stem.properties.attributes.haveProperty(a)},
hasMethodModifiersFor:function(a){return this.stem.properties.methodsModifiers.haveProperty(a)},hasOwnMethod:function(a){return this.stem.properties.methods.haveOwnProperty(a)},hasOwnAttribute:function(a){return this.stem.properties.attributes.haveOwnProperty(a)},getMethod:function(a){return this.stem.properties.methods.getProperty(a)},getAttribute:function(a){return this.stem.properties.attributes.getProperty(a)},eachRole:function(b,c,d){a.A.each(b,function(b,e){c.call(d||this,b,b.meta instanceof
a.Managed.Class?b:b.role,e)},this)},addRole:function(){this.eachRole(arguments,function(a,b){this.beforeRoleAdd(b);var c=a;b!=a?(c.propertySet=b.meta.stem,delete c.role):c=c.meta.stem;this.stem.addComposeInfo(c)},this)},beforeRoleAdd:function(a){a=a.meta;a.builderClassCreated&&this.getBuilderTarget().meta.extend({does:[a.getBuilderTarget()]});a.stemClassCreated&&this.getStemTarget().meta.extend({does:[a.getStemTarget()]});a.meta.isDetached&&!this.firstPass&&this.builder.traits(this,a.constructor)},
beforeRoleRemove:function(a){a=a.meta;a.builderClassCreated&&this.getBuilderTarget().meta.extend({doesnt:[a.getBuilderTarget()]});a.stemClassCreated&&this.getStemTarget().meta.extend({doesnt:[a.getStemTarget()]});a.meta.isDetached&&!this.firstPass&&this.builder.removeTraits(this,a.constructor)},removeRole:function(){this.eachRole(arguments,function(a,b){this.beforeRoleRemove(b);this.stem.removeComposeInfo(b.meta.stem)},this)},getRoles:function(){return a.A.map(this.stem.composedFrom,function(b){return b instanceof
a.Managed.PropertySet?b.targetMeta.c:b.propertySet})},does:function(b){for(var c=this.getRoles(),d=0;d<c.length;d++)if(b==c[d])return!0;for(d=0;d<c.length;d++)if(c[d].meta.does(b))return!0;c=this.superClass.meta;return this.superClass!=a.Proto.Empty&&c&&c.meta&&c.meta.hasMethod("does")?c.does(b):!1},getMethods:function(){return this.stem.properties.methods},getAttributes:function(){return this.stem.properties.attributes},afterMutate:function(){},getCurrentMethod:function(){for(var a=arguments.callee.caller,
b=0;a&&5>b;a=a.caller,b++)if(a.__METHOD__)return a.__METHOD__;return null}})).c;a.Managed.Role=(new a.Managed.Class("Joose.Managed.Role",{isa:a.Managed.Class,have:{defaultSuperClass:a.Proto.Empty,builderRole:null,stemRole:null},methods:{defaultConstructor:function(){return function(){throw Error("Roles cant be instantiated");}},processSuperClass:function(){if(this.superClass!=this.defaultSuperClass)throw Error("Roles can't inherit from anything");},getBuilderTarget:function(){this.builderRole||(this.builderRole=
(new this.constructor).c,this.builderClassCreated=!0);return this.builderRole},getStemTarget:function(){this.stemRole||(this.stemRole=(new this.constructor).c,this.stemClassCreated=!0);return this.stemRole},addRequirement:function(a){this.stem.properties.requirements.addProperty(a,{})}},stem:{methods:{apply:function(){},unapply:function(){}}},builder:{methods:{requires:function(b,c){a.A.each(a.O.wantArray(c),function(a){b.addRequirement(a)},this)}}}})).c;a.Managed.Attribute=(new a.Managed.Class("Joose.Managed.Attribute",
{isa:a.Managed.Property.Attribute,have:{is:null,builder:null,isPrivate:!1,role:null,publicName:null,setterName:null,getterName:null,readable:!1,writeable:!1,hasGetter:!1,hasSetter:!1,required:!1,canInlineSetRaw:!0,canInlineGetRaw:!0},after:{initialize:function(){var a=this.name;this.publicName=a.replace(/^_+/,"");this.slot=this.isPrivate?"$"+a:a;this.setterName=this.setterName||this.getSetterName();this.getterName=this.getterName||this.getGetterName();this.readable=this.hasGetter=/^r/i.test(this.is);
this.writeable=this.hasSetter=/^.w/i.test(this.is)}},override:{computeValue:function(){var b=this.init;!a.O.isClass(b)&&a.O.isFunction(b)||this.SUPER()},preApply:function(a){a.meta.extend({methods:this.getAccessorsFor(a)})},postUnApply:function(a){a.meta.extend({removeMethods:this.getAccessorsFrom(a)})}},methods:{getAccessorsFor:function(a){a=a.meta;var b=this.setterName,c=this.getterName,d={};this.hasSetter&&!a.hasMethod(b)&&(d[b]=this.getSetter(),d[b].ACCESSOR_FROM=this);this.hasGetter&&!a.hasMethod(c)&&
(d[c]=this.getGetter(),d[c].ACCESSOR_FROM=this);return d},getAccessorsFrom:function(a){var b=a.meta;a=this.setterName;var c=this.getterName,d=this.hasSetter&&b.getMethod(a),b=this.hasGetter&&b.getMethod(c),e=[];d&&d.value.ACCESSOR_FROM==this&&e.push(a);b&&b.value.ACCESSOR_FROM==this&&e.push(c);return e},getGetterName:function(){return"get"+a.S.uppercaseFirst(this.publicName)},getSetterName:function(){return"set"+a.S.uppercaseFirst(this.publicName)},getSetter:function(){var a=this,b=a.slot;return a.canInlineSetRaw?
function(a){this[b]=a;return this}:function(){return a.setRawValueTo.apply(this,arguments)}},getGetter:function(){var a=this,b=a.slot;return a.canInlineGetRaw?function(a){return this[b]}:function(){return a.getRawValueFrom.apply(this,arguments)}},getValueFrom:function(a){var b=this.getterName;return this.readable&&a.meta.hasMethod(b)?a[b]():this.getRawValueFrom(a)},setValueTo:function(a,b){var c=this.setterName;if(this.writeable&&a.meta.hasMethod(c))a[c](b);else this.setRawValueTo(a,b)},initFromConfig:function(b,
c){var d=this.name,e,f=!1;if(c.hasOwnProperty(d))e=c[d],f=!0;else{var g=this.init;a.O.isFunction(g)&&!a.O.isClass(g)?(e=g.call(b,c,d),f=!0):this.builder&&(e=b[this.builder.replace(/^this\./,"")](c,d),f=!0)}if(f)this.setRawValueTo(b,e);else if(this.required)throw Error("Required attribute ["+d+"] is missed during initialization of "+b);}}})).c;a.Managed.Attribute.Builder=(new a.Managed.Role("Joose.Managed.Attribute.Builder",{have:{defaultAttributeClass:a.Managed.Attribute},builder:{methods:{has:function(b,
c){a.O.eachOwn(c,function(a,c){if("object"!=typeof a||null==a||a.constructor==/ /.constructor)a={init:a};a.meta=a.meta||b.defaultAttributeClass;/^__/.test(c)&&(c=c.replace(/^_+/,""),a.isPrivate=!0);b.addAttribute(c,a.init,a)},this)},hasnot:function(a,b){this.havenot(a,b)},hasnt:function(a,b){this.hasnot(a,b)}}}})).c;a.Managed.My=(new a.Managed.Role("Joose.Managed.My",{have:{myClass:null,needToReAlias:!1},methods:{createMy:function(b){var c=this instanceof a.Managed.Role,d=b.my||{};delete b.my;b=this.superClass.meta.myClass;
c||d.isa||!b||(d.isa=b);d.meta||d.isa||(d.meta=this.constructor);d.name=this.name+".my";d=this.myClass=g(d);b=this.c;b.prototype.my=b.my=c?d:new d({HOST:b});this.needToReAlias=!0},aliasStaticMethods:function(){this.needToReAlias=!1;var b=this.c,c=this.myClass.prototype;a.O.eachOwn(b,function(a,c){a.IS_ALIAS&&delete b[c]});this.myClass.meta.stem.properties.methods.each(function(a,d){b[d]||((b[d]=function(){return c[d].apply(b.my,arguments)}).IS_ALIAS=!0)})}},override:{extend:function(b){var c=this.myClass;
!c&&this.superClass.meta.myClass&&this.createMy(b);b.my&&(c?(this.needToReAlias=!0,c.meta.extend(b.my),delete b.my):this.createMy(b));this.SUPER(b);!this.needToReAlias||this instanceof a.Managed.Role||this.aliasStaticMethods()}},before:{addRole:function(){var b;a.A.each(arguments,function(c){if(!c)throw Error("Attempt to consume an undefined Role into ["+this.name+"]");c=c.meta instanceof a.Managed.Class?c:c.role;c.meta.meta.hasAttribute("myClass")&&c.meta.myClass&&(this.myClass?(b=this.myClass.meta.stem,
b.opened||b.open(),b.addComposeInfo(c.my.meta.stem)):this.createMy({my:{does:c.meta.myClass}}))},this);b&&(b.close(),this.needToReAlias=!0)},removeRole:function(){if(this.myClass){var b=this.myClass.meta.stem;b.open();a.A.each(arguments,function(a){a.meta.meta.hasAttribute("myClass")&&a.meta.myClass&&(b.removeComposeInfo(a.my.meta.stem),this.needToReAlias=!0)},this);b.close()}}}})).c;a.Namespace=a.stub();a.Namespace.Able=(new a.Managed.Role("Joose.Namespace.Able",{have:{bodyFunc:null},before:{extend:function(a){a.body&&
(this.bodyFunc=a.body,delete a.body)}},after:{afterMutate:function(){var b=this.bodyFunc;delete this.bodyFunc;b&&a.Namespace.Manager.my.executeIn(this.c,b)}}})).c;a.Managed.Bootstrap=(new a.Managed.Role("Joose.Managed.Bootstrap",{does:[a.Namespace.Able,a.Managed.My,a.Managed.Attribute.Builder]})).c;a.Meta=a.stub();a.Meta.Object=(new a.Proto.Class("Joose.Meta.Object",{isa:a.Proto.Object})).c;a.Meta.Class=(new a.Managed.Class("Joose.Meta.Class",{isa:a.Managed.Class,does:a.Managed.Bootstrap,have:{defaultSuperClass:a.Meta.Object}})).c;
a.Meta.Role=(new a.Meta.Class("Joose.Meta.Role",{isa:a.Managed.Role,does:a.Managed.Bootstrap})).c;a.Namespace.Keeper=(new a.Meta.Class("Joose.Namespace.Keeper",{isa:a.Meta.Class,have:{externalConstructor:null},methods:{defaultConstructor:function(){return function(){var b=arguments.callee.meta;if(b instanceof a.Namespace.Keeper)throw Error("Module ["+b.c+"] may not be instantiated. Forgot to 'use' the class with the same name?");var c=b.externalConstructor;if("function"==typeof c)return c.meta=b,
c.apply(this,arguments);throw"NamespaceKeeper of ["+b.name+"] was planted incorrectly.";}},plant:function(a){var b=this.c;b.meta=a.meta;b.meta.c=b;b.meta.externalConstructor=a}}})).c;a.Namespace.Manager=(new a.Managed.Class("Joose.Namespace.Manager",{have:{current:null},methods:{initialize:function(){this.current=[a.top]},getCurrent:function(){return this.current[0]},executeIn:function(a,b){var c=this.current;c.unshift(a);var d=b.call(a,a);c.shift();return d},earlyCreate:function(a,b,c){c.constructorOnly=
!0;return(new b(a,c)).c},create:function(b,c,d){if(!b)return(new c(b,d)).c;var e=this;if(/^\./.test(b))return this.executeIn(a.top,function(){return e.create(b.replace(/^\./,""),c,d)});for(var f=d||{},g=a.S.saneSplit(b,"."),q=this.getCurrent(),t=q==a.top?[]:a.S.saneSplit(q.meta.name,"."),v=0;v<g.length;v++){var z=g[v],w=v==g.length-1;if("meta"==z||"my"==z||!z)throw"Module name ["+b+"] may not include a part called 'meta' or 'my' or empty part.";var x=q[z];t.push(z);var A=t.join("."),B=!1;if("undefined"==
typeof x)w?(x=this.earlyCreate(A,c,f),B=!0):x=(new a.Namespace.Keeper(A)).c,q[z]=x;else if(w&&x&&x.meta)if(q=x.meta,c==a.Namespace.Keeper)q.extend(f);else if(q instanceof a.Namespace.Keeper)q.plant(this.earlyCreate(A,c,f)),B=!0;else{if(!a.C.ignoreRepeatedDeclarations)throw Error("Double declaration of ["+A+"]");}else if(w&&!(x&&x.meta&&x.meta.meta))throw"Trying to setup module "+A+" failed. There is already something: "+x;w&&this.prepareMeta(x.meta);B&&x.meta.construct(f);q=x}return q},prepareMeta:function(){},
prepareProperties:function(a,b,c,d){a&&"string"!=typeof a&&(b=a,a=null);var e;b&&b.meta&&(e=b.meta,delete b.meta);e||(e=b&&"function"==typeof b.isa&&b.isa.meta?b.isa.meta.constructor:c);return d.call(this,a,e,b)},getDefaultHelperFor:function(a){var b=this;return function(c,d){return b.prepareProperties(c,d,a,function(a,c,d){return b.create(a,c,d)})}},register:function(b,c,d){var e=this;if(this.meta.hasMethod(b))c=function(){return e[b].apply(e,arguments)},a.top[b]||(a.top[b]=c),a[b]||(a[b]=c),a.is_NodeJS&&
"undefined"!=typeof exports&&(exports[b]=c);else{var f={};f[b]=d||this.getDefaultHelperFor(c);this.meta.extend({methods:f});this.register(b)}},Module:function(b,c){return this.prepareProperties(b,c,a.Namespace.Keeper,function(a,b,c){"function"==typeof c&&(c={body:c});return this.create(a,b,c)})}}})).c;a.Namespace.Manager.my=new a.Namespace.Manager;a.Namespace.Manager.my.register("Class",a.Meta.Class);a.Namespace.Manager.my.register("Role",a.Meta.Role);a.Namespace.Manager.my.register("Module");var g=
a.Class;e=a.Role;e("Joose.Attribute.Delegate",{have:{handles:null},override:{eachDelegate:function(b,c,d){if("string"==typeof b)return c.call(d,b,b);if(b instanceof Array)return a.A.each(b,function(a){c.call(d,a,a)});b===Object(b)&&a.O.eachOwn(b,function(a,b){c.call(d,b,a)})},getAccessorsFor:function(a){var b=a.meta,c=this.SUPER(a),d=this;this.eachDelegate(this.handles,function(a,e){b.hasMethod(a)||((c[a]=function(){var a=d.getValueFrom(this);return a[e].apply(a,arguments)}).ACCESSOR_FROM=d)});return c},
getAccessorsFrom:function(a){var b=this.SUPER(a),c=this,d=a.meta;this.eachDelegate(this.handles,function(a){var e=d.getMethod(a);e&&e.value.ACCESSOR_FROM==c&&b.push(a)});return b}}});e("Joose.Attribute.Trigger",{have:{trigger:null},after:{initialize:function(){if(this.trigger){if(!this.writeable)throw Error("Can't use `trigger` for read-only attributes");this.hasSetter=!0}}},override:{getSetter:function(){var b=this.SUPER(),c=this.trigger;if(!c)return b;var d=this,e=a.O.isFunction(d.init)?null:d.init;
return function(){var a=d.hasValue(this)?d.getValueFrom(this):e,f=b.apply(this,arguments);c.call(this,d.getValueFrom(this),a);return f}}}});e("Joose.Attribute.Lazy",{have:{lazy:null},before:{computeValue:function(){"function"==typeof this.init&&this.lazy&&(this.lazy=this.init,delete this.init)}},after:{initialize:function(){this.lazy&&(this.readable=this.hasGetter=!0)}},override:{getGetter:function(){var a=this.SUPER(),b=this.lazy;if(!b)return a;var c=this;return function(){if(!c.hasValue(this)){var d=
"function"==typeof b?b:this[b.replace(/^this\./,"")];c.setValueTo(this,d.apply(this,arguments))}return a.call(this)}}}});e("Joose.Attribute.Accessor.Combined",{have:{isCombined:!1},after:{initialize:function(){if(this.isCombined=this.isCombined||/..c/i.test(this.is))this.slot="$$"+this.name,this.hasGetter=!0,this.hasSetter=!1,this.setterName=this.getterName=this.publicName}},override:{getGetter:function(){var a=this.SUPER();if(!this.isCombined)return a;var b=this.getSetter(),c=this;return function(){if(!arguments.length){if(c.readable)return a.call(this);
throw Error("Call to getter of unreadable attribute: ["+c.name+"]");}if(c.writeable)return b.apply(this,arguments);throw Error("Call to setter of read-only attribute: ["+c.name+"]");}}}});a.Managed.Attribute.meta.extend({does:[a.Attribute.Delegate,a.Attribute.Trigger,a.Attribute.Lazy,a.Attribute.Accessor.Combined]});e("Joose.Meta.Singleton",{has:{forceInstance:a.I.Object,instance:null},override:{defaultConstructor:function(){var a=this,b=this.SUPER();this.adaptConstructor(b);return function(c,d){if(c==
a.forceInstance)return b.apply(this,d)||this;var e=a.instance;e||(e=a.instance=new a.c(a.forceInstance,arguments));a.hasMethod("configure")&&e.configure.apply(e,arguments);return e}}}});a.Namespace.Manager.my.register("Singleton",g({isa:a.Meta.Class,meta:a.Meta.Class,does:a.Meta.Singleton}))}();Joose.C.ignoreRepeatedDeclarations=!0;
Class("JooseX.Observable.Event",{has:{name:{required:!0},args:{required:!0},source:{required:!0},splat:null,current:null,bubbling:!0},methods:{stopPropagation:function(){this.bubbling=!1}}});
Class("JooseX.Observable.Listener",{has:{channel:{required:!0},eventName:{required:!0},func:{required:!0},scope:null,single:!1,buffer:null,bufferMax:null,bufferStartedAt:null,bufferTimeout:null,delayTimeout:null,delay:null},methods:{activate:function(a,b){var c=this;if(null!=c.buffer){if(null!=c.bufferMax)if(!c.bufferStartedAt)c.bufferStartedAt=new Date;else if(new Date-c.bufferStartedAt>c.bufferMax)return;c.bufferTimeout&&clearTimeout(c.bufferTimeout);c.bufferTimeout=setTimeout(function(){delete c.bufferStartedAt;
delete c.bufferTimeout;c.doActivate(a,b)},c.buffer)}else if(null!=c.delay)c.delayTimeout=setTimeout(function(){delete c.delayTimeout;c.doActivate(a,b)},c.delay);else return c.doActivate(a,b)},doActivate:function(a,b){this.single&&this.remove();return!1!==this.func.apply(this.scope||a.source,[a].concat(b))},cancel:function(){this.buffer&&(clearTimeout(this.bufferTimeout),delete this.bufferTimeout,delete this.bufferStartedAt);this.delay&&clearTimeout(this.delayTimeout)},remove:function(){this.channel.removeListener(this)}}});
Class("JooseX.Observable.Channel",{has:{channels:Joose.I.Object,listeners:Joose.I.Object},methods:{destroy:function(){Joose.O.each(this.channels,function(a,b){a.purgeListeners()});this.channels=null;Joose.O.each(this.listeners,function(a,b){this.listeners[b]=null},this);this.listeners=null},getListenersFor:function(a,b,c){var d=this.listeners;if(d["**"]){var e=a.concat(b);Joose.A.each(d["**"],function(a){c.push({listener:a,splat:e})})}a.length?(d=this.getSingleChannel(a.shift(),!0))&&d.getListenersFor(a,
b,c):(d["*"]&&Joose.A.each(d["*"],function(a){c.push({listener:a,splat:b})}),d[b]&&Joose.A.each(d[b],function(a){c.push({listener:a})}))},hasListenerFor:function(a,b){var c=this.listeners;if(c["**"]&&c["**"].length)return!0;if(a.length){if(c=this.getSingleChannel(a.shift(),!0))return c.hasListenerFor(a,b)}else if(c["*"]&&c["*"].length||c[b]&&c[b].length)return!0;return!1},addListener:function(a){var b=a.eventName,c=this.listeners;c[b]=c[b]||[];c[b].push(a)},removeListener:function(a){if(this.listeners){var b=
this.listeners[a.eventName];b&&Joose.A.each(b,function(c,d){if(c==a)return b.splice(d,1),!1})}},removeListenerByHandler:function(a,b,c){var d=this.listeners[a];d&&Joose.A.each(d,function(a,f){if(a.func==b&&a.scope==c)return d.splice(f,1),!1})},getSingleChannel:function(a,b){var c=this.channels;return c[a]?c[a]:b?null:c[a]=new JooseX.Observable.Channel},getChannel:function(a,b){if(!a.length)return this;var c=this.getSingleChannel(a.shift(),b);return b&&!c?null:c.getChannel(a,b)}}});
Role("JooseX.Observable",{VERSION:.04,has:{rootChannel:{is:"rw",init:function(){return new JooseX.Observable.Channel}},suspendCounter:0},methods:{getBubbleTarget:function(){},parseEventPath:function(a){a=a.split("/");var b=a.pop();a.length&&!a[0]&&a.shift();return{channels:a,eventName:b}},on:function(a,b,c,d){if(!b)throw"Not valid listener function provided when subsribing on event: "+a;var e=this.parseEventPath(a);a=this.getRootChannel().getChannel(e.channels);b=new JooseX.Observable.Listener(Joose.O.extend(d||
{},{channel:a,eventName:e.eventName,func:b,scope:c}));a.addListener(b);return b},un:function(a,b,c){if(a instanceof JooseX.Observable.Listener)a.remove();else{a=this.parseEventPath(a);var d=this.getRootChannel().getChannel(a.channels,!0);d&&d.removeListenerByHandler(a.eventName,b,c)}},emit:function(){return this.fireEvent.apply(this,arguments)},fireEvent:function(a){if(!this.suspendCounter){var b=Array.prototype.slice.call(arguments,1),c=new JooseX.Observable.Event({name:a,args:b,source:this});return this.propagateEvent(c,
a,b)}},propagateEvent:function(a,b,c){if(!this.suspendCounter){var d=this.parseEventPath(b),e=d.eventName;if("*"==!e||"**"==e)throw Error("Can't fire an empty event or event with `*`, `**` names ");var f=[];this.getRootChannel().getListenersFor(d.channels,e,f);var g=!0;a.current=this;f.length&&Joose.A.each(f,function(b){a.splat=b.splat;g=!1!==b.listener.activate(a,c)&&g});a.bubbling&&(d=this.getBubbleTarget())&&(g=!1!==d.propagateEvent(a,b,c)&&g);return g}},hasListenerFor:function(a){a=this.parseEventPath(a);
return this.getRootChannel().hasListenerFor(a.channels,a.eventName)},purgeListeners:function(){this.rootChannel.destroy();this.rootChannel=new JooseX.Observable.Channel},suspendEvents:function(){this.suspendCounter++},resumeEvents:function(){this.suspendCounter--;0>this.suspendCounter&&(this.suspendCounter=0)}}});
Class("JooseX.Namespace.Depended.Manager",{my:{have:{INC:["lib","/jsan"],disableCaching:!0,resources:{},resourceTypes:{},ANONYMOUS_RESOURCE_COUNTER:0},methods:{getMyResource:function(a,b,c){a=this.getResource({type:a,token:b});if(a.attachedTo&&a.attachedTo!=c)throw a+" is already attached to ["+a.attachedTo+"]";a.attachedTo=c;a.loaded=!0;a.loading=!1;return a},getResource:function(a){if("object"==typeof a){var b=a.type=a.type||"javascript",c=a.token,d=a.version;delete a.version}else if("string"==
typeof a)if(c=/^(\w+):\/\/(.+)/.exec(a)){if(b=c[1],c=c[2],"http"==b||"https"==b)c=b+"://"+c,b="javascript"}else c=a,b=/\//.test(c)||/\.js$/.test(c)?"javascript":"joose";c||(c="__ANONYMOUS_RESOURCE__"+this.ANONYMOUS_RESOURCE_COUNTER++,a=void 0);var e=b+"://"+c,f=this.resources[e];if(!f){f=this.resourceTypes[b];if(!f)throw Error("Unknown resource type: ["+b+"]");f=this.resources[e]=new f("object"==typeof a?a:{token:c,type:b})}f.setRequiredVersion(d);return f},registerResourceClass:function(a,b){this.resourceTypes[a]=
b},use:function(a,b,c){Class({use:a,body:function(){b&&Joose.Namespace.Manager.my.executeIn(Joose.top,function(a){b.call(c||this,a)})}})},getINC:function(){var a=this.INC,b=use.__ORIGINAL__,c=use.paths;if(a==b&&c!=b)return c;if(a!=b&&c==b)return a;if(a!=b&&c!=b)throw"Both INC sources has been modified";return a}}}});use=function(a,b,c){JooseX.Namespace.Depended.Manager.my.use(a,b,c)};use.paths=use.__ORIGINAL__=JooseX.Namespace.Depended.Manager.my.INC;Joose.I.FutureClass=function(a){return function(){return eval(a)}};
Class("JooseX.Namespace.Depended.Resource",{has:{attachedTo:null,type:null,token:null,id:null,loading:!1,loaded:!1,ready:!1,presence:null,readyness:null,loadedFromURL:null,readyListeners:Joose.I.Array,dependencies:Joose.I.Object,onBeforeReady:{is:"rw",init:null},readyDelegated:!1,version:{is:"rw",init:null},requiredVersion:{is:"rw",init:null},hasReadyCheckScheduled:!1},after:{initialize:function(){this.id||(this.id=this.type+"://"+this.token)}},methods:{setOnBeforeReady:function(a){if(this.onBeforeReady)throw"Can't redefine 'onBeforeReady' for "+
this;this.onBeforeReady=a},setVersion:function(a){if(a){if(this.version&&this.version!=a)throw Error("Cant redefine version of "+this);var b=this.requiredVersion;if(b&&a<b)throw Error("Versions conflict on "+this+" required ["+b+"], got ["+a+"]");this.version=a}},setRequiredVersion:function(a){if(a){var b=this.requiredVersion;if(!b||a>b){if(this.isLoaded()||this.loading)throw"Cant increase required version - "+this+" is already loaded";this.requiredVersion=a}}},toString:function(){return"Resource: id=["+
this.id+"], type=["+this.meta.name+"]"},addDescriptor:function(a){a=JooseX.Namespace.Depended.Manager.my.getResource(a);var b=this.dependencies,c=a.id;if(!b[c]&&!a.isReady()){var d=this;a.readyListeners.push(function(){delete b[c];d.checkReady()});b[c]=a;this.ready=!1}},handleDependencies:function(){Joose.O.eachOwn(this.dependencies||{},function(a){a.handleLoad()});this.checkReady()},checkReady:function(){if(Joose.O.isEmpty(this.dependencies)&&!this.hasReadyCheckScheduled)if(this.onBeforeReady){if(!this.readyDelegated){this.readyDelegated=
!0;var a=this;this.onBeforeReady(function(){a.fireReady()},a)}}else this.fireReady()},fireReady:function(){this.ready=!0;var a=this.readyListeners;this.readyListeners=[];Joose.A.each(a,function(a){a()})},isReady:function(){if(!this.isLoaded())return!1;var a=!1;try{a=this.readyness()}catch(b){}return a||this.ready},isLoaded:function(){var a=!1;try{a=this.presence()}catch(b){}return a||this.loaded},handleLoad:function(){if(this.isLoaded())this.checkReady();else if(!this.loading){this.loading=!0;var a=
Joose.O.wantArray(this.getUrls()),b=this;b.hasReadyCheckScheduled=!0;var c=function(a,c){b.loaded=!0;b.loading=!1;b.loadedFromURL=c;Joose.Namespace.Manager.my.executeIn(Joose.top,function(){b.materialize(a,c)});b.hasReadyCheckScheduled=!1;b.handleDependencies()},d=function(e){if(!a.length)throw Error(b+" not found");b.load(a.shift(),c,d)};this.load(a.shift(),c,d)}},getUrls:function(){throw"Abstract resource method 'getUrls' was called";},load:function(a,b,c){throw"Abstract resource method 'load' was called";
},materialize:function(a){throw"Abstract resource method 'materialize' was called";}}});Role("JooseX.Namespace.Depended.Materialize.Eval",{requires:["handleLoad"],methods:{materialize:function(a){(window.execScript||window.eval)(a)}}});
Class("JooseX.Namespace.Depended.Resource.JavaScript",{isa:JooseX.Namespace.Depended.Resource,has:{hasDirectUrl:!1},after:{initialize:function(){var a=this;"nonjoose"==this.type&&(this.type="javascript");var b=this.presence;"string"==typeof b&&(this.presence=function(){return eval(b)});b||(this.presence=function(){return eval(a.token)});this.readyness||(this.readyness=this.presence)}},methods:{BUILD:function(a){var b=a.token,c=/^=(.*)/.exec(b);c&&(this.hasDirectUrl=!0,b=c[1]);/^http/.test(b)&&(this.hasDirectUrl=
!0,a.trait=JooseX.Namespace.Depended.Transport.ScriptTag);/^\//.test(b)&&(this.hasDirectUrl=!0);return a},getUrls:function(){var a=this.token;if(this.hasDirectUrl)return[a];var b=JooseX.Namespace.Depended.Manager.my;return Joose.A.map(b.getINC(),function(c){c=c.replace(/\/$/,"");return[c].concat(a).join("/")+(b.disableCaching?"?disableCaching="+(new Date).getTime():"")})}}});JooseX.Namespace.Depended.Manager.my.registerResourceClass("javascript",JooseX.Namespace.Depended.Resource.JavaScript);
JooseX.Namespace.Depended.Manager.my.registerResourceClass("nonjoose",JooseX.Namespace.Depended.Resource.JavaScript);
Class("JooseX.Namespace.Depended.Resource.JooseClass",{isa:JooseX.Namespace.Depended.Resource.JavaScript,after:{initialize:function(){var a=this;this.presence=function(){var b=Joose.S.strToClass(a.token);return b&&b.meta.resource};this.readyness=function(){var b=eval(a.token);return b&&b.meta.resource.ready}}},methods:{addDescriptor:function(a){"object"!=typeof a||a.token?this.SUPER(a):Joose.O.eachOwn(a,function(a,c){this.addDescriptor({type:"joose",token:c,version:a})},this)},getUrls:function(){var a=
this.token.split("."),b=JooseX.Namespace.Depended.Manager.my;return Joose.A.map(b.getINC(),function(c){c=c.replace(/\/$/,"");return[c].concat(a).join("/")+".js"+(b.disableCaching?"?disableCaching="+(new Date).getTime():"")})}}});JooseX.Namespace.Depended.Manager.my.registerResourceClass("joose",JooseX.Namespace.Depended.Resource.JooseClass);
"undefined"==typeof JooseX||JooseX.SimpleRequest||Class("JooseX.SimpleRequest",{have:{req:null},methods:{initialize:function(){this.req=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},getText:function(a,b,c,d){var e=this.req,f,g;"string"!=typeof a?(f=a.headers,g=a.url,b=b||a.async,c=c||a.callback,d=d||a.scope):g=a;e.open("GET",g,b||!1);f&&Joose.O.eachOwn(f,function(a,b){e.setRequestHeader(b,a)});try{e.onreadystatechange=function(a){b&&4==e.readyState&&(200==e.status||
0==e.status&&0<e.responseText.length?c.call(d||this,!0,e.responseText):c.call(d||this,!1,"File not found: "+g))},e.send(null)}catch(k){throw"File not found: "+g;}if(!b){if(200==e.status||0==e.status&&0<e.responseText.length)return e.responseText;throw"File not found: "+g;}return null}}});Role("JooseX.Namespace.Depended.Materialize.ScriptTag",{requires:["handleLoad"],methods:{materialize:function(a){var b=document.createElement("script");b.text=a;document.body.appendChild(b)}}});
Role("JooseX.Namespace.Depended.Transport.XHRAsync",{requires:["handleLoad"],override:{load:function(a,b,c){var d=new JooseX.SimpleRequest;try{d.getText(a,!0,function(d,f){d?b(f,a):c(this+" not found")})}catch(e){c(e)}}}});
Role("JooseX.Namespace.Depended.Transport.ScriptTag",{requires:["handleLoad"],methods:{getScriptTag:function(){}},override:{load:function(a,b,c){var d=document.createElement("script");d.type="text/javascript";d.src=a;d.async=!0;if(Joose.is_IE){var e=setTimeout(function(){c(a+" load failed.")},1E4);d.onreadystatechange=function(){var c=d.readyState;if("complete"==c||"loaded"==c)clearTimeout(e),b(null,a)}}else d.onload=function(){b(d.text,a)},d.onerror=function(){c(a+" load failed.")};(document.getElementsByTagName("head")[0]||
document.body).appendChild(d)},materialize:function(a,b){}}});Role("JooseX.Namespace.Depended.Transport.NodeJS",{requires:["handleLoad"],override:{load:function(a,b,c){var d=require("fs");try{var e=d.readFileSync(a,"utf8")}catch(f){c(f);return}b(e,a)}}});Role("JooseX.Namespace.Depended.Materialize.NodeJS",{requires:["handleLoad"],methods:{materialize:function(a,b){}}});
Class("JooseX.Namespace.Depended.Resource.Require",{isa:JooseX.Namespace.Depended.Resource,methods:{getUrls:function(){return[this.token]},load:function(a,b,c){},materialize:function(){}}});JooseX.Namespace.Depended.Manager.my.registerResourceClass("require",JooseX.Namespace.Depended.Resource.Require);
Role("JooseX.Namespace.Depended",{meta:Joose.Managed.Role,requires:["prepareProperties"],have:{containResources:"use meta isa does trait traits".split(" ")},override:{prepareProperties:function(a,b,c,d){a&&"string"!=typeof a&&(b=a,a=null);b=b||{};var e=this.collectAllDeps(b),f=this.getCurrent(),g=JooseX.Namespace.Depended.Manager.my.getResource({type:"joose",token:f==Joose.top?a:f.meta.name+"."+a});b.VERSION&&g.setVersion(b.VERSION);b.BEGIN&&(g.setOnBeforeReady(b.BEGIN),delete b.BEGIN);Joose.A.each(e,
function(a){g.addDescriptor(a)});if(Joose.O.isEmpty(g.dependencies))return this.inlineAllDeps(b),e=this.SUPER(a,b,c,d),g.checkReady(),e;var k=this,l=this.SUPER;g.readyListeners.unshift(function(){k.inlineAllDeps(b);Joose.Namespace.Manager.my.executeIn(f,function(){l.call(k,a,b,c,d)})});g.hasReadyCheckScheduled||(Joose.is_NodeJS?g.handleDependencies():setTimeout(function(){g.handleDependencies()},0));return this.create(a,Joose.Namespace.Keeper,{})},prepareMeta:function(a){a.resource=a.resource||JooseX.Namespace.Depended.Manager.my.getMyResource("joose",
a.name,a.c)}},methods:{alsoDependsFrom:function(a,b){},collectAllDeps:function(a){var b=[],c=this;this.collectClassDeps(a,b);var d=a.my;this.collectClassDeps(d,b);a.has&&Joose.O.each(a.has,function(a,d){Joose.O.isClass(a)||c.collectClassDeps(a,b)});d&&d.has&&Joose.O.each(d.has,function(a,d){Joose.O.isClass(a)||c.collectClassDeps(a,b)});this.alsoDependsFrom(a,b);return b},collectClassDeps:function(a,b){a&&Joose.A.each(this.containResources,function(c){this.collectDependencies(a[c],b,a,c)},this)},collectDependencies:function(a,
b,c,d){a&&Joose.A.each(Joose.O.wantArray(a),function(a){a&&"function"!=typeof a&&b.push(a)})},inlineAllDeps:function(a){var b=this;this.inlineDeps(a);var c=a.my;c&&this.inlineDeps(c);a.has&&Joose.O.each(a.has,function(a,c){a&&"object"==typeof a&&b.inlineDeps(a)});c&&c.has&&Joose.O.each(c.has,function(a,c){a&&"object"==typeof a&&b.inlineDeps(a)})},inlineDeps:function(a){delete a.use;Joose.A.each(this.containResources,function(b){if(a[b]){var c=[];Joose.A.each(Joose.O.wantArray(a[b]),function(a,e){var f=
typeof a;if("function"==f)c.push(a.meta?a:"isa"!=b?a():null);else if("object"==f)a.token?c.push(eval(a.token)):Joose.O.each(a,function(a,b){c.push(eval(b))});else if("string"==f)c.push(eval(a));else throw Error("Wrong dependency descriptor format: "+a);});if("isa"!=b&&"meta"!=b)a[b]=c;else{if(1<c.length)throw"Cant specify several super- or meta- classes";c[0]&&(a[b]=c[0])}}})}}});Joose.Namespace.Manager.meta.extend({does:JooseX.Namespace.Depended});
Joose.is_NodeJS?(JooseX.Namespace.Depended.Resource.JavaScript.meta.extend({does:[JooseX.Namespace.Depended.Transport.NodeJS,JooseX.Namespace.Depended.Materialize.NodeJS]}),JooseX.Namespace.Depended.Manager.my.disableCaching=!1,Joose.Namespace.Manager.my.containResources.unshift("require"),JooseX.Namespace.Depended.meta.extend({override:{collectDependencies:function(a,b,c,d){if("require"!=d)return this.SUPERARG(arguments);a&&(Joose.A.each(Joose.O.wantArray(a),function(a){b.push({type:"require",token:a})}),
delete c.require)}}})):JooseX.Namespace.Depended.Resource.JavaScript.meta.extend({does:[JooseX.Namespace.Depended.Transport.XHRAsync,JooseX.Namespace.Depended.Materialize.Eval]});
Class("Scope.Provider",{has:{name:null,launchId:null,scope:null,seedingCode:null,seedingScript:null,seedingScriptIsEcmaModule:!1,preload:{is:"ro",init:Joose.I.Array},cleanupCallback:null,beforeCleanupCallback:null},methods:{isCSS:function(a){return/\.css(\?.*)?$/i.test(a)},isAlreadySetUp:function(){return!!this.scope},addPreload:function(a){if(this.isAlreadySetUp())throw Error("Can't use `addPreload` - scope is already setup. Use `runCode/runScript` instead");"string"==typeof a?a=this.isCSS(a)?{type:"css",
url:a}:{type:"js",url:a}:a.text&&(a={type:"js",content:a.text});if(!a.type)throw Error("Preload descriptor must have the `type` property");this.preload.push(a)},addOnErrorHandler:function(a,b){throw"Abstract method `addOnErrorHandler` of Scope.Provider called";},create:function(){throw"Abstract method `create` of Scope.Provider called";},setup:function(a){throw"Abstract method `setup` of Scope.Provider called";},cleanup:function(a){throw"Abstract method `cleanup` of Scope.Provider called";},runCode:function(a,
b){throw"Abstract method `runCode` of Scope.Provider called";},runScript:function(a,b){throw"Abstract method `runScript` of Scope.Provider called";}}});Scope.Provider.__ONLOAD__={};Scope.Provider.__ONERROR__={};Scope.Provider.__FAILED_PRELOAD__={};
Role("Scope.Provider.Role.WithDOM",{requires:["getDocument","create","getPreload","isAlreadySetUp","setViewportSize"],has:{useStrictMode:!0,sourceURL:null,crossOriginFailed:!1,innerHtmlHead:null,innerHtmlBody:null,minViewportSize:null,parentWindow:function(){return window},scopeId:function(){return Math.round(1E10*Math.random())},failOnResourceLoadError:!1,failOnPromiseRejection:!0,attachToOnError:function(){return function(a,b,c,d,e,f){c=(a.opener||a.parent).Scope.Provider.__ONERROR__[b];if(e&&"ErrorEvent"in
a)a.addEventListener("error",c,!0);else{var g=a.onerror;if(g&&g.__SP_MANAGED__)return;a.onerror=function(b,e,f){if(!c.__CALLING__&&(c.__CALLING__=!0,g&&g.apply(this,arguments),c.apply(this,arguments),c.__CALLING__=!1,!1!==d))return a.WebKitPoint?!1:!0};a.onerror.__SP_MANAGED__=!0}f&&a.Promise&&"onunhandledrejection"in a&&a.addEventListener("unhandledrejection",function(a){c.apply(this,[null,null,null,null,null,a])},!0)}},cachedOnError:null},override:{cleanup:function(){var a=this.cachedOnError;this.cachedOnError=
null;try{var b=this.scope;b.ErrorEvent&&b.removeEventListener("error",a);b.onerror=null}catch(c){}this.SUPERARG(arguments);this.scope=null}},methods:{cleanupHandlers:function(){var a=this.parentWindow.Scope.Provider,b=this.scopeId;delete a.__ONLOAD__[b];delete a.__ONERROR__[b];delete a.__FAILED_PRELOAD__[b]},getHead:function(){return this.getDocument().getElementsByTagName("head")[0]},installOnErrorHandler:function(a){if(!this.crossOriginFailed){if(!this.isAlreadySetUp())throw"Scope should be already set up";
this.attachToOnError(this.scope,this.scopeId,a,!1,this.failOnResourceLoadError,this.failOnPromiseRejection)}},addOnErrorHandler:function(a,b){if(!this.crossOriginFailed){a.__SP_MANAGED__=!0;this.cachedOnError=a;var c=this.scopeId;this.parentWindow.Scope.Provider.__ONERROR__[c]=a;c=";("+this.attachToOnError.toString()+")(window, "+c+", (window.opener || window.parent).Scope.Provider.__ONERROR__[ "+c+" ], "+b+", "+this.failOnResourceLoadError+", "+this.failOnPromiseRejection+");";this.isAlreadySetUp()?
this.runCode(c):this.getPreload().unshift({type:"js",content:c,unordered:!0})}},addSeedingToPreload:function(){var a=this.getPreload();this.seedingCode&&a.unshift({type:"js",content:this.seedingCode});this.seedingScript&&a.push({type:"js",url:this.seedingScript,isEcmaModule:this.seedingScriptIsEcmaModule})},setup:function(a){var b="v"=="\v"||!!this.parentWindow.msWriteProfilerMark,c=!1;Joose.A.each(this.getPreload(),function(a){if("js"==a.type&&a.content&&!a.unordered)return c=!0,!1});var d=this,
e=function(b){a&&a(d,d.parentWindow.Scope.Provider.__FAILED_PRELOAD__[d.scopeId],b)};this.parentWindow.Scope.Provider.__FAILED_PRELOAD__[this.scopeId]={};this.sourceURL||b&&c?(this.addSeedingToPreload(),this.setupIncrementally(e)):(b||this.addSeedingToPreload(),this.setupWithDocWrite(e,b))},setupWithDocWrite:function(a,b){var c=[],d=this;Joose.A.each(this.getPreload(),function(a){if("js"==a.type)c.push(d.getScriptTagString(a.url,a.content,a.isEcmaModule));else if("css"==a.type)c.push(d.getLinkTagString(a.url,
a.content));else throw"Incorrect preload descriptor "+a;});this.create();var e=this.scopeId;this.parentWindow.Scope.Provider.__ONLOAD__[e]=function(){var c=function(){a&&a()};b?(d.seedingCode&&d.runCode(d.seedingCode,null),d.seedingScript?d.runScript(d.seedingScript,c,d.seedingScriptIsEcmaModule):c()):c()};var f=this.getDocument();f.open();f.write([this.useStrictMode?"<!DOCTYPE html>":"",'<html style="width: 100%; height: 100%; margin : 0; padding : 0;"><head>',this.innerHtmlHead||"",c.join(""),"</head>",
'<body style="margin : 0; padding : 0; width: 100%; height: 100%" onload="setTimeout(function () { (window.opener || window.parent).Scope.Provider.__ONLOAD__['+e+']() }, 0)">',this.innerHtmlBody||"","</body></html>"].join(""));f.close();d.cachedOnError&&d.installOnErrorHandler(d.cachedOnError)},setupIncrementally:function(a){this.create(function(b,c){if(c)a&&a(c);else{if(!b.sourceURL){var d=b.getDocument();if(b.innerHtmlHead){var e=b.getHead();try{e.innerHTML=b.innerHtmlHead}catch(l){var f=d.createElement("div");
f.innerHTML=b.innerHtmlHead;for(var g=0;g<f.children.length;g++)e.appendChild(f.children[g])}}b.innerHtmlBody&&(d.body.innerHTML=b.innerHtmlBody)}var k=function(a,c){var d=function(){b.scope&&k(a,c)};if(a.length){var e=a.shift();e.url?b.runScript(e.url,d,e.isEcmaModule):"js"==e.type?b.runCode(e.content,d,e.isEcmaModule):(b.addStyleTag(e.content),d())}else c&&c()};b.scope&&k(b.getPreload().slice(),a)}})},getScriptTagString:function(a,b,c){c='<script type="'+(c?"module":"text/javascript")+'"'+(c?' crossorigin="anonymous"':
"");var d;d="(window.opener || window.parent).Scope.Provider.__FAILED_PRELOAD__[ scopeId ][ url ] = true".replace(/scopeId/,"'"+this.scopeId+"'").replace(/url/,"'"+a+"'");return c=a?c+(' src="'+a+'" onerror="'+d+'">\x3c/script>'):c+(">"+b.replace(/<\/script>/gi,"\\x3C/script>")+"\x3c/script>")},getLinkTagString:function(a,b){if(a)return'<link href="'+a+'" rel="stylesheet" type="text/css" />';if(b)return"<style>"+b+"</style>"},loadCSS:function(a,b){var c=this.getDocument(),d=c.createElement("link");
d.type="text/css";d.rel="stylesheet";d.href=a;var e=!1;"onload"in d&&(e=!0,d.onload=function(){d.onload=null;b&&b();d=b=null});this.getHead().appendChild(d);if(!e){var f=!1,e=function(){f||(f=!0,clearTimeout(g),b&&b(),c.body.removeChild(k))},g=setTimeout(e,3E4),k=c.createElement("img");k.onerror=e;c.body.appendChild(k);k.src=a}},runCode:function(a,b,c){this.crossOriginFailed||this.getHead().appendChild(this.createScriptTag(a,null,null,null,c));b&&b()},runScript:function(a,b,c){if(this.crossOriginFailed)b&&
b();else{var d=this.scopeId;this.isCSS(a)?this.loadCSS(a,b):this.getHead().appendChild(this.createScriptTag(null,a,b,function(){this.onerror=null;var c=this.ownerDocument,c=c.defaultView||c.parentWindow;(c.opener||c.parent).Scope.Provider.__FAILED_PRELOAD__[d][a]=!0;b()},c))}},createScriptTag:function(a,b,c,d,e){var f=this.getDocument().createElement("script");f.setAttribute("type",e?"module":"text/javascript");e&&f.setAttribute("crossorigin","anonymous");b&&f.setAttribute("src",b);a&&(f.text=a);
c&&(f.onload=f.onreadystatechange=function(){if(!f.readyState||"loaded"==f.readyState||"complete"==f.readyState||4==f.readyState&&200==f.status)f.onload=f.onreadystatechange=null,"v"=="\v"?setTimeout(c,0):c()});d&&(f.onerror=d);return f},addStyleTag:function(a){var b=this.getDocument(),c=b.createElement("style");c.setAttribute("type","text/css");b.getElementsByTagName("head")[0].appendChild(c);c.styleSheet?c.styleSheet.cssText=a:c.appendChild(b.createTextNode(a))}}});
Class("Scope.Provider.IFrame",{isa:Scope.Provider,does:Scope.Provider.Role.WithDOM,have:{iframe:null,cls:null,performWrap:!1,wrapCls:null,wrapper:null,iframeParentEl:null,parentEl:null,cleanupDelay:1E3},methods:{getDocument:function(){return this.iframe.contentWindow.document},setViewportSize:function(a,b){var c=this.iframe;c&&(c.style.width=a+"px",c.style.height=b+"px")},create:function(a){var b=this,c=this.parentWindow.document,d=this.iframe=c.createElement("iframe"),e=this.minViewportSize;d.className=
this.cls||"";d.style.width=(e&&e.width||1024)+"px";d.style.height=(e&&e.height||768)+"px";d.setAttribute("frameborder",0);this.name&&d.setAttribute("name",this.name);var f=!1,g=function(){if(!f){d.detachEvent?d.detachEvent("onload",g):d.onload=null;try{b.getHead(),a&&a(b)}catch(c){b.crossOriginFailed=!0,a&&a(b,c)}}};d.attachEvent?d.attachEvent("onload",g):d.onload=g;d.src=this.sourceURL||"about:blank";if(this.performWrap){var k=this.wrapper;k||(k=this.wrapper=c.createElement("div"),k.className=this.wrapCls||
"");(this.iframeParentEl||k).appendChild(d);this.iframeParentEl=null}(this.parentEl||c.body).appendChild(k||d);var l=this.scope=d.contentWindow;if("v"=="\v"||this.parentWindow.msWriteProfilerMark){try{var m=this.getDocument();this.sourceURL&&(f=!0);m.open();m.write([this.useStrictMode?"<!DOCTYPE html>":"",'<html style="width: 100%; height: 100%; margin : 0; padding : 0;"><head></head><body style="margin : 0; padding : 0; width: 100%; height: 100%"></body></html>'].join(""));m.close();f=!1}catch(n){b.crossOriginFailed=
!0}d.onreadystatechange=function(){"complete"==d.readyState&&(d.onreadystatechange=null);b.cachedOnError&&!b.crossOriginFailed&&b.attachToOnError(l,b.scopeId,b.cachedOnError)};this.sourceURL&&(d.src=this.sourceURL)}b.cachedOnError&&b.installOnErrorHandler(b.cachedOnError)},cleanup:function(){var a=this.wrapper||this.iframe,b=this.iframe,c=this;b.onreadystatechange=null;a.style.display="none";this.runCode(";("+function(){window.onunload||(window.onunload=function(){return"something"})}.toString()+
")();");this.wrapper=this.scope=this.iframe=null;c.beforeCleanupCallback&&c.beforeCleanupCallback();c.beforeCleanupCallback=null;c.crossOriginFailed||(b.src="javascript:false");setTimeout(function(){(c.parentEl||c.parentWindow.document.body).removeChild(a);b=a=null;c.parentEl=null;c.cleanupHandlers();c.cleanupCallback&&c.cleanupCallback();c.cleanupCallback=null},c.cleanupDelay)}}});
Class("Scope.Provider.Window",{isa:Scope.Provider,does:Scope.Provider.Role.WithDOM,has:{popupWindow:null},methods:{setViewportSize:function(a,b){var c=this.popupWindow;c&&c.resizeTo(a,b)},create:function(a){var b=this.minViewportSize,c=this.scope=this.popupWindow=this.parentWindow.open(this.sourceURL||"about:blank","_blank","left=10,top=10,width="+(b&&b.width||1024)+",height="+(b&&b.height||768));if(!c)throw alert("Please enable popups for the host with this test suite running: "+this.parentWindow.location.host),
"Please enable popups for the host with this test suite running: "+this.parentWindow.location.host;"v"!="\v"&&!this.parentWindow.msWriteProfilerMark||this.sourceURL||(b=this.getDocument(),b.open(),b.write(""),b.close());this.cachedOnError&&this.installOnErrorHandler(this.cachedOnError);var d=this,e=function(a,b){var c=!1,e=!0,m=a.document,n=m.documentElement,r=m.addEventListener?"addEventListener":"attachEvent",p=m.addEventListener?"removeEventListener":"detachEvent",q=m.addEventListener?"":"on",
t=function(e){if("readystatechange"!=e.type||"complete"==m.readyState)("load"==e.type?a:m)[p](q+e.type,t,!1),!c&&(c=!0)&&b.call(a,d)},v=function(){try{n.doScroll("left")}catch(a){setTimeout(v,50);return}t("poll")};if("complete"==m.readyState)b.call(a,d);else{if(m.createEventObject&&n.doScroll){try{e=!a.frameElement}catch(z){}e&&v()}m[r](q+"DOMContentLoaded",t,!1);m[r](q+"readystatechange",t,!1);a[r](q+"load",t,!1)}};this.sourceURL?setTimeout(function(){e(c,a||function(){})},10):e(c,a||function(){})},
getDocument:function(){return this.popupWindow.document},cleanup:function(){this.beforeCleanupCallback&&this.beforeCleanupCallback();this.beforeCleanupCallback=null;this.popupWindow.close();this.popupWindow=null;this.cleanupHandlers();this.cleanupCallback&&this.cleanupCallback();this.cleanupCallback=null}}});
Class("Scope.Provider.NodeJS",{isa:Scope.Provider,has:{sourceURL:null,requireFunc:null,errorHandlerBorrowed:null,onErrorHandler:null},methods:{runInContext:function(a,b,c){return require("vm").runInContext(a,b,c)},addOnErrorHandler:function(a,b){var c=this;if(c.eventHandlerBorrowed)throw Error("Exclusive resource borrowing failed");c.onErrorHandler=a;process.on("uncaughtException",exceptionHandler=function(b){a(b.message,null,null,null,b)});process.on("unhandledRejection",rejectHandler=function(b){a(null,
null,null,null,null,{reason:b})});return c.eventHandlerBorrowed=function(){process.removeListener("uncaughtException",exceptionHandler);process.removeListener("unhandledRejection",rejectHandler);c.eventHandlerBorrowed=null;c.onErrorHandler=null}},create:function(a){var b=require("vm"),c={};Joose.O.extend(c,{process:process,console:console,global:c,setImmediate:setImmediate,clearImmediate:clearImmediate,setTimeout:setTimeout,clearTimeout:clearTimeout,setInterval:setInterval,clearInterval:clearInterval});
this.scope=b.createContext(c);a&&a()},setup:function(a){this.create();var b=this;this.seedingCode&&this.runCode(this.seedingCode);Joose.A.each(this.getPreload(),function(a){"js"==a.type&&(a.url?b.runScript(a.url):b.runCode(a.content))});this.seedingScript&&this.runScript(this.seedingScript);a&&a(b)},stripBom:function(a){65279===a.charCodeAt(0)&&(a=a.slice(1));return a},fileNameToModuleId:function(a){var b=require("path");return b.isAbsolute(a)?a:b.resolve("./",a)},runCode:function(a,b){var c=require("vm").runInContext(this.stripBom(a),
this.scope);b&&b(c);return c},runScript:function(a,b){return/mjs(\?.*)?$/.test(a)?this.importEcmaModule(a,b):this.requireCjsModule(a,b)},requireCjsModule:function(a,b){var c=require("vm"),d=c.runInThisContext,e=this.scope;c.runInThisContext=function(a,b){return c.runInContext(a,e,b)};try{var f=this.requireFunc(this.fileNameToModuleId(a))}catch(g){this.onErrorHandler&&this.onErrorHandler(g.message,null,null,null,g)}c.runInThisContext=d;b&&b(f);return f},importEcmaModule:function(a,b){throw Error("Ecma module for different context - implement me?");
},cleanup:function(){this.beforeCleanupCallback&&this.beforeCleanupCallback();this.cleanupCallback&&this.cleanupCallback()}}});
Class("Scope.Provider.NodeJsEmbed",{isa:Scope.Provider.NodeJS,methods:{runCode:function(a,b){var c=require("vm").runInThisContext(this.stripBom(a),{filename:"/"});b&&b(c);return c},requireCjsModule:function(a,b){try{var c=this.requireFunc(this.fileNameToModuleId(a))}catch(d){this.onErrorHandler&&this.onErrorHandler(d.message,null,null,null,d)}b&&b(c);return c},importEcmaModule:function(a,b){this.runCode("import('"+this.fileNameToModuleId(a)+"')").then(function(a){b&&b(a)},function(){})},create:function(a){this.scope=
SCOPE;a&&a()}}});var JSON;JSON||(JSON={});
(function(){function a(a){return 10>a?"0"+a:a}function b(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=k[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,d){var e,k,q,t,v=f,z,w=d[a];w&&"object"===typeof w&&"function"===typeof w.toJSON&&(w=w.toJSON(a));"function"===typeof l&&(w=l.call(d,a,w));switch(typeof w){case "string":return b(w);case "number":return isFinite(w)?String(w):"null";case "boolean":case "null":return String(w);
case "object":if(!w)return"null";f+=g;z=[];if("[object Array]"===Object.prototype.toString.apply(w)){t=w.length;for(e=0;e<t;e+=1)z[e]=c(e,w)||"null";q=0===z.length?"[]":f?"[\n"+f+z.join(",\n"+f)+"\n"+v+"]":"["+z.join(",")+"]";f=v;return q}if(l&&"object"===typeof l)for(t=l.length,e=0;e<t;e+=1)"string"===typeof l[e]&&(k=l[e],(q=c(k,w))&&z.push(b(k)+(f?": ":":")+q));else for(k in w)Object.prototype.hasOwnProperty.call(w,k)&&(q=c(k,w))&&z.push(b(k)+(f?": ":":")+q);q=0===z.length?"{}":f?"{\n"+f+z.join(",\n"+
f)+"\n"+v+"}":"{"+z.join(",")+"}";f=v;return q}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(b){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,g,k={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,b,d){var e;g=f="";if("number"===typeof d)for(e=0;e<d;e+=1)g+=" ";else"string"===typeof d&&(g=d);if((l=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return c("",{"":a})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function c(a,d){var e,f,g=a[d];if(g&&"object"===typeof g)for(e in g)Object.prototype.hasOwnProperty.call(g,e)&&(f=c(g,e),void 0!==f?g[e]=f:delete g[e]);return b.call(a,d,g)}var e;a=String(a);d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"===typeof b?c({"":e},""):e;throw new SyntaxError("JSON.parse");})})();
!function(){var a=1;Class("Data.Visitor2",{has:{seenPlaceholder:{init:{}},outOfDepthPlaceholder:{init:{}},seen:Joose.I.Object,maxDepth:null},methods:{getClassNameFor:function(a){return Joose.O.isInstance(a)?a.meta.name:Object.prototype.toString.call(a).replace(/^\[object /,"").replace(/\]$/,"")},getRefAdr:function(){return a++},assignRefAdrTo:function(b){b.__REFADR__||(Object.defineProperty?Object.defineProperty(b,"__REFADR__",{value:a++}):b.__REFADR__=a++);return b.__REFADR__},isSeen:function(a){return a.__REFADR__&&
this.seen.hasOwnProperty(a.__REFADR__)},markSeenAs:function(a,c){return this.seen[a.__REFADR__]=c},hasSeenResultFor:function(a){a=a.__REFADR__;return this.seen.hasOwnProperty(a)&&this.seen[a]!=this.seenPlaceholder},visit:function(a,c){return c>this.maxDepth?this.visitOutOfDepthValue(a,c+1):Object(a)===a?this.isSeen(a)?this.visitSeen(a,c+1):this.visitNotSeen(a,c+1):this.visitValue(a,c+1)},visitOutOfDepthValue:function(a,c){return this.outOfDepthPlaceholder},visitValue:function(a,c){return a},visitSeen:function(a,
c){return this.seen[a.__REFADR__]},getInitialSeenMarker:function(a,c){return this.seenPlaceholder},visitNotSeen:function(a,c){this.assignRefAdrTo(a);this.markSeenAs(a,this.getInitialSeenMarker(a,c));if(Joose.O.isInstance(a))return this.markSeenAs(a,this.visitJooseInstance(a,c));var d="visit"+this.getClassNameFor(a);this.meta.hasMethod(d)||(d="visitObject");return this.markSeenAs(a,this[d](a,c))},visitArray:function(a,c){Joose.A.each(a,function(d,e){this.visitArrayEntry(d,e,a,c)},this);return a},visitArrayEntry:function(a,
c,d,e){return this.visit(a,e)},visitObject:function(a,c){Joose.O.eachOwn(a,function(d,e){"__REFADR__"!=e&&(this.visitObjectKey(e,d,a,c),this.visitObjectValue(d,e,a,c))},this);return a},visitJooseInstance:function(a,c){return this.visitObject(a,c)},visitObjectKey:function(a,c,d,e){return this.visitValue(a,e)},visitObjectValue:function(a,c,d,e){return this.visit(a,e)}},my:{has:{HOST:null},methods:{visit:function(a,c){return(new this.HOST({maxDepth:c||Infinity})).visit(a,0)}}}})}();
Class("Siesta.Util.Serializer",{isa:Data.Visitor2,has:{result:Joose.I.Array,manualEnum:function(){for(var a in{toString:1})return!1;return!0}},methods:{assignRefAdrTo:function(a){try{return this.SUPER(a)}catch(b){a.__REFADR__||(a.__REFADR__=this.getRefAdr())}return a.__REFADR__},write:function(a){this.result.push(a)},visitOutOfDepthValue:function(a,b){this.write("...")},visitSymbol:function(a){this.write(a.toString())},visitValue:function(a){null==a?this.write(a+""):"symbol"===typeof a?this.write(a.toString()):
this.write("string"==typeof a?'"'+a.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':a+"")},visitObjectKey:function(a,b,c){this.write('"'+a+'": ')},getClassNameFor:function(a){return null!=a.nodeType&&null!=a.nodeName&&a.tagName?"DOMElement":null!=a.document&&null!=a.location&&null!=a.location.href?"Window":this.SUPER(a)},visitSeen:function(a,b){this.write("[Circular]")},visitRegExp:function(a,b){this.write(a+"")},visitFunction:function(a,b){this.write("function "+(a.name||"")+"() { ... }")},visitDate:function(a,
b){this.write('"'+a+'"')},visitObject:function(a,b){for(var c in a)if("__REFADR__"!=c&&(!a.hasOwnProperty||a.hasOwnProperty(c))){var d=a[c];this.visitObjectKey(c,d,a,b);this.visitObjectValue(d,c,a,b)}var e=this;this.manualEnum&&Joose.A.each(["hasOwnProperty","valueOf","toString","constructor"],function(c){if(a.hasOwnProperty&&a.hasOwnProperty(c)){var d=a[c];e.visitObjectKey(c,d,a,b);e.visitObjectValue(d,c,a,b)}});return a},visitJooseInstance:function(a,b){return a.meta.hasMethod("toString")?(this.write(a.toString()),
a):this.SUPERARG(arguments)},visitDOMElement:function(a,b){var c="&lt;"+a.tagName;a.id&&(c+=' id="'+a.id+'"');a.className&&(c+=' class="'+a.className+'"');this.write(c+"&gt;")},visitDOMStringMap:function(){this.write("[DOMStringMap]")},visitWindow:function(){this.write("[window]")},visitLocation:function(){this.write("[window.location]")},visitMap:function(a){this.write("Map("+a.size+"){");for(var b=a.entries(),c=b.next();!c.done;c=b.next())this.visit(c.value[0]),this.write("=>"),this.visit(c.value[1]),
this.write(", ");0<a.size&&this.result.pop();this.write("}")}},before:{visitObject:function(){this.write("{")},visitArray:function(){this.write("[")}},after:{visitObject:function(){var a=this.result;", "==a[a.length-1]&&a.pop();this.write("}")},visitArray:function(){var a=this.result;", "==a[a.length-1]&&a.pop();this.write("]")},visitObjectValue:function(){this.write(", ")},visitArrayEntry:function(){this.write(", ")}},my:{has:{HOST:null},methods:{stringify:function(a,b){var c=new this.HOST({maxDepth:b||
4});c.visit(a,0);return c.result.join("")}}}});
Role("Siesta.Util.Role.CanFormatStrings",{has:{serializeFormatingPlaceholders:!0},methods:{formatString:function(a,b){if(!b)return a;for(var c,d=[],e=[],f=/\{(\!)?((?:\w|-|_)+?)\}/g;c=f.exec(a);)e.push(c[1]),d.push(c[2]);var g=a;Joose.A.each(d,function(a,c){var d=e[c];g=g.replace(new RegExp("\\{"+(d?"!":"")+a+"\\}","g"),b.hasOwnProperty(a)?d||!this.serializeFormatingPlaceholders?b[a]+"":Siesta.Util.Serializer.stringify(b[a]):"")},this);return g},extractKeysAndSpecialKeys:function(a){var b=Siesta.Test.UserAgent.KeyCodes().keys,
c=this,d=[];a=a.match(/(\[\[(?:\w|-){1,11}\]\])|(\[(?:\w|-){1,11}\])|([\s\S])/g)||[];Joose.A.each(a,function(a,f){if(1<a.length){var g=/\[\[/.test(a),k=a.substring(g?2:1,a.length-(g?2:1)),l=void 0===b[k.toUpperCase()];l||g?(d.push("["),l&&g&&d.push("["),d.push.apply(d,c.extractKeysAndSpecialKeys(k)),d.push("]"),l&&g&&d.push("]")):d.push(a)}else d.push(a)});return d}}});Role("Siesta.Util.Role.CanGetType",{methods:{typeOf:function(a){return Object.prototype.toString.call(a).slice(8,-1)}}});
Role("Siesta.Util.Role.CanCompareObjects",{does:[Siesta.Util.Role.CanGetType],methods:{countKeys:function(a){var b=0;Joose.O.eachOwn(a,function(){b++});return b},compareObjects:function(a,b,c,d,e){var f=Joose.O.isInstance(a)&&a.meta.does(Siesta.Test.Role.Placeholder),g=Joose.O.isInstance(b)&&b.meta.does(Siesta.Test.Role.Placeholder);if(c){if(a===b)return!0}else if(a==b)return!0;if(f&&g)return a.equalsTo(b);if(g)return b.equalsTo(a);if(f)return a.equalsTo(b);if(d)return!1;d=this.typeOf(a);f=this.typeOf(b);
if(d!=f)return!1;var k=this;if("Set"==d){if(a.size!=b.size)return!1;e=a.entries();for(f=e.next();!f.done;f=e.next())if(d=f.value[0],!b.has(d))return!1;e=b.entries();for(f=e.next();!f.done;f=e.next())if(d=f.value[0],!a.has(d))return!1;return!0}if("Map"==d){if(a.size!=b.size)return!1;e=a.entries();for(f=e.next();!f.done;f=e.next())if(d=f.value[0],f=f.value[1],!b.has(d)||!k.compareObjects(f,b.get(d),c))return!1;e=b.entries();for(f=e.next();!f.done;f=e.next())if(d=f.value[0],f=f.value[1],!a.has(d)||!k.compareObjects(f,
a.get(d),c))return!1;return!0}if("Object"==d||e)return this.countKeys(a)!=this.countKeys(b)?!1:!1===Joose.O.eachOwn(a,function(a,d){if(!k.compareObjects(a,b[d],c))return!1})?!1:!0;if("Array"==d){if(a.length!=b.length)return!1;for(e=0;e<a.length;e++)if(!this.compareObjects(a[e],b[e],c))return!1;return!0}return"Function"==d?a.toString()==b.toString()&&(!c||this.compareObjects(a,b,c,!1,!0)):"RegExp"==d?a.source==b.source&&a.global==b.global&&a.ignoreCase==b.ignoreCase&&a.multiline==b.multiline&&(!c||
this.compareObjects(a,b,c,!1,!0)):"Date"==d?!(a-b)&&(!c||this.compareObjects(a,b,c,!1,!0)):!1}}});Role("Siesta.Util.Role.CanEscapeRegExp",{methods:{escapeRegExp:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}}});!function(){var a=1;Role("Siesta.Util.Role.HasUniqueGeneratedId",{has:{id:{is:"ro",init:function(){return a++}}}})}();
Class("Siesta.Util.Queue",{has:{steps:Joose.I.Array,interval:100,callbackDelay:0,deferer:{required:!0},deferClearer:null,processor:null,processorScope:null,currentTimeout:null,callback:null,scope:null,isAborted:!1,observeTest:null,currentDelayStepId:null,isDestroyed:!1},methods:{addStep:function(a){this.addSyncStep(a)},addSyncStep:function(a){this.steps.push(a)},addAsyncStep:function(a){a.isAsync=!0;this.steps.push(a)},addDelayStep:function(a){var b=this.deferer,c=this;this.addAsyncStep({processor:function(d){c.currentDelayStepId=
b(d.next,a||500)}})},run:function(a,b){this.callback=a;this.scope=b;this.observeTest&&this.observeTest.on("teststop",function(){this.abort(!0)},this,{single:!0});this.doSteps(this.steps.slice(),a,b)},abort:function(a){if(!this.isDestroyed){this.isAborted=!0;var b=this.deferClearer;if(!b)throw"Need `deferClearer` to be able to `abort` the queue";b(this.currentDelayStepId);b(this.currentTimeout);a||this.callback.call(this.scope||this);this.destroy()}},doSteps:function(a,b,c){this.currentTimeout=null;
var d=this,e=this.deferer,f=a.shift();if(!this.isAborted)if(f)for(;this.doOneStep(f,a,b,c)&&!this.isAborted;)if(a.length)f=a.shift();else{this.doSteps(a,b,c);break}else b&&(this.callbackDelay?e(function(){d.isAborted||(b.call(c||this),d.destroy())},this.callbackDelay):(b.call(c||this),d.destroy()))},doOneStep:function(a,b,c,d){var e=this,f=this.deferer,g=a.processor||this.processor,k=a.processorScope||this.processorScope,l=this.steps.length-b.length-1;if(!g)throw Error("No process function found for step: "+
l);if(a.isAsync){var m=!1,n=!1,f=a.next=function(){n?e.doSteps(b,c,d):m=!0};g.call(k||e,a,l,this,f);n=!0;if(m)return!0}else g.call(k||e,a,l,this),this.isAborted||((a=a.hasOwnProperty("interval")?a.interval:e.interval)?this.currentTimeout=f(function(){e.doSteps(b,c,d)},a):e.doSteps(b,c,d))},destroy:function(){if(!this.isDestroyed){this.processor=this.processorScope=this.callback=this.observeTest=this.deferer=this.deferClearer=null;for(var a=0;a<this.steps.length;a++)this.steps[a].next=null;this.steps=
null;this.isDestroyed=!0}}}});
Class("Siesta.Util.XMLNode",{has:{children:Joose.I.Array,tag:{required:!0},attributes:Joose.I.Object,textContent:null,escapeTable:{init:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"}}},methods:{escapeXml:function(a){var b=this;return"string"!=typeof a?a:a.replace(/[&<>"]/g,function(a){return b.escapeTable[a]})},toString:function(){var a=this,b=[];Joose.A.each(this.children,function(a){b.push(a.toString())});var c=[];Joose.O.each(this.attributes,function(b,e){c.push(e+'="'+a.escapeXml(b)+'"')});
c.sort();c.unshift(this.tag);return"<"+c.join(" ")+">"+(null!=this.textContent?this.escapeXml(this.textContent):"")+b.join("")+"</"+this.tag+">"},appendChild:function(a){a instanceof Siesta.Util.XMLNode?a.parent=this:a=new Siesta.Util.XMLNode(Joose.O.extend(a,{parent:this}));this.children.push(a);return a},setAttribute:function(a,b){this.attributes[a]=b}}});
Class("Siesta.Util.Rect",{has:{left:null,top:null,width:null,height:null,right:null,bottom:null},methods:{initialize:function(){var a=this.left,b=this.width,c=this.right;null==c&&null!=a&&null!=b&&(this.right=a+b-1);null==b&&null!=a&&null!=c&&(this.width=c-a+1);a=this.top;b=this.height;c=this.bottom;null==c&&null!=a&&null!=b&&(this.bottom=a+b-1);null==b&&null!=a&&null!=c&&(this.height=c-a+1)},isEmpty:function(){return null==this.left},intersect:function(a){return a.isEmpty()||this.isEmpty()||a.left>
this.right||a.right<this.left||a.top>this.bottom||a.bottom<this.top?this.my.getEmpty():new this.constructor({left:Math.max(this.left,a.left),right:Math.min(this.right,a.right),top:Math.max(this.top,a.top),bottom:Math.min(this.bottom,a.bottom)})},contains:function(a,b){return this.left<=a&&a<=this.right&&this.top<=b&&b<=this.bottom},cropLeftRight:function(a){return this.intersect(new this.constructor({left:a.left,right:a.right,top:this.top,bottom:this.bottom}))},cropTopBottom:function(a){return this.intersect(new this.constructor({left:this.left,
right:this.right,top:a.top,bottom:a.bottom}))},equalsTo:function(a){return this.left==a.left&&this.right==a.right&&this.top==a.top&&this.bottom==a.bottom}},my:{has:{HOST:null},methods:{getEmpty:function(){return new this.HOST}}}});Class("Siesta.Content.Resource",{has:{url:null,content:null},methods:{asHTML:function(){throw"Abstract method called";},asDescriptor:function(){throw"Abstract method called";},canCache:function(){}}});
Class("Siesta.Content.Resource.CSS",{isa:Siesta.Content.Resource,has:{},methods:{asHTML:function(){},asDescriptor:function(){var a={type:"css"};this.url&&(a.url=this.url);this.content&&(a.content=this.content);return a}}});
Class("Siesta.Content.Resource.JavaScript",{isa:Siesta.Content.Resource,has:{instrument:!1,isEcmaModule:!1},methods:{asHTML:function(){},asDescriptor:function(){var a={type:"js"};this.url&&(a.url=this.url);this.content&&(a.content=this.content);this.isEcmaModule&&(a.isEcmaModule=this.isEcmaModule);return a}}});
Class("Siesta.Content.Preset",{has:{preload:Joose.I.Array,resources:Joose.I.Array},methods:{initialize:function(){var a=this;Joose.A.each(this.preload,function(b){a.addResource(b)})},isCSS:function(a){return/\.css(\?.*)?$/i.test(a)},getResourceFromDescriptor:function(a){var b,c;if("string"==typeof a)b=this.isCSS(a)?Siesta.Content.Resource.CSS:Siesta.Content.Resource.JavaScript,c={url:a};else if(a.text)b=Siesta.Content.Resource.JavaScript,c={content:a.text};else{if(!a.url&&!a.content)throw"Incorrect preload descriptor:"+
a;b=a.type&&"css"==a.type||this.isCSS(a.url)?Siesta.Content.Resource.CSS:Siesta.Content.Resource.JavaScript;c={};a.url&&(c.url=a.url);a.content&&(c.content=a.content);a.instrument&&(c.instrument=a.instrument);a.isEcmaModule&&(c.isEcmaModule=a.isEcmaModule)}return new b(c)},addResource:function(a){a=a instanceof Siesta.Content.Resource&&a||this.getResourceFromDescriptor(a);this.resources.push(a);return a},eachResource:function(a,b){return Joose.A.each(this.resources,a,b||this)},prepareScope:function(a,
b){this.eachResource(function(c){b.hasContentOf(c)?a.addPreload({type:c instanceof Siesta.Content.Resource.CSS?"css":"js",content:b.getContentOf(c)}):a.addPreload(c.asDescriptor())})}}});
Class("Siesta.Content.Manager",{has:{disabled:!1,presets:{required:!0},urls:Joose.I.Object,maxLoads:5,project:null},methods:{cache:function(a,b,c){if(this.disabled)a&&a();else{var d=this.urls,e=this;Joose.A.each(this.presets,function(a){a.eachResource(function(a){a.url&&(d[a.url]=null)})});var f=0,g=0,k=[];Joose.O.each(d,function(a,b){e.hasContentOf(b)||k.push(b)});var l=k.length;if(l)for(var m=function(){if(k.length){var n=k.shift();e.load(n,function(b){g||(d[n]=b,++f==l?a&&a():m())},c?function(){++f==
l?a&&a():m()}:function(){g++;b&&b(n)})}},n=0;n<this.maxLoads;n++)m();else a&&a()}},load:function(a,b,c){throw"abstract method `load` called";},addContent:function(a,b){this.urls[a]=b},hasContentOf:function(a){a instanceof Siesta.Content.Resource&&(a=a.url);return"string"==typeof this.urls[a]},getContentOf:function(a){a instanceof Siesta.Content.Resource&&(a=a.url);return this.urls[a]}}});
Class("Siesta",{VERSION:"5.3.0",my:{has:{config:null,activeHarness:null,license:"%LICENSE%"},methods:{getConfigForTestScript:function(a){try{return eval(a),this.config}catch(b){return null}},StartTest:function(a,b){this.config="object"==typeof a?a:"object"==typeof b?b:null}}}});"undefined"==typeof StartTest&&(StartTest=Siesta.StartTest);"undefined"==typeof startTest&&(startTest=Siesta.StartTest);"undefined"==typeof describe&&(describe=Siesta.StartTest);
Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d?this:a,b.concat(Array.prototype.slice.call(arguments)))};d.prototype=this.prototype;e.prototype=new d;return e});
Siesta.CurrentLocale=Siesta.CurrentLocale||{"Siesta.Project":{preloadHasFailed:"Preload of {url} has failed",preloadHasFailedForTest:"Preload of {url} has failed for test {test}",staticDeprecationWarning:"You are calling static method `{methodName}` of the project class {projectClass}. Such usage is deprecated now, please switch to creation of the project class instance: `var project = new {projectClass}()`",resourceFailedToLoad:"Loading of a {nodeName} resource failed",crossOriginFailed:"Failed to access cross-origin page: {url}. \nIn general tests should reside on the same domain as the app itself,\nbut you can try to disable web security:\nhttps://www.bryntum.com/blog/testing-x-domain-websites-with-siesta-in-chrome/"},
"Siesta.Project.Browser.UI.AboutWindow":{upgradeText:"Upgrade to Siesta Standard",closeText:"Close",titleText:"ABOUT SIESTA (v. {VERSION})",bodyText:'<img height="35" src="https://www.bryntum.com/bryntum-logo.png"/><p>Siesta is a JavaScript unit and functional test tool made by <a target="_blank" href="https://www.bryntum.com">Bryntum</a>. You can test any web page or JavaScript code, including Ext JS, jQuery or NodeJS. Siesta comes in two versions: <strong>Lite</strong> and <strong>Standard</strong>. With Lite, you can launch your tests in the browser UI. With the Standard version, you can also automate your tests and use the automation scripts together with tools like Puppeteer or Selenium WebDriver. </p>Siesta would not be possible without these awesome products & libraries: <br><ul style="padding:0 0 0 30px"><li><a href="http://sencha.com/extjs">Ext JS</a></li><li><a href="http://jquery.com">jQuery</a></li><li><a href="http://http://alexgorbatchev.com/SyntaxHighlighter/">SyntaxHighlighter</a></li><li><a href="http://joose.it/">Joose</a></li><li><a href="https://github.com/gotwarlost/istanbul">Istanbul</a></li></ul>'},
"Siesta.Project.Browser.UI.AssertionGrid":{initializingText:"Initializing test..."},"Siesta.Project.Browser.UI.CoverageReport":{closeText:"Close",showText:"Show: ",lowText:"Low",mediumText:"Med",highText:"High",statementsText:"Statements",branchesText:"Branches",functionsText:"Functions",linesText:"Lines",loadingText:"Loading coverage data...",loadingErrorText:"Loading error",loadingErrorMessageText:"Could not load the report data from this url: ",globalNamespaceText:"[Global namespace]"},"Siesta.Project.Browser.UI.DomContainer":{title:"DOM Panel",
viewDocsText:"View documentation for ",docsUrlText:"http://docs.sencha.com/{0}/apidocs/#!/api/{1}"},"Siesta.Project.Browser.UI.ResultPanel":{rerunText:"Run test",toggleDomVisibleText:"Toggle DOM visible",viewSourceText:"View source",showFailedOnlyText:"Show failed only",componentInspectorText:"Toggle Ext Component Inspector",eventRecorderText:"Event Recorder",closeText:"Close"},"Siesta.Project.Browser.UI.TestGrid":{mouseSimulation:"Mouse simulation",title:"Test list",nameText:"Name",filterTestsText:"Filter tests",
expandCollapseAllText:"Expand / Collapse all",runCheckedText:"Run checked",runFailedText:"Run failed",runAllText:"Run all",observerModeText:"Observer mode",observerModeTooltip:"Sets the `forceDOMVisible` and `runCore=sequential` globally",passText:"Pass",failText:"Fail",optionsText:"Options...",todoPassedText:"todo assertion(s) passed",todoFailedText:"todo assertion(s) failed",viewDomText:"View DOM",transparentExText:"Transparent exceptions",transparentExTooltip:"Disable internal try/catch for any exceptions from tests. Useful for debugging.",
cachePreloadsText:"Cache preloads",autoLaunchText:"Auto launch",autoLaunchTooltip:"Launch the test suite immediately after project page load.",speedRunText:"Fast (still accurate)",speedRunTooltip:"Reduce mouse cursor visualization quality to run tests faster",superSpeedRun:"Very fast, but inaccurate",superSpeedRunTooltip:"Sets the `mouseMovePrecision` option to `Infinity`. Read the docs before using.",breakOnFailText:"Break on fail",breakOnFailTooltip:"Stop the test suite on first failed assertion",
debuggerOnFailText:"Debugger on fail",debuggerOnFailTooltip:"Issue a `debugger` statement on any failed assertion. Useful for debugging",aboutText:"About Siesta",documentationText:"Siesta Documentation",siestaDocsUrl:"https://bryntum.com/docs/siesta",filterFieldTooltip:"Supported patterns for tests filtering:\nWORD - any word, will match with the test file name (no directory part)\nWORD | WORD - any of the alternative patterns\nGROUP > TEST - first match GROUP with the group name, then TEST with tests inside that group\nGROUP1 | GROUP2 > TEST1 | TEST2 - alternation support for groups too\n",
landscape:"Landscape"},"Siesta.Project.Browser.UI.VersionUpdateButton":{newUpdateText:"New Update Available...",updateWindowTitleText:"New version available for download! Current version: ",cancelText:"Cancel",changelogLoadFailedText:"Bummer! Failed to fetch changelog.",downloadText:"Download ",liteText:" (Lite)",standardText:" (Standard)",loadingChangelogText:"Loading changelog..."},"Siesta.Project.Browser.UI.Viewport":{apiLinkText:"API Documentation",apiLinkUrl:"https://bryntum.com/docs/siesta",
uncheckOthersText:"Uncheck others (and check this)",uncheckAllText:"Uncheck all",checkAllText:"Check all",runThisText:"Run this",expandAll:"Expand all",collapseAll:"Collapse all",filterToCurrentGroup:"Filter to current group",filterToFailed:"Filter to failed",httpWarningTitle:"You must use a web server",httpWarningDesc:"You must run Siesta in a web server context, and not using the file:/// protocol",viewSource:"View source"},"Siesta.Project.Browser":{codeCoverageWarningText:"Can not enable code coverage - did you forget to include the `siesta-coverage-all.js` on the project page?",
noJasmine:"No `jasmine` object found on spec runner page",noJasmineSiestaReporter:"Can't find SiestaReporter in Jasmine. \nDid you add the `siesta/bin/jasmine-siesta-reporter.js` file to your spec runner page?"},"Siesta.Result.Assertion":{todoText:"TODO: ",passText:"ok",failText:"fail"},"Siesta.Role.ConsoleReporter":{passText:"PASS",failText:"FAIL",warnText:"WARN",errorText:"ERROR",missingFileText:"Test file [{URL}] not found.",allTestsPassedText:"All tests passed",failuresFoundText:"There are failures"},
"Siesta.Test.Action.Drag":{byOrToMissingText:'Either "to" or "by" configuration option is required for "drag" step',byAndToDefinedText:'Exactly one of "to" or "by" configuration options is required for "drag" step, not both'},"Siesta.Test.Action.Eval":{invalidMethodNameText:"Invalid method name: ",wrongFormatText:"Wrong format of the action string: ",parseErrorText:"Can't parse arguments: "},"Siesta.Test.Action.Wait":{missingMethodText:"Could not find a waitFor method named "},"Siesta.Test.BDD.Expectation":{expectText:"Expect",
needNotText:"Need not",needText:"Need",needMatchingText:"Need matching",needNotMatchingText:"Need not matching",needStringNotContainingText:"Need string not containing",needStringContainingText:"Need string containing",needArrayNotContainingText:"Need array not containing",needArrayContainingText:"Need array containing",needGreaterEqualThanText:"Need value greater or equal than",needGreaterThanText:"Need value greater than",needLessThanText:"Need value less than",needLessEqualThanText:"Need value less or equal than",
needValueNotCloseToText:"Need value not close to",needValueCloseToText:"Need value close to",toBeText:"to be",toBeDefinedText:"to be defined",toBeUndefinedText:"to be undefined",toBeEqualToText:"to be equal to",toBeTruthyText:"to be truthy",toBeFalsyText:"to be falsy",toMatchText:"to match",toContainText:"to contain",toBeLessThanText:"to be less than",toBeGreaterThanText:"to be greater than",toBeCloseToText:"to be close to",toThrowText:"to throw exception",thresholdIsText:"Threshold is ",exactMatchText:"Exact match text",
thrownExceptionText:"Thrown exception",noExceptionThrownText:"No exception thrown",wrongSpy:"Incorrect spy instance",toHaveBeenCalledDescTpl:"Expect method {methodName} to have been called {!need} times",actualNbrOfCalls:"Actual number of calls",expectedNbrOfCalls:"Expected number of calls",toHaveBeenCalledWithDescTpl:"Expect method {methodName} to have been called at least once with the specified arguments"},"Siesta.Test.ExtJS.Ajax":{ajaxIsLoading:"An Ajax call is currently loading",allAjaxRequestsToComplete:"all ajax requests to complete",
ajaxRequest:"ajax request",toComplete:"to complete"},"Siesta.Test.ExtJS.Component":{badInputText:"Expected an Ext.Component, got",toBeVisible:"to be visible",toNotBeVisible:"to not be visible",component:"component",Component:"Component",componentQuery:"componentQuery",compositeQuery:"composite query",toReturnEmptyArray:"to return an empty array",toReturnEmpty:"to return empty",toReturnAVisibleComponent:"to return a visible component",toReturnHiddenCmp:"to return a hidden/missing component",invalidDestroysOkInput:"No components provided, or component query returned empty result",
exception:"Exception",exceptionAnnotation:'Exception thrown while calling "destroy" method of',destroyFailed:"was not destroyed (probably destroy was canceled in the `beforedestroy` listener)",destroyPassed:"All passed components were destroyed ok"},"Siesta.Test.ExtJS.DataView":{view:"view",toRender:"to render"},"Siesta.Test.ExtJS.Element":{top:"top",left:"left",bottom:"bottom",right:"right"},"Siesta.Test.ExtJS.Grid":{waitForRowsVisible:"rows to show for panel with id",waitForCellEmpty:"cell to be empty"},
"Siesta.Test.ExtJS.Observable":{hasListenerInvalid:"1st argument for `t.hasListener` should be an observable instance",hasListenerPass:"Observable has listener for {eventName}",hasListenerFail:"Provided observable has no listeners for event",isFiredWithSignatureNotFired:"event was not fired during the test",observableFired:"Observable fired",correctSignature:"with correct signature",incorrectSignature:"with incorrect signature"},"Siesta.Test.ExtJS.Store":{storesToLoad:"stores to load",failedToLoadStore:"Failed to load the store",
URL:"URL"},"Siesta.Test.Action":{missingTestAction:"Action [{0}] requires `{1}` method in your test class"},"Siesta.Test.BDD":{codeBodyMissing:"Code body is not provided for",codeBodyOf:"Code body of",missingFirstArg:"does not declare a test instance as 1st argument",iitFound:"t.iit should only be used during debugging",noObject:"No object to spy on"},"Siesta.Test.BDD.Spy":{spyingNotOnFunction:"Trying to create a spy over a non-function property"},"Siesta.Test.Browser":{popupsDisabled:"Failed to open the popup for url: {url}. Enable the popups in the browser settings.",
noDomElementFound:"No DOM element found for CSS selector",noActionTargetFound:"No action target found for",waitForEvent:"observable to fire its",event:"event",wrongFormat:"Wrong format for expected number of events",unrecognizedSignature:"Unrecognized signature for `firesOk`",observableFired:"Observable fired",observableFiredOk:"Observable fired expected number of",actualNbrEvents:"Actual number of events",expectedNbrEvents:"Expected number of events",events:"events",noElementFound:"Could not find any element at",
targetElementOfAction:"Target element of action",targetElementOfSomeAction:"Target element of some action",isNotVisible:"is not visible or not reachable",text:"text",toBePresent:"to be present",toNotBePresent:"to not be present",target:"target",toAppear:"to appear",targetMoved:"Moving target detected, retargeting initiated",alertMethodNotCalled:"Expected a call to alert()",focusLostWarning:"Focus has left the test window {url}",focusLostWarningLauncher:"Focus has left the test window {url}, it will be restarted. This behavior is controled with the --restart-on-blur option."},
"Siesta.Test.Date":{isEqualTo:"is equal to",Got:"Got"},"Siesta.Test.Element":{elementContent:"element content",toAppear:"to appear",toDisappear:"to disappear",toAppearAt:"to appear at",monkeyException:"Monkey testing action did not complete properly - probably an exception was thrown",monkeyNoExceptions:"No exceptions thrown during monkey test",monkeyActionLog:"Monkey action log",elementHasClass:"Element has the CSS class",elementHasNoClass:"Element has no CSS class",elementClasses:"Classes of element",
needClass:"Need CSS class",hasStyleDescTpl:"Element has correct {value} for CSS style {property}",elementStyles:"Styles of element",needStyle:"Need style",hasNotStyleDescTpl:"Element does not have: {value} for CSS style {property}",hasTheStyle:"Element has the style",element:"element",toBeTopEl:"to be the top element at its position",toNotBeTopEl:"to not be the top element at its position",selector:"selector",selectors:"selectors",noCssSelector:"A CSS selector must be supplied",waitForSelectorsBadInput:"An array of CSS selectors must be supplied",
Position:"Position",noElementAtPosition:"No element found at the specified position",elementIsAtDescTpl:"DOM element or its child is at [ {x}, {y} ] coordinates",topElement:"Top element",elementIsAtPassTpl:"DOM element is at [ {x}, {y} ] coordinates",allowChildrenDesc:"Need exactly this or its child",allowChildrenAnnotation:"Passed element is not the top-most one and not the child of one",shouldBe:"Should be",noChildrenFailAnnotation:"Passed element is not the top-most one",topLeft:"(t-l)",bottomLeft:"(b-l)",
topRight:"(t-r)",bottomRight:"(b-r)",elementIsNotTopElementPassTpl:"Element is not the top element on the screen",selectorIsAtPassTpl:"Found element matching CSS selector {selector} at [ {xy} ]",elementMatching:"Element matching",selectorIsAtFailAnnotation:"Passed selector does not match any selector at",selectorExistsFailTpl:"No element matching the passed selector found",selectorExistsPassTpl:"Found DOM element(s) matching CSS selector {selector}",selectorNotExistsFailTpl:"Elements found matching the passed selector",
selectorNotExistsPassTpl:"Did not find any DOM element(s) matching CSS selector {selector}",toChangeForElement:"to change for element",selectorCountIsPassTpl:"Found exactly {count} elements matching {selector}",selectorCountIsFailTpl:"Found {got} elements matching the selector {selector}, expected {need}",isInViewPassTpl:"Passed element is within the visible viewport",toAppearInTheViewport:"to appear in the viewport",elementIsEmptyPassTpl:"Passed element is empty",elementIsNotEmptyPassTpl:"Passed element is not empty",
elementToBeEmpty:"element to be empty",elementToNotBeEmpty:"element to not be empty"},"Siesta.Test.ExtJS":{bundleUrlNotFound:"Cannot find Ext JS bundle url",assertNoGlobalExtOverridesInvalid:"Was not able to find the Ext JS bundle URL in the `assertNoGlobalExtOverrides` assertion",assertNoGlobalExtOverridesPassTpl:"No global Ext overrides found",assertNoGlobalExtOverridesGotDesc:"Number of overrides found",foundOverridesFor:"Found overrides for",animationsToFinalize:"animations to finalize",extOverridesInvalid:"Was not able to find the ExtJS bundle URL in the `assertMaxNumberOfGlobalExtOverrides` assertion)",
foundLessOrEqualThan:"Found less or equal than",nbrOverridesFound:"Number of overrides found",globalOverrides:"Ext JS global overrides"},"Siesta.Test.ExtJSCore":{waitedForRequires:"Waiting for required classes took too long - \nCheck the `Net` tab in Firebug and the `loaderPath` config",waitedForExt:"Waiting for Ext.onReady took too long - probably some dependency could not be loaded. \nCheck the `Net` tab in Firebug and the `loaderPath` config",waitedForApp:"Waiting for MVC application launch took too long - no MVC application on test page? \nYou may need to disable the `waitForAppReady` config option",
noComponentMatch:'Your component query: "{component}" returned no components',multipleComponentMatch:'Your component query: "{component}" returned more than 1 component',noComponentFound:"No component found for CQ",knownBugIn:"Known bug in",Class:"Class",wasLoaded:"was loaded",wasNotLoaded:"was not loaded",invalidCompositeQuery:"Invalid composite query selector",ComponentQuery:"ComponentQuery",CompositeQuery:"CompositeQuery",matchedNoCmp:"matched no Ext.Component",messageBoxVisible:"Message box is visible",
messageBoxHidden:"Message box is hidden",waitedForComponentQuery:"Waiting too long for Ext.ComponentQuery"},"Siesta.Test.Function":{Need:"need",atLeast:"at least",exactly:"exactly",methodCalledExactly:"method was called exactly {n} times",exceptionEvalutingClass:"Exception [{e}] caught while evaluating the class name"},"Siesta.Test.More":{isGreaterPassTpl:"`{value1}` is greater than `{value2}`",isLessPassTpl:"`{value1}` is less than `{value2}`",isGreaterEqualPassTpl:"`{value1}` is greater or equal to`{value2}`",
isLessEqualPassTpl:"`{value1}` is less or equal to`{value2}`",isApproxToPassTpl:"`{value1}` is approximately equal to `{value2}`",needGreaterThan:"Need greater than",needGreaterEqualTo:"Need greater or equal to",needLessThan:"Need less than",needLessEqualTo:"Need less or equal to",exactMatch:"Exact match",withinThreshold:"Match within treshhold",needApprox:"Need approx",thresholdIs:"Threshold is",stringMatchesRe:"`{string}` matches regexp {regex}",stringNotMatchesRe:"`{string}` does not match regexp {regex}",
needStringMatching:"Need string matching",needStringNotMatching:"Need string not matching",needStringContaining:"Need string containing",needStringNotContaining:"Need string not containing",stringHasSubstring:"`{string}` has a substring: `{regex}`",stringHasNoSubstring:"`{string}` does not have a substring: `{regex}`",throwsOkInvalid:"throws_ok accepts a function as 1st argument",didntThrow:"Function did not throw an exception",exMatchesRe:"Function throws exception matching to {expected}",exceptionStringifiesTo:"Exception stringifies to",
exContainsSubstring:"Function throws exception containing a substring: {expected}",fnDoesntThrow:"Function does not throw any exceptions",fnThrew:"Function threw an exception",isInstanceOfPass:"Object is an instance of the specified class",needInstanceOf:"Need instance of",isAString:"{value} is a string",aStringValue:"AStringValue",isAnObject:"{value} is an object",anObject:"An object value",isAnArray:"{value} is an array",anArrayValue:"An array value",isANumber:"{value} is a number",aNumberValue:"a number value",
isABoolean:"{value} is a boolean",aBooleanValue:"a number value",isADate:"{value} is a date",aDateValue:"a date value",isARe:"{value} is a regular expression",aReValue:"a regular expression",isAFunction:"{value} is a function",aFunctionValue:"a function",isDeeplyPassTpl:"{obj1} is deeply equal to {obj2}",isDeeplyStrictPassTpl:"{obj1} is strictly deeply equal to {obj2}",globalCheckNotSupported:"Testing leakage of global variables is not supported on this platform",globalVariables:"Global Variables",
noGlobalsFound:"No unexpected global variables found",globalFound:"Unexpected global found",globalName:"Global name",value:"value",conditionToBeFulfilled:"condition to be fulfilled",pageToLoad:"page to load",ms:"ms",waitingFor:"Waiting for",waitedTooLong:"Waited too long for",conditionNotFulfilled:"Condition was not fullfilled during",waitingAborted:"Waiting aborted",Waited:"Waited",checkerException:"checker threw an exception",Exception:"Exception",msFor:"ms for",forcedWaitFinalization:"Forced finalization of waiting for",
chainStepNotCompleted:"The step in `t.chain()` call did not complete within required timeframe, chain can not proceed",stepNumber:"Step number",oneBased:"(1-based)",atLine:"At line",chainStepEx:"Chain step threw an exception",stepFn:"Step function",notUsingNext:'does not use the provided "next" function anywhere',calledMoreThanOnce:"The `next` callback of {num} step (1-based) of `t.chain()` call at line {line} is called more than once.",tooManyDifferences:"Showing {num} of {total} differences"},"Siesta.Test.SenchaTouch":{STSetupFailed:"Waiting for Ext.setup took too long - some dependency could not be loaded? Check the `Net` tab in Firebug",
invalidSwipeDir:"Invalid swipe direction",moveFingerByInvalidInput:"Trying to call moveFingerBy without relative distances",scrollUntilFailed:"scrollUntil failed to achieve its mission",scrollUntilElementVisibleInvalid:"scrollUntilElementVisible: target or scrollable not provided",scrollerReachPos:"scroller to reach position"},"Siesta.Test":{noCodeProvidedToTest:"No code provided to test",addingAssertionsAfterDone:"Adding assertions after the test has finished",testFailedAndAborted:"Assertion failed, test execution aborted",
atLine:"at line",of:"of",character:"character",isTruthy:'`{value}` is a "truthy" value',needTruthy:'Need "truthy" value',isFalsy:'`{value}` is a "falsy" value',needFalsy:'Need "falsy" value',isEqualTo:"`{got}` is equal to `{expected}`",isNotEqualTo:"`{got}` is not equal to `{expected}`",needNot:"Need not",isStrictlyEqual:"`{got}` is strictly equal to `{expected}`",needStrictly:"Need strictly",isStrictlyNotEqual:"`{got}` is strictly not equal to `{expected}`",needStrictlyNot:"Need strictly not",alreadyWaiting:"Already waiting with title",
noOngoingWait:"There is no ongoing `wait` action with title",noMatchingEndAsync:"No matching `endAsync` call within {time}ms",endAsyncMisuse:"Calls to endAsync without argument should only be performed if you have single beginAsync statement",codeBodyMissingForSubTest:"Code body is not provided for sub test [{name}]",codeBodyMissingTestArg:"Code body of sub test [{name}] does not declare a test instance as 1st argument",Subtest:"Subtest",Test:"Test",failedToFinishWithin:"Subtest {name} failed to finish within {timeout}ms",
threwException:"threw an exception",testAlreadyStarted:"Test has already been started",setupTookTooLong:"`setup` method took too long to complete",errorBeforeTestStarted:"Error happened before the test started",testStillRunning:"Your test is still considered to be running, if this is unexpected please see console for more information",testNotFinalized:'Your test [{url}] has not finalized, most likely since a timer (setTimeout) is still active. If this is the expected behavior, try setting "overrideSetTimeout : false" on your Harness configuration.',
missingDoneCall:"Test has completed, but there was no `t.done()` call. Add it at the bottom, or use `t.beginAsync()` for asynchronous code",allTestsPassed:"All tests passed","Snoozed until":"Snoozed until",testTearDownTimeout:"Test's tear down process has timeout out"},"Siesta.Recorder.UI.Editor.Code":{invalidSyntax:"Invalid syntax"},"Siesta.Recorder.UI.Editor.DragTarget":{targetLabel:"Target",toLabel:"To",byLabel:"By",cancelButtonText:"Cancel",saveButtonText:"Save",dragVariantTitle:"Edit `drag` action",
moveCursorVariantTitle:"Edit `moveCursor` action"},"Siesta.Recorder.UI.RecorderPanel":{actionColumnHeader:"Action",offsetColumnHeader:"Offset",queryMatchesNothing:"Query matches no DOM elements or components",queryMatchesMultiple:"Query matches multiple components",noVisibleElsFound:"No visible elements found for target",noTestDetected:"No test detected",noTestStarted:"You need to run a test first, or provide a Page URL",recordTooltip:"Record",stopTooltip:"Stop",playTooltip:"Play",clearTooltip:"Clear all",
codeWindowTitle:"Code",addNewTooltip:"Add a new step",removeAllPromptTitle:"Remove all?",removeAllPromptMessage:"Do you want to clear the recorded events?",Error:"Error",showSource:"Show source",showSourceInNewWindow:"Show source in new window",newRecording:"New recording...",pageUrl:"Page URL"},"Siesta.Recorder.UI.TargetColumn":{headerText:"Target / Value",by:"by",to:"to",coordinateTargetWarning:"Siesta was unable to find a stable selector for this target. Using coordinates as locator is not recommended."}};
Siesta.Resource=function(){var a={},b=Class({does:Siesta.Util.Role.CanFormatStrings,has:{dict:null},methods:{get:function(a,b){var e=this.dict[a];if(e)return this.formatString(e,b);window.console&&console.error&&window.top.console.error("TEXT_NOT_DEFINED: "+a);return"TEXT_NOT_DEFINED: "+a}}});return function(c,d,e){var f=Siesta.CurrentLocale[c];if(!f)throw"Missing dictionary for namespace: "+c;var g=a[c];g||(g=a[c]=new b({dict:f,serializeFormatingPlaceholders:!1}));return d?g.get(d,e):g}}();
(function(){var a=0;Class("Siesta.Result",{has:{description:null,children:Joose.I.Array,length:0,id:function(){return++a},parent:null},methods:{itemAt:function(a){return this.children[a]},push:function(a){this.children.push(a);a.parent=this;this.length=this.children.length},each:function(a,c){var d=this.children;if(!1===a.call(c||this,this))return!1;for(var e=0;e<d.length;e++)if(!1===d[e].each(a,c))return!1},eachChild:function(a,c){for(var d=this.children,e=0;e<d.length;e++)if(!1===a.call(c,d[e]))return!1},
toString:function(){return this.description},toJSON:function(){return{type:this.meta.name,description:this.description}},findChildById:function(a){var c;this.each(function(d){if(d.id==a)return c=d,!1});return c}},my:{methods:{seedID:function(b){a=b}}}})})();
Class("Siesta.Result.Diagnostic",{isa:Siesta.Result,has:{isWarning:!1},methods:{toString:function(){return"# "+this.description},toJSON:function(){var a={parentId:this.parent.id,type:this.meta.name,description:this.description};this.isWarning&&(a.isWarning=!0);return a}}});Class("Siesta.Result.Summary",{isa:Siesta.Result,has:{isFailed:!1},methods:{getTest:function(){return this.parent.test},toString:function(){}}});
Class("Siesta.Result.Assertion",{isa:Siesta.Result,has:{name:null,passed:null,annotation:null,index:null,sourceLine:null,isTodo:!1,isException:!1,exceptionType:null,isWaitFor:!1,completed:!1},methods:{isPassed:function(a){return a?this.passed:this.isTodo||this.isWaitFor&&!this.completed?!0:this.passed},toString:function(){var a=Siesta.Resource("Siesta.Result.Assertion"),a=(this.isTodo?a.get("todoText"):"")+(this.passed?a.get("passText"):a.get("failText"))+" "+this.index+" - "+this.description;this.annotation&&
(a+="\n"+this.annotation);return a},toJSON:function(){var a=this,b={parentId:this.parent.id,type:this.meta.name,passed:this.passed,index:this.index,description:String(this.description)||"No description"};this.annotation&&(b.annotation=String(this.annotation));Joose.A.each(["isTodo","isWaitFor","isException","sourceLine","name"],function(c){a[c]&&(b[c]=a[c])});this.isException&&(b.exceptionType=this.exceptionType);return b}}});
Class("Siesta.Result.SubTest",{isa:Siesta.Result,has:{test:null},methods:{isWorking:function(){return!this.test.isFinished()},toJSON:function(){var a=this.test,b=!(a instanceof Object),c={id:this.id,parentId:a.parent?a.parent.getResults().id:null,type:this.meta.name,name:a.name,startDate:a.startDate,endDate:a.endDate||new Date-0,passed:b?null:a.isPassed()};a.parent||(c.automationElementId=a.automationElementId,c.url=a.url,c.jUnitClass=a.getJUnitClass(),c.groups=a.groups);a.specType&&(c.bddSpecType=
a.specType);a.isTodo&&(c.isTodo=!0);var d=!1,e=[];Joose.A.each(this.children,function(a){if(a instanceof Siesta.Result.Assertion||a instanceof Siesta.Result.Diagnostic||a instanceof Siesta.Result.SubTest)a=a.toJSON(),a.passed||a.isTodo||(d=!0),e.push(a)});c.assertions=e;b&&(c.passed=!(d||a.failed||!a.endDate));return c}}});
Role("Siesta.Test.Function",{methods:{isCalled:function(a,b,c){this.isCalledNTimes(a,b,1,c,!0)},isCalledOnce:function(a,b,c){this.isCalledNTimes(a,b,1,c,!1)},isCalledNTimes:function(a,b,c,d,e){var f=this,g="string"===typeof a?a:f.getPropertyName(b,a),k=0,l=b[g];b[g]=function(){k++;return l.apply(this,arguments)};d=d?d+" ":"";this.on("beforetestfinalizeearly",function(){var a=Siesta.Resource("Siesta.Test.Function");k===c||e&&k>c?f.pass(d||g+" "+a.get("methodCalledExactly").replace("{n}",c)):f.fail(d||
g,{assertionName:"isCalledNTimes "+g,got:k,need:c,needDesc:a.get("Need")+" "+(e?a.get("atLeast"):a.get("exactly"))+" "});b[g]=l})},isntCalled:function(a,b,c){this.isCalledNTimes(a,b,0,c)},getPropertyName:function(a,b){for(var c in a)if(a[c]===b)return c},methodIsCalledNTimes:function(a,b,c,d,e){var f=this,g=0,k=Siesta.Resource("Siesta.Test.Function");d=d?d+" ":"";try{"String"==f.typeOf(b)&&(b=f.global.eval(b))}catch(m){f.fail(d,{assertionName:"isMethodCalled",annotation:k.get("exceptionEvalutingClass").replace("{e}",
m)+"["+b+"]"});return}b=b.prototype;var l="string"===typeof a?a:f.getPropertyName(b,a);f.on("beforetestfinalizeearly",function(){g===c||e&&g>c?f.pass(d||l+" "+k.get("methodCalledExactly").replace("{n}",c)):f.fail(d||l,{assertionName:"methodIsCalledNTimes "+l,got:g,need:c,needDesc:k.get("Need")+" "+(e?k.get("atLeast"):k.get("exactly"))+" "})});a=b[l];b[l]=function(){g++;return a.apply(this,arguments)}},methodIsCalled:function(a,b,c){this.methodIsCalledNTimes(a,b,1,c,!0)},methodIsntCalled:function(a,
b,c){this.methodIsCalledNTimes(a,b,0,c)}}});Role("Siesta.Test.Date",{methods:{isDateEq:function(a,b,c){this.isDateEqual.apply(this,arguments)},isDateEqual:function(a,b,c){var d=Siesta.Resource("Siesta.Test.Date");0===a-b?this.pass(c,{descTpl:"{got} "+d.get("isEqualTo")+" {expectedDate}",got:a,expectedDate:b}):this.fail(c,{assertionName:"isDateEqual",got:a?a.toString():"",gotDesc:d.get("Got"),need:b.toString()})}}});
Role("Siesta.Test.More",{requires:["isFailed","typeOf","on"],has:{autoCheckGlobals:!1,expectedGlobals:Joose.I.Array,disableGlobalsCheck:!1,browserGlobals:{init:["console","getInterface","ExtBox1","__IE_DEVTOOLBAR_CONSOLE_COMMAND_LINE",/__BROWSERTOOLS/,"seleniumAlert","onload","onerror","StartTest","startTest","__loaderInstrumentationHookInstalled__","describe","setTimeout","clearTimeout","requestAnimationFrame","cancelAnimationFrame","__coverage__",/cov_\w+/]},waitForTimeout:1E4,waitForPollInterval:100,
suppressPassedWaitForAssertion:!1},methods:{isGreater:function(a,b,c){var d=Siesta.Resource("Siesta.Test.More");a>b?this.pass(c,{descTpl:d.get("isGreaterPassTpl"),value1:a,value2:b}):this.fail(c,{assertionName:"isGreater",got:a,need:b,needDesc:d.get("needGreaterThan")})},isLess:function(a,b,c){var d=Siesta.Resource("Siesta.Test.More");a<b?this.pass(c,{descTpl:d.get("isLessPassTpl"),value1:a,value2:b}):this.fail(c,{assertionName:"isLess",got:a,need:b,needDesc:d.get("needLessThan")})},isGE:function(){this.isGreaterOrEqual.apply(this,
arguments)},isGreaterOrEqual:function(a,b,c){var d=Siesta.Resource("Siesta.Test.More");a>=b?this.pass(c,{descTpl:d.get("isGreaterEqualPassTpl"),value1:a,value2:b}):this.fail(c,{assertionName:"isGreaterOrEqual",got:a,need:b,needDesc:d.get("needGreaterEqualTo")})},isLE:function(){this.isLessOrEqual.apply(this,arguments)},isLessOrEqual:function(a,b,c){var d=Siesta.Resource("Siesta.Test.More");a<=b?this.pass(c,{descTpl:d.get("isLessEqualPassTpl"),value1:a,value2:b}):this.fail(c,{assertionName:"isLessOrEqual",
got:a,need:b,needDesc:d.get("needLessEqualTo")})},isApprox:function(a,b,c,d){var e=Siesta.Resource("Siesta.Test.More");2==arguments.length&&(c=Math.abs(.05*a));3==arguments.length&&"String"==this.typeOf(c)&&(d=c,c=Math.abs(.05*a));Math.abs(function(a,b){var c=function(a){return(a=(a+"").split(".")[1])&&a.length||0},c=Math.max(c(a),c(b)),c=Math.pow(10,c);return(a*c-b*c)/c}(b,a))<=c?this.pass(d,{descTpl:e.get("isApproxToPassTpl"),value1:a,value2:b,annotation:b==a?e.get("exactMatch"):e.get("withinThreshold")+
": "+c}):this.fail(d,{assertionName:"isApprox",got:a,need:b,needDesc:e.get("needApprox"),annotation:e.get("thresholdIs")+": "+c})},like:function(a,b,c){var d=Siesta.Resource("Siesta.Test.More");"RegExp"==this.typeOf(b)?a.match(b)?this.pass(c,{descTpl:d.get("stringMatchesRe"),string:a,regex:b}):this.fail(c,{assertionName:"like",got:a,need:b,needDesc:d.get("needStringMatching")}):-1!=a.indexOf(b)?this.pass(c,{descTpl:d.get("stringHasSubstring"),string:a,regex:b}):this.fail(c,{assertionName:"like",got:a,
need:b,needDesc:d.get("needStringContaining")})},unlike:function(a,b,c){var d=Siesta.Resource("Siesta.Test.More");"RegExp"==this.typeOf(b)?a.match(b)?this.fail(c,{assertionName:"unlike",got:a,need:b,needDesc:d.get("needStringNotMatching")}):this.pass(c,{descTpl:d.get("stringNotMatchesRe"),string:a,regex:b}):-1==a.indexOf(b)?this.pass(c,{descTpl:d.get("stringHasNoSubstring"),string:a,regex:b}):this.fail(c,{assertionName:"unlike",got:a,need:b,needDesc:d.get("needStringNotContaining")})},"throws":function(){this.throwsOk.apply(this,
arguments)},throws_ok:function(){this.throwsOk.apply(this,arguments)},throwsOk:function(a,b,c){var d=Siesta.Resource("Siesta.Test.More");if("Function"!=this.typeOf(a))throw Error(d.get("throwsOkInvalid"));a=this.getExceptionCatcher()(a);void 0===a?this.fail(c,{assertionName:"throws_ok",annotation:d.get("didntThrow")}):(a instanceof this.getTestErrorClass()&&(a=a.message||a.description),a=""+a,"RegExp"==this.typeOf(b)?a.match(b)?this.pass(c,{descTpl:d.get("exMatchesRe"),expected:b}):this.fail(c,{assertionName:"throws_ok",
got:a,gotDesc:d.get("exceptionStringifiesTo"),need:b,needDesc:d.get("needStringMatching")}):-1!=a.indexOf(b)?this.pass(c,{descTpl:d.get("exContainsSubstring"),expected:b}):this.fail(c,{assertionName:"throws_ok",got:a,gotDesc:d.get("exceptionStringifiesTo"),need:b,needDesc:d.get("needStringContaining")}))},lives_ok:function(){this.livesOk.apply(this,arguments)},lives:function(){this.livesOk.apply(this,arguments)},livesOk:function(a,b){"Function"!=this.typeOf(a)&&(a=[b,b=a][0]);var c=Siesta.Resource("Siesta.Test.More"),
d=this.getExceptionCatcher()(a);void 0===d?this.pass(b,{descTpl:c.get("fnDoesntThrow")}):this.fail(b,{assertionName:"lives_ok",annotation:c.get("fnThrew")+": "+d})},isa_ok:function(a,b,c){this.isInstanceOf(a,b,c)},isaOk:function(a,b,c){this.isInstanceOf(a,b,c)},isInstanceOf:function(a,b,c){var d=Siesta.Resource("Siesta.Test.More");try{"String"==this.typeOf(b)&&(b=this.global.eval(b))}catch(e){this.fail(c,{assertionName:"isa_ok",annotation:Siesta.Resource("Siesta.Test.Function","exceptionEvalutingClass")});
return}a instanceof b?this.pass(c,{descTpl:d.get("isInstanceOfPass")}):this.fail(c,{assertionName:"isa_ok",got:a,need:String(b),needDesc:d.get("needInstanceOf")})},isString:function(a,b){var c=Siesta.Resource("Siesta.Test.More");"String"==this.typeOf(a)?this.pass(b,{descTpl:c.get("isAString"),value:a}):this.fail(b,{got:a,need:c.get("aStringValue")})},isObject:function(a,b){var c=Siesta.Resource("Siesta.Test.More");"Object"==this.typeOf(a)?this.pass(b,{descTpl:c.get("isAnObject"),value:a}):this.fail(b,
{got:a,need:c.get("anObject")})},isArray:function(a,b){var c=Siesta.Resource("Siesta.Test.More");"Array"==this.typeOf(a)?this.pass(b,{descTpl:c.get("isAnArray"),value:a}):this.fail(b,{got:a,need:c.get("anArrayValue")})},isNumber:function(a,b){var c=Siesta.Resource("Siesta.Test.More");"Number"==this.typeOf(a)?this.pass(b,{descTpl:c.get("isANumber"),value:a}):this.fail(b,{got:a,need:c.get("aNumberValue")})},isBoolean:function(a,b){var c=Siesta.Resource("Siesta.Test.More");"Boolean"==this.typeOf(a)?
this.pass(b,{descTpl:c.get("isABoolean"),value:a}):this.fail(b,{got:a,need:c.get("aBooleanValue")})},isDate:function(a,b){var c=Siesta.Resource("Siesta.Test.More");"Date"==this.typeOf(a)?this.pass(b,{descTpl:c.get("isADate"),value:a}):this.fail(b,{got:a,need:c.get("aDateValue")})},isRegExp:function(a,b){var c=Siesta.Resource("Siesta.Test.More");"RegExp"==this.typeOf(a)?this.pass(b,{descTpl:c.get("isARe"),value:a}):this.fail(b,{got:a,need:c.get("aReValue")})},isFunction:function(a,b){var c=Siesta.Resource("Siesta.Test.More");
"Function"==this.typeOf(a)||"AsyncFunction"==this.typeOf(a)?this.pass(b,{descTpl:c.get("isAFunction"),value:a}):this.fail(b,{got:a,need:c.get("aFunctionValue")})},is_deeply:function(a,b,c){this.isDeeply.apply(this,arguments)},isDeeply:function(a,b,c){var d=Siesta.Resource("Siesta.Test.More"),e;if(this.typeOf(a)===this.typeOf(b)&&this.compareObjects(a,b))this.pass(c,{descTpl:d.get("isDeeplyPassTpl"),obj1:a,obj2:b});else if("undefined"!=typeof DeepDiff&&(e=DeepDiff(a,b)))for(5<e.length&&this.diag(d.get("tooManyDifferences",
{num:5,total:e.length})),d=0;d<Math.min(e.length,5);d++){var f=e[d],g=(f.path||[]).join(".");this.fail(c,{assertionName:"isDeeply",got:g?g+": "+f.lhs:a,need:g?g+": "+f.rhs:b});window.console&&console.log("DIFF RESULT:",f)}else this.fail(c,{assertionName:"isDeeply",got:a,need:b})},isDeeplyStrict:function(a,b,c){if(this.typeOf(a)===this.typeOf(b)&&this.compareObjects(a,b,!0)){var d=Siesta.Resource("Siesta.Test.More");this.pass(c,{descTpl:d.get("isDeeplyStrictPassTpl"),obj1:a,obj2:b})}else this.fail(c,
{assertionName:"isDeeplyStrict",got:a,need:b})},expectGlobal:function(){this.expectGlobals.apply(this,arguments)},expectGlobals:function(){this.expectedGlobals.push.apply(this.expectedGlobals,arguments)},isGlobalExpected:function(a,b){var c=this;if(!b||b&&!b.expectedStrings)b||(b={}),Joose.O.extend(b,{expectedStrings:{},expectedRegExps:[]}),Joose.A.each(this.expectedGlobals.concat(this.browserGlobals),function(a){"RegExp"==c.typeOf(a)?b.expectedRegExps.push(a):b.expectedStrings[a]=!0});if(b.expectedStrings[a])return!0;
if(Siesta.Project.Browser.FeatureSupport().supports.imageWithIdCreatesGlobalEnumerable){var d=this.global.document.getElementById(a);if(d&&"img"==d.tagName.toLowerCase())return!0}for(d=0;d<b.expectedRegExps.length;d++)if(b.expectedRegExps[d].test(a))return!0;return!1},forEachUnexpectedGlobal:function(a,b){b=b||this;var c={},d;for(d in this.global)if(!this.isGlobalExpected(d,c)&&!1===a.call(b,d))break},verifyGlobals:function(){var a=Siesta.Resource("Siesta.Test.More");if(this.disableGlobalsCheck)this.diag(a.get("globalCheckNotSupported"));
else{this.expectGlobals.apply(this,arguments);this.diag(a.get("globalVariables"));var b=!1,c=0;this.forEachUnexpectedGlobal(function(d){this.fail(a.get("globalFound"),a.get("globalName")+": "+d+", "+a.get("value")+": "+Siesta.Util.Serializer.stringify(this.global[d]));b=!0;return 50>c++});b||this.pass(a.get("noGlobalsFound"))}},startWaiting:function(a,b){var c=new Siesta.Result.Assertion({description:a,isWaitFor:!0,sourceLine:b});this.fireEvent("testupdate",this,c,this.getResults());return c},finalizeWaiting:function(a,
b,c,d,e,f){a.completed=!0;b?this.suppressPassedWaitForAssertion||f?this.fireEvent("assertiondiscard",this,a):this.pass(c,d,a):(this.fail(c,d,a),e&&e())},waitFor:function(a,b,c,d,e){var f=Siesta.Resource("Siesta.Test.More"),g=" "+f.get("conditionToBeFulfilled"),k="waitFor",l=this,m=l.getSourceLine(),n=l.originalSetTimeout,r=l.originalClearTimeout,p,q;if(1===arguments.length&&"Object"==this.typeOf(a)){var t=a;a=t.method;b=t.callback;c=t.scope;d=t.timeout;e=t.interval;g=t.description||g;k=t.assertionName||
k;q=t.suppressAssertion;p=t.errback}else t={};var v="Number"==this.typeOf(a);b=b||function(){};var g=v?a+" "+f.get("ms"):g,z,w=l.startWaiting(f.get("waitingFor")+" "+g,m);e=e||this.waitForPollInterval;d=d||this.waitForTimeout;var x=this.beginAsync((v?a:d)+3*e,function(){A=!0;r(z);l.finalizeWaiting(w,!1,f.get("waitedTooLong")+": "+g,{assertionName:k,annotation:"Function"===l.typeOf(t.annotation)?t.annotation():f.get("conditionNotFulfilled")+" "+d+f.get("ms")},p,q);return!0}),A=!1;this.on("beforetestfinalize",
function(){A||(A=!0,l.finalizeWaiting(w,!1,f.get("waitingAborted"),null,null,q),l.endAsync(x),r(z))},null,{single:!0});if(v){if(0>a)throw Error("Cannot wait for a negative amount of time");z=n(function(){A=!0;l.finalizeWaiting(w,!0,f.get("Waited")+" "+a+" "+f.get("ms"),null,null,q||0===a);l.endAsync(x);l.processCallbackFromTest(b,[],c||l)},a)}else{var B,F=new Date,C=function(){var m=new Date-F;if(m>d)l.endAsync(x),l.finalizeWaiting(w,!1,f.get("waitedTooLong")+": "+g,{assertionName:k,annotation:"Function"===
l.typeOf(t.annotation)?t.annotation():f.get("conditionNotFulfilled")+" "+d+f.get("ms")},p,q),A=!0;else{try{B=a.call(c||l)}catch(r){l.endAsync(x);l.finalizeWaiting(w,!1,k+" "+f.get("checkerException"),{assertionName:k,got:r.toString(),gotDesc:f.get("Exception")},p,q);A=!0;return}null!=B&&!1!==B?(l.endAsync(x),A=!0,l.finalizeWaiting(w,!0,f.get("Waited")+" "+m+" "+f.get("msFor")+" "+g,"Function"===l.typeOf(t.annotation)?t.annotation():null,null,(q||0===m)&&!t.description),l.processCallbackFromTest(b,
[B],c||l)):z=n(C,e)}};C()}return{force:function(){A||(A=!0,r(z),l.endAsync(x),l.finalizeWaiting(w,!0,f.get("forcedWaitFinalization")+" "+g,null,null,q),l.processCallbackFromTest(b,[],c||l))}}},waitForMs:function(){return this.waitFor.apply(this,arguments)},waitForFn:function(){return this.waitFor.apply(this,arguments)},analyzeChainStep:function(a){a=a.toString();var b=!a.match(/^function/),c;return(c=b?a.match(/^\(/)?a.match(/\(\s*(.*?)\s*(?:,|\))/)[1]:a.match(/(.*?)\s*=>/)[1]:a.match(/function\s*[^(]*\(\s*(.*?)\s*(?:,|\))/)[1])?
-1!=(b?a.match(/=>\s*([\s\S]*)/)[1]:a.match(/\{([\s\S]*)\}/)[1]).indexOf(c):!1},stringifyChainStep:function(a){return this.typeOf(a).match(/^(Async)?Function$/)?a.toString():Siesta.Util.Serializer.stringify(a)},chain:function(){var a=this.flattenArray(arguments),b=Siesta.Resource("Siesta.Test.More"),c=[];Joose.A.each(a,function(a){a&&c.push(a)});var a=c,d=a.length;if(d){var e=this,f=arguments.callee,g=new Siesta.Util.Queue({deferer:this.originalSetTimeout,deferClearer:this.originalClearTimeout,interval:f.hasOwnProperty("actionDelay")?
f.actionDelay:this.simulator?this.simulator.actionDelay:1,observeTest:this});delete f.actionDelay;var k=e.getSourceLine(),l=[];Joose.A.each(a,function(a,c){var f=c==d-1;g.addAsyncStep({processor:function(d){var g=function(f){if(!f)var g=e.beginAsync((a.timeout||e.defaultTimeout)+100,function(){e.fail(b.get("chainStepNotCompleted"),{sourceLine:k,annotation:b.get("stepNumber")+": "+(c+1)+" "+b.get("oneBased")+(k?"\n"+b.get("atLine")+": "+k:"")+"\nStep source: "+e.stringifyChainStep(a),ownTextOnly:!0});
return!0});return{next:function(){var w=arguments.callee;w.__CALLED__&&e.fail(b.get("calledMoreThanOnce",{num:c+1,line:k}));w.__CALLED__=!0;f||e.endAsync(g);l=Array.prototype.slice.call(arguments);a.desc&&e.pass(a.desc);d.next()},async:g}};if(a instanceof Siesta.Test)e.launchSubTest(a,g(!0).next);else if(e.typeOf(a).match(/^(Async)?Function$/)||e.typeOf(a.action).match(/^(Async)?Function$/)){var t=e.typeOf(a).match(/^(Async)?Function$/)?a:a.action,g=g(!1),v=f?function(){}:g.next;l.unshift(v);var z;
if(e.transparentEx)z=t.apply(e,l);else{var w=e.getExceptionCatcher()(function(){z=t.apply(e,l)});void 0!==w&&(f||e.endAsync(g.async),e.failWithException(w,b.get("chainStepEx")))}z||f||e.analyzeChainStep(t)||e.fail(b.get("stepFn")+" ["+t.toString()+"] "+b.get("notUsingNext"));z&&e.handleReturnedPromise(z,v,e.formatString("The promise returned from the chain step ["+e.stringifyChainStep(a)+"] did not resolve within {time}ms",{time:e.defaultTimeout}));f&&(e.endAsync(g.async),a.desc&&e.pass(a.desc))}else("String"==
e.typeOf(a)?new Siesta.Test.Action.Eval({actionString:a,next:g(!1).next,test:e}):Siesta.Test.ActionRegistry().create(a,e,l,g)).process()}})});g.run()}},chainForArray:function(a,b,c,d){var e=this,f=[];Joose.A[d?"eachR":"each"](a,function(a,c){var d=b.call(e,a,c);"Array"==e.typeOf(d)?f.push.apply(f,d):d&&f.push(d)});c&&f.push(function(){e.processCallbackFromTest(c)});this.chain(f)},verifyExpectedNumber:function(a,b){var c="==";if("String"==this.typeOf(b)){var d=/([<>=]=?)\s*(\d+)/.exec(b),c=Siesta.Resource("Siesta.Test.Browser");
if(!d)throw Error(c.get("wrongFormat")+": "+b);c=d[1];b=Number(d[2])}switch(c){case "==":return a==b;case "<=":return a<=b;case ">=":return a>=b;case "<":return a<b;case ">":return a>b}},getMaximalTimeout:function(){return Math.max(this.waitForTimeout,this.defaultTimeout,this.subTestTimeout,this.timeout||0,this.isReadyTimeout)}},after:{onBeforeTestFinalize:function(){!this.autoCheckGlobals||this.isFailed()||this.parent||this.verifyGlobals()}}});Role("Siesta.Test.Role.Placeholder",{requires:["equalsTo"]});
Class("Siesta.Test.BDD.Spy",{does:[Siesta.Util.Role.CanGetType],has:{name:null,processor:{lazy:"this.buildProcessor"},hostObject:null,propertyName:null,hasOwnOriginalValue:!1,originalValue:null,strategy:"callThrough",returnValueObj:void 0,fakeFunc:null,throwErrorObj:null,callsLog:Joose.I.Array,calls:null,t:null,and:function(){return this}},methods:{initialize:function(){var a=this;this.calls={any:function(){return 0<a.callsLog.length},count:function(){return a.callsLog.length},argsFor:function(b){return a.callsLog[b].args},
allArgs:function(b){return Joose.A.map(a.callsLog,function(a){return a.args})},all:function(){return a.callsLog},mostRecent:function(){return a.callsLog[a.callsLog.length-1]},first:function(){return a.callsLog[0]},reset:function(){a.reset()}};var b=Siesta.Resource("Siesta.Test.BDD.Spy"),c=this.hostObject,d=this.propertyName;if(c){var e=c[d];if(!/Function/.test(this.typeOf(e)))throw b.get("spyingNotOnFunction");e.__SIESTA_SPY__&&e.__SIESTA_SPY__.remove();this.originalValue=c[d];this.hasOwnOriginalValue=
c.hasOwnProperty(d);c[d]=this.getProcessor()}this.t&&this.t.spies.push(this)},buildProcessor:function(){var a=this,b=function(){var b=Array.prototype.slice.call(arguments),d={object:this,args:b};a.callsLog.push(d);return d.returnValue=a[a.strategy+"Strategy"](this,b)};b.__SIESTA_SPY__=b.and=a;b.calls=a.calls;return b},returnValueStrategy:function(a,b){return this.returnValueObj},callThroughStrategy:function(a,b){return this.originalValue.apply(a,b)},callFakeStrategy:function(a,b){return this.fakeFunc.apply(a,
b)},throwErrorStrategy:function(a,b){var c=this.throwErrorObj,d=this.t&&this.t.global?this.t.global.Error:Error;c instanceof d||(c=new d(c));throw c;},callThrough:function(){if(!this.hostObject)throw"Need the host object to call through to original method";this.strategy="callThrough";return this},stub:function(){this.returnValue();return this},returnValue:function(a){this.strategy="returnValue";this.returnValueObj=a;return this},callFake:function(a){this.strategy="callFake";this.fakeFunc=a;return this},
throwError:function(a){this.strategy="throwError";this.throwErrorObj=a;return this},remove:function(){var a=this.hostObject;a&&(this.hasOwnOriginalValue?a[this.propertyName]=this.originalValue:delete a[this.propertyName]);this.originalValue=this.hostObject=null;this.callsLog=[];this.returnValueObj=this.fakeFunc=this.throwErrorObj=null;if(a=this.getProcessor())a.and=a.calls=a.__SIESTA_SPY__=null;this.processor=null},reset:function(){this.callsLog=[]}}});
Class("Siesta.Test.BDD.Placeholder",{does:Siesta.Test.Role.Placeholder,has:{clsConstructor:{required:!0},t:null,context:null,globals:{init:"String Boolean Number Date RegExp Function Array Object".split(" ")}},methods:{getClassName:function(a){var b=this.getClassConstructor(),c=this.context,d;Joose.A.each(this.globals,function(a){if(b==c[a])return d=a,!1});return a?d:d||(b?b+"":"")},getClassConstructor:function(){return this.clsConstructor},equalsTo:function(a){var b=this.getClassConstructor();if(!b)return!0;
if(a instanceof Siesta.Test.BDD.Placeholder){var c=this.getClassName(!0);return"Object"!=a.getClassName(!0)||"Date"!=c&&"RegExp"!=c&&"Function"!=c&&"Array"!=c?b==a.getClassConstructor():!0}var c=!1,d=this.getClassName(!0);d&&(c=this.t.typeOf(a)==d||a instanceof this.context[d]);return c||a instanceof b},toString:function(){return"any "+(this.getClassName()||"value")}}});
Class("Siesta.Test.BDD.NumberPlaceholder",{does:Siesta.Test.Role.Placeholder,has:{value:{required:!0},threshold:null},methods:{initialize:function(){null==this.threshold&&(this.threshold=.05*this.value)},equalsTo:function(a){return Math.abs(a-this.value)<=this.threshold},toString:function(){return"any number approximately equal to "+this.value}}});
Class("Siesta.Test.BDD.StringPlaceholder",{does:[Siesta.Util.Role.CanGetType,Siesta.Test.Role.Placeholder],has:{value:{required:!0}},methods:{equalsTo:function(a){return"RegExp"==this.typeOf(this.value)?this.value.test(a):-1<String(a).indexOf(this.value)},toString:function(){return"RegExp"==this.typeOf(this.value)?"any string matching: "+this.value:"any string containing: "+this.value}}});
Class("Siesta.Test.BDD.Expectation",{does:[Siesta.Util.Role.CanGetType],has:{value:null,isNot:!1,not:null,t:null},methods:{initialize:function(){this.isNot||(this.not=new this.constructor({isNot:!0,t:this.t,value:this.value}))},process:function(a,b){var c=this.isNot;b=b||{};b.not=b.not||c?"not ":"";b.got=b.hasOwnProperty("got")?b.got:this.value;b.noGot&&delete b.got;var d=b.assertionName;d&&c&&(b.assertionName=d.replace(/^(expect\(.+?\)\.)/,"$1not."));this.t[(c?!a:a)?"pass":"fail"](null,b)},toBe:function(a){var b=
Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(this.t.compareObjects(this.value,a,!0,!0),{descTpl:b.get("expectText")+" {got} {!not}"+b.get("toBeText")+" {need}",assertionName:"expect(got).toBe(need)",need:a,needDesc:this.isNot?b.get("needNotText"):b.get("needText")})},toEqual:function(a){var b=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(this.t.compareObjects(this.value,a,!0),{descTpl:b.get("expectText")+" {got} {!not}"+b.get("toBeEqualToText")+" {need}",assertionName:"expect(got).toEqual(need)",
need:a,needDesc:this.isNot?b.get("needNotText"):b.get("needText")})},toBeNull:function(){var a=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(this.t.compareObjects(this.value,null,!0,!0),{descTpl:a.get("expectText")+" {got} {!not}"+a.get("toBeText")+" null",assertionName:"expect(got).toBeNull()",need:null,needDesc:this.isNot?a.get("needNotText"):a.get("needText")})},toBeNaN:function(){var a=this.value,b=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process("Number"==this.t.typeOf(a)&&
a!=a,{descTpl:b.get("expectText")+" {got} {!not}"+b.get("toBeText")+" NaN",assertionName:"expect(got).toBeNaN()",need:NaN,needDesc:this.isNot?b.get("needNotText"):b.get("needText")})},toBeDefined:function(){var a=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(void 0!==this.value,{descTpl:a.get("expectText")+" {got} {!not}"+a.get("toBeDefinedText"),assertionName:"expect(got).toBeDefined()"})},toBeUndefined:function(a){a=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(void 0===
this.value,{descTpl:a.get("expectText")+" {got} {!not}"+a.get("toBeUndefinedText"),assertionName:"expect(got).toBeUndefined()"})},toBeTruthy:function(){var a=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(this.value,{descTpl:a.get("expectText")+" {got} {!not}"+a.get("toBeTruthyText"),assertionName:"expect(got).toBeTruthy()"})},toBeFalsy:function(){var a=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(!this.value,{descTpl:a.get("expectText")+" {got} {!not}"+a.get("toBeFalsyText"),
assertionName:"expect(got).toBeFalsy()"})},toMatch:function(a){var b=Siesta.Resource("Siesta.Test.BDD.Expectation");if("RegExp"!=this.t.typeOf(a))throw Error("`expect().toMatch()` matcher expects a regular expression");this.process((new RegExp(a)).test(this.value),{descTpl:b.get("expectText")+" {got} {!not}"+b.get("toMatchText")+" {need}",assertionName:"expect(got).toMatch(need)",need:a,needDesc:this.isNot?b.get("needNotMatchingText"):b.get("needMatchingText")})},toContain:function(a){var b=this.value,
c=this.t,d=Siesta.Resource("Siesta.Test.BDD.Expectation"),e=!1;if("String"==c.typeOf(b))this.process(0<=b.indexOf(a),{descTpl:d.get("expectText")+" {got} {!not}"+d.get("toContainText")+" {need}",assertionName:"expect(got).toContain(need)",need:a,needDesc:this.isNot?d.get("needStringNotContainingText"):d.get("needStringContainingText")});else{for(var b=Array.prototype.slice.call(b),f=0;f<b.length;f++)if(c.compareObjects(a,b[f],!0)){e=!0;break}this.process(e,{descTpl:d.get("expectText")+" {got} {!not}"+
d.get("toContainText")+" {need}",assertionName:"expect(got).toContain(need)",need:a,needDesc:this.isNot?d.get("needArrayNotContainingText"):d.get("needArrayContainingText")})}},toBeLessThan:function(a){var b=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(this.value<a,{descTpl:b.get("expectText")+" {got} {!not}"+b.get("toBeLessThanText")+" {need}",assertionName:"expect(got).toBeLessThan(need)",need:a,needDesc:this.isNot?b.get("needGreaterEqualThanText"):b.get("needLessThanText")})},toBeGreaterThan:function(a){var b=
Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(this.value>a,{descTpl:b.get("expectText")+" {got} {!not}"+b.get("toBeGreaterThanText")+" {need}",assertionName:"expect(got).toBeGreaterThan(need)",need:a,needDesc:this.isNot?b.get("needLessEqualThanText"):b.get("needGreaterThanText")})},toBeCloseTo:function(a,b){var c=Math.pow(10,-(null!=b?b:2))/2,d=Math.abs(this.value-a),e=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(d<c,{descTpl:e.get("expectText")+" {got} {!not}"+e.get("toBeCloseToText")+
" {need}",assertionName:"expect(got).toBeCloseTo(need)",need:a,needDesc:this.isNot?e.get("needValueNotCloseToText"):e.get("needValueCloseToText"),annotation:d?e.get("thresholdIsText")+c:e.get("exactMatchText")})},toThrow:function(){var a=this.value,b=this.t,c=Siesta.Resource("Siesta.Test.BDD.Expectation");if("Function"!=b.typeOf(a))throw Error("`expect().toMatch()` matcher expects a function");a=b.getExceptionCatcher()(a);a instanceof b.getTestErrorClass()&&(a=a.message||a.description);this.process(void 0!==
a,{descTpl:c.get("expectText")+" function {!not}"+c.get("toThrowText"),assertionName:"expect(func).toThrow()",annotation:a?c.get("thrownExceptionText")+": "+Siesta.Util.Serializer.stringify(a):c.get("noExceptionThrownText"),noGot:!0})},toHaveBeenCalled:function(a){a=null!=a?a:">=1";var b=this.value,c=this.t,d=Siesta.Resource("Siesta.Test.BDD.Expectation");if("Function"==this.typeOf(b)){if(!b.__SIESTA_SPY__)throw Error(d.get("wrongSpy"));b=b.__SIESTA_SPY__}if(!(b instanceof Siesta.Test.BDD.Spy))throw Error(d.get("wrongSpy"));
this.process(c.verifyExpectedNumber(b.callsLog.length,a),{descTpl:d.get("toHaveBeenCalledDescTpl"),assertionName:"expect(func).toHaveBeenCalled()",methodName:b.propertyName||"[function]",got:b.callsLog.length,gotDesc:d.get("actualNbrOfCalls"),need:(this.isNot?"not ":"")+a,needDesc:d.get("expectedNbrOfCalls")})},toHaveBeenCalledWith:function(){var a=this.value,b=this.t,c=Siesta.Resource("Siesta.Test.BDD.Expectation");if("Function"==this.typeOf(a)){if(!a.__SIESTA_SPY__)throw Error(c.get("wrongSpy"));
a=a.__SIESTA_SPY__}if(!(a instanceof Siesta.Test.BDD.Spy))throw Error(c.get("wrongSpy"));var d=Array.prototype.slice.call(arguments),e=!1;Joose.A.each(a.callsLog,function(a){if(b.compareObjects(a.args,d))return e=!0,!1});this.process(e,{descTpl:c.get("toHaveBeenCalledWithDescTpl"),assertionName:"expect(func).toHaveBeenCalledWith()",methodName:a.propertyName,noGot:!0})}}});
Role("Siesta.Test.BDD",{requires:["getSubTest","chain"],has:{specType:null,beforeEachHooks:Joose.I.Array,afterEachHooks:Joose.I.Array,sequentialSubTests:Joose.I.Array,codeProcessed:!1,launchTimeout:null,expectationClass:Siesta.Test.BDD.Expectation,failOnExclusiveSpecsWhenAutomated:!1,spies:Joose.I.Array},methods:{checkSpecFunction:function(a,b,c){if(!a)throw Error(Siesta.Resource("Siesta.Test.BDD","codeBodyMissing")+" "+("describe"==b?"suite":"spec")+" ["+c+"]");if(!a.length)throw Error(Siesta.Resource("Siesta.Test.BDD",
"codeBodyOf")+" "+("describe"==b?"suite":"spec")+" ["+c+"] "+Siesta.Resource("Siesta.Test.BDD","missingFirstArg"));},ddescribe:function(a,b,c){this.describe(a,b,c,!0)},xdescribe:function(){},describe:function(a,b,c,d){this.checkSpecFunction(b,"describe",a);a=this.getSubTest({name:a,run:b,isExclusive:d,specType:"describe",timeout:c});this.codeProcessed&&this.scheduleSpecsLaunch();this.sequentialSubTests.push(a)},iit:function(a,b,c){this.project.isAutomated&&this.failOnExclusiveSpecsWhenAutomated&&
this.fail(Siesta.Resource("Siesta.Test.BDD","iitFound"));this.it(a,b,c,!0)},xit:function(){},it:function(a,b,c,d,e){this.checkSpecFunction(b,"it",a);a=this.getSubTest({name:a,run:b,isExclusive:d,isTodo:!!e||this.isTodo,specType:"it",timeout:c});this.codeProcessed&&this.scheduleSpecsLaunch();this.sequentialSubTests.push(a)},expect:function(a){return new this.expectationClass({t:this,value:a})},any:function(a){return new Siesta.Test.BDD.Placeholder({clsConstructor:a,t:this,context:this.global})},anyNumberApprox:function(a,
b){return new Siesta.Test.BDD.NumberPlaceholder({value:a,threshold:b})},anyStringLike:function(a){return new Siesta.Test.BDD.StringPlaceholder({value:a})},scheduleSpecsLaunch:function(){if(!this.launchTimeout){var a=this.beginAsync(),b=this.originalSetTimeout,c=this;this.launchTimeout=b(function(){c.endAsync(a);c.launchTimeout=null;c.launchSpecs()},0)}},runBeforeSpecHooks:function(a,b){var c=this,d=function(b){c.chainForArray(c.beforeEachHooks,function(b){return function(c){var d=b.code;b.isAsync?
d(a,c):(d(a),c())}},b)};this.parent?this.parent.runBeforeSpecHooks(a,function(){d(b)}):d(b)},runAfterSpecHooks:function(a,b){var c=this;c.chainForArray(this.afterEachHooks,function(b){return function(c){var f=b.code;b.isAsync?f(a,c):(f(a),c())}},function(){c.parent?c.parent.runAfterSpecHooks(a,b):b()},!0)},launchSpecs:function(){var a=this,b=this.sequentialSubTests;this.sequentialSubTests=[];this.chain.actionDelay=0;var c=[];Joose.A.each(b,function(a){a.isExclusive&&c.push(a)});this.chainForArray(c.length?
c:b,function(b){return["it"==b.specType?function(c){a.runBeforeSpecHooks(b,c)}:null,b,"it"==b.specType?function(c){a.runAfterSpecHooks(b,c)}:null]})},beforeEach:function(a,b){this.beforeEachHooks.push({code:a,isAsync:b||2==a.length})},afterEach:function(a,b){this.afterEachHooks.push({code:a,isAsync:b||2==a.length})},spyOn:function(a,b){var c=Siesta.Resource("Siesta.Test.BDD");if(a)return new Siesta.Test.BDD.Spy({name:b,t:this,hostObject:a,propertyName:b});this.warn(c.get("noObject"))},createSpy:function(a){return(new Siesta.Test.BDD.Spy({name:a||
"James Bond",t:this})).stub().getProcessor()},createSpyObj:function(a,b){1==arguments.length&&(b=a,a=null);a=a||"spyObject";var c=this,d={};Joose.A.each(b,function(b){d[b]=c.createSpy(a)});return d}},override:{cleanup:function(){this.beforeEachHooks=this.afterEachHooks=null;this.SUPER()},onTestFinalize:function(){Joose.A.each(this.spies,function(a){a.remove()});this.spies=null;this.SUPER()},afterLaunch:function(){this.codeProcessed=!0;this.launchSpecs();this.SUPERARG(arguments)}}});
Role("Siesta.Test.Sub",{has:{isExclusive:!1,parent:{required:!0}},methods:{getExceptionCatcher:function(){return this.parent.getExceptionCatcher()},getTestErrorClass:function(){return this.parent.getTestErrorClass()},getStartTestAnchor:function(){return this.parent.getStartTestAnchor()},expectGlobals:function(){return this.parent.expectGlobals.apply(this.parent,arguments)}}});
Class("Siesta.Test",{does:[Siesta.Util.Role.CanFormatStrings,Siesta.Util.Role.CanGetType,Siesta.Util.Role.CanCompareObjects,Siesta.Util.Role.CanEscapeRegExp,Siesta.Test.More,Siesta.Test.Date,Siesta.Test.Function,Siesta.Test.BDD,JooseX.Observable,Siesta.Util.Role.HasUniqueGeneratedId],has:{name:null,uniqueId:function(){var a=Siesta.Test;a.__UNIQUE_ID_GEN__=a.__UNIQUE_ID_GEN__||0;return++a.__UNIQUE_ID_GEN__},url:{required:!0},urlExtractRegex:{is:"rwc",lazy:function(){return new RegExp(this.url.replace(/([.*+?^${}()|[\]\/\\])/g,
"\\$1")+":(\\d+)")}},referenceUrl:null,assertPlanned:null,assertCount:0,isTodo:!1,results:{lazy:function(){return new Siesta.Result.SubTest({description:this.name||"Root",test:this})}},run:null,startTestAnchor:null,exceptionCatcher:null,testErrorClass:null,generation:function(){return Math.random()},launchId:null,parent:null,project:null,harness:null,isReadyTimeout:1E4,failed:!1,failedException:null,failedExceptionType:null,startDate:null,endDate:null,lastActivityDate:null,contentManager:null,scopeProvider:null,
global:null,reusingSandbox:!1,sandboxCleanup:!0,sharedSandboxState:null,scriptScopeProvider:null,transparentEx:!1,needDone:!1,isDone:!1,defaultTimeout:15E3,subTestTimeout:null,timeout:null,timeoutsCount:function(){return{counter:1}},timeoutIds:Joose.I.Object,idsToIndex:Joose.I.Object,waitTitles:Joose.I.Object,processed:!1,finalizationStarted:!1,callback:null,nbrExceptions:0,testEndReported:!1,needToCleanup:!0,overrideSetTimeout:!1,overrideForSetTimeout:null,overrideForClearTimeout:null,originalSetTimeout:null,
originalClearTimeout:null,sourceLineForAllAssertions:!1,$passCount:null,$failCount:null,actionableMethods:{lazy:"buildActionableMethods"},jUnitClass:null,groups:null,automationElementId:null,snoozeUntil:null,config:null},methods:{initialize:function(){this.harness=this.project=this.project||this.harness;this.on("teststart",function(a){this.parent&&a.stopPropagation()});this.on("testfinalize",function(a){this.parent&&a.stopPropagation()});this.on("teststop",function(a){this.parent&&a.stopPropagation()});
this.on("beforetestfinalize",function(a){this.parent&&a.stopPropagation()});this.on("beforetestfinalizeearly",function(a){this.parent&&a.stopPropagation()});this.subTestTimeout=this.subTestTimeout||2*this.defaultTimeout;this.snoozeUntil&&(this.snoozeUntil=new Date(this.snoozeUntil),isNaN(this.snoozeUntil-0)&&(this.snoozeUntil=null));this.snoozeUntil&&new Date<this.snoozeUntil&&(this.isTodo=!0);this.config&&Joose.O.extend(this,this.config)},isReady:function(){var a=Siesta.Resource("Siesta.Test");this.run=
this.run||this.getStartTestAnchor().args&&this.getStartTestAnchor().args[0];return{ready:"Function"==this.typeOf(this.run),reason:a.get("noCodeProvidedToTest")}},isFromTheSameGeneration:function(a){return this.generation==a.generation},toString:function(){return this.url},plan:function(a){if(null!=this.assertPlanned)throw Error("Test plan can't be changed");this.assertPlanned=a},addResult:function(a){var b=a instanceof Siesta.Result.Assertion;b&&(a.isTodo=this.isTodo);if(b&&(this.isDone||this.isFinished())&&
!a.isTodo&&!this.testEndReported){this.testEndReported=!0;var c=Siesta.Resource("Siesta.Test");this.fail(c.get("addingAssertionsAfterDone"))}b&&!a.index&&(a.index=++this.assertCount);this.getResults().push(a);this.$passCount=this.$failCount=null;this.fireEvent("testupdate",this,a,this.getResults());this.lastActivityDate=new Date;return a},diag:function(a,b){this.addResult(new Siesta.Result.Diagnostic({description:String(a||"")}));b&&b()},pass:function(a,b,c){b&&"String"!=this.typeOf(b)&&(!a&&b.descTpl&&
(a=this.formatString(b.descTpl,b)),b=b.annotation);c&&(c.passed=!0,c.description=String(a||""),c.annotation=b);this.addResult(c||new Siesta.Result.Assertion({passed:!0,annotation:String(b||""),description:String(a||""),sourceLine:c&&c.sourceLine||b&&b.sourceLine||this.sourceLineForAllAssertions&&this.getSourceLine()||null}))},fail:function(a,b,c){var d=c&&c.sourceLine||b&&b.sourceLine||this.getSourceLine(),e="";if(b&&"String"!=this.typeOf(b)){!a&&b.descTpl&&(a=this.formatString(b.descTpl,b));var f=
[],g=b,k=g.hasOwnProperty("got"),l=g.hasOwnProperty("need"),m=g.gotDesc||"Got",n=g.needDesc||"Need",e=g.assertionName;b=g.annotation;g.ownTextOnly||!e&&!d||f.push("Failed assertion "+(e?"`"+e+"` ":"")+this.formatSourceLine(d));if(k&&l)var r=Math.max(m.length,n.length),m=this.appendSpaces(m,r-m.length+1),n=this.appendSpaces(n,r-n.length+1);k&&f.push(m+": "+Siesta.Util.Serializer.stringify(g.got));l&&f.push(n+": "+Siesta.Util.Serializer.stringify(g.need));b&&f.push(b);b=f.join("\n")}c&&(c.name=e,c.passed=
!1,c.annotation=b,c.description=a);this.addResult(c||new Siesta.Result.Assertion({name:e,passed:!1,sourceLine:d,annotation:String(b||""),description:String(a||"")}));this.onFailedAssertion()},onFailedAssertion:function(a){this.isTodo||(this.project.debuggerOnFail&&eval("debugger"),this.project.breakOnFail&&!this.__STOPPED__&&(this.__STOPPED__=!0,this.project.stopCurrentLaunch(this),a||this.exit()))},exit:function(a,b){0<arguments.length&&this.fail(a,b);this.finalize(!0);throw"__SIESTA_TEST_EXIT_EXCEPTION__";
},getSource:function(){return this.contentManager.getContentOf(this.url)},getSourceLine:function(){var a=Error().stack;if(!a)try{throw Error();}catch(b){a=b.stack}return a&&(a=a.match(this.urlExtractRegex()))?a[1]:null},getStartTestAnchor:function(){return this.startTestAnchor},getExceptionCatcher:function(){return this.exceptionCatcher},getTestErrorClass:function(){return this.testErrorClass},processCallbackFromTest:function(a,b,c){var d=this;if(!a)return!0;if(this.transparentEx)a.apply(c||this.global,
b||[]);else{var e=this.getExceptionCatcher()(function(){a.apply(c||d.global,b||[])});if(e)return this.failWithException(e),!1}return!0},getStackTrace:function(a){if(Object(a)!==a||!a.stack)return null;var b=(a.stack+"").split("\n");a+="";for(var c=Siesta.Resource("Siesta.Test"),d=[],e,f=0;f<b.length;f++){var g=b[f];if(g){if(!f)if(g!=a)d.push(a);else{d.push(g);continue}(e=/@(.*?):(\d+):(\d+)$/.exec(g)||/\((.*?):(\d+):(\d+)\)$/.exec(g)||/at (.*?):(\d+):(\d+)$/.exec(g)||/(.*?):(\d+):(\d+)$/.exec(g))?
d.push("    "+c.get("atLine")+" "+e[2]+(e[3]?", "+c.get("character")+" "+e[3]:"")+", "+c.get("of")+" "+e[1]):d.push(g)}}return d.length?d:null},formatSourceLine:function(a){var b=Siesta.Resource("Siesta.Test");return a?b.get("atLine")+" "+a+" "+b.get("of")+" "+this.url:""},appendSpaces:function(a,b){for(var c="";b--;)c+=" ";return a+c},eachAssertion:function(a,b){b=b||this;this.getResults().each(function(c){c instanceof Siesta.Result.Assertion&&a.call(b,c)})},eachSubTest:function(a,b){b=b||this;this.getResults().each(function(c){if(c instanceof
Siesta.Result.SubTest&&!1===a.call(b,c.test))return!1})},eachChildTest:function(a,b){b=b||this;this.getResults().eachChild(function(c){if(c instanceof Siesta.Result.SubTest&&!1===a.call(b,c.test))return!1})},ok:function(a,b){var c=Siesta.Resource("Siesta.Test");a?this.pass(b,{descTpl:c.get("isTruthy"),value:a}):this.fail(b,{assertionName:"ok",got:a,annotation:c.get("needTruthy")})},notok:function(){this.notOk.apply(this,arguments)},notOk:function(a,b){var c=Siesta.Resource("Siesta.Test");a?this.fail(b,
{assertionName:"notOk",got:a,annotation:c.get("needFalsy")}):this.pass(b,{descTpl:c.get("isFalsy"),value:a})},is:function(a,b,c){var d=Siesta.Resource("Siesta.Test");b&&a instanceof this.global.Date?this.isDateEqual(a,b,c):this.compareObjects(a,b,!1,!0)?this.pass(c,{descTpl:d.get("isEqualTo"),got:a,expected:b}):this.fail(c,{assertionName:"is",got:a,need:b})},isnot:function(){this.isNot.apply(this,arguments)},isnt:function(){this.isNot.apply(this,arguments)},isNot:function(a,b,c){var d=Siesta.Resource("Siesta.Test");
this.compareObjects(a,b,!1,!0)?this.fail(c,{assertionName:"isnt",got:a,need:b,needDesc:d.get("needNot")}):this.pass(c,{descTpl:d.get("isNotEqualTo"),got:a,expected:b})},exact:function(a,b,c){var d=Siesta.Resource("Siesta.Test");this.compareObjects(a,b,!0,!0)?this.pass(c,{descTpl:d.get("isStrictlyEqual"),got:a,expected:b}):this.fail(c,{assertionName:"isStrict",got:a,need:b,needDesc:d.get("needStrictly")})},isStrict:function(a,b,c){var d=Siesta.Resource("Siesta.Test");this.compareObjects(a,b,!0,!0)?
this.pass(c,{descTpl:d.get("isStrictlyEqual"),got:a,expected:b}):this.fail(c,{assertionName:"isStrict",got:a,need:b,needDesc:d.get("needStrictly")})},isntStrict:function(){this.isNotStrict.apply(this,arguments)},isNotStrict:function(a,b,c){var d=Siesta.Resource("Siesta.Test");this.compareObjects(a,b,!0,!0)?this.fail(c,{assertionName:"isntStrict",got:a,need:b,needDesc:d.get("needStrictlyNot")}):this.pass(c,{descTpl:d.get("isStrictlyNotEqual"),got:a,expected:b})},wait:function(a,b){var c=Siesta.Resource("Siesta.Test");
if(this.waitTitles.hasOwnProperty(a))throw Error(c.get("alreadyWaiting")+" ["+a+"]");return this.waitTitles[a]=this.beginAsync(b)},endWait:function(a){var b=Siesta.Resource("Siesta.Test");if(!this.waitTitles.hasOwnProperty(a))throw Error(b.get("noOngoingWait")+" ["+a+"]");this.endAsync(this.waitTitles[a]);delete this.waitTitles[a]},beginAsync:function(a,b){a=a||this.defaultTimeout;a>this.getMaximalTimeout()&&this.fireEvent("maxtimeoutchanged",a);var c=Siesta.Resource("Siesta.Test"),d=this,e=this.originalSetTimeout,
f=this.timeoutsCount.counter++,e=e(function(){d.hasAsyncFrame(f)&&(b&&b.call(d,d)||d.fail(c.get("noMatchingEndAsync",{time:a})),d.endAsync(f))},a);this.timeoutIds[f]=e;return f},timeoutIdToIndex:function(a){return"object"==typeof a?a.__index:this.idsToIndex[a]},hasAsyncFrame:function(a){return this.timeoutIds.hasOwnProperty(a)},hasAsyncFrameByTimeoutId:function(a){return this.timeoutIds.hasOwnProperty(this.timeoutIdToIndex(a))},endAsync:function(a){var b=this.originalSetTimeout,c=this.originalClearTimeout||
this.global.clearTimeout,d=0,e=Siesta.Resource("Siesta.Test");null==a&&Joose.O.each(this.timeoutIds,function(b,c){a=c;if(d++)throw Error(e.get("endAsyncMisuse"));});c(this.timeoutIds[a]);delete this.timeoutIds[a];var f=this;this.processed&&!this.isFinished()&&b(function(){f.finalize()},1)},clearTimeouts:function(){var a=this.originalClearTimeout;Joose.O.each(this.timeoutIds,function(b,c){a(b)});this.timeoutIds={}},processSubTestConfig:function(a){return Joose.O.extend({parent:this,isTodo:this.isTodo,
transparentEx:this.transparentEx,waitForTimeout:this.waitForTimeout,waitForPollInterval:this.waitForPollInterval,defaultTimeout:this.defaultTimeout,timeout:this.subTestTimeout,subTestTimeout:this.subTestTimeout,global:this.global,url:this.url,scopeProvider:this.scopeProvider,project:this.project,generation:this.generation,launchId:this.launchId,overrideSetTimeout:this.overrideSetTimeout,originalSetTimeout:this.originalSetTimeout,originalClearTimeout:this.originalClearTimeout,timeoutsCount:this.timeoutsCount,
autoCheckGlobals:!1,needToCleanup:!1},a)},getSubTest:function(a,b,c){var d,e=Siesta.Resource("Siesta.Test");2==arguments.length||3==arguments.length?d={name:a,run:b,timeout:c}:1==arguments.length&&"Function"==this.typeOf(a)&&(d={name:"Sub test",run:a});d=d||a||{};null==d.timeout&&delete d.timeout;var f=d.name;if(!d.run)throw this.failWithException(e.get("codeBodyMissingForSubTest",{name:f})),Error(e.get("codeBodyMissingForSubTest",{name:f}));if(!d.run.length)throw this.failWithException(e.get("codeBodyMissingTestArg",
{name:f})),Error(e.get("codeBodyMissingTestArg",{name:f}));f=e=d.meta||this.meta.c;d=this.processSubTestConfig(d);e.__WITHSUB__?f=e.__WITHSUB__:this.parent||(d.trait=Siesta.Test.Sub);d=new f(d);this.parent||e.__WITHSUB__||(e.__WITHSUB__=d.meta.c);return d},launchSubTest:function(a,b){var c=this,d=Siesta.Resource("Siesta.Test"),e=a.timeout||this.subTestTimeout,f=this.beginAsync(e,function(){c.fail(d.get("failedToFinishWithin",{name:a.name?"["+a.name+"]":"",timeout:e}));c.restoreTimeoutOverrides();
g.remove();a.finalize(!0);b&&b(a);return!0}),g=a.on("testfinalize",function(){c.endAsync(f);c.restoreTimeoutOverrides();b&&b(a)});this.addResult(a.getResults());a.start()},todo:function(a,b,c){"Function"==this.typeOf(a)&&(a=[b,b=a][0]);a=this.getSubTest({name:a,run:b,isTodo:!0,transparentEx:!1});this.launchSubTest(a,c)},snooze:function(a,b,c){var d=Siesta.Resource("Siesta.Test");a=new Date(a);new Date>a?this.it("Unsnoozed",b,null,!1,!1):this.it(d.get("Snoozed until")+" "+a+": "+(c||""),b,null,!1,
!0)},subTest:function(a,b,c,d){a=this.getSubTest({name:a||Siesta.Resource("Siesta.Test","Subtest"),timeout:d,run:b});this.launchSubTest(a,c);return a},stringifyException:function(a,b){var c=a+"",d=(b||this.getStackTrace(a)||[]).join("\n");-1==d.indexOf(c)&&(d=c+d);return d},failWithException:function(a,b,c){var d=Siesta.Resource("Siesta.Test");this.failed=!0;this.failedException=a+"";this.failedExceptionType=this.typeOf(a);var e=this.getStackTrace(a);this.addResult(new Siesta.Result.Assertion({isException:!0,
exceptionType:this.failedExceptionType,passed:!1,description:b?b:(this.parent?d.get("Subtest")+" `"+this.name+"`":d.get("Test")+" ")+" "+d.get("threwException"),annotation:this.stringifyException(a,e)}));this.fireEvent("testfailedwithexception",this,a,e);this.onFailedAssertion(!0);c?this.doFinalize():this.finalize(!0)},restoreTimeoutOverrides:function(){this.overrideSetTimeout&&(this.global.setTimeout=this.overrideForSetTimeout,this.global.clearTimeout=this.overrideForClearTimeout)},start:function(a){var b=
this,c=Siesta.Resource("Siesta.Test");if(this.startDate)throw c.get("testAlreadyStarted");this.startDate=new Date-0;this.fireEvent("teststart",this);if(a&&a.length)return Joose.A.each(a,function(a){if(a.isException)return b.failWithException(a.message,"",!0),!1;b.fail(a.message)}),b.doFinalize(),!0;this.doStart()},doStart:function(){var a=this,b=Siesta.Resource("Siesta.Test");a.onTestStart();if(a.parent||a.reusingSandbox)a.launch();else{var c,d=function(c){var d=!1,e=setTimeout(function(){d=!0;a.launch(b.get("setupTookTooLong"))},
a.isReadyTimeout);a.setup(function(){d||(clearTimeout(e),a.launch(c))},function(b){d||(clearTimeout(e),a.launch(c||b))})},e=a.isReady();if(e.ready)d();else var f=setTimeout(function(){clearInterval(g);d(c)},a.isReadyTimeout),g=setInterval(function(){e=a.isReady();e.ready?(clearInterval(g),clearTimeout(f),d()):c=e.reason||c},100)}},setup:function(a,b){a.call(this)},tearDown:function(a,b){a.call(this)},earlySetup:function(a,b){a.call(this)},cleanupContextBeforeStart:function(){var a=this.global;this.forEachUnexpectedGlobal(function(b){try{delete a[b]}catch(c){}})},
clearAsyncFrameGlobally:function(a){for(var b=this;b.parent;)b=b.parent;b.eachSubTest(function(b){if(b.hasAsyncFrameByTimeoutId(a))return b.overrideForClearTimeout(a),!1})},launch:function(a){if(a){var b=Siesta.Resource("Siesta.Test");this.fail(b.get("errorBeforeTestStarted"),{annotation:a})}var c=this,d=this.global;a=this.scopeProvider;var e=this.originalSetTimeout,f=this.originalClearTimeout;this.overrideSetTimeout&&(this.reusingSandbox||this.parent||a.runCode("var setTimeout, clearTimeout;"),d.setTimeout=
this.overrideForSetTimeout=function(a,b){var d=c.timeoutsCount.counter++,g=e(function(){f(g);delete c.timeoutIds[d];c.processed&&!c.isFinished()&&e(function(){c.finalize()},1);a()},b);"object"==typeof g?g.__index=d:c.idsToIndex[g]=d;return c.timeoutIds[d]=g},d.clearTimeout=this.overrideForClearTimeout=function(a){null!=a&&(c.hasAsyncFrameByTimeoutId(a)?(f(a),a=c.timeoutIdToIndex(a),null!=a&&delete c.timeoutIds[a],c.processed&&!c.isFinished()&&e(function(){c.finalize()},1)):c.clearAsyncFrameGlobally(a))});
this.needToCleanup&&(a.beforeCleanupCallback=function(){c.isFinished()||c.finalize(!0);c.overrideSetTimeout&&(d.setTimeout=e,d.clearTimeout=f);d=e=f=null;c.eachSubTest(function(a){a.cleanup()})});this.reusingSandbox&&this.sandboxCleanup&&!this.parent&&this.cleanupContextBeforeStart();var g,k=this.run,l;this.transparentEx?(c.project.debuggerOnStart&&!c.parent&&eval("debugger"),g=k(c)):l=this.getExceptionCatcher()(function(){c.project.debuggerOnStart&&!c.parent&&eval("debugger");g=k(c)});g&&this.handleReturnedPromise(g,
null,this.formatString("The promise returned from the sub-test ["+c.name+"] did not resolve within {time}ms",{time:c.defaultTimeout}));this.afterLaunch(l)},handleReturnedPromise:function(a,b,c){var d=this.global;if((d=d.Promise||d.Ext&&d.Ext.Promise)&&a instanceof d){var e=this,f=this.beginAsync(this.defaultTimeout,function(){e.fail(c);return!0});a.then(function(a){e.endAsync(f);b&&b(a)},function(a){e.endAsync(f);a&&e.failWithException(a,"Unhandled promise rejection during the test: ["+e.name+"]")})}},
cleanup:function(){this.scopeProvider=this.startTestAnchor=this.exceptionCatcher=this.testErrorClass=this.global=this._global=this.run=this.originalSetTimeout=this.originalClearTimeout=this.overrideForSetTimeout=this.overrideForClearTimeout=null;this.purgeListeners()},afterLaunch:function(a){a?this.failWithException(a):this.finalize()},finalize:function(a){var b=this,c=Siesta.Resource("Siesta.Test");if(!b.finalizationStarted&&!b.isFinished())if(b.processed=!0,a&&(b.clearTimeouts(),b.eachChildTest(function(a){a.finalize(!0)})),
Joose.O.isEmpty(b.timeoutIds)){try{if(!b.isDone&&!1===b.doDone(a))return}catch(k){}b.finalizationStarted=!0;b.fireEvent("teststop",b);var d=!1,e=function(a){d||(d=!0,a&&b.fail(a),b.doFinalize())};if(b.parent||b.reusingSandbox)e();else{a=b.originalSetTimeout;var f=b.originalClearTimeout,g=a(function(){e(c.get("testTearDownTimeout"))},b.isReadyTimeout);try{b.tearDown(function(){f(g);e()},function(a){f(g);e(a)})}catch(k){e(k+"")}}}else!b.__timeoutWarning&&b.overrideSetTimeout&&b.lastActivityDate&&new Date-
b.lastActivityDate>2*b.defaultTimeout&&(b.diag(c.get("testStillRunning")),b.warn(c.get("testNotFinalized",{url:b.url})),b.__timeoutWarning=!0)},doFinalize:function(){if(!this.endDate){this.endDate=new Date-0;this.parent||this.addResult(new Siesta.Result.Summary({isFailed:this.isFailed(),description:this.getSummaryMessage()}));try{this.onTestFinalize()}catch(a){"undefined"!==typeof console&&console.log(a)}this.fireEvent("testfinalize",this);this.fireEvent("testendbubbling",this);this.callback&&this.callback();
this.callback=null}},onBeforeTestFinalize:function(){},onTestFinalize:function(){},onTestStart:function(){},getSummaryMessage:function(a){var b=[],c=this.getPassCount(),d=this.getFailCount(),e=this.assertPlanned,f=d+c;b.push("Passed: "+c);b.push("Failed: "+d);this.failed||(null!=e?(f<e&&b.push("Looks like you planned "+e+" tests, but ran only "+f),f>e&&b.push("Looks like you planned "+e+" tests, but ran "+(f-e)+" extra tests, "+f+" total."),f!=e||d||b.push("All tests passed")):(c=Siesta.Resource("Siesta.Test"),
this.isDoneCorrectly()||b.push(c.get("missingDoneCall")),this.isDoneCorrectly()&&!d&&b.push(c.get("allTestsPassed"))));return a?b.join(a):b},done:function(a){var b=this;if(a){var c=this.beginAsync(),d=this.originalSetTimeout;d(function(){b.endAsync(c);b.done()},a)}else this.doDone(!1),this.processed&&this.finalize()},doDone:function(a){this.fireEvent("beforetestfinalizeearly",this);if(!Joose.O.isEmpty(this.timeoutIds))if(a)this.clearTimeouts();else return!1;this.onBeforeTestFinalize();this.fireEvent("beforetestfinalize",
this);this.isDone=!0},isDoneCorrectly:function(){return!this.needDone||this.isDone},getAssertionCount:function(a){var b=0;this.eachAssertion(function(c){a&&c.isTodo||b++});return b},getPassCount:function(a){if(null!=this.$passCount&&!a)return this.$passCount;var b=0;this.eachAssertion(function(c){!c.passed||!a&&c.isTodo||b++});return a?b:this.$passCount=b},getTodoPassCount:function(){var a=0;this.eachAssertion(function(b){b.isTodo&&b.passed&&a++});return a},getTodoFailCount:function(){var a=0;this.eachAssertion(function(b){b.isTodo&&
!b.passed&&a++});return a},getFailCount:function(a){if(null!=this.$failCount&&!a)return this.$failCount;var b=0;this.eachAssertion(function(c){c.passed||!a&&c.isTodo||b++});return a?b:this.$failCount=b},getFailedAssertions:function(){var a=[];this.eachAssertion(function(b){b.isPassed()||a.push(b)});return a},isPassed:function(){var a=this.getPassCount(),b=this.getFailCount(),c=this.assertPlanned;return this.isFinished()&&(!this.failed||this.isTodo)&&!b&&(null!=c&&a==c||null==c&&this.isDoneCorrectly())},
isFailed:function(){var a=this.getPassCount(),b=this.getFailCount(),c=this.assertPlanned;return this.failed||b||this.isFinished()&&(null!=c&&a!=c||null==c&&!this.isDoneCorrectly())},isFailedWithException:function(){return this.failed},isStarted:function(){return null!=this.startDate},isFinished:function(){return null!=this.endDate},getDuration:function(){return this.endDate-this.startDate},getBubbleTarget:function(){return this.parent||this.project},warn:function(a){this.addResult(new Siesta.Result.Diagnostic({description:a,
isWarning:!0}))},flattenArray:function(a,b){var c=this,d=[];Joose.A.each(a,function(a){"Array"==c.typeOf(a)?d.push.apply(d,c.flattenArray(a,b)):b&&!a||d.push(a)});return d},trimString:function(a){return String(a).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},buildActionableMethods:function(){var a={};this.meta.getMethods().each(function(b,c){a[c.toLowerCase()]=c});return a},getJUnitClass:function(){return this.jUnitClass||this.meta.name||"Siesta.Test"},resource:function(){return Siesta.Resource.apply(Siesta.Resource,
arguments)},getRootTest:function(){for(var a=this;a.parent;)a=a.parent;return a},onException:function(){}}});
Singleton("Siesta.Test.ActionRegistry",{has:{actionClasses:Joose.I.Object},methods:{registerAction:function(a,b){this.actionClasses[a.toLowerCase()]=b},getActionClass:function(a){return this.actionClasses[a.toLowerCase()]},create:function(a,b,c,d){if(a!==Object(a))throw"Action configuration should be an Object instance";a=Joose.O.copy(a);if(!a.action){var e=this.actionClasses,f={};b&&(f=b.getActionableMethods());Joose.O.eachOwn(a,function(b,c){var d=c.toLowerCase();if(e[d]){a.action=d;switch(d){case "setvalue":case "waitfor":break;
case "type":a.text=b;break;default:a.target=b}return!1}if(f[d])return d.match(/^waitFor/i)?(a.action="wait",a.waitFor=f[d]):(a.action="methodCall",a.methodName=f[d]),a.args=b||[],!1})}if(!a.action)throw"Need to include `action` property or shortcut property in the step config: "+Siesta.Util.Serializer.stringify(a,2);"wait"!=a.action&&"waitfor"!=a.action&&"delay"!=a.action&&"methodCall"!=a.action&&!a.args&&c&&(a.args=c);c=this.getActionClass(a.action);if(!a.next||d)a.next=d(c.prototype.hasOwnAsyncFrame).next;
if(!a.test||b)a.test=b;return new c(a)}}});Class("Siesta.Test.Action",{has:{args:null,desc:null,test:{required:!0},next:{required:!0},requiredTestMethod:null},methods:{initialize:function(){var a=this.requiredTestMethod;if(a&&!this.test[a])throw Error(Siesta.Resource("Siesta.Test.Action","missingTestAction").replace("{0}",this.meta.name).replace("{1}",a));},process:function(){this.next()}}});
Class("Siesta.Test.Action.Done",{isa:Siesta.Test.Action,has:{delay:null},methods:{process:function(){this.test.done(this.delay);this.next()}}});Siesta.Test.ActionRegistry().registerAction("done",Siesta.Test.Action.Done);
Class("Siesta.Test.Action.Wait",{isa:Siesta.Test.Action,has:{delay:1E3,timeout:null,interval:null,args:Joose.I.Array,waitFor:null,trigger:null,hasOwnAsyncFrame:!0,description:""},methods:{process:function(){var a=this.waitFor,b=this.test;if("Number"===b.typeOf(a)||"Function"===b.typeOf(a))this.args=[a],a="";null==a&&(this.args=[this.delay],a="");"Function"===b.typeOf(this.args)&&"waitForFn"!=a&&(this.args=this.args.call(b,this));"Array"!==b.typeOf(this.args)&&(this.args=[this.args]);a=a.replace(/^waitFor/,
"");a="waitFor"+Joose.S.uppercaseFirst(a);if(!b[a])throw Siesta.Resource("Siesta.Test.Action.Wait","missingMethodText")+a;"waitFor"===a?b.waitFor({method:this.args[0],callback:this.next,scope:b,timeout:this.timeout||b.waitForTimeout,interval:this.interval,description:this.description||this.desc||""}):b[a].apply(b,this.args.concat(this.next,b,this.timeout||b.waitForTimeout));if(a=this.trigger)"Function"==b.typeOf(a)?a.call(b,b):(a instanceof Siesta.Test.Action||(a.next=function(){},a.test=this.test,
a=Siesta.Test.ActionRegistry().create(a,b)),a.process())}}});Joose.A.each(["wait","waitFor","delay"],function(a){Siesta.Test.ActionRegistry().registerAction(a,Siesta.Test.Action.Wait)});
Class("Siesta.Test.Action.Eval",{isa:Siesta.Test.Action,has:{actionString:null},methods:{process:function(){var a=this.test,b=this.parseActionString(this.actionString);if(b.error)a.fail(b.error),this.next();else{var c=b.methodName;c&&"Function"==a.typeOf(a[c])?(b.params.push(this.next),a[c].apply(a,b.params)):(a.fail(Siesta.Resource("Siesta.Test.Action.Eval","invalidMethodNameText")+c),this.next())}},parseActionString:function(a){var b=/^\s*(.+?)\(\s*(.*)\s*\)\s*$/.exec(a);if(!b)return{error:Siesta.Resource("Siesta.Test.Action.Eval",
"wrongFormatText")+a};a=b[1].replace(/^t\./,"");try{var c=JSON.parse("["+b[2]+"]")}catch(d){return{error:Siesta.Resource("Siesta.Test.Action.Eval","parseErrorText")+b[2]}}return{methodName:a,params:c}}}});
Class("Siesta.Test.Action.MethodCall",{isa:Siesta.Test.Action,has:{methodName:null,args:null,callbackIndex:null},methods:{process:function(){var a=this.test,b=this.methodName,c=this.args;"Function"==a.typeOf(c)&&(c=c.call(a,this));c="Array"==a.typeOf(c)?c.slice():[c];null!=this.callbackIndex?c.splice(this.callbackIndex,0,this.next):c.push(this.next);a[b].apply(a,c)}}});Siesta.Test.ActionRegistry().registerAction("methodCall",Siesta.Test.Action.MethodCall);
Class("Siesta.Util.TreeStoreFilterer",{has:{idProp:{required:!0},childNodesProp:{required:!0},parentNodeProp:{required:!0},isLeaf:{required:!0}},does:[Siesta.Util.Role.CanEscapeRegExp],methods:{parseFilterValue:function(a){a=a.split(/\s*\>\s*/);var b=1<a.length?a[0]:"";return{testFilterRegexps:this.splitTermByPipe(1<a.length?a[1]:a[0]),groupFilterRegexps:b?this.splitTermByPipe(b):null}},checkCommonFilter:function(a,b,c,d){if(d){for(var e=a,f=!1;e&&e[this.parentNodeProp];)if(e=e[this.parentNodeProp],
this.matchAnyOfRegExps(b(e),d)){f=!0;break}if(!f)return!1}return this.matchAnyOfRegExps(b(a),c)?!0:!c.length},splitTermByPipe:function(a){a=a.split(/\s*\|\s*/);for(var b=[],c=this,d=0;d<a.length;d++)a[d]&&b.push(Joose.A.map(a[d].split(/\s+/),function(a){return new RegExp(c.escapeRegExp(a),"i")}));return b},matchAnyOfRegExps:function(a,b){for(var c=0;c<b.length;c++){for(var d=!0,e=b[c].length,f=0;f<e;f++)if(!b[c][f].test(a)){d=!1;break}if(d)return!0}return!1},collectNodes:function(a,b){var c=b.filter,
d=b.scope||this,e=b.shallow,f=b.checkParents||e,g=b.fullMatchingParents,k=b.onlyParents||g;if(k&&f)throw Error("Can't combine `onlyParents` and `checkParents` options");var l=this.idProp,m=this.parentNodeProp,n=this.childNodesProp,r=this.isLeaf,p=b.rootVisible,q={},t=function(a){q[a[l]]=!0;for(a=a[m];a&&!q[a[l]];)q[a[l]]=!0,a=a[m]},v=function(a,b){b(a);for(var c=a[n],d=c.length,e=0;e<d;e++)r(a)?b(a):v(c[e],b)};p&&(q[a[l]]=!0);var z=function(b){if(!b.hidden){var m,A,B;if(r(b))c.call(d,b,q)&&t(b);else if(k){if(m=
c.call(d,b))if(t(b),g){v(b,function(a){q[a[l]]=!0});return}b=b[n];A=b.length;for(B=0;B<A;B++)m&&r(b[B])?q[b[B][l]]=!0:r(b[B])||z(b[B])}else if(f&&(m=c.call(d,b,q))&&t(b),!f||!e||e&&(m||b==a&&!p))for(b=b[n],A=b.length,B=0;B<A;B++)z(b[B])}};z(a);return q}}});Role("Siesta.Util.Role.CanDetectES6",{has:{supportsArrowFunctions:function(){return this.canEvaluate("x => x")}},methods:{canEvaluate:function(a){try{return eval(a),!0}catch(b){return!1}}}});
Class("Siesta.Project",{does:[JooseX.Observable,Siesta.Util.Role.CanGetType,Siesta.Util.Role.CanDetectES6],has:{title:null,desc:null,testClass:Siesta.Test,contentManagerClass:Siesta.Content.Manager,descriptors:Joose.I.Array,descriptorsById:Joose.I.Object,launchCounter:0,launches:Joose.I.Object,scopesByURL:Joose.I.Object,testsByURL:Joose.I.Object,transparentEx:!1,scopeProviderConfig:null,scopeProvider:null,runCore:"parallel",maxThreads:4,autoCheckGlobals:!1,disableGlobalsCheck:!1,expectedGlobals:Joose.I.Array,
cleanScopeGlobals:Joose.I.Array,preload:Joose.I.Array,cachePreload:!1,mainPreset:null,emptyPreset:null,keepNLastResults:2,lastResultsURLs:Joose.I.Array,lastResultsByURL:Joose.I.Object,breakOnFail:!1,overrideSetTimeout:!1,needDone:!1,increaseTimeoutThreshold:8,startDate:null,endDate:null,waitForTimeout:1E4,defaultTimeout:15E3,subTestTimeout:null,isReadyTimeout:1E4,pauseBetweenTests:10,failOnExclusiveSpecsWhenAutomated:!1,snooze:null,referenceUrl:null,suppressPassedWaitForAssertion:!1,isEcmaModule:null,
setupDone:!1,sourceLineForAllAssertions:!1,currentLaunchId:null,isAutomated:!1,autoLaunchTests:!0,configSynonyms:function(){return this.processConfigSynonyms(this.buildConfigSynonyms())},uniqueCounter:0,valueToHashIndicies:Joose.I.Object,sandboxHashStructure:{lazy:"this.buildSandboxHashStructure"},sandbox:!0,sandboxBoundaryByGroup:!0,sandboxCleanup:!0,debuggerOnFail:!1,debuggerOnStart:!1},methods:{initialize:function(){var a=this;a.on("testupdate",function(b,c,d,e){a.onTestUpdate(c,d,e)});a.on("testfailedwithexception",
function(b,c,d,e){a.onTestFail(c,d,e)});a.on("teststart",function(b,c){a.onTestStart(c)});a.on("testfinalize",function(b,c){a.onTestEnd(c)})},buildConfigSynonyms:function(){return{}},processConfigSynonyms:function(a){var b={};Joose.O.each(a,function(a,d){a instanceof Array?a.unshift(d):a=[d,a];Joose.A.each(a,function(d){b[d]=a})});return b},onTestUpdate:function(a,b,c){},onTestFail:function(a,b,c){},onTestStart:function(a){},onTestEnd:function(a){},onTestSuiteStart:function(a,b,c){this.startDate=
new Date;this.fireEvent("testsuitestart",this,c)},onTestSuiteEnd:function(a,b,c){this.endDate=new Date;this.fireEvent("testsuiteend",this,c)},onBeforeScopePreload:function(a,b){this.fireEvent("beforescopepreload",a,b)},onAfterScopePreload:function(a,b){this.fireEvent("afterscopepreload",a,b)},onCachingError:function(a,b){},configure:function(a){Joose.O.copy(a,this);var b=this;a.listeners&&Joose.O.each(a.listeners,function(c,d){if("scope"!=d)b.on(d,c,a.scope||b)})},processPreloadArray:function(a){var b=
this;a=this.flattenArray(a,!0);Joose.A.each(a,function(c,d){Object(c)===c?c.url&&(c.url=b.normalizeURL(c.url)):a[d]=b.normalizeURL(c)});return a},populateCleanScopeGlobals:function(a,b){var c=new (eval(a)),d=this.cleanScopeGlobals;c.setup(function(){for(var a in c.scope)d.push(a);b();setTimeout(function(){c.cleanup()},0)})},startSingle:function(a,b){var c=this;this.__counter__=this.__counter__||0;var d=function(){c.launch([c.normalizeDescriptor(a,c,c.__counter__++)],b)};c.setupDone?d():this.setup(d)},
setup:function(a){this.mainPreset=new Siesta.Content.Preset({preload:this.processPreloadArray(this.preload)});this.emptyPreset=new Siesta.Content.Preset;this.descriptors.push({isSystemDescriptor:!0,url:"/"});this.normalizeDescriptors(this.descriptors);this.populateCleanScopeGlobals(this.scopeProvider,a)},plan:function(){var a=this.flattenArray(arguments);this.descriptors.push.apply(this.descriptors,a)},start:function(){var a=Siesta.my.activeHarness=this;a.plan(this.flattenArray(arguments));this.setup(function(){a.setupDone=
!0;a.fireEvent("setupdone");a.autoLaunchTests&&a.launch(a.descriptors)})},startFromUrl:function(a){var b=new this.contentManagerClass({project:this,presets:[new Siesta.Content.Preset({preload:[a]})]}),c=this;b.cache(function(){var d=b.getContentOf(a);try{var e=JSON.parse(d)}catch(f){alert("The content of: "+a+" is not a valid JSON");return}"Array"==c.typeOf(e)?c.start(e):alert("The content of: "+a+" is not an array")},function(){alert("Can not load the content of: "+a)})},normalizeDescriptors:function(a){var b=
this,c=[];Joose.A.each(a,function(a,e){a&&c.push(b.normalizeDescriptor(a,b,e))});b.descriptors=c},launch:function(a,b,c){var d=this.currentLaunchId=++this.launchCounter,e=this,f=this.flattenDescriptors(a),g=new Siesta.Content.Preset,k=[g,this.mainPreset],l={};Joose.A.each(f,function(a){a.preset!=e.mainPreset&&a.preset!=e.emptyPreset&&k.push(a.preset);a.testCode||g.addResource(a.url);e.deleteTestByURL(a.url);l[a.automationElementId]=1});var m=new this.contentManagerClass({project:this,presets:[g].concat(this.cachePreload?
k:[])}),n=this.launches[d]={launchId:d,increaseTimeout:"parallel"==this.runCore&&f.length>this.increaseTimeoutThreshold,descriptors:f,contentManager:m,needToStop:!1,notLaunchedByAutomationId:l};e.onTestSuiteStart(a,m,n);m.cache(function(){Joose.A.each(f,function(a){var b=a.url;m.hasContentOf(b)?(b=a.testConfig=Siesta.getConfigForTestScript(m.getContentOf(b)))&&(b.preload||b.alsoPreload)&&(a.preset=e.getDescriptorPreset(a)):a.testCode||e.markMissingFile(a);e.normalizeScopeProvider(a)});e.fireEvent("testsuitelaunch",
a,m,n);e.runCoreGeneral(f,m,n,n.callback=function(){e.onTestSuiteEnd(a,m,n);b&&b(a);n.needToStop=!0;delete e.launches[d]})},function(){},!0)},markMissingFile:function(a){a.isMissing=!0},flattenDescriptors:function(a,b){var c=[],d=this;Joose.A.each(a,function(a){a.group?(b&&c.push(a),c.push.apply(c,d.flattenDescriptors(a.items,b))):a.isSystemDescriptor||c.push(a)});return c},forEachDescriptor:function(a,b,c,d){var e=this;return Joose.A.each(a,function(a){if(a.group)return b&&!1===c.call(d||e,a)?!1:
e.forEachDescriptor(a.items,b,c,d);if(!a.isSystemDescriptor&&!1===c.call(d||e,a))return!1})},lookUpValueInDescriptorTree:function(a,b,c){if(this.descriptorHasOwnValueFor(a,b))return this.getConfigValueFromDescriptor(a,b);if(a=a.parent)return a==this?c?void 0:this.getConfigValueFromDescriptor(this,b):this.lookUpValueInDescriptorTree(a,b,c)},descriptorHasOwnValueFor:function(a,b){var c=a.testConfig;if(c&&c.hasOwnProperty(b)||a.hasOwnProperty(b))return!0;var d=this.configSynonyms[b],e=!1;d&&Joose.A.each(d,
function(d){if(d!=b&&(c&&c.hasOwnProperty(d)||a.hasOwnProperty(d)))return e=!0,!1});return e},getConfigValueFromDescriptor:function(a,b,c){if(a==this){c=this.configSynonyms[b]||[b];var d,e;Joose.A.each(c,function(b){if(a.hasOwnProperty(b))return d=a[b],e=!0,!1});return e?d:this[b]}var f=a.testConfig;if(f&&f.hasOwnProperty(b))return f[b];if(a.hasOwnProperty(b))return a[b];(c=this.configSynonyms[b])&&Joose.A.each(c,function(c){if(c!=b&&(f&&f.hasOwnProperty(c)||a.hasOwnProperty(c)))return d=f&&f.hasOwnProperty(c)?
f[c]:a[c],!1});return d},getDescriptorConfig:function(a,b,c){return this.lookUpValueInDescriptorTree(a,b,c)},getDescriptorPreset:function(a){var b=this.getDescriptorConfig(a,"preload",!0);a=this.getDescriptorConfig(a,"alsoPreload",!0);return b||a?(b=(b||this.preload||[]).concat(a||[]),b.length?new Siesta.Content.Preset({preload:this.processPreloadArray(b)}):this.emptyPreset):this.mainPreset},normalizeScopeProvider:function(a){var b=this.getDescriptorConfig(a,"scopeProvider");if(b)var c,b=(c=/^=(.+)/.exec(b))?
c[1]:b.replace(/^(Scope\.Provider\.)?/,"Scope.Provider.");a.scopeProvider=b;a.scopeProviderConfig=this.getDescriptorConfig(a,"scopeProviderConfig")},normalizeDescriptor:function(a,b,c,d){if(a.normalized)return a;"string"==typeof a&&(a={url:a});d=d||0;var e=this;a.parent=b;if(a.group){a.id=b==this?"testFolder-"+d+"-"+c:b.id+"/"+d+"-"+c;var f=[];Joose.A.each(a.items||[],function(b,c){b&&f.push(e.normalizeDescriptor(b,a,c,d+1))});a.items=f}else a.id=a.url,a.preset=this.getDescriptorPreset(a),a.name=
a.name||a.url.replace(/(?:.*\/)?([^/]+)$/,"$1");this.descriptorsById[a.id]=a;a.normalized=!0;return a},runCoreGeneral:function(a,b,c,d){var e="runCore"+Joose.S.uppercaseFirst(this.runCore);if("function"!=typeof this[e])throw Error("Invalid `runCore` specified: ["+this.runCore+"]");this[e](a,b,c,d)},runCoreParallel:function(a,b,c,d){var e=this,f=0,g=a.length;g||d();for(var k=!1,l=!1,m=function(l){e.processURL(l,l.index,b,c,function(){f++;c.needToStop?k||(k=!0,d()):f==g?d():n(a)})},n=function(a){var b=
a.shift();b&&(l?setTimeout(function(){m(b)},e.pauseBetweenTests):m(b))},r=1;r<=this.maxThreads;r++)n(a);l=!0},runCoreSequential:function(a,b,c,d){if(a.length&&!c.needToStop){var e=a.shift(),f=this;this.processURL(e,e.index,b,c,function(){a.length&&!c.needToStop?setTimeout(function(){f.runCoreSequential(a,b,c,d)},f.pauseBetweenTests):d()})}else d()},stopCurrentLaunch:function(a){if((a=this.launches[a?a.launchId:this.currentLaunchId])&&!a.needToStop){a.needToStop=!0;var b=this;Joose.A.each(a.descriptors,
function(a){if(a=b.testsByURL[a.url])try{a.finalize(!0)}catch(d){}});return!0}},getSeedingCode:function(a,b){return";("+function(a,b){StartTest=startTest=function(){arguments.callee.args=arguments};describe=function(){if(describe.called)throw Error("`describe()` used as global function instead of test method `t.describe()`");describe.called=!0;StartTest.apply(this,arguments)};StartTest.launchId=b;StartTest.id=a;StartTest.exceptionCatcher=function(a){var b;try{a()}catch(c){b=c}return"__SIESTA_TEST_EXIT_EXCEPTION__"==
b?void 0:b};StartTest.testErrorClass=Error}.toString()+")("+JSON.stringify(a.id)+", "+b+")"},getScopeProviderConfigFor:function(a,b){var c=Joose.O.copy(a.scopeProviderConfig||{});c.seedingCode=this.getSeedingCode(a,b);c.launchId=b;return c},keepTestResult:function(a){if(this.lastResultsByURL[a]){var b=-1;Joose.A.each(this.lastResultsURLs,function(c,d){if(c==a)return b=d,!1});this.lastResultsURLs.splice(b,1);this.lastResultsURLs.push(a)}else this.lastResultsURLs.push(a),this.lastResultsByURL[a]=!0,
this.lastResultsURLs.length>this.keepNLastResults&&this.releaseTestResult()},releaseTestResult:function(){if(!(this.lastResultsURLs.length<=this.keepNLastResults)){var a=this.lastResultsURLs.shift();delete this.lastResultsByURL[a];var b=this.getTestByURL(a);b&&b.isFinished()&&this.cleanupScopeForURL(a)}},isKeepingResultForURL:function(a){return this.lastResultsByURL[a]},setupScope:function(a,b){var c=a.url,d=this.scopesByURL[c],d=d&&d.launchId>b,e=new (eval(a.scopeProvider))(this.getScopeProviderConfigFor(a,
b));if(d)return e;this.cleanupScopeForURL(c);this.keepTestResult(c);return this.scopesByURL[c]=e},cleanupScopeForURL:function(a){var b=this.scopesByURL[a];b&&(delete this.scopesByURL[a],b.cleanup())},prepareScopeSeeding:function(a,b,c){var d=this.getDescriptorConfig(b,"isEcmaModule");b.testCode||this.cachePreload&&c.hasContentOf(b.url)?a.addPreload({type:"js",content:b.testCode||c.getContentOf(b.url)+"\n//# sourceURL="+b.url,isEcmaModule:d}):(a.seedingScript=this.resolveURL(b.url,a,b),a.seedingScriptIsEcmaModule=
d)},normalizeURL:function(a){return a},resolveURL:function(a,b,c){return a},canUseCachedContent:function(a,b){return this.cachePreload&&a instanceof Siesta.Content.Resource.JavaScript},addCachedResourceToPreloads:function(a,b,c,d){a.addPreload({type:"js",content:b.getContentOf(c)})},getOnErrorHandler:function(a,b){var c=Siesta.Resource("Siesta.Project");return function(d,e,f,g,k,l){var m=a.test;l&&(d=l.reason||"",e=f=g="");if(1==arguments.length){var n=d;k=n.error;if(n.target&&n.target.tagName&&!k){d=
c.get("resourceFailedToLoad",{nodeName:n.target?n.target.nodeName.toUpperCase():""});e=n.srcElement?n.srcElement.href||n.srcElement.src:"";f="";m.fail(d+" "+(n.target?n.target.outerHTML:e));return}d=n.message;e="";f=0}/__SIESTA_TEST_EXIT_EXCEPTION__|ResizeObserver loop limit exceeded/.test(d)||m&&!0===m.onException(d,e,f,g,k)||(m&&m.isStarted()?(m.nbrExceptions++,m.failWithException(k||d+" "+e+" "+f,l?"Unhandled promise rejection in test "+(m.name||m.url):null)):b&&b.push({isException:!0,message:k&&
k.stack?k.stack+"":d+" "+e+" "+f}))}},processURL:function(a,b,c,d,e,f,g){function k(){var b=Siesta.Resource("Siesta.Project");q.setup(function(g,k,q){l.onAfterScopePreload(g,m,v,k);k&&Joose.O.each(k,function(a,c){r.unshift({isException:!1,message:b.get("preloadHasFailed",{url:c})})});q&&r.push({isException:!0,message:b.get("crossOriginFailed",{url:g.sourceURL})});g.scope?l.launchTest({testHolder:n,desc:a,scopeProvider:g,contentManager:c,launchState:d,preloadErrors:r,onErrorHandler:p,onErrorHandlerBorrowing:t,
startTestAnchor:q?null:g.scope.StartTest,noCleanup:f,reusingSandbox:!1},e):e()})}var l=this,m=a.url;if(a.isMissing)e();else{delete d.notLaunchedByAutomationId[a.automationElementId];var n={},r=[],p=this.getOnErrorHandler(n,r),q=this.setupScope(a,d.launchId);b=this.getDescriptorConfig(a,"transparentEx");var t=q.addOnErrorHandler(p,!b);a.preset.eachResource(function(b){c.hasContentOf(b)&&l.canUseCachedContent(b,a)?l.addCachedResourceToPreloads(q,c,b,a):(b=b.asDescriptor(),b.url&&(b.url=l.resolveURL(b.url,
q,a)),q.addPreload(b))});l.prepareScopeSeeding(q,a,c);b=l.getDescriptorConfig(a,"testClass");"String"==l.typeOf(b)&&(b=Joose.S.strToClass(b));g=l.getNewTestConfiguration(a,q,c,d,g);var v=n.test=new b(g);this.onBeforeScopePreload(q,m,v);v.earlySetup(function(){k()},function(a){r.push({isException:!1,message:a});k()})}},launchTest:function(a,b){var c=a.scopeProvider,d=a.desc,e=this,f=d.url,g=a.testHolder,k=a.noCleanup,l=a.cleanupUrl,m=g.test;m.callback=function(){k||e.isKeepingResultForURL(f)||e.cleanupScopeForURL(l||
f);b&&b(g);g=null};if(c.crossOriginFailed)m.isFinished()||m.start(a.preloadErrors),m=a=null;else{var n=a.startTestAnchor,r=n&&n.args,p=c.scope;Joose.O.extend(m,{startTestAnchor:n,exceptionCatcher:n.exceptionCatcher,testErrorClass:n.testErrorClass,global:p,originalSetTimeout:a.originalSetTimeout||p.setTimeout,originalClearTimeout:a.originalClearTimeout||p.clearTimeout,run:r&&("function"==typeof r[0]?r[0]:r[1]),reusingSandbox:a.reusingSandbox});if(a.onErrorHandler){if(a.onErrorHandlerBorrowing)a.onErrorHandlerBorrowing();
a.onErrorHandlerBorrowing=c.addOnErrorHandler(a.onErrorHandler,!this.getDescriptorConfig(d,"transparentEx"))}this.saveTestWithURL(f,m);d=function(){c.scope?(e.fireEvent("beforeteststart",m),m.isFinished()||m.start(a.preloadErrors),m=a=null):b()};a.reusingSandbox?d():c instanceof Scope.Provider.IFrame?p.setTimeout(d,10):setTimeout(d,50)}},getNewTestConfiguration:function(a,b,c,d,e){for(var f=[],g=a.parent;g;)g.parent&&f.unshift(String(g.group)),g=g.parent;return{url:a.url,name:a.name,referenceUrl:this.getDescriptorConfig(a,
"referenceUrl"),launchId:d.launchId,automationElementId:a.automationElementId,groups:f,jUnitClass:this.getDescriptorConfig(a,"jUnitClass"),project:this,expectedGlobals:this.cleanScopeGlobals.concat(this.getDescriptorConfig(a,"expectedGlobals")),autoCheckGlobals:this.getDescriptorConfig(a,"autoCheckGlobals"),disableGlobalsCheck:this.disableGlobalsCheck,scopeProvider:b,contentManager:c,transparentEx:this.getDescriptorConfig(a,"transparentEx"),needDone:this.getDescriptorConfig(a,"needDone"),overrideSetTimeout:this.getDescriptorConfig(a,
"overrideSetTimeout"),defaultTimeout:this.getDescriptorConfig(a,"defaultTimeout")*(d.increaseTimeout?2:1),subTestTimeout:this.getDescriptorConfig(a,"subTestTimeout")*(d.increaseTimeout?2:1),waitForTimeout:this.getDescriptorConfig(a,"waitForTimeout")*(d.increaseTimeout?3:1),isReadyTimeout:this.getDescriptorConfig(a,"isReadyTimeout"),sourceLineForAllAssertions:this.sourceLineForAllAssertions,sandboxCleanup:this.getDescriptorConfig(a,"sandboxCleanup"),sharedSandboxState:e,config:this.getDescriptorConfig(a,
"config"),failOnExclusiveSpecsWhenAutomated:this.getDescriptorConfig(a,"failOnExclusiveSpecsWhenAutomated"),snoozeUntil:this.getDescriptorConfig(a,"snooze"),suppressPassedWaitForAssertion:this.getDescriptorConfig(a,"suppressPassedWaitForAssertion")}},getScriptDescriptor:function(a){return this.descriptorsById[a]},getDescById:function(a){return this.descriptorsById[a]},getTestByURL:function(a){return this.testsByURL[a]},saveTestWithURL:function(a,b){this.testsByURL[a]=b},deleteTestByURL:function(a){var b=
this.testsByURL[a];if(b){try{b.finalize(!0)}catch(c){}this.cleanupScopeForURL(a)}delete this.testsByURL[a]},allPassed:function(){var a=!0,b=this;Joose.A.each(this.flattenDescriptors(this.descriptors),function(c){if(c.isMissing)return a=!1;if(c=b.getTestByURL(c.url))if(a=a&&c.isPassed(),!a)return!1});return a},flattenArray:function(a,b){var c=this,d=[];Joose.A.each(a,function(a){"Array"==c.typeOf(a)?d.push.apply(d,c.flattenArray(a,b)):b&&!a||d.push(a)});return d},buildSandboxHashStructure:function(){return"preload alsoPreload hostPageUrl pageUrl useStrictMode overrideSetTimeout".split(" ")},
assignUniqueTag:function(a,b){if(null==a)return"";if(a===Object(a))return a.__UNIQUE__?a.__UNIQUE__:a.__UNIQUE__=(this.uniqueCounter++).toString(36);a+="";var c=this.valueToHashIndicies[b];c||(c=this.valueToHashIndicies[b]={});return c[a]?c[a]:c[a]=(this.uniqueCounter++).toString(36)},calculateSharedContextGroupHash:function(a){var b=this,c=this.getSandboxHashStructure(),d="";Joose.A.each(c,function(c){d+=b.assignUniqueTag(b.getDescriptorConfig(a,c),c)});this.sandboxBoundaryByGroup&&(d+=this.assignUniqueTag(a.parent));
return d},sortDescriptors:function(a,b,c){var d=this,e=[],f=[],g=[],k={};Joose.A.each(a,function(a){if(d.getDescriptorConfig(a,"sandbox"))"sequential"==(b||d.getDescriptorConfig(a,"runCore"))||d.testMustRunSequential(a)?f.push(c?a.id:a):e.push(c?a.id:a);else{var m=d.calculateSharedContextGroupHash(a),n=k[m];n||(n=k[m]={groupHash:m,items:[]},g.push(n));n.items.push(c?a.id:a)}});return{sharedContextGroups:g,mustRunSequential:f,canRunParallel:e}},hasDescriptorWithNativeEventsSimulation:function(a){return!1}},
my:{has:{HOST:null,instance:null},methods:{staticDeprecationWarning:function(a){a=Siesta.Resource("Siesta.Project","staticDeprecationWarning",{methodName:a,projectClass:this.HOST+""});"undefined"!=typeof console&&console.warn(a)},configure:function(a){this.staticDeprecationWarning("configure");return(this.instance=new this.HOST).configure(a)},start:function(){this.staticDeprecationWarning("start");return this.instance.start.apply(this.instance,arguments)},on:function(){this.staticDeprecationWarning("on");
return this.instance.on.apply(this.instance,arguments)}}}});Siesta.Harness=Siesta.Project;
Role("Siesta.Util.Role.CanStyleOutput",{has:{disableColoring:!1,style:{is:"rwc",lazy:"this.buildStyle"},styles:{init:{bold:[1,22],italic:[3,23],underline:[4,24],"black ":[30,39],yellow:[33,39],cyan:[36,39],white:[37,39],green:[32,39],red:[31,39],grey:[90,39],blue:[34,39],magenta:[35,39],"bgblack ":[40,49],bgyellow:[43,49],bgcyan:[46,49],bgwhite:[47,49],bggreen:[42,49],bgred:[41,49],bggrey:[100,49],bgblue:[44,49],bgmagenta:[45,49],inverse:[7,27]}}},methods:{buildStyle:function(){var a=this,b={};Joose.O.each(this.styles,
function(c,d){b[d]=function(b){return a.styled(b,d)}});return b},styled:function(a,b){if(this.disableColoring)return a;var c=this.styles;return"\u001b["+c[b][0]+"m"+a+"\u001b["+c[b][1]+"m"}}});
Role("Siesta.Util.Role.CanParseBrowser",{methods:{parseBrowser:function(a){var b="unknown",c="",d;if(d=/Firefox\/((?:\d+\.?)+)/.exec(a))b="Firefox",c=d[1];if(d=/Chrome\/((?:\d+\.?)+)/.exec(a))b="Chrome",c=d[1];if(d=/MSIE\s*((?:\d+\.?)+)/.exec(a))b="IE",c=d[1];a.match(/trident/i)&&(d=/rv.(\d\d\.?\d?)/.exec(a))&&(b="IE",c=d[1]);if(d=/chrome.+? edge\/(\d+(\.\d+)?)/i.exec(a))b="Edge",c=d[1];if(d=/Apple.*Version\/((?:\d+\.?)+)\s*(?=Safari\/((?:\d+\.?)+))/.exec(a))b="Safari",c=d[1]+" ("+d[2]+")";if(d=/PhantomJS\/(\d+\.\d+\.\d+)/.exec(a))b=
"PhantomJS",c=d[1];if(d=/SlimerJS\/(\d+\.\d+\.\d+)/.exec(a))b="SlimerJS",c=d[1];if(d=/NodeJS\/(.+)/.exec(a))b="NodeJS",c=d[1];return{name:b,version:c}}}});
"undefined"==typeof Promise&&function(a,b){"object"===typeof exports&&"undefined"!==typeof module?module.exports=b():"function"===typeof define&&define.amd?define(b):a.ES6Promise=b()}(this,function(){function a(){return function(){return process.nextTick(f)}}function b(){return"undefined"!==typeof oa?function(){oa(f)}:e()}function c(){var a=0,b=new T(f),c=document.createTextNode("");b.observe(c,{characterData:!0});return function(){c.data=a=++a%2}}function d(){var a=new MessageChannel;a.port1.onmessage=
f;return function(){return a.port2.postMessage(0)}}function e(){var a=setTimeout;return function(){return a(f,1)}}function f(){for(var a=0;a<O;a+=2)(0,J[a])(J[a+1]),J[a]=void 0,J[a+1]=void 0;O=0}function g(){try{var a=Function("return this")().require("vertx");oa=a.runOnLoop||a.runOnContext;return b()}catch(c){return e()}}function k(a,b){var c=this,d=new this.constructor(m);void 0===d[I]&&K(d);var e=c._state;if(e){var f=arguments[e-1];y(function(){return F(e,d,f,c._result)})}else A(c,d,a,b);return d}
function l(a){if(a&&"object"===typeof a&&a.constructor===this)return a;var b=new this(m);v(b,a);return b}function m(){}function n(a){try{return a.then}catch(b){return G.error=b,G}}function r(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function p(a,b,c){y(function(a){var d=!1,e=r(c,b,function(c){d||(d=!0,b!==c?v(a,c):w(a,c))},function(b){d||(d=!0,x(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,x(a,e))},a)}function q(a,b){b._state===U?w(a,b._result):b._state===Q?x(a,b._result):A(b,
void 0,function(b){return v(a,b)},function(b){return x(a,b)})}function t(a,b,c){b.constructor===a.constructor&&c===k&&b.constructor.resolve===l?q(a,b):c===G?(x(a,G.error),G.error=null):void 0===c?w(a,b):"function"===typeof c?p(a,b,c):w(a,b)}function v(a,b){if(a===b)x(a,new TypeError("You cannot resolve a promise with itself"));else{var c=typeof b;null===b||"object"!==c&&"function"!==c?w(a,b):t(a,b,n(b))}}function z(a){a._onerror&&a._onerror(a._result);B(a)}function w(a,b){a._state===R&&(a._result=
b,a._state=U,0!==a._subscribers.length&&y(B,a))}function x(a,b){a._state===R&&(a._state=Q,a._result=b,y(z,a))}function A(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null;e[f]=b;e[f+U]=c;e[f+Q]=d;0===f&&a._state&&y(B,a)}function B(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,e,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?F(c,d,e,f):e(f);a._subscribers.length=0}}function F(a,b,c,d){var e="function"===typeof c,f,g=void 0,h=void 0,k=void 0;if(e){try{f=c(d)}catch(l){G.error=
l,f=G}f===G?(k=!0,g=f.error,f.error=null):h=!0;if(b===f){x(b,new TypeError("A promises callback cannot return that same promise."));return}}else f=d,h=!0;b._state===R&&(e&&h?v(b,f):k?x(b,g):a===U?w(b,f):a===Q&&x(b,f))}function C(a,b){try{b(function(b){v(a,b)},function(b){x(a,b)})}catch(c){x(a,c)}}function K(a){a[I]=P++;a._state=void 0;a._result=void 0;a._subscribers=[]}var aa=void 0,ca=aa=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},O=0,oa=void 0,
da=void 0,y=function(a,b){J[O]=a;J[O+1]=b;O+=2;2===O&&(da?da(f):M())},V=(aa="undefined"!==typeof window?window:void 0)||{},T=V.MutationObserver||V.WebKitMutationObserver,V="undefined"===typeof self&&"undefined"!==typeof process&&"[object process]"==={}.toString.call(process),h="undefined"!==typeof Uint8ClampedArray&&"undefined"!==typeof importScripts&&"undefined"!==typeof MessageChannel,J=Array(1E3),M=void 0,M=V?a():T?c():h?d():void 0===aa&&"function"===typeof require?g():e(),I=Math.random().toString(36).substring(2),
R=void 0,U=1,Q=2,G={error:null},P=0,W=function(){function a(b,c){this._instanceConstructor=b;this.promise=new b(m);this.promise[I]||K(this.promise);ca(c)?(this._remaining=this.length=c.length,this._result=Array(this.length),0===this.length?w(this.promise,this._result):(this.length=this.length||0,this._enumerate(c),0===this._remaining&&w(this.promise,this._result))):x(this.promise,Error("Array Methods must be provided an Array"))}a.prototype._enumerate=function(a){for(var b=0;this._state===R&&b<a.length;b++)this._eachEntry(a[b],
b)};a.prototype._eachEntry=function(a,b){var c=this._instanceConstructor,d=c.resolve;d===l?(d=n(a),d===k&&a._state!==R?this._settledAt(a._state,b,a._result):"function"!==typeof d?(this._remaining--,this._result[b]=a):c===L?(c=new c(m),t(c,a,d),this._willSettleAt(c,b)):this._willSettleAt(new c(function(b){return b(a)}),b)):this._willSettleAt(d(a),b)};a.prototype._settledAt=function(a,b,c){var d=this.promise;d._state===R&&(this._remaining--,a===Q?x(d,c):this._result[b]=c);0===this._remaining&&w(d,this._result)};
a.prototype._willSettleAt=function(a,b){var c=this;A(a,void 0,function(a){return c._settledAt(U,b,a)},function(a){return c._settledAt(Q,b,a)})};return a}(),L=function(){function a(b){this[I]=P++;this._result=this._state=void 0;this._subscribers=[];if(m!==b){if("function"!==typeof b)throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(this instanceof a)C(this,b);else throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
}}a.prototype["catch"]=function(a){return this.then(null,a)};a.prototype["finally"]=function(a){var b=this.constructor;return this.then(function(c){return b.resolve(a()).then(function(){return c})},function(c){return b.resolve(a()).then(function(){throw c;})})};return a}();L.prototype.then=k;L.all=function(a){return(new W(this,a)).promise};L.race=function(a){var b=this;return ca(a)?new b(function(c,d){for(var e=a.length,f=0;f<e;f++)b.resolve(a[f]).then(c,d)}):new b(function(a,b){return b(new TypeError("You must pass an array to race."))})};
L.resolve=l;L.reject=function(a){var b=new this(m);x(b,a);return b};L._setScheduler=function(a){da=a};L._setAsap=function(a){y=a};L._asap=y;L.polyfill=function(){var a=void 0;if("undefined"!==typeof global)a=global;else if("undefined"!==typeof self)a=self;else try{a=Function("return this")()}catch(b){throw Error("polyfill failed because global object is unavailable in this environment");}var c=a.Promise;if(c){var d=null;try{d=Object.prototype.toString.call(c.resolve())}catch(b){}if("[object Promise]"===
d&&!c.cast)return}a.Promise=L};L.Promise=L;L.polyfill();return L});
!function(a,b,c){("undefined"!=typeof window?window:a)[b]=c()}(this,"bowser",function(){function a(a){function b(c){return(c=a.match(c))&&1<c.length&&c[1]||""}function c(b){return(b=a.match(b))&&1<b.length&&b[2]||""}var d=b(/(ipod|iphone|ipad)/i).toLowerCase(),e=!/like android/i.test(a)&&/android/i.test(a),n=/nexus\s*[0-6]\s*/i.test(a),r=!n&&/nexus\s*[0-9]+/i.test(a),p=/CrOS/.test(a),q=/silk/i.test(a),t=/sailfish/i.test(a),v=/tizen/i.test(a),z=/(web|hpw)os/i.test(a),w=/windows phone/i.test(a);/SamsungBrowser/i.test(a);
var x=!w&&/windows/i.test(a),A=!d&&!q&&/macintosh/i.test(a),B=!e&&!t&&!v&&!z&&/linux/i.test(a),F=b(/edge\/(\d+(\.\d+)?)/i),C=b(/version\/(\d+(\.\d+)?)/i),K=/tablet/i.test(a),aa=!K&&/[^-]mobi/i.test(a),ca=/xbox/i.test(a);/opera/i.test(a)?p={name:"Opera",opera:!0,version:C||b(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr|opios/i.test(a)?p={name:"Opera",opera:!0,version:b(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||C}:/SamsungBrowser/i.test(a)?p={name:"Samsung Internet for Android",samsungBrowser:!0,version:C||
b(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/coast/i.test(a)?p={name:"Opera Coast",coast:!0,version:C||b(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(a)?p={name:"Yandex Browser",yandexbrowser:!0,version:C||b(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(a)?p={name:"UC Browser",ucbrowser:!0,version:b(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(a)?p={name:"Maxthon",maxthon:!0,version:b(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(a)?p={name:"Epiphany",epiphany:!0,
version:b(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(a)?p={name:"Puffin",puffin:!0,version:b(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(a)?p={name:"Sleipnir",sleipnir:!0,version:b(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(a)?p={name:"K-Meleon",kMeleon:!0,version:b(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:w?(p={name:"Windows Phone",windowsphone:!0},F?(p.msedge=!0,p.version=F):(p.msie=!0,p.version=b(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(a)?p={name:"Internet Explorer",
msie:!0,version:b(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:p?p={name:"Chrome",chromeos:!0,chromeBook:!0,chrome:!0,version:b(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/chrome.+? edge/i.test(a)?p={name:"Microsoft Edge",msedge:!0,version:F}:/vivaldi/i.test(a)?p={name:"Vivaldi",vivaldi:!0,version:b(/vivaldi\/(\d+(\.\d+)?)/i)||C}:t?p={name:"Sailfish",sailfish:!0,version:b(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(a)?p={name:"SeaMonkey",seamonkey:!0,version:b(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(a)?
(p={name:"Firefox",firefox:!0,version:b(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(a)&&(p.firefoxos=!0)):q?p={name:"Amazon Silk",silk:!0,version:b(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(a)?p={name:"PhantomJS",phantom:!0,version:b(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(a)?p={name:"SlimerJS",slimer:!0,version:b(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(a)||/rim\stablet/i.test(a)?p={name:"BlackBerry",blackberry:!0,version:C||
b(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:z?(p={name:"WebOS",webos:!0,version:C||b(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(a)&&(p.touchpad=!0)):/bada/i.test(a)?p={name:"Bada",bada:!0,version:b(/dolfin\/(\d+(\.\d+)?)/i)}:v?p={name:"Tizen",tizen:!0,version:b(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||C}:/qupzilla/i.test(a)?p={name:"QupZilla",qupzilla:!0,version:b(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||C}:/chromium/i.test(a)?p={name:"Chromium",chromium:!0,version:b(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||
C}:/chrome|crios|crmo/i.test(a)?p={name:"Chrome",chrome:!0,version:b(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:e?p={name:"Android",version:C}:/safari|applewebkit/i.test(a)?(p={name:"Safari",safari:!0},C&&(p.version=C)):d?(p={name:"iphone"==d?"iPhone":"ipad"==d?"iPad":"iPod"},C&&(p.version=C)):p=/googlebot/i.test(a)?{name:"Googlebot",googlebot:!0,version:b(/googlebot\/(\d+(\.\d+))/i)||C}:{name:b(/^(.*)\/(.*) /),version:c(/^(.*)\/(.*) /)};!p.msedge&&/(apple)?webkit/i.test(a)?(/(apple)?webkit\/537\.36/i.test(a)?
(p.name=p.name||"Blink",p.blink=!0):(p.name=p.name||"Webkit",p.webkit=!0),!p.version&&C&&(p.version=C)):!p.opera&&/gecko\//i.test(a)&&(p.name=p.name||"Gecko",p.gecko=!0,p.version=p.version||b(/gecko\/(\d+(\.\d+)?)/i));p.windowsphone||p.msedge||!e&&!p.silk?p.windowsphone||p.msedge||!d?A?p.mac=!0:ca?p.xbox=!0:x?p.windows=!0:B&&(p.linux=!0):(p[d]=!0,p.ios=!0):p.android=!0;x="";p.windowsphone?x=b(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):d?(x=b(/os (\d+([_\s]\d+)*) like mac os x/i),x=x.replace(/[_\s]/g,
".")):e?x=b(/android[ \/-](\d+(\.\d+)*)/i):p.webos?x=b(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):p.blackberry?x=b(/rim\stablet\sos\s(\d+(\.\d+)*)/i):p.bada?x=b(/bada\/(\d+(\.\d+)*)/i):p.tizen&&(x=b(/tizen[\/\s](\d+(\.\d+)*)/i));x&&(p.osversion=x);x=x.split(".")[0];if(K||r||"ipad"==d||e&&(3==x||4<=x&&!aa)||p.silk)p.tablet=!0;else if(aa||"iphone"==d||"ipod"==d||e||n||p.blackberry||p.webos||p.bada)p.mobile=!0;p.msedge||p.msie&&10<=p.version||p.yandexbrowser&&15<=p.version||p.vivaldi&&1<=p.version||p.chrome&&
20<=p.version||p.samsungBrowser&&4<=p.version||p.firefox&&20<=p.version||p.safari&&6<=p.version||p.opera&&10<=p.version||p.ios&&p.osversion&&6<=p.osversion.split(".")[0]||p.blackberry&&10.1<=p.version||p.chromium&&20<=p.version?p.a=!0:p.msie&&10>p.version||p.chrome&&20>p.version||p.firefox&&20>p.version||p.safari&&6>p.version||p.opera&&10>p.version||p.ios&&p.osversion&&6>p.osversion.split(".")[0]||p.chromium&&20>p.version?p.c=!0:p.x=!0;return p}function b(a,b){var c=[],d;if(Array.prototype.map)return Array.prototype.map.call(a,
b);for(d=0;d<a.length;d++)c.push(b(a[d]));return c}function c(a){var c=Math.max(a[0].split(".").length,a[1].split(".").length);for(a=b(a,function(a){var d=c-a.split(".").length;a+=Array(d+1).join(".0");return b(a.split("."),function(a){return Array(20-a.length).join("0")+a}).reverse()});0<=--c;){if(a[0][c]>a[1][c])return 1;if(a[0][c]===a[1][c]){if(0===c)return 0}else return-1}}function d(b,d,k){var l=e;"string"===typeof d&&(k=d,d=void 0);void 0===d&&(d=!1);k&&(l=a(k));k=""+l.version;for(var m in b)if(b.hasOwnProperty(m)&&
l[m]){if("string"!==typeof b[m])throw Error("Browser version in the minVersion map should be a string: "+m+": "+String(b));return 0>c([k,b[m]])}return d}var e=a("undefined"!==typeof navigator?navigator.userAgent||"":"");e.test=function(a){for(var b=0;b<a.length;++b){var c=a[b];if("string"===typeof c&&c in e)return!0}return!1};e.isUnsupportedBrowser=d;e.compareVersions=c;e.check=function(a,b,c){return!d(a,b,c)};e._detect=a;return e});
(function(a,b){function c(a,c,d){if(d===b&&1===a.nodeType)if(d="data-"+c.replace(R,"$1-$2").toLowerCase(),d=a.getAttribute(d),"string"===typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:h.isNaN(d)?I.test(d)?h.parseJSON(d):d:parseFloat(d)}catch(e){}h.data(a,c,d)}else d=b;return d}function d(a){for(var b in a)if("toJSON"!==b)return!1;return!0}function e(a,c,d){var e=c+"defer",f=c+"queue",g=c+"mark",k=h.data(a,e,b,!0);!k||"queue"!==d&&h.data(a,f,b,!0)||"mark"!==d&&h.data(a,g,b,!0)||setTimeout(function(){h.data(a,
f,b,!0)||h.data(a,g,b,!0)||(h.removeData(a,e,!0),k.resolve())},0)}function f(){return!1}function g(){return!0}function k(a,c,d){var e=h.extend({},d[0]);e.type=a;e.originalEvent={};e.liveFired=b;h.event.handle.call(c,e);e.isDefaultPrevented()&&d[0].preventDefault()}function l(a){var b,c,d,e,f,g,k,l,u,m,n,E=[];e=[];f=h._data(this,"events");if(a.liveFired!==this&&f&&f.live&&!a.target.disabled&&(!a.button||"click"!==a.type)){a.namespace&&(n=new RegExp("(^|\\.)"+a.namespace.split(".").join("\\.(?:.*\\.)?")+
"(\\.|$)"));a.liveFired=this;var p=f.live.slice(0);for(k=0;k<p.length;k++)f=p[k],f.origType.replace(Da,"")===a.type?e.push(f.selector):p.splice(k--,1);e=h(a.target).closest(e,a.currentTarget);l=0;for(u=e.length;l<u;l++)for(m=e[l],k=0;k<p.length;k++)if(f=p[k],m.selector===f.selector&&(!n||n.test(f.namespace))&&!m.elem.disabled){g=m.elem;d=null;if("mouseenter"===f.preType||"mouseleave"===f.preType)a.type=f.preType,(d=h(a.relatedTarget).closest(f.selector)[0])&&h.contains(g,d)&&(d=g);d&&d===g||E.push({elem:g,
handleObj:f,level:m.level})}l=0;for(u=E.length;l<u;l++){e=E[l];if(c&&e.level>c)break;a.currentTarget=e.elem;a.data=e.handleObj.data;a.handleObj=e.handleObj;n=e.handleObj.origHandler.apply(e.elem,arguments);if(!1===n||a.isPropagationStopped())if(c=e.level,!1===n&&(b=!1),a.isImmediatePropagationStopped())break}return b}}function m(a,b){return(a&&"*"!==a?a+".":"")+b.replace(Ua,"`").replace(Va,"&")}function n(a){return!a||!a.parentNode||11===a.parentNode.nodeType}function r(a,b,c){b=b||0;if(h.isFunction(b))return h.grep(a,
function(a,d){return!!b.call(a,d,a)===c});if(b.nodeType)return h.grep(a,function(a,d){return a===b===c});if("string"===typeof b){var d=h.grep(a,function(a){return 1===a.nodeType});if(Wa.test(b))return h.filter(b,d,!c);b=h.filter(b,d)}return h.grep(a,function(a,d){return 0<=h.inArray(a,b)===c})}function p(a,b){return h.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function q(a,b){if(1===b.nodeType&&h.hasData(a)){var c=h.expando,d=h.data(a),
e=h.data(b,d);if(d=d[c]){var f=d.events,e=e[c]=h.extend({},d);if(f){delete e.handle;e.events={};for(var g in f)for(c=0,d=f[g].length;c<d;c++)h.event.add(b,g+(f[g][c].namespace?".":"")+f[g][c].namespace,f[g][c],f[g][c].data)}}}}function t(a,b){var c;if(1===b.nodeType){b.clearAttributes&&b.clearAttributes();b.mergeAttributes&&b.mergeAttributes(a);c=b.nodeName.toLowerCase();if("object"===c)b.outerHTML=a.outerHTML;else if("input"===c&&("checkbox"===a.type||"radio"===a.type))a.checked&&(b.defaultChecked=
b.checked=a.checked),b.value!==a.value&&(b.value=a.value);else if("option"===c)b.selected=a.defaultSelected;else if("input"===c||"textarea"===c)b.defaultValue=a.defaultValue;b.removeAttribute(h.expando)}}function v(a){return"getElementsByTagName"in a?a.getElementsByTagName("*"):"querySelectorAll"in a?a.querySelectorAll("*"):[]}function z(a){if("checkbox"===a.type||"radio"===a.type)a.defaultChecked=a.checked}function w(a){h.nodeName(a,"input")?z(a):"getElementsByTagName"in a&&h.grep(a.getElementsByTagName("input"),
z)}function x(a,b){b.src?h.ajax({url:b.src,async:!1,dataType:"script"}):h.globalEval((b.text||b.textContent||b.innerHTML||"").replace(H,"/*$0*/"));b.parentNode&&b.parentNode.removeChild(b)}function A(a,b,c){var d="width"===b?a.offsetWidth:a.offsetHeight,e="width"===b?pa:Xa;if(0<d)return"border"!==c&&h.each(e,function(){c||(d-=parseFloat(h.css(a,"padding"+this))||0);d="margin"===c?d+(parseFloat(h.css(a,c+this))||0):d-(parseFloat(h.css(a,"border"+this+"Width"))||0)}),d+"px";d=Y(a,b,b);if(0>d||null==
d)d=a.style[b]||0;d=parseFloat(d)||0;c&&h.each(e,function(){d+=parseFloat(h.css(a,"padding"+this))||0;"padding"!==c&&(d+=parseFloat(h.css(a,"border"+this+"Width"))||0);"margin"===c&&(d+=parseFloat(h.css(a,c+this))||0)});return d+"px"}function B(a){return function(b,c){"string"!==typeof b&&(c=b,b="*");if(h.isFunction(c))for(var d=b.toLowerCase().split(fb),e=0,f=d.length,g,k;e<f;e++)g=d[e],(k=/^\+/.test(g))&&(g=g.substr(1)||"*"),g=a[g]=a[g]||[],g[k?"unshift":"push"](c)}}function F(a,c,d,e,f,g){f=f||
c.dataTypes[0];g=g||{};g[f]=!0;f=a[f];for(var h=0,k=f?f.length:0,l=a===Ya,u;h<k&&(l||!u);h++)u=f[h](c,d,e),"string"===typeof u&&(!l||g[u]?u=b:(c.dataTypes.unshift(u),u=F(a,c,d,e,u,g)));!l&&u||g["*"]||(u=F(a,c,d,e,"*",g));return u}function C(a,b,c,d){if(h.isArray(b))h.each(b,function(b,e){c||qb.test(a)?d(a,e):C(a+"["+("object"===typeof e||h.isArray(e)?b:"")+"]",e,c,d)});else if(c||null==b||"object"!==typeof b)d(a,b);else for(var e in b)C(a+"["+e+"]",b[e],c,d)}function K(){try{return new a.XMLHttpRequest}catch(b){}}
function aa(){setTimeout(ca,0);return Ka=h.now()}function ca(){Ka=b}function O(a,b){var c={};h.each(gb.concat.apply([],gb.slice(0,b)),function(){c[this]=a});return c}function oa(a){if(!Za[a]){var b=y.body,c=h("<"+a+">").appendTo(b),d=c.css("display");c.remove();if("none"===d||""===d)ka||(ka=y.createElement("iframe"),ka.frameBorder=ka.width=ka.height=0),b.appendChild(ka),wa&&ka.createElement||(wa=(ka.contentWindow||ka.contentDocument).document,wa.write(("CSS1Compat"===y.compatMode?"<!doctype html>":
"")+"<html><body>"),wa.close()),c=wa.createElement(a),wa.body.appendChild(c),d=h.css(c,"display"),b.removeChild(ka);Za[a]=d}return Za[a]}function da(a){return h.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}var y=a.document,V=a.navigator,T=a.location,h=function(){function c(){if(!d.isReady){try{y.documentElement.doScroll("left")}catch(a){setTimeout(c,1);return}d.ready()}}var d=function(a,b){return new d.fn.init(a,b,g)},e=a.jQuery,f=a.$,g,h=/^(?:[^<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,
k=/\S/,l=/^\s+/,u=/\s+$/,m=/\d/,n=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,E=/^[\],:{}\s]*$/,p=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,H=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,x=/(?:^|:|,)(?:\s*\[)+/g,q=/(webkit)[ \/]([\w.]+)/,w=/(opera)(?:.*version)?[ \/]([\w.]+)/,r=/(msie) ([\w.]+)/,hb=/(mozilla)(?:.*? rv:([\w.]+))?/,rb=/-([a-z])/ig,sb=function(a,b){return b.toUpperCase()},fa=V.userAgent,La,Ma,t,A=Object.prototype.toString,N=Object.prototype.hasOwnProperty,v=Array.prototype.push,B=
Array.prototype.slice,ra=String.prototype.trim,z=Array.prototype.indexOf,ia={};d.fn=d.prototype={constructor:d,init:function(a,c,e){var f;if(!a)return this;if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if("body"===a&&!c&&y.body)return this.context=y,this[0]=y.body,this.selector=a,this.length=1,this;if("string"===typeof a){f="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&3<=a.length?[null,a,null]:h.exec(a);if(!f||!f[1]&&c)return!c||c.jquery?(c||e).find(a):this.constructor(c).find(a);
if(f[1])return e=(c=c instanceof d?c[0]:c)?c.ownerDocument||c:y,(a=n.exec(a))?d.isPlainObject(c)?(a=[y.createElement(a[1])],d.fn.attr.call(a,c,!0)):a=[e.createElement(a[1])]:(a=d.buildFragment([f[1]],[e]),a=(a.cacheable?d.clone(a.fragment):a.fragment).childNodes),d.merge(this,a);if((c=y.getElementById(f[2]))&&c.parentNode){if(c.id!==f[2])return e.find(a);this.length=1;this[0]=c}this.context=y;this.selector=a;return this}if(d.isFunction(a))return e.ready(a);a.selector!==b&&(this.selector=a.selector,
this.context=a.context);return d.makeArray(a,this)},selector:"",jquery:"1.6.2",length:0,size:function(){return this.length},toArray:function(){return B.call(this,0)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},pushStack:function(a,b,c){var e=this.constructor();d.isArray(a)?v.apply(e,a):d.merge(e,a);e.prevObject=this;e.context=this.context;"find"===b?e.selector=this.selector+(this.selector?" ":"")+c:b&&(e.selector=this.selector+"."+b+"("+c+")");return e},each:function(a,
b){return d.each(this,a,b)},ready:function(a){d.bindReady();Ma.done(a);return this},eq:function(a){return-1===a?this.slice(a):this.slice(a,+a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(B.apply(this,arguments),"slice",B.call(arguments).join(","))},map:function(a){return this.pushStack(d.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:v,sort:[].sort,splice:[].splice};
d.fn.init.prototype=d.fn;d.extend=d.fn.extend=function(){var a,c,e,f,D,g=arguments[0]||{},h=1,k=arguments.length,X=!1;"boolean"===typeof g&&(X=g,g=arguments[1]||{},h=2);"object"===typeof g||d.isFunction(g)||(g={});k===h&&(g=this,--h);for(;h<k;h++)if(null!=(a=arguments[h]))for(c in a)e=g[c],f=a[c],g!==f&&(X&&f&&(d.isPlainObject(f)||(D=d.isArray(f)))?(D?(D=!1,e=e&&d.isArray(e)?e:[]):e=e&&d.isPlainObject(e)?e:{},g[c]=d.extend(X,e,f)):f!==b&&(g[c]=f));return g};d.extend({noConflict:function(b){a.$===
d&&(a.$=f);b&&a.jQuery===d&&(a.jQuery=e);return d},isReady:!1,readyWait:1,holdReady:function(a){a?d.readyWait++:d.ready(!0)},ready:function(a){if(!0===a&&!--d.readyWait||!0!==a&&!d.isReady){if(!y.body)return setTimeout(d.ready,1);d.isReady=!0;!0!==a&&0<--d.readyWait||(Ma.resolveWith(y,[d]),d.fn.trigger&&d(y).trigger("ready").unbind("ready"))}},bindReady:function(){if(!Ma){Ma=d._Deferred();if("complete"===y.readyState)return setTimeout(d.ready,1);if(y.addEventListener)y.addEventListener("DOMContentLoaded",
t,!1),a.addEventListener("load",d.ready,!1);else if(y.attachEvent){y.attachEvent("onreadystatechange",t);a.attachEvent("onload",d.ready);var b=!1;try{b=null==a.frameElement}catch(e){}y.documentElement.doScroll&&b&&c()}}},isFunction:function(a){return"function"===d.type(a)},isArray:Array.isArray||function(a){return"array"===d.type(a)},isWindow:function(a){return a&&"object"===typeof a&&"setInterval"in a},isNaN:function(a){return null==a||!m.test(a)||isNaN(a)},type:function(a){return null==a?String(a):
ia[A.call(a)]||"object"},isPlainObject:function(a){if(!a||"object"!==d.type(a)||a.nodeType||d.isWindow(a)||a.constructor&&!N.call(a,"constructor")&&!N.call(a.constructor.prototype,"isPrototypeOf"))return!1;for(var c in a);return c===b||N.call(a,c)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw a;},parseJSON:function(b){if("string"!==typeof b||!b)return null;b=d.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(E.test(b.replace(p,"@").replace(H,"]").replace(x,
"")))return(new Function("return "+b))();d.error("Invalid JSON: "+b)},parseXML:function(b,c,e){a.DOMParser?(e=new DOMParser,c=e.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b));(e=c.documentElement)&&e.nodeName&&"parsererror"!==e.nodeName||d.error("Invalid XML: "+b);return c},noop:function(){},globalEval:function(b){b&&k.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(rb,sb)},nodeName:function(a,
b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,e){var f,D=0,g=a.length,h=g===b||d.isFunction(a);if(e)if(h)for(f in a){if(!1===c.apply(a[f],e))break}else for(;D<g&&!1!==c.apply(a[D++],e););else if(h)for(f in a){if(!1===c.call(a[f],f,a[f]))break}else for(;D<g&&!1!==c.call(a[D],D,a[D++]););return a},trim:ra?function(a){return null==a?"":ra.call(a)}:function(a){return null==a?"":a.toString().replace(l,"").replace(u,"")},makeArray:function(a,b){var c=b||[];if(null!=
a){var e=d.type(a);null==a.length||"string"===e||"function"===e||"regexp"===e||d.isWindow(a)?v.call(c,a):d.merge(c,a)}return c},inArray:function(a,b){if(z)return z.call(b,a);for(var c=0,d=b.length;c<d;c++)if(b[c]===a)return c;return-1},merge:function(a,c){var d=a.length,e=0;if("number"===typeof c.length)for(var f=c.length;e<f;e++)a[d++]=c[e];else for(;c[e]!==b;)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,D=a.length;f<D;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);
return d},map:function(a,c,e){var f,D,g=[],h=0,k=a.length;if(a instanceof d||k!==b&&"number"===typeof k&&(0<k&&a[0]&&a[k-1]||0===k||d.isArray(a)))for(;h<k;h++)f=c(a[h],h,e),null!=f&&(g[g.length]=f);else for(D in a)f=c(a[D],D,e),null!=f&&(g[g.length]=f);return g.concat.apply([],g)},guid:1,proxy:function(a,c){if("string"===typeof c){var e=a[c];c=a;a=e}if(!d.isFunction(a))return b;var f=B.call(arguments,2),e=function(){return a.apply(c,f.concat(B.call(arguments)))};e.guid=a.guid=a.guid||e.guid||d.guid++;
return e},access:function(a,c,e,f,D,g){var h=a.length;if("object"===typeof c){for(var k in c)d.access(a,k,c[k],f,D,e);return a}if(e!==b){f=!g&&f&&d.isFunction(e);for(k=0;k<h;k++)D(a[k],c,f?e.call(a[k],k,D(a[k],c)):e,g);return a}return h?D(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();if(a.match(/trident/i)&&a.match(/rv.\d\d/))return{browser:"msie",version:"11.0"};a=q.exec(a)||w.exec(a)||r.exec(a)||0>a.indexOf("compatible")&&hb.exec(a)||[];return{browser:a[1]||
"",version:a[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}d.extend(!0,a,this);a.superclass=this;a.fn=a.prototype=this();a.fn.constructor=a;a.sub=this.sub;a.fn.init=function(c,e){e&&e instanceof d&&!(e instanceof a)&&(e=a(e));return d.fn.init.call(this,c,e,b)};a.fn.init.prototype=a.fn;var b=a(y);return a},browser:{}});d.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){ia["[object "+b+"]"]=b.toLowerCase()});La=d.uaMatch(fa);La.browser&&(d.browser[La.browser]=
!0,d.browser.version=La.version);d.browser.webkit&&(d.browser.safari=/safari/i.test(fa)&&!/chrome/i.test(fa));k.test("\u00a0")&&(l=/^[\s\xA0]+/,u=/[\s\xA0]+$/);g=d(y);y.addEventListener?t=function(){y.removeEventListener("DOMContentLoaded",t,!1);d.ready()}:y.attachEvent&&(t=function(){"complete"===y.readyState&&(y.detachEvent("onreadystatechange",t),d.ready())});return d}(),J="done fail isResolved isRejected promise then always pipe".split(" "),M=[].slice;h.extend({_Deferred:function(){var a=[],b,
c,d,e={done:function(){if(!d){var c=arguments,f,g,k,X,l;b&&(l=b,b=0);f=0;for(g=c.length;f<g;f++)k=c[f],X=h.type(k),"array"===X?e.done.apply(e,k):"function"===X&&a.push(k);l&&e.resolveWith(l[0],l[1])}return this},resolveWith:function(e,f){if(!d&&!b&&!c){f=f||[];c=1;try{for(;a[0];)a.shift().apply(e,f)}finally{b=[e,f],c=0}}return this},resolve:function(){e.resolveWith(this,arguments);return this},isResolved:function(){return!(!c&&!b)},cancel:function(){d=1;a=[];return this}};return e},Deferred:function(a){var b=
h._Deferred(),c=h._Deferred(),d;h.extend(b,{then:function(a,c){b.done(a).fail(c);return this},always:function(){return b.done.apply(b,arguments).fail.apply(this,arguments)},fail:c.done,rejectWith:c.resolveWith,reject:c.resolve,isRejected:c.isResolved,pipe:function(a,c){return h.Deferred(function(d){h.each({done:[a,"resolve"],fail:[c,"reject"]},function(a,c){var e=c[0],f=c[1],D;if(h.isFunction(e))b[a](function(){if((D=e.apply(this,arguments))&&h.isFunction(D.promise))D.promise().then(d.resolve,d.reject);
else d[f](D)});else b[a](d[f])})}).promise()},promise:function(a){if(null==a){if(d)return d;d=a={}}for(var c=J.length;c--;)a[J[c]]=b[J[c]];return a}});b.done(c.cancel).fail(b.cancel);delete b.cancel;a&&a.call(b,b);return b},when:function(a){function b(a){return function(b){c[a]=1<arguments.length?M.call(arguments,0):b;--f||g.resolveWith(g,M.call(c,0))}}var c=arguments,d=0,e=c.length,f=e,g=1>=e&&a&&h.isFunction(a.promise)?a:h.Deferred();if(1<e){for(;d<e;d++)c[d]&&h.isFunction(c[d].promise)?c[d].promise().then(b(d),
g.reject):--f;f||g.resolveWith(g,c)}else g!==a&&g.resolveWith(g,e?[a]:[]);return g.promise()}});h.support=function(){var a=y.createElement("div"),b=y.documentElement,c,d,e,f,g,k;a.setAttribute("className","t");a.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";c=a.getElementsByTagName("*");d=a.getElementsByTagName("a")[0];if(!c||!c.length||!d)return{};e=y.createElement("select");f=e.appendChild(y.createElement("option"));c=a.getElementsByTagName("input")[0];
g={leadingWhitespace:3===a.firstChild.nodeType,tbody:!a.getElementsByTagName("tbody").length,htmlSerialize:!!a.getElementsByTagName("link").length,style:/top/.test(d.getAttribute("style")),hrefNormalized:"/a"===d.getAttribute("href"),opacity:/^0.55$/.test(d.style.opacity),cssFloat:!!d.style.cssFloat,checkOn:"on"===c.value,optSelected:f.selected,getSetAttribute:"t"!==a.className,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,
reliableMarginRight:!0};c.checked=!0;g.noCloneChecked=c.cloneNode(!0).checked;e.disabled=!0;g.optDisabled=!f.disabled;try{delete a.test}catch(l){g.deleteExpando=!1}!a.addEventListener&&a.attachEvent&&a.fireEvent&&(a.attachEvent("onclick",function(){g.noCloneEvent=!1}),a.cloneNode(!0).fireEvent("onclick"));c=y.createElement("input");c.value="t";c.setAttribute("type","radio");g.radioValue="t"===c.value;c.setAttribute("checked","checked");a.appendChild(c);d=y.createDocumentFragment();d.appendChild(a.firstChild);
g.checkClone=d.cloneNode(!0).cloneNode(!0).lastChild.checked;a.innerHTML="";a.style.width=a.style.paddingLeft="1px";e=y.getElementsByTagName("body")[0];d=y.createElement(e?"div":"body");f={visibility:"hidden",width:0,height:0,border:0,margin:0};e&&h.extend(f,{position:"absolute",left:-1E3,top:-1E3});for(k in f)d.style[k]=f[k];d.appendChild(a);b=e||b;b.insertBefore(d,b.firstChild);g.appendChecked=c.checked;g.boxModel=2===a.offsetWidth;"zoom"in a.style&&(a.style.display="inline",a.style.zoom=1,g.inlineBlockNeedsLayout=
2===a.offsetWidth,a.style.display="",a.innerHTML="<div style='width:4px;'></div>",g.shrinkWrapBlocks=2!==a.offsetWidth);a.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";e=a.getElementsByTagName("td");c=0===e[0].offsetHeight;e[0].style.display="";e[1].style.display="none";g.reliableHiddenOffsets=c&&0===e[0].offsetHeight;a.innerHTML="";y.defaultView&&y.defaultView.getComputedStyle&&(c=y.createElement("div"),c.style.width="0",c.style.marginRight="0",a.appendChild(c),
g.reliableMarginRight=0===(parseInt((y.defaultView.getComputedStyle(c,null)||{marginRight:0}).marginRight,10)||0));d.innerHTML="";b.removeChild(d);if(a.attachEvent)for(k in{submit:1,change:1,focusin:1})b="on"+k,c=b in a,c||(a.setAttribute(b,"return;"),c="function"===typeof a[b]),g[k+"Bubbles"]=c;d=d=e=f=e=c=a=c=null;return g}();h.boxModel=h.support.boxModel;var I=/^(?:\{.*\}|\[.*\])$/,R=/([a-z])([A-Z])/g;h.extend({cache:{},uuid:0,expando:"jQuery"+(h.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,
object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?h.cache[a[h.expando]]:a[h.expando];return!!a&&!d(a)},data:function(a,c,d,e){if(h.acceptData(a)){var f=h.expando,g="string"===typeof c,k=a.nodeType,l=k?h.cache:a,u=k?a[h.expando]:a[h.expando]&&h.expando;if(u&&(!e||!u||l[u][f])||!g||d!==b){u||(k?a[h.expando]=u=++h.uuid:u=h.expando);l[u]||(l[u]={},k||(l[u].toJSON=h.noop));if("object"===typeof c||"function"===typeof c)e?l[u][f]=h.extend(l[u][f],c):l[u]=h.extend(l[u],
c);a=l[u];e&&(a[f]||(a[f]={}),a=a[f]);d!==b&&(a[h.camelCase(c)]=d);return"events"!==c||a[c]?g?a[h.camelCase(c)]||a[c]:a:a[f]&&a[f].events}}},removeData:function(b,c,e){if(h.acceptData(b)){var f=h.expando,g=b.nodeType,k=g?h.cache:b,l=g?b[h.expando]:h.expando;if(k[l]){if(c){var u=e?k[l][f]:k[l];if(u&&(delete u[c],!d(u)))return}if(e&&(delete k[l][f],!d(k[l])))return;c=k[l][f];h.support.deleteExpando||k!=a?delete k[l]:k[l]=null;c?(k[l]={},g||(k[l].toJSON=h.noop),k[l][f]=c):g&&(h.support.deleteExpando?
delete b[h.expando]:b.removeAttribute?b.removeAttribute(h.expando):b[h.expando]=null)}}},_data:function(a,b,c){return h.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=h.noData[a.nodeName.toLowerCase()];if(b)return!(!0===b||a.getAttribute("classid")!==b)}return!0}});h.fn.extend({data:function(a,d){var e=null;if("undefined"===typeof a){if(this.length&&(e=h.data(this[0]),1===this[0].nodeType))for(var f=this[0].attributes,g,k=0,l=f.length;k<l;k++)g=f[k].name,0===g.indexOf("data-")&&(g=h.camelCase(g.substring(5)),
c(this[0],g,e[g]));return e}if("object"===typeof a)return this.each(function(){h.data(this,a)});var u=a.split(".");u[1]=u[1]?"."+u[1]:"";return d===b?(e=this.triggerHandler("getData"+u[1]+"!",[u[0]]),e===b&&this.length&&(e=h.data(this[0],a),e=c(this[0],a,e)),e===b&&u[1]?this.data(u[0]):e):this.each(function(){var b=h(this),c=[u[0],d];b.triggerHandler("setData"+u[1]+"!",c);h.data(this,a,d);b.triggerHandler("changeData"+u[1]+"!",c)})},removeData:function(a){return this.each(function(){h.removeData(this,
a)})}});h.extend({_mark:function(a,c){a&&(c=(c||"fx")+"mark",h.data(a,c,(h.data(a,c,b,!0)||0)+1,!0))},_unmark:function(a,c,d){!0!==a&&(d=c,c=a,a=!1);if(c){d=d||"fx";var f=d+"mark";(a=a?0:(h.data(c,f,b,!0)||1)-1)?h.data(c,f,a,!0):(h.removeData(c,f,!0),e(c,d,"mark"))}},queue:function(a,c,d){if(a){c=(c||"fx")+"queue";var e=h.data(a,c,b,!0);d&&(!e||h.isArray(d)?e=h.data(a,c,h.makeArray(d),!0):e.push(d));return e||[]}},dequeue:function(a,b){b=b||"fx";var c=h.queue(a,b),d=c.shift();"inprogress"===d&&(d=
c.shift());d&&("fx"===b&&c.unshift("inprogress"),d.call(a,function(){h.dequeue(a,b)}));c.length||(h.removeData(a,b+"queue",!0),e(a,b,"queue"))}});h.fn.extend({queue:function(a,c){"string"!==typeof a&&(c=a,a="fx");return c===b?h.queue(this[0],a):this.each(function(){var b=h.queue(this,a,c);"fx"===a&&"inprogress"!==b[0]&&h.dequeue(this,a)})},dequeue:function(a){return this.each(function(){h.dequeue(this,a)})},delay:function(a,b){a=h.fx?h.fx.speeds[a]||a:a;b=b||"fx";return this.queue(b,function(){var c=
this;setTimeout(function(){h.dequeue(c,b)},a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function d(){--k||e.resolveWith(f,[f])}"string"!==typeof a&&(a=b);a=a||"fx";for(var e=h.Deferred(),f=this,g=f.length,k=1,l=a+"defer",u=a+"queue",m=a+"mark",n;g--;)if(n=h.data(f[g],l,b,!0)||(h.data(f[g],u,b,!0)||h.data(f[g],m,b,!0))&&h.data(f[g],l,h._Deferred(),!0))k++,n.done(d);d();return e.promise()}});var U=/[\n\t\r]/g,Q=/\s+/,G=/\r/g,P=/^(?:button|input)$/i,W=/^(?:button|input|object|select|textarea)$/i,
L=/^a(?:rea)?$/i,Ca=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Ia=/\:|^on/,ba,va;h.fn.extend({attr:function(a,b){return h.access(this,a,b,!0,h.attr)},removeAttr:function(a){return this.each(function(){h.removeAttr(this,a)})},prop:function(a,b){return h.access(this,a,b,!0,h.prop)},removeProp:function(a){a=h.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,
c,d,e,f,g,k;if(h.isFunction(a))return this.each(function(b){h(this).addClass(a.call(this,b,this.className))});if(a&&"string"===typeof a)for(b=a.split(Q),c=0,d=this.length;c<d;c++)if(e=this[c],1===e.nodeType)if(e.className||1!==b.length){f=" "+e.className+" ";g=0;for(k=b.length;g<k;g++)~f.indexOf(" "+b[g]+" ")||(f+=b[g]+" ");e.className=h.trim(f)}else e.className=a;return this},removeClass:function(a){var c,d,e,f,g,k,l;if(h.isFunction(a))return this.each(function(b){h(this).removeClass(a.call(this,
b,this.className))});if(a&&"string"===typeof a||a===b)for(c=(a||"").split(Q),d=0,e=this.length;d<e;d++)if(f=this[d],1===f.nodeType&&f.className)if(a){g=(" "+f.className+" ").replace(U," ");k=0;for(l=c.length;k<l;k++)g=g.replace(" "+c[k]+" "," ");f.className=h.trim(g)}else f.className="";return this},toggleClass:function(a,b){var c=typeof a,d="boolean"===typeof b;return h.isFunction(a)?this.each(function(c){h(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===
c)for(var e,f=0,g=h(this),k=b,l=a.split(Q);e=l[f++];)k=d?k:!g.hasClass(e),g[k?"addClass":"removeClass"](e);else if("undefined"===c||"boolean"===c)this.className&&h._data(this,"__className__",this.className),this.className=this.className||!1===a?"":h._data(this,"__className__")||""})},hasClass:function(a){a=" "+a+" ";for(var b=0,c=this.length;b<c;b++)if(-1<(" "+this[b].className+" ").replace(U," ").indexOf(a))return!0;return!1},val:function(a){var c,d,e=this[0];if(!arguments.length){if(e){if((c=h.valHooks[e.nodeName.toLowerCase()]||
h.valHooks[e.type])&&"get"in c&&(d=c.get(e,"value"))!==b)return d;d=e.value;return"string"===typeof d?d.replace(G,""):null==d?"":d}return b}var f=h.isFunction(a);return this.each(function(d){var e=h(this);1===this.nodeType&&(d=f?a.call(this,d,e.val()):a,null==d?d="":"number"===typeof d?d+="":h.isArray(d)&&(d=h.map(d,function(a){return null==a?"":a+""})),c=h.valHooks[this.nodeName.toLowerCase()]||h.valHooks[this.type],c&&"set"in c&&c.set(this,d,"value")!==b||(this.value=d))})}});h.extend({valHooks:{option:{get:function(a){var b=
a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c=a.selectedIndex,d=[],e=a.options;a="select-one"===a.type;if(0>c)return null;for(var f=a?c:0,g=a?c+1:e.length;f<g;f++)if(b=e[f],!(!b.selected||(h.support.optDisabled?b.disabled:null!==b.getAttribute("disabled"))||b.parentNode.disabled&&h.nodeName(b.parentNode,"optgroup"))){b=h(b).val();if(a)return b;d.push(b)}return a&&!d.length&&e.length?h(e[c]).val():d},set:function(a,b){var c=h.makeArray(b);h(a).find("option").each(function(){this.selected=
0<=h.inArray(h(this).val(),c)});c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attrFix:{tabindex:"tabIndex"},attr:function(a,c,d,e){var f=a.nodeType;if(!a||3===f||8===f||2===f)return b;if(e&&c in h.attrFn)return h(a)[c](d);if(!("getAttribute"in a))return h.prop(a,c,d);var g,k;if(e=1!==f||!h.isXMLDoc(a))c=h.attrFix[c]||c,(k=h.attrHooks[c])||(Ca.test(c)?k=va:ba&&"className"!==c&&(h.nodeName(a,"form")||Ia.test(c))&&(k=ba));if(d!==
b){if(null===d)return h.removeAttr(a,c),b;if(k&&"set"in k&&e&&(g=k.set(a,d,c))!==b)return g;a.setAttribute(c,""+d);return d}if(k&&"get"in k&&e&&null!==(g=k.get(a,c)))return g;g=a.getAttribute(c);return null===g?b:g},removeAttr:function(a,b){var c;1===a.nodeType&&(b=h.attrFix[b]||b,h.support.getSetAttribute?a.removeAttribute(b):(h.attr(a,b,""),a.removeAttributeNode(a.getAttributeNode(b))),Ca.test(b)&&(c=h.propFix[b]||b)in a&&(a[c]=!1))},attrHooks:{type:{set:function(a,b){if(P.test(a.nodeName)&&a.parentNode)h.error("type property can't be changed");
else if(!h.support.radioValue&&"radio"===b&&h.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b);c&&(a.value=c);return b}}},tabIndex:{get:function(a){var c=a.getAttributeNode("tabIndex");return c&&c.specified?parseInt(c.value,10):W.test(a.nodeName)||L.test(a.nodeName)&&a.href?0:b}},value:{get:function(a,b){return ba&&h.nodeName(a,"button")?ba.get(a,b):b in a?a.value:null},set:function(a,b,c){if(ba&&h.nodeName(a,"button"))return ba.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly",
"for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e=a.nodeType;if(!a||3===e||8===e||2===e)return b;var f,g;1===e&&h.isXMLDoc(a)||(c=h.propFix[c]||c,g=h.propHooks[c]);return d!==b?g&&"set"in g&&(f=g.set(a,d,c))!==b?f:a[c]=d:g&&"get"in g&&(f=g.get(a,c))!==b?f:a[c]},propHooks:{}});va={get:function(a,c){return h.prop(a,
c)?c.toLowerCase():b},set:function(a,b,c){!1===b?h.removeAttr(a,c):(b=h.propFix[c]||c,b in a&&(a[b]=!0),a.setAttribute(c,c.toLowerCase()));return c}};h.support.getSetAttribute||(h.attrFix=h.propFix,ba=h.attrHooks.name=h.attrHooks.title=h.valHooks.button={get:function(a,c){var d;return(d=a.getAttributeNode(c))&&""!==d.nodeValue?d.nodeValue:b},set:function(a,b,c){if(a=a.getAttributeNode(c))return a.nodeValue=b}},h.each(["width","height"],function(a,b){h.attrHooks[b]=h.extend(h.attrHooks[b],{set:function(a,
c){if(""===c)return a.setAttribute(b,"auto"),c}})}));h.support.hrefNormalized||h.each(["href","src","width","height"],function(a,c){h.attrHooks[c]=h.extend(h.attrHooks[c],{get:function(a){a=a.getAttribute(c,2);return null===a?b:a}})});h.support.style||(h.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}});h.support.optSelected||(h.propHooks.selected=h.extend(h.propHooks.selected,{get:function(a){if(a=a.parentNode)a.selectedIndex,
a.parentNode&&a.parentNode.selectedIndex}}));h.support.checkOn||h.each(["radio","checkbox"],function(){h.valHooks[this]={get:function(a){return null===a.getAttribute("value")?"on":a.value}}});h.each(["radio","checkbox"],function(){h.valHooks[this]=h.extend(h.valHooks[this],{set:function(a,b){if(h.isArray(b))return a.checked=0<=h.inArray(h(a).val(),b)}})});var Da=/\.(.*)$/,ga=/^(?:textarea|input|select)$/i,Ua=/\./g,Va=/ /g,ja=/[^\w\s.|`]/g,Ja=function(a){return a.replace(ja,"\\$&")};h.event={add:function(a,
c,d,e){if(3!==a.nodeType&&8!==a.nodeType){if(!1===d)d=f;else if(!d)return;var g,k;d.handler&&(g=d,d=g.handler);d.guid||(d.guid=h.guid++);if(k=h._data(a)){var l=k.events,u=k.handle;l||(k.events=l={});u||(k.handle=u=function(a){return"undefined"===typeof h||a&&h.event.triggered===a.type?b:h.event.handle.apply(u.elem,arguments)});u.elem=a;c=c.split(" ");for(var m,n=0,E;m=c[n++];){k=g?h.extend({},g):{handler:d,data:e};-1<m.indexOf(".")?(E=m.split("."),m=E.shift(),k.namespace=E.slice(0).sort().join(".")):
(E=[],k.namespace="");k.type=m;k.guid||(k.guid=d.guid);var p=l[m],H=h.event.special[m]||{};p||(p=l[m]=[],H.setup&&!1!==H.setup.call(a,e,E,u)||(a.addEventListener?a.addEventListener(m,u,!1):a.attachEvent&&a.attachEvent("on"+m,u)));H.add&&(H.add.call(a,k),k.handler.guid||(k.handler.guid=d.guid));p.push(k);h.event.global[m]=!0}a=null}}},global:{},remove:function(a,c,d,e){if(3!==a.nodeType&&8!==a.nodeType){!1===d&&(d=f);var g,k,l=0,u,m,n,E,p,H,x=h.hasData(a)&&h._data(a),q=x&&x.events;if(x&&q)if(c&&c.type&&
(d=c.handler,c=c.type),!c||"string"===typeof c&&"."===c.charAt(0))for(g in c=c||"",q)h.event.remove(a,g+c);else{for(c=c.split(" ");g=c[l++];)if(E=g,u=0>g.indexOf("."),m=[],u||(m=g.split("."),g=m.shift(),n=new RegExp("(^|\\.)"+h.map(m.slice(0).sort(),Ja).join("\\.(?:.*\\.)?")+"(\\.|$)")),p=q[g])if(d){E=h.event.special[g]||{};for(k=e||0;k<p.length;k++)if(H=p[k],d.guid===H.guid){if(u||n.test(H.namespace))null==e&&p.splice(k--,1),E.remove&&E.remove.call(a,H);if(null!=e)break}if(0===p.length||null!=e&&
1===p.length)E.teardown&&!1!==E.teardown.call(a,m)||h.removeEvent(a,g,x.handle),delete q[g]}else for(k=0;k<p.length;k++)if(H=p[k],u||n.test(H.namespace))h.event.remove(a,E,H.handler,k),p.splice(k--,1);if(h.isEmptyObject(q)){if(c=x.handle)c.elem=null;delete x.events;delete x.handle;h.isEmptyObject(x)&&h.removeData(a,b,!0)}}}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,f){var g=c.type||c,k=[],l;0<=g.indexOf("!")&&(g=g.slice(0,-1),l=!0);0<=g.indexOf(".")&&(k=g.split("."),
g=k.shift(),k.sort());if(e&&!h.event.customEvent[g]||h.event.global[g]){c="object"===typeof c?c[h.expando]?c:new h.Event(g,c):new h.Event(g);c.type=g;c.exclusive=l;c.namespace=k.join(".");c.namespace_re=new RegExp("(^|\\.)"+k.join("\\.(?:.*\\.)?")+"(\\.|$)");if(f||!e)c.preventDefault(),c.stopPropagation();if(!e)h.each(h.cache,function(){var a=this[h.expando];a&&a.events&&a.events[g]&&h.event.trigger(c,d,a.handle.elem)});else if(3!==e.nodeType&&8!==e.nodeType){c.result=b;c.target=e;d=null!=d?h.makeArray(d):
[];d.unshift(c);k=e;f=0>g.indexOf(":")?"on"+g:"";do l=h._data(k,"handle"),c.currentTarget=k,l&&l.apply(k,d),f&&h.acceptData(k)&&k[f]&&!1===k[f].apply(k,d)&&(c.result=!1,c.preventDefault()),k=k.parentNode||k.ownerDocument||k===c.target.ownerDocument&&a;while(k&&!c.isPropagationStopped());if(!c.isDefaultPrevented()){var u,k=h.event.special[g]||{};if(!(k._default&&!1!==k._default.call(e.ownerDocument,c)||"click"===g&&h.nodeName(e,"a"))&&h.acceptData(e)){try{f&&e[g]&&((u=e[f])&&(e[f]=null),h.event.triggered=
g,e[g]())}catch(m){}u&&(e[f]=u);h.event.triggered=b}}return c.result}}},handle:function(c){c=h.event.fix(c||a.event);var d=((h._data(this,"events")||{})[c.type]||[]).slice(0),e=!c.exclusive&&!c.namespace,f=Array.prototype.slice.call(arguments,0);f[0]=c;c.currentTarget=this;for(var g=0,k=d.length;g<k;g++){var l=d[g];if(e||c.namespace_re.test(l.namespace))if(c.handler=l.handler,c.data=l.data,c.handleObj=l,l=l.handler.apply(this,f),l!==b&&(c.result=l,!1===l&&(c.preventDefault(),c.stopPropagation())),
c.isImmediatePropagationStopped())break}return c.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(a){if(a[h.expando])return a;var c=a;a=h.Event(c);for(var d=this.props.length,e;d;)e=this.props[--d],
a[e]=c[e];a.target||(a.target=a.srcElement||y);3===a.target.nodeType&&(a.target=a.target.parentNode);!a.relatedTarget&&a.fromElement&&(a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement);null==a.pageX&&null!=a.clientX&&(d=a.target.ownerDocument||y,c=d.documentElement,d=d.body,a.pageX=a.clientX+(c&&c.scrollLeft||d&&d.scrollLeft||0)-(c&&c.clientLeft||d&&d.clientLeft||0),a.pageY=a.clientY+(c&&c.scrollTop||d&&d.scrollTop||0)-(c&&c.clientTop||d&&d.clientTop||0));null!=a.which||null==a.charCode&&
null==a.keyCode||(a.which=null!=a.charCode?a.charCode:a.keyCode);!a.metaKey&&a.ctrlKey&&(a.metaKey=a.ctrlKey);a.which||a.button===b||(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0);return a},guid:1E8,proxy:h.proxy,special:{ready:{setup:h.bindReady,teardown:h.noop},live:{add:function(a){h.event.add(this,m(a.origType,a.selector),h.extend({},a,{handler:l,guid:a.handler.guid}))},remove:function(a){h.event.remove(this,m(a.origType,a.selector),a)}},beforeunload:{setup:function(a,b,c){h.isWindow(this)&&
(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}}};h.removeEvent=y.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)};h.Event=function(a,b){if(!this.preventDefault)return new h.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||!1===a.returnValue||a.getPreventDefault&&a.getPreventDefault()?g:f):this.type=
a;b&&h.extend(this,b);this.timeStamp=h.now();this[h.expando]=!0};h.Event.prototype={preventDefault:function(){this.isDefaultPrevented=g;var a=this.originalEvent;a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=g;var a=this.originalEvent;a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=g;this.stopPropagation()},isDefaultPrevented:f,isPropagationStopped:f,
isImmediatePropagationStopped:f};var la=function(a){var b=a.relatedTarget,c=!1,d=a.type;a.type=a.data;b!==this&&(b&&(c=h.contains(this,b)),c||(h.event.handle.apply(this,arguments),a.type=d))},Na=function(a){a.type=a.data;h.event.handle.apply(this,arguments)};h.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){h.event.special[a]={setup:function(c){h.event.add(this,b,c&&c.selector?Na:la,a)},teardown:function(a){h.event.remove(this,b,a&&a.selector?Na:la)}}});h.support.submitBubbles||
(h.event.special.submit={setup:function(a,b){if(h.nodeName(this,"form"))return!1;h.event.add(this,"click.specialSubmit",function(a){var b=a.target,c=b.type;"submit"!==c&&"image"!==c||!h(b).closest("form").length||k("submit",this,arguments)});h.event.add(this,"keypress.specialSubmit",function(a){var b=a.target,c=b.type;"text"!==c&&"password"!==c||!h(b).closest("form").length||13!==a.keyCode||k("submit",this,arguments)})},teardown:function(a){h.event.remove(this,".specialSubmit")}});if(!h.support.changeBubbles){var ma,
Oa=function(a){var b=a.type,c=a.value;"radio"===b||"checkbox"===b?c=a.checked:"select-multiple"===b?c=-1<a.selectedIndex?h.map(a.options,function(a){return a.selected}).join("-"):"":h.nodeName(a,"select")&&(c=a.selectedIndex);return c},xa=function(a,c){var d=a.target,e,f;ga.test(d.nodeName)&&!d.readOnly&&(e=h._data(d,"_change_data"),f=Oa(d),"focusout"===a.type&&"radio"===d.type||h._data(d,"_change_data",f),e===b||f===e||null==e&&!f||(a.type="change",a.liveFired=b,h.event.trigger(a,c,d)))};h.event.special.change=
{filters:{focusout:xa,beforedeactivate:xa,click:function(a){var b=a.target,c=h.nodeName(b,"input")?b.type:"";("radio"===c||"checkbox"===c||h.nodeName(b,"select"))&&xa.call(this,a)},keydown:function(a){var b=a.target,c=h.nodeName(b,"input")?b.type:"";(13===a.keyCode&&!h.nodeName(b,"textarea")||32===a.keyCode&&("checkbox"===c||"radio"===c)||"select-multiple"===c)&&xa.call(this,a)},beforeactivate:function(a){a=a.target;h._data(a,"_change_data",Oa(a))}},setup:function(a,b){if("file"===this.type)return!1;
for(var c in ma)h.event.add(this,c+".specialChange",ma[c]);return ga.test(this.nodeName)},teardown:function(a){h.event.remove(this,".specialChange");return ga.test(this.nodeName)}};ma=h.event.special.change.filters;ma.focus=ma.beforeactivate}h.support.focusinBubbles||h.each({focus:"focusin",blur:"focusout"},function(a,b){function c(a){var d=h.event.fix(a);d.type=b;d.originalEvent={};h.event.trigger(d,null,d.target);d.isDefaultPrevented()&&a.preventDefault()}var d=0;h.event.special[b]={setup:function(){0===
d++&&y.addEventListener(a,c,!0)},teardown:function(){0===--d&&y.removeEventListener(a,c,!0)}}});h.each(["bind","one"],function(a,c){h.fn[c]=function(a,d,e){var f;if("object"===typeof a){for(var g in a)this[c](g,d,a[g],e);return this}if(2===arguments.length||!1===d)e=d,d=b;"one"===c?(f=function(a){h(this).unbind(a,f);return e.apply(this,arguments)},f.guid=e.guid||h.guid++):f=e;if("unload"===a&&"one"!==c)this.one(a,d,e);else{g=0;for(var k=this.length;g<k;g++)h.event.add(this[g],a,f,d)}return this}});
h.fn.extend({unbind:function(a,b){if("object"!==typeof a||a.preventDefault)for(var c=0,d=this.length;c<d;c++)h.event.remove(this[c],a,b);else for(c in a)this.unbind(c,a[c]);return this},delegate:function(a,b,c,d){return this.live(b,c,d,a)},undelegate:function(a,b,c){return 0===arguments.length?this.unbind("live"):this.die(b,null,c,a)},trigger:function(a,b){return this.each(function(){h.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return h.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=
arguments,c=a.guid||h.guid++,d=0,e=function(c){var e=(h.data(this,"lastToggle"+a.guid)||0)%d;h.data(this,"lastToggle"+a.guid,e+1);c.preventDefault();return b[e].apply(this,arguments)||!1};for(e.guid=c;d<b.length;)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});var Ea={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};h.each(["live","die"],function(a,c){h.fn[c]=function(a,d,e,g){var k=0,D,l,u=g||this.selector,n=g?this:
h(this.context);if("object"===typeof a&&!a.preventDefault){for(D in a)n[c](D,d,a[D],u);return this}if("die"===c&&!a&&g&&"."===g.charAt(0))return n.unbind(g),this;if(!1===d||h.isFunction(d))e=d||f,d=b;for(a=(a||"").split(" ");null!=(g=a[k++]);)if(D=Da.exec(g),l="",D&&(l=D[0],g=g.replace(Da,"")),"hover"===g)a.push("mouseenter"+l,"mouseleave"+l);else if(D=g,Ea[g]?(a.push(Ea[g]+l),g+=l):g=(Ea[g]||g)+l,"live"===c){l=0;for(var E=n.length;l<E;l++)h.event.add(n[l],"live."+m(g,u),{data:d,selector:u,handler:e,
origType:g,origHandler:e,preType:D})}else n.unbind("live."+m(g,u),e);return this}});h.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),function(a,b){h.fn[b]=function(a,c){null==c&&(c=a,a=null);return 0<arguments.length?this.bind(b,a,c):this.trigger(b)};h.attrFn&&(h.attrFn[b]=!0)});(function(){function a(b,c,d,e,f,g){f=0;for(var h=e.length;f<h;f++){var k=
e[f];if(k){for(var l=!1,k=k[b];k;){if(k.sizcache===d){l=e[k.sizset];break}1!==k.nodeType||g||(k.sizcache=d,k.sizset=f);if(k.nodeName.toLowerCase()===c){l=k;break}k=k[b]}e[f]=l}}}function c(a,b,d,e,f,g){f=0;for(var h=e.length;f<h;f++){var k=e[f];if(k){for(var l=!1,k=k[a];k;){if(k.sizcache===d){l=e[k.sizset];break}if(1===k.nodeType)if(g||(k.sizcache=d,k.sizset=f),"string"!==typeof b){if(k===b){l=!0;break}}else if(0<m.filter(b,[k]).length){l=k;break}k=k[a]}e[f]=l}}}var d=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,
e=0,f=Object.prototype.toString,g=!1,k=!0,l=/\\/g,u=/\W/;[0,0].sort(function(){k=!1;return 0});var m=function(a,b,c,e){c=c||[];var g=b=b||y;if(1!==b.nodeType&&9!==b.nodeType)return[];if(!a||"string"!==typeof a)return c;var h,k,l,D,u,ha=!0,ea=m.isXML(b),p=[],H=a;do if(d.exec(""),h=d.exec(H))if(H=h[3],p.push(h[1]),h[2]){D=h[3];break}while(h);if(1<p.length&&E.exec(a))if(2===p.length&&n.relative[p[0]])k=r(p[0]+p[1],b);else for(k=n.relative[p[0]]?[b]:m(p.shift(),b);p.length;)a=p.shift(),n.relative[a]&&
(a+=p.shift()),k=r(a,k);else if(!e&&1<p.length&&9===b.nodeType&&!ea&&n.match.ID.test(p[0])&&!n.match.ID.test(p[p.length-1])&&(h=m.find(p.shift(),b,ea),b=h.expr?m.filter(h.expr,h.set)[0]:h.set[0]),b)for(h=e?{expr:p.pop(),set:x(e)}:m.find(p.pop(),1!==p.length||"~"!==p[0]&&"+"!==p[0]||!b.parentNode?b:b.parentNode,ea),k=h.expr?m.filter(h.expr,h.set):h.set,0<p.length?l=x(k):ha=!1;p.length;)h=u=p.pop(),n.relative[u]?h=p.pop():u="",null==h&&(h=b),n.relative[u](l,h,ea);else l=[];l||(l=k);l||m.error(u||a);
if("[object Array]"===f.call(l))if(ha)if(b&&1===b.nodeType)for(a=0;null!=l[a];a++)l[a]&&(!0===l[a]||1===l[a].nodeType&&m.contains(b,l[a]))&&c.push(k[a]);else for(a=0;null!=l[a];a++)l[a]&&1===l[a].nodeType&&c.push(k[a]);else c.push.apply(c,l);else x(l,c);D&&(m(D,g,c,e),m.uniqueSort(c));return c};m.uniqueSort=function(a){if(q&&(g=k,a.sort(q),g))for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1);return a};m.matches=function(a,b){return m(a,null,null,b)};m.matchesSelector=function(a,b){return 0<
m(b,null,null,[a]).length};m.find=function(a,b,c){var d;if(!a)return[];for(var e=0,f=n.order.length;e<f;e++){var g,h=n.order[e];if(g=n.leftMatch[h].exec(a)){var k=g[1];g.splice(1,1);if("\\"!==k.substr(k.length-1)&&(g[1]=(g[1]||"").replace(l,""),d=n.find[h](g,b,c),null!=d)){a=a.replace(n.match[h],"");break}}}d||(d="undefined"!==typeof b.getElementsByTagName?b.getElementsByTagName("*"):[]);return{set:d,expr:a}};m.filter=function(a,c,d,e){for(var f,g,h=a,k=[],l=c,D=c&&c[0]&&m.isXML(c[0]);a&&c.length;){for(var u in n.filter)if(null!=
(f=n.leftMatch[u].exec(a))&&f[2]){var ha,ea,p=n.filter[u];ea=f[1];g=!1;f.splice(1,1);if("\\"!==ea.substr(ea.length-1)){l===k&&(k=[]);if(n.preFilter[u])if(f=n.preFilter[u](f,l,d,k,e,D),!f)g=ha=!0;else if(!0===f)continue;if(f)for(var E=0;null!=(ea=l[E]);E++)if(ea){ha=p(ea,f,E,l);var X=e^!!ha;d&&null!=ha?X?g=!0:l[E]=!1:X&&(k.push(ea),g=!0)}if(ha!==b){d||(l=k);a=a.replace(n.match[u],"");if(!g)return[];break}}}if(a===h)if(null==g)m.error(a);else break;h=a}return l};m.error=function(a){throw Error("Syntax error, unrecognized expression: "+
a);};var n=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,
PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c="string"===typeof b,d=c&&!u.test(b),c=c&&!d;d&&(b=b.toLowerCase());for(var d=0,e=a.length,f;d<e;d++)if(f=a[d]){for(;(f=f.previousSibling)&&1!==f.nodeType;);a[d]=c||f&&f.nodeName.toLowerCase()===b?f||!1:f===b}c&&m.filter(b,
a,!0)},">":function(a,b){var c,d="string"===typeof b,e=0,f=a.length;if(d&&!u.test(b))for(b=b.toLowerCase();e<f;e++){if(c=a[e])c=c.parentNode,a[e]=c.nodeName.toLowerCase()===b?c:!1}else{for(;e<f;e++)(c=a[e])&&(a[e]=d?c.parentNode:c.parentNode===b);d&&m.filter(b,a,!0)}},"":function(b,d,f){var g,h=e++,k=c;"string"!==typeof d||u.test(d)||(g=d=d.toLowerCase(),k=a);k("parentNode",d,h,b,g,f)},"~":function(b,d,f){var g,h=e++,k=c;"string"!==typeof d||u.test(d)||(g=d=d.toLowerCase(),k=a);k("previousSibling",
d,h,b,g,f)}},find:{ID:function(a,b,c){if("undefined"!==typeof b.getElementById&&!c)return(a=b.getElementById(a[1]))&&a.parentNode?[a]:[]},NAME:function(a,b){if("undefined"!==typeof b.getElementsByName){for(var c=[],d=b.getElementsByName(a[1]),e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return 0===c.length?null:c}},TAG:function(a,b){if("undefined"!==typeof b.getElementsByTagName)return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(l,
"")+" ";if(f)return a;f=0;for(var g;null!=(g=b[f]);f++)g&&(e^(g.className&&0<=(" "+g.className+" ").replace(/[\t\n\r]/g," ").indexOf(a))?c||d.push(g):c&&(b[f]=!1));return!1},ID:function(a){return a[1].replace(l,"")},TAG:function(a,b){return a[1].replace(l,"").toLowerCase()},CHILD:function(a){if("nth"===a[1]){a[2]||m.error(a[0]);a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec("even"===a[2]&&"2n"||"odd"===a[2]&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-
0;a[3]=b[3]-0}else a[2]&&m.error(a[0]);a[0]=e++;return a},ATTR:function(a,b,c,d,e,f){b=a[1]=a[1].replace(l,"");!f&&n.attrMap[b]&&(a[1]=n.attrMap[b]);a[4]=(a[4]||a[5]||"").replace(l,"");"~="===a[2]&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(a,b,c,e,f){if("not"===a[1])if(1<(d.exec(a[3])||"").length||/^\w/.test(a[3]))a[3]=m(a[3],null,null,b);else return a=m.filter(a[3],b,c,1^f),c||e.push.apply(e,a),!1;else if(n.match.POS.test(a[0])||n.match.CHILD.test(a[0]))return!0;return a},POS:function(a){a.unshift(!0);
return a}},filters:{enabled:function(a){return!1===a.disabled&&"hidden"!==a.type},disabled:function(a){return!0===a.disabled},checked:function(a){return!0===a.checked},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return!0===a.selected},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return"input"===a.nodeName.toLowerCase()&&
"text"===c&&(b===c||null===b)},radio:function(a){return"input"===a.nodeName.toLowerCase()&&"radio"===a.type},checkbox:function(a){return"input"===a.nodeName.toLowerCase()&&"checkbox"===a.type},file:function(a){return"input"===a.nodeName.toLowerCase()&&"file"===a.type},password:function(a){return"input"===a.nodeName.toLowerCase()&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return("input"===b||"button"===b)&&"submit"===a.type},image:function(a){return"input"===a.nodeName.toLowerCase()&&
"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return("input"===b||"button"===b)&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return 0===b},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return 0===b%2},odd:function(a,b){return 1===
b%2},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=n.filters[e];if(f)return f(a,c,b,d);if("contains"===e)return 0<=(a.textContent||a.innerText||m.getText([a])||"").indexOf(b[3]);if("not"===e){b=b[3];c=0;for(d=b.length;c<d;c++)if(b[c]===a)return!1;return!0}m.error(e)},CHILD:function(a,b){var c=b[1],d=a;switch(c){case "only":case "first":for(;d=d.previousSibling;)if(1===
d.nodeType)return!1;if("first"===c)return!0;d=a;case "last":for(;d=d.nextSibling;)if(1===d.nodeType)return!1;return!0;case "nth":var c=b[2],e=b[3];if(1===c&&0===e)return!0;var f=b[0],g=a.parentNode;if(g&&(g.sizcache!==f||!a.nodeIndex)){for(var h=0,d=g.firstChild;d;d=d.nextSibling)1===d.nodeType&&(d.nodeIndex=++h);g.sizcache=f}d=a.nodeIndex-e;return 0===c?0===d:0===d%c&&0<=d/c}},ID:function(a,b){return 1===a.nodeType&&a.getAttribute("id")===b},TAG:function(a,b){return"*"===b&&1===a.nodeType||a.nodeName.toLowerCase()===
b},CLASS:function(a,b){return-1<(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)},ATTR:function(a,b){var c=b[1],c=n.attrHandle[c]?n.attrHandle[c](a):null!=a[c]?a[c]:a.getAttribute(c),d=c+"",e=b[2],f=b[4];return null==c?"!="===e:"="===e?d===f:"*="===e?0<=d.indexOf(f):"~="===e?0<=(" "+d+" ").indexOf(f):f?"!="===e?d!==f:"^="===e?0===d.indexOf(f):"$="===e?d.substr(d.length-f.length)===f:"|="===e?d===f||d.substr(0,f.length+1)===f+"-":!1:d&&!1!==c},POS:function(a,b,c,d){var e=n.setFilters[b[2]];
if(e)return e(a,c,b,d)}}},E=n.match.POS,p=function(a,b){return"\\"+(b-0+1)},H;for(H in n.match)n.match[H]=new RegExp(n.match[H].source+/(?![^\[]*\])(?![^\(]*\))/.source),n.leftMatch[H]=new RegExp(/(^(?:.|\r|\n)*?)/.source+n.match[H].source.replace(/\\(\d+)/g,p));var x=function(a,b){a=Array.prototype.slice.call(a,0);return b?(b.push.apply(b,a),b):a};try{Array.prototype.slice.call(y.documentElement.childNodes,0)[0].nodeType}catch(hb){x=function(a,b){var c=0,d=b||[];if("[object Array]"===f.call(a))Array.prototype.push.apply(d,
a);else if("number"===typeof a.length)for(var e=a.length;c<e;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var q,w;y.documentElement.compareDocumentPosition?q=function(a,b){return a===b?(g=!0,0):a.compareDocumentPosition&&b.compareDocumentPosition?a.compareDocumentPosition(b)&4?-1:1:a.compareDocumentPosition?-1:1}:(q=function(a,b){if(a===b)return g=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[];c=a.parentNode;d=b.parentNode;var h=c;if(c===d)return w(a,
b);if(!c)return-1;if(!d)return 1;for(;h;)e.unshift(h),h=h.parentNode;for(h=d;h;)f.unshift(h),h=h.parentNode;c=e.length;d=f.length;for(h=0;h<c&&h<d;h++)if(e[h]!==f[h])return w(e[h],f[h]);return h===c?w(a,f[h],-1):w(e[h],b,1)},w=function(a,b,c){if(a===b)return c;for(a=a.nextSibling;a;){if(a===b)return-1;a=a.nextSibling}return 1});m.getText=function(a){for(var b="",c,d=0;a[d];d++)c=a[d],3===c.nodeType||4===c.nodeType?b+=c.nodeValue:8!==c.nodeType&&(b+=m.getText(c.childNodes));return b};(function(){var a=
y.createElement("div"),c="script"+(new Date).getTime(),d=y.documentElement;a.innerHTML="<a name='"+c+"'/>";d.insertBefore(a,d.firstChild);y.getElementById(c)&&(n.find.ID=function(a,c,d){if("undefined"!==typeof c.getElementById&&!d)return(c=c.getElementById(a[1]))?c.id===a[1]||"undefined"!==typeof c.getAttributeNode&&c.getAttributeNode("id").nodeValue===a[1]?[c]:b:[]},n.filter.ID=function(a,b){var c="undefined"!==typeof a.getAttributeNode&&a.getAttributeNode("id");return 1===a.nodeType&&c&&c.nodeValue===
b});d.removeChild(a);d=a=null})();(function(){var a=y.createElement("div");a.appendChild(y.createComment(""));0<a.getElementsByTagName("*").length&&(n.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if("*"===a[1]){for(var d=[],e=0;c[e];e++)1===c[e].nodeType&&d.push(c[e]);c=d}return c});a.innerHTML="<a href='#'></a>";a.firstChild&&"undefined"!==typeof a.firstChild.getAttribute&&"#"!==a.firstChild.getAttribute("href")&&(n.attrHandle.href=function(a){return a.getAttribute("href",2)});a=null})();
y.querySelectorAll&&function(){var a=m,b=y.createElement("div");b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||0!==b.querySelectorAll(".TEST").length){m=function(b,c,d,e){c=c||y;if(!e&&!m.isXML(c)){var f=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(f&&(1===c.nodeType||9===c.nodeType)){if(f[1])return x(c.getElementsByTagName(b),d);if(f[2]&&n.find.CLASS&&c.getElementsByClassName)return x(c.getElementsByClassName(f[2]),d)}if(9===c.nodeType){if("body"===b&&c.body)return x([c.body],d);if(f&&
f[3]){var g=c.getElementById(f[3]);if(g&&g.parentNode){if(g.id===f[3])return x([g],d)}else return x([],d)}try{return x(c.querySelectorAll(b),d)}catch(h){}}else if(1===c.nodeType&&"object"!==c.nodeName.toLowerCase()){var f=c,k=(g=c.getAttribute("id"))||"__sizzle__",l=c.parentNode,D=/^\s*[+~]/.test(b);g?k=k.replace(/'/g,"\\$&"):c.setAttribute("id",k);D&&l&&(c=c.parentNode);try{if(!D||l)return x(c.querySelectorAll("[id='"+k+"'] "+b),d)}catch(h){}finally{g||f.removeAttribute("id")}}}return a(b,c,d,e)};
for(var c in a)m[c]=a[c];b=null}}();(function(){var a=y.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var c=!b.call(y.createElement("div"),"div"),d=!1;try{b.call(y.documentElement,"[test!='']:sizzle")}catch(e){d=!0}m.matchesSelector=function(a,e){e=e.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a))try{if(d||!n.match.PSEUDO.test(e)&&!/!=/.test(e)){var f=b.call(a,e);if(f||!c||a.document&&11!==a.document.nodeType)return f}}catch(g){}return 0<
m(e,null,null,[a]).length}}})();(function(){var a=y.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";a.getElementsByClassName&&0!==a.getElementsByClassName("e").length&&(a.lastChild.className="e",1!==a.getElementsByClassName("e").length&&(n.order.splice(1,0,"CLASS"),n.find.CLASS=function(a,b,c){if("undefined"!==typeof b.getElementsByClassName&&!c)return b.getElementsByClassName(a[1])},a=null))})();m.contains=y.documentElement.contains?function(a,b){return a!==
b&&(a.contains?a.contains(b):!0)}:y.documentElement.compareDocumentPosition?function(a,b){return!!(a.compareDocumentPosition(b)&16)}:function(){return!1};m.isXML=function(a){return(a=(a?a.ownerDocument||a:0).documentElement)?"HTML"!==a.nodeName:!1};var r=function(a,b){for(var c,d=[],e="",f=b.nodeType?[b]:b;c=n.match.PSEUDO.exec(a);)e+=c[0],a=a.replace(n.match.PSEUDO,"");a=n.relative[a]?a+"*":a;c=0;for(var g=f.length;c<g;c++)m(a,f[c],d);return m.filter(e,d)};h.find=m;h.expr=m.selectors;h.expr[":"]=
h.expr.filters;h.unique=m.uniqueSort;h.text=m.getText;h.isXMLDoc=m.isXML;h.contains=m.contains})();var $a=/Until$/,ab=/^(?:parents|prevUntil|prevAll)/,ya=/,/,Wa=/^.[^:#\[\.,]*$/,bb=Array.prototype.slice,qa=h.expr.match.POS,cb={children:!0,contents:!0,next:!0,prev:!0};h.fn.extend({find:function(a){var b=this,c,d;if("string"!==typeof a)return h(a).filter(function(){c=0;for(d=b.length;c<d;c++)if(h.contains(b[c],this))return!0});var e=this.pushStack("","find",a),f,g,k;c=0;for(d=this.length;c<d;c++)if(f=
e.length,h.find(a,this[c],e),0<c)for(g=f;g<e.length;g++)for(k=0;k<f;k++)if(e[k]===e[g]){e.splice(g--,1);break}return e},has:function(a){var b=h(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(h.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(r(this,a,!1),"not",a)},filter:function(a){return this.pushStack(r(this,a,!0),"filter",a)},is:function(a){return!!a&&("string"===typeof a?0<h.filter(a,this).length:0<this.filter(a).length)},closest:function(a,b){var c=[],
d,e,f=this[0];if(h.isArray(a)){var g,k={},l=1;if(f&&a.length){d=0;for(e=a.length;d<e;d++)g=a[d],k[g]||(k[g]=qa.test(g)?h(g,b||this.context):g);for(;f&&f.ownerDocument&&f!==b;){for(g in k)d=k[g],(d.jquery?-1<d.index(f):h(f).is(d))&&c.push({selector:g,elem:f,level:l});f=f.parentNode;l++}}return c}g=qa.test(a)||"string"!==typeof a?h(a,b||this.context):0;d=0;for(e=this.length;d<e;d++)for(f=this[d];f;)if(g?-1<g.index(f):h.find.matchesSelector(f,a)){c.push(f);break}else if(f=f.parentNode,!f||!f.ownerDocument||
f===b||11===f.nodeType)break;c=1<c.length?h.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){return a&&"string"!==typeof a?h.inArray(a.jquery?a[0]:a,this):h.inArray(this[0],a?h(a):this.parent().children())},add:function(a,b){var c="string"===typeof a?h(a,b):h.makeArray(a&&a.nodeType?[a]:a),d=h.merge(this.get(),c);return this.pushStack(n(c[0])||n(d[0])?d:h.unique(d))},andSelf:function(){return this.add(this.prevObject)}});h.each({parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?
a:null},parents:function(a){return h.dir(a,"parentNode")},parentsUntil:function(a,b,c){return h.dir(a,"parentNode",c)},next:function(a){return h.nth(a,2,"nextSibling")},prev:function(a){return h.nth(a,2,"previousSibling")},nextAll:function(a){return h.dir(a,"nextSibling")},prevAll:function(a){return h.dir(a,"previousSibling")},nextUntil:function(a,b,c){return h.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return h.dir(a,"previousSibling",c)},siblings:function(a){return h.sibling(a.parentNode.firstChild,
a)},children:function(a){return h.sibling(a.firstChild)},contents:function(a){return h.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:h.makeArray(a.childNodes)}},function(a,b){h.fn[a]=function(c,d){var e=h.map(this,b,c),f=bb.call(arguments);$a.test(a)||(d=c);d&&"string"===typeof d&&(e=h.filter(d,e));e=1<this.length&&!cb[a]?h.unique(e):e;(1<this.length||ya.test(d))&&ab.test(a)&&(e=e.reverse());return this.pushStack(e,a,f.join(","))}});h.extend({filter:function(a,b,c){c&&(a=":not("+
a+")");return 1===b.length?h.find.matchesSelector(b[0],a)?[b[0]]:[]:h.find.matches(a,b)},dir:function(a,c,d){var e=[];for(a=a[c];a&&9!==a.nodeType&&(d===b||1!==a.nodeType||!h(a).is(d));)1===a.nodeType&&e.push(a),a=a[c];return e},nth:function(a,b,c,d){b=b||1;for(d=0;a&&(1!==a.nodeType||++d!==b);a=a[c]);return a},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});var Fa=/ jQuery\d+="(?:\d+|null)"/g,S=/^\s+/,Z=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,
Ga=/<([\w:]+)/,Pa=/<tbody/i,Qa=/<|&#?\w+;/,Ra=/<(?:script|object|embed|option|style)/i,Sa=/checked\s*(?:[^=]|=\s*.checked.)/i,u=/\/(java|ecma)script/i,H=/^\s*<!(?:\[CDATA\[|\-\-)/,E={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,
"",""]};E.optgroup=E.option;E.tbody=E.tfoot=E.colgroup=E.caption=E.thead;E.th=E.td;h.support.htmlSerialize||(E._default=[1,"div<div>","</div>"]);h.fn.extend({text:function(a){return h.isFunction(a)?this.each(function(b){var c=h(this);c.text(a.call(this,b,c.text()))}):"object"!==typeof a&&a!==b?this.empty().append((this[0]&&this[0].ownerDocument||y).createTextNode(a)):h.text(this)},wrapAll:function(a){if(h.isFunction(a))return this.each(function(b){h(this).wrapAll(a.call(this,b))});if(this[0]){var b=
h(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]);b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return h.isFunction(a)?this.each(function(b){h(this).wrapInner(a.call(this,b))}):this.each(function(){var b=h(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){return this.each(function(){h(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){h.nodeName(this,
"body")||h(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){1===this.nodeType&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){1===this.nodeType&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=h(arguments[0]);a.push.apply(a,this.toArray());return this.pushStack(a,
"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,h(arguments[0]).toArray());return a}},remove:function(a,b){for(var c=0,d;null!=(d=this[c]);c++)if(!a||h.filter(a,[d]).length)b||1!==d.nodeType||(h.cleanData(d.getElementsByTagName("*")),h.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},
empty:function(){for(var a=0,b;null!=(b=this[a]);a++)for(1===b.nodeType&&h.cleanData(b.getElementsByTagName("*"));b.firstChild;)b.removeChild(b.firstChild);return this},clone:function(a,b){a=null==a?!1:a;b=null==b?a:b;return this.map(function(){return h.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&1===this[0].nodeType?this[0].innerHTML.replace(Fa,""):null;if("string"!==typeof a||Ra.test(a)||!h.support.leadingWhitespace&&S.test(a)||E[(Ga.exec(a)||["",""])[1].toLowerCase()])h.isFunction(a)?
this.each(function(b){var c=h(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);else{a=a.replace(Z,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)1===this[c].nodeType&&(h.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(h.isFunction(a))return this.each(function(b){var c=h(this),d=c.html();c.replaceWith(a.call(this,b,d))});"string"!==typeof a&&(a=h(a).detach());
return this.each(function(){var b=this.nextSibling,c=this.parentNode;h(this).remove();b?h(b).before(a):h(c).append(a)})}return this.length?this.pushStack(h(h.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,f,g,k=a[0],l=[];if(!h.support.checkClone&&3===arguments.length&&"string"===typeof k&&Sa.test(k))return this.each(function(){h(this).domManip(a,c,d,!0)});if(h.isFunction(k))return this.each(function(e){var f=h(this);a[0]=k.call(this,
e,c?f.html():b);f.domManip(a,c,d)});if(this[0]){e=k&&k.parentNode;e=h.support.parentNode&&e&&11===e.nodeType&&e.childNodes.length===this.length?{fragment:e}:h.buildFragment(a,this,l);g=e.fragment;if(f=1===g.childNodes.length?g=g.firstChild:g.firstChild){c=c&&h.nodeName(f,"tr");for(var u=0,m=this.length,n=m-1;u<m;u++)d.call(c?p(this[u],f):this[u],e.cacheable||1<m&&u<n?h.clone(g,!0,!0):g)}l.length&&h.each(l,x)}return this}});h.buildFragment=function(a,b,c){var d,e,f,g;b&&b[0]&&(g=b[0].ownerDocument||
b[0]);g.createDocumentFragment||(g=y);1===a.length&&"string"===typeof a[0]&&512>a[0].length&&g===y&&"<"===a[0].charAt(0)&&!Ra.test(a[0])&&(h.support.checkClone||!Sa.test(a[0]))&&(e=!0,(f=h.fragments[a[0]])&&1!==f&&(d=f));d||(d=g.createDocumentFragment(),h.clean(a,g,d,c));e&&(h.fragments[a[0]]=f?d:1);return{fragment:d,cacheable:e}};h.fragments={};h.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){h.fn[a]=function(c){var d=
[];c=h(c);var e=1===this.length&&this[0].parentNode;if(e&&11===e.nodeType&&1===e.childNodes.length&&1===c.length)return c[b](this[0]),this;for(var e=0,f=c.length;e<f;e++){var g=(0<e?this.clone(!0):this).get();h(c[e])[b](g);d=d.concat(g)}return this.pushStack(d,a,c.selector)}});h.extend({clone:function(a,b,c){var d=a.cloneNode(!0),e,f,g;if(!(h.support.noCloneEvent&&h.support.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||h.isXMLDoc(a)))for(t(a,d),e=v(a),f=v(d),g=0;e[g];++g)t(e[g],f[g]);if(b&&(q(a,
d),c))for(e=v(a),f=v(d),g=0;e[g];++g)q(e[g],f[g]);return d},clean:function(a,b,c,d){b=b||y;"undefined"===typeof b.createElement&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||y);for(var e=[],f,g=0,k;null!=(k=a[g]);g++)if("number"===typeof k&&(k+=""),k){if("string"===typeof k)if(Qa.test(k)){k=k.replace(Z,"<$1></$2>");f=(Ga.exec(k)||["",""])[1].toLowerCase();var l=E[f]||E._default,m=l[0],n=b.createElement("div");for(n.innerHTML=l[1]+k+l[2];m--;)n=n.lastChild;if(!h.support.tbody)for(m=Pa.test(k),l="table"!==
f||m?"<table>"!==l[1]||m?[]:n.childNodes:n.firstChild&&n.firstChild.childNodes,f=l.length-1;0<=f;--f)h.nodeName(l[f],"tbody")&&!l[f].childNodes.length&&l[f].parentNode.removeChild(l[f]);!h.support.leadingWhitespace&&S.test(k)&&n.insertBefore(b.createTextNode(S.exec(k)[0]),n.firstChild);k=n.childNodes}else k=b.createTextNode(k);var p;if(!h.support.appendChecked)if(k[0]&&"number"===typeof(p=k.length))for(f=0;f<p;f++)w(k[f]);else w(k);k.nodeType?e.push(k):e=h.merge(e,k)}if(c)for(a=function(a){return!a.type||
u.test(a.type)},g=0;e[g];g++)!d||!h.nodeName(e[g],"script")||e[g].type&&"text/javascript"!==e[g].type.toLowerCase()?(1===e[g].nodeType&&(b=h.grep(e[g].getElementsByTagName("script"),a),e.splice.apply(e,[g+1,0].concat(b))),c.appendChild(e[g])):d.push(e[g].parentNode?e[g].parentNode.removeChild(e[g]):e[g]);return e},cleanData:function(a){for(var b,c,d=h.cache,e=h.expando,f=h.event.special,g=h.support.deleteExpando,k=0,l;null!=(l=a[k]);k++)if(!l.nodeName||!h.noData[l.nodeName.toLowerCase()])if(c=l[h.expando]){if((b=
d[c]&&d[c][e])&&b.events){for(var u in b.events)f[u]?h.event.remove(l,u):h.removeEvent(l,u,b.handle);b.handle&&(b.handle.elem=null)}g?delete l[h.expando]:l.removeAttribute&&l.removeAttribute(h.expando);delete d[c]}}});var fa=/alpha\([^)]*\)/i,N=/opacity=([^)]*)/,ra=/([A-Z]|^ms)/g,ia=/^-?\d+(?:px)?$/i,na=/^-?\d/,za=/^[+\-]=/,sa=/[^+\-\.\de]+/g,Ha={position:"absolute",visibility:"hidden",display:"block"},pa=["Left","Right"],Xa=["Top","Bottom"],Y,ib,jb;h.fn.css=function(a,c){return 2===arguments.length&&
c===b?this:h.access(this,a,c,!0,function(a,c,d){return d!==b?h.style(a,c,d):h.css(a,c)})};h.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Y(a,"opacity","opacity");return""===c?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":h.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var f,g=h.camelCase(c),k=a.style,l=h.cssHooks[g];
c=h.cssProps[g]||g;if(d!==b){if(e=typeof d,!("number"===e&&isNaN(d)||null==d||("string"===e&&za.test(d)&&(d=+d.replace(sa,"")+parseFloat(h.css(a,c)),e="number"),"number"!==e||h.cssNumber[g]||(d+="px"),l&&"set"in l&&(d=l.set(a,d))===b)))try{k[c]=d}catch(u){}}else return l&&"get"in l&&(f=l.get(a,!1,e))!==b?f:k[c]}},css:function(a,c,d){var e,f;c=h.camelCase(c);f=h.cssHooks[c];c=h.cssProps[c]||c;"cssFloat"===c&&(c="float");if(f&&"get"in f&&(e=f.get(a,!0,d))!==b)return e;if(Y)return Y(a,c)},swap:function(a,
b,c){var d={},e;for(e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]}});h.curCSS=h.css;h.each(["height","width"],function(a,b){h.cssHooks[b]={get:function(a,c,d){var e;if(c){if(0!==a.offsetWidth)return A(a,b,d);h.swap(a,Ha,function(){e=A(a,b,d)});return e}},set:function(a,b){if(ia.test(b)){if(b=parseFloat(b),0<=b)return b+"px"}else return b}}});h.support.opacity||(h.cssHooks.opacity={get:function(a,b){return N.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||
"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle;c.zoom=1;var e=h.isNaN(b)?"":"alpha(opacity="+100*b+")",d=d&&d.filter||c.filter||"";c.filter=fa.test(d)?d.replace(fa,e):d+" "+e}});h(function(){h.support.reliableMarginRight||(h.cssHooks.marginRight={get:function(a,b){var c;h.swap(a,{display:"inline-block"},function(){c=b?Y(a,"margin-right","marginRight"):a.style.marginRight});return c}})});y.defaultView&&y.defaultView.getComputedStyle&&(ib=function(a,c){var d,
e;c=c.replace(ra,"-$1").toLowerCase();if(!(e=a.ownerDocument.defaultView))return b;if(e=e.getComputedStyle(a,null))d=e.getPropertyValue(c),""!==d||h.contains(a.ownerDocument.documentElement,a)||(d=h.style(a,c));return d});y.documentElement.currentStyle&&(jb=function(a,b){var c,d=a.currentStyle&&a.currentStyle[b],e=a.runtimeStyle&&a.runtimeStyle[b],f=a.style;!ia.test(d)&&na.test(d)&&(c=f.left,e&&(a.runtimeStyle.left=a.currentStyle.left),f.left="fontSize"===b?"1em":d||0,d=f.pixelLeft+"px",f.left=c,
e&&(a.runtimeStyle.left=e));return""===d?"auto":d});Y=ib||jb;h.expr&&h.expr.filters&&(h.expr.filters.hidden=function(a){var b=a.offsetHeight;return 0===a.offsetWidth&&0===b||!h.support.reliableHiddenOffsets&&"none"===(a.style.display||h.css(a,"display"))},h.expr.filters.visible=function(a){return!h.expr.filters.hidden(a)});var tb=/%20/g,qb=/\[\]$/,kb=/\r?\n/g,ub=/#.*$/,vb=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,wb=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,
xb=/^(?:GET|HEAD)$/,yb=/^\/\//,lb=/\?/,zb=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Ab=/^(?:select|textarea)/i,fb=/\s+/,Bb=/([?&])_=[^&]*/,mb=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,nb=h.fn.load,Ya={},ob={},ta,ua;try{ta=T.href}catch(D){ta=y.createElement("a"),ta.href="",ta=ta.href}ua=mb.exec(ta.toLowerCase())||[];h.fn.extend({load:function(a,c,d){if("string"!==typeof a&&nb)return nb.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(0<=e){var f=a.slice(e,
a.length);a=a.slice(0,e)}e="GET";c&&(h.isFunction(c)?(d=c,c=b):"object"===typeof c&&(c=h.param(c,h.ajaxSettings.traditional),e="POST"));var g=this;h.ajax({url:a,type:e,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText;a.isResolved()&&(a.done(function(a){c=a}),g.html(f?h("<div>").append(c.replace(zb,"")).find(f):c));d&&g.each(d,[c,b,a])}});return this},serialize:function(){return h.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?
h.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||Ab.test(this.nodeName)||wb.test(this.type))}).map(function(a,b){var c=h(this).val();return null==c?null:h.isArray(c)?h.map(c,function(a,c){return{name:b.name,value:a.replace(kb,"\r\n")}}):{name:b.name,value:c.replace(kb,"\r\n")}}).get()}});h.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){h.fn[b]=function(a){return this.bind(b,a)}});h.each(["get","post"],
function(a,c){h[c]=function(a,d,e,f){h.isFunction(d)&&(f=f||e,e=d,d=b);return h.ajax({type:c,url:a,data:d,success:e,dataType:f})}});h.extend({getScript:function(a,c){return h.get(a,b,c,"script")},getJSON:function(a,b,c){return h.get(a,b,c,"json")},ajaxSetup:function(a,b){b?h.extend(!0,a,h.ajaxSettings,b):(b=a,a=h.extend(!0,h.ajaxSettings,b));for(var c in{context:1,url:1})c in b?a[c]=b[c]:c in h.ajaxSettings&&(a[c]=h.ajaxSettings[c]);return a},ajaxSettings:{url:ta,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|widget):$/.test(ua[1]),
global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":h.parseJSON,"text xml":h.parseXML}},ajaxPrefilter:B(Ya),ajaxTransport:B(ob),ajax:function(a,c){function d(a,c,n,p){if(2!==r){r=
2;q&&clearTimeout(q);x=b;E=p||"";A.readyState=a?4:0;var H,D,w;if(n){p=e;var ha=A,t=p.contents,N=p.dataTypes,X=p.responseFields,v,B,y,ra;for(B in X)B in n&&(ha[X[B]]=n[B]);for(;"*"===N[0];)N.shift(),v===b&&(v=p.mimeType||ha.getResponseHeader("content-type"));if(v)for(B in t)if(t[B]&&t[B].test(v)){N.unshift(B);break}if(N[0]in n)y=N[0];else{for(B in n){if(!N[0]||p.converters[B+" "+N[0]]){y=B;break}ra||(ra=B)}y=y||ra}y?(y!==N[0]&&N.unshift(y),n=n[y]):n=void 0}else n=b;if(200<=a&&300>a||304===a){if(e.ifModified){if(v=
A.getResponseHeader("Last-Modified"))h.lastModified[m]=v;if(v=A.getResponseHeader("Etag"))h.etag[m]=v}if(304===a)c="notmodified",H=!0;else try{v=e;v.dataFilter&&(n=v.dataFilter(n,v.dataType));var z=v.dataTypes;B={};var ia,za,F=z.length,C,na=z[0],Y,Ha,K,pa,sa;for(ia=1;ia<F;ia++){if(1===ia)for(za in v.converters)"string"===typeof za&&(B[za.toLowerCase()]=v.converters[za]);Y=na;na=z[ia];if("*"===na)na=Y;else if("*"!==Y&&Y!==na){Ha=Y+" "+na;K=B[Ha]||B["* "+na];if(!K)for(pa in sa=b,B)if(C=pa.split(" "),
C[0]===Y||"*"===C[0])if(sa=B[C[1]+" "+na]){pa=B[pa];!0===pa?K=sa:!0===sa&&(K=pa);break}K||sa||h.error("No conversion from "+Ha.replace(" "," to "));!0!==K&&(n=K?K(n):sa(pa(n)))}}D=n;c="success";H=!0}catch(Xa){c="parsererror",w=Xa}}else if(w=c,!c||a)c="error",0>a&&(a=0);A.status=a;A.statusText=c;H?k.resolveWith(f,[D,c,A]):k.rejectWith(f,[A,c,w]);A.statusCode(u);u=b;fa&&g.trigger("ajax"+(H?"Success":"Error"),[A,e,H?D:w]);l.resolveWith(f,[A,c]);fa&&(g.trigger("ajaxComplete",[A,e]),--h.active||h.event.trigger("ajaxStop"))}}
"object"===typeof a&&(c=a,a=b);c=c||{};var e=h.ajaxSetup({},c),f=e.context||e,g=f!==e&&(f.nodeType||f instanceof h)?h(f):h.event,k=h.Deferred(),l=h._Deferred(),u=e.statusCode||{},m,n={},p={},E,H,x,q,w,r=0,fa,t,A={readyState:0,setRequestHeader:function(a,b){if(!r){var c=a.toLowerCase();a=p[c]=p[c]||a;n[a]=b}return this},getAllResponseHeaders:function(){return 2===r?E:null},getResponseHeader:function(a){var c;if(2===r){if(!H)for(H={};c=vb.exec(E);)H[c[1].toLowerCase()]=c[2];c=H[a.toLowerCase()]}return c===
b?null:c},overrideMimeType:function(a){r||(e.mimeType=a);return this},abort:function(a){a=a||"abort";x&&x.abort(a);d(0,a);return this}};k.promise(A);A.success=A.done;A.error=A.fail;A.complete=l.done;A.statusCode=function(a){if(a){var b;if(2>r)for(b in a)u[b]=[u[b],a[b]];else b=a[A.status],A.then(b,b)}return this};e.url=((a||e.url)+"").replace(ub,"").replace(yb,ua[1]+"//");e.dataTypes=h.trim(e.dataType||"*").toLowerCase().split(fb);null==e.crossDomain&&(w=mb.exec(e.url.toLowerCase()),e.crossDomain=
!(!w||w[1]==ua[1]&&w[2]==ua[2]&&(w[3]||("http:"===w[1]?80:443))==(ua[3]||("http:"===ua[1]?80:443))));e.data&&e.processData&&"string"!==typeof e.data&&(e.data=h.param(e.data,e.traditional));F(Ya,e,c,A);if(2===r)return!1;fa=e.global;e.type=e.type.toUpperCase();e.hasContent=!xb.test(e.type);fa&&0===h.active++&&h.event.trigger("ajaxStart");if(!e.hasContent&&(e.data&&(e.url+=(lb.test(e.url)?"&":"?")+e.data),m=e.url,!1===e.cache)){w=h.now();var N=e.url.replace(Bb,"$1_="+w);e.url=N+(N===e.url?(lb.test(e.url)?
"&":"?")+"_="+w:"")}(e.data&&e.hasContent&&!1!==e.contentType||c.contentType)&&A.setRequestHeader("Content-Type",e.contentType);e.ifModified&&(m=m||e.url,h.lastModified[m]&&A.setRequestHeader("If-Modified-Since",h.lastModified[m]),h.etag[m]&&A.setRequestHeader("If-None-Match",h.etag[m]));A.setRequestHeader("Accept",e.dataTypes[0]&&e.accepts[e.dataTypes[0]]?e.accepts[e.dataTypes[0]]+("*"!==e.dataTypes[0]?", */*; q=0.01":""):e.accepts["*"]);for(t in e.headers)A.setRequestHeader(t,e.headers[t]);if(e.beforeSend&&
(!1===e.beforeSend.call(f,A,e)||2===r))return A.abort(),!1;for(t in{success:1,error:1,complete:1})A[t](e[t]);if(x=F(ob,e,c,A)){A.readyState=1;fa&&g.trigger("ajaxSend",[A,e]);e.async&&0<e.timeout&&(q=setTimeout(function(){A.abort("timeout")},e.timeout));try{r=1,x.send(n,d)}catch(v){2>status?d(-1,v):h.error(v)}}else d(-1,"No Transport");return A},param:function(a,c){var d=[],e=function(a,b){b=h.isFunction(b)?b():b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=h.ajaxSettings.traditional);
if(h.isArray(a)||a.jquery&&!h.isPlainObject(a))h.each(a,function(){e(this.name,this.value)});else for(var f in a)C(f,a[f],c,e);return d.join("&").replace(tb,"+")}});h.extend({active:0,lastModified:{},etag:{}});var Cb=h.now(),Ta=/(\=)\?(&|$)|\?\?/i;h.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return h.expando+"_"+Cb++}});h.ajaxPrefilter("json jsonp",function(b,c,d){c="application/x-www-form-urlencoded"===b.contentType&&"string"===typeof b.data;if("jsonp"===b.dataTypes[0]||!1!==b.jsonp&&(Ta.test(b.url)||
c&&Ta.test(b.data))){var e,f=b.jsonpCallback=h.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,g=a[f],k=b.url,l=b.data,u="$1"+f+"$2";!1!==b.jsonp&&(k=k.replace(Ta,u),b.url===k&&(c&&(l=l.replace(Ta,u)),b.data===l&&(k+=(/\?/.test(k)?"&":"?")+b.jsonp+"="+f)));b.url=k;b.data=l;a[f]=function(a){e=[a]};d.always(function(){a[f]=g;if(e&&h.isFunction(g))a[f](e[0])});b.converters["script json"]=function(){e||h.error(f+" was not called");return e[0]};b.dataTypes[0]="json";return"script"}});h.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){h.globalEval(a);return a}}});h.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1);a.crossDomain&&(a.type="GET",a.global=!1)});h.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=y.head||y.getElementsByTagName("head")[0]||y.documentElement;return{send:function(e,f){c=y.createElement("script");c.async="async";a.scriptCharset&&(c.charset=a.scriptCharset);c.src=a.url;c.onload=c.onreadystatechange=function(a,
e){if(e||!c.readyState||/loaded|complete/.test(c.readyState))c.onload=c.onreadystatechange=null,d&&c.parentNode&&d.removeChild(c),c=b,e||f(200,"success")};d.insertBefore(c,d.firstChild)},abort:function(){if(c)c.onload(0,1)}}}});var db=a.ActiveXObject?function(){for(var a in Aa)Aa[a](0,1)}:!1,Db=0,Aa;h.ajaxSettings.xhr=a.ActiveXObject?function(){var b;if(!(b=!this.isLocal&&K()))a:{try{b=new a.ActiveXObject("Microsoft.XMLHTTP");break a}catch(c){}b=void 0}return b}:K;(function(a){h.extend(h.support,
{ajax:!!a,cors:!!a&&"withCredentials"in a})})(h.ajaxSettings.xhr());h.support.ajax&&h.ajaxTransport(function(c){if(!c.crossDomain||h.support.cors){var d;return{send:function(e,f){var g=c.xhr(),k,l;c.username?g.open(c.type,c.url,c.async,c.username,c.password):g.open(c.type,c.url,c.async);if(c.xhrFields)for(l in c.xhrFields)g[l]=c.xhrFields[l];c.mimeType&&g.overrideMimeType&&g.overrideMimeType(c.mimeType);c.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");try{for(l in e)g.setRequestHeader(l,
e[l])}catch(u){}g.send(c.hasContent&&c.data||null);d=function(a,e){var l,u,m,n,p;try{if(d&&(e||4===g.readyState))if(d=b,k&&(g.onreadystatechange=h.noop,db&&delete Aa[k]),e)4!==g.readyState&&g.abort();else{l=g.status;m=g.getAllResponseHeaders();n={};(p=g.responseXML)&&p.documentElement&&(n.xml=p);n.text=g.responseText;try{u=g.statusText}catch(E){u=""}l||!c.isLocal||c.crossDomain?1223===l&&(l=204):l=n.text?200:404}}catch(E){e||f(-1,E)}n&&f(l,u,n,m)};c.async&&4!==g.readyState?(k=++Db,db&&(Aa||(Aa={},
h(a).unload(db)),Aa[k]=d),g.onreadystatechange=d):d()},abort:function(){d&&d(0,1)}}}});var Za={},ka,wa,Eb=/^(?:toggle|show|hide)$/,Fb=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,Ba,gb=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],Ka,eb=a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame;h.fn.extend({show:function(a,b,c){if(a||0===a)return this.animate(O("show",3),a,b,c);c=0;
for(var d=this.length;c<d;c++)a=this[c],a.style&&(b=a.style.display,h._data(a,"olddisplay")||"none"!==b||(b=a.style.display=""),""===b&&"none"===h.css(a,"display")&&h._data(a,"olddisplay",oa(a.nodeName)));for(c=0;c<d;c++)if(a=this[c],a.style&&(b=a.style.display,""===b||"none"===b))a.style.display=h._data(a,"olddisplay")||"";return this},hide:function(a,b,c){if(a||0===a)return this.animate(O("hide",3),a,b,c);a=0;for(b=this.length;a<b;a++)this[a].style&&(c=h.css(this[a],"display"),"none"===c||h._data(this[a],
"olddisplay")||h._data(this[a],"olddisplay",c));for(a=0;a<b;a++)this[a].style&&(this[a].style.display="none");return this},_toggle:h.fn.toggle,toggle:function(a,b,c){var d="boolean"===typeof a;h.isFunction(a)&&h.isFunction(b)?this._toggle.apply(this,arguments):null==a||d?this.each(function(){var b=d?a:h(this).is(":hidden");h(this)[b?"show":"hide"]()}):this.animate(O("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},
a,c,d)},animate:function(a,b,c,d){var e=h.speed(b,c,d);if(h.isEmptyObject(a))return this.each(e.complete,[!1]);a=h.extend({},a);return this[!1===e.queue?"each":"queue"](function(){!1===e.queue&&h._mark(this);var b=h.extend({},e),c=1===this.nodeType,d=c&&h(this).is(":hidden"),f,g,k,l,u;b.animatedProperties={};for(k in a){f=h.camelCase(k);k!==f&&(a[f]=a[k],delete a[k]);g=a[f];h.isArray(g)?(b.animatedProperties[f]=g[1],g=a[f]=g[0]):b.animatedProperties[f]=b.specialEasing&&b.specialEasing[f]||b.easing||
"swing";if("hide"===g&&d||"show"===g&&!d)return b.complete.call(this);!c||"height"!==f&&"width"!==f||(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],"inline"===h.css(this,"display")&&"none"===h.css(this,"float")&&(h.support.inlineBlockNeedsLayout?(g=oa(this.nodeName),"inline"===g?this.style.display="inline-block":(this.style.display="inline",this.style.zoom=1)):this.style.display="inline-block"))}null!=b.overflow&&(this.style.overflow="hidden");for(k in a)if(c=new h.fx(this,
b,k),g=a[k],Eb.test(g))c["toggle"===g?d?"show":"hide":g]();else f=Fb.exec(g),l=c.cur(),f?(g=parseFloat(f[2]),u=f[3]||(h.cssNumber[k]?"":"px"),"px"!==u&&(h.style(this,k,(g||1)+u),l*=(g||1)/c.cur(),h.style(this,k,l+u)),f[1]&&(g=("-="===f[1]?-1:1)*g+l),c.custom(l,g,u)):c.custom(l,g,"");return!0})},stop:function(a,b){a&&this.queue([]);this.each(function(){var a=h.timers,c=a.length;for(b||h._unmark(!0,this);c--;)if(a[c].elem===this){if(b)a[c](!0);a.splice(c,1)}});b||this.dequeue();return this}});h.each({slideDown:O("show",
1),slideUp:O("hide",1),slideToggle:O("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){h.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}});h.extend({speed:function(a,b,c){var d=a&&"object"===typeof a?h.extend({},a):{complete:c||!c&&b||h.isFunction(a)&&a,duration:a,easing:c&&b||b&&!h.isFunction(b)&&b};d.duration=h.fx.off?0:"number"===typeof d.duration?d.duration:d.duration in h.fx.speeds?h.fx.speeds[d.duration]:h.fx.speeds._default;d.old=
d.complete;d.complete=function(a){h.isFunction(d.old)&&d.old.call(this);!1!==d.queue?h.dequeue(this):!1!==a&&h._unmark(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b;this.elem=a;this.prop=c;b.orig=b.orig||{}}});h.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this);(h.fx.step[this.prop]||h.fx.step._default)(this)},cur:function(){if(null!=
this.elem[this.prop]&&(!this.elem.style||null==this.elem.style[this.prop]))return this.elem[this.prop];var a,b=h.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?b&&"auto"!==b?b:0:a},custom:function(a,b,c){function d(a){return e.step(a)}var e=this,f=h.fx,g;this.startTime=Ka||aa();this.start=a;this.end=b;this.unit=c||this.unit||(h.cssNumber[this.prop]?"":"px");this.now=this.start;this.pos=this.state=0;d.elem=this.elem;d()&&h.timers.push(d)&&!Ba&&(eb?(Ba=!0,g=function(){Ba&&(eb(g),f.tick())},
eb(g)):Ba=setInterval(f.tick,f.interval))},show:function(){this.options.orig[this.prop]=h.style(this.elem,this.prop);this.options.show=!0;this.custom("width"===this.prop||"height"===this.prop?1:0,this.cur());h(this.elem).show()},hide:function(){this.options.orig[this.prop]=h.style(this.elem,this.prop);this.options.hide=!0;this.custom(this.cur(),0)},step:function(a){var b=Ka||aa(),c=!0,d=this.elem,e=this.options,f;if(a||b>=e.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();
e.animatedProperties[this.prop]=!0;for(f in e.animatedProperties)!0!==e.animatedProperties[f]&&(c=!1);if(c){null==e.overflow||h.support.shrinkWrapBlocks||h.each(["","X","Y"],function(a,b){d.style["overflow"+b]=e.overflow[a]});e.hide&&h(d).hide();if(e.hide||e.show)for(var g in e.animatedProperties)h.style(d,g,e.orig[g]);e.complete.call(d)}return!1}Infinity==e.duration?this.now=b:(a=b-this.startTime,this.state=a/e.duration,this.pos=h.easing[e.animatedProperties[this.prop]](this.state,a,0,1,e.duration),
this.now=this.start+(this.end-this.start)*this.pos);this.update();return!0}};h.extend(h.fx,{tick:function(){for(var a=h.timers,b=0;b<a.length;++b)a[b]()||a.splice(b--,1);a.length||h.fx.stop()},interval:13,stop:function(){clearInterval(Ba);Ba=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){h.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&null!=a.elem.style[a.prop]?a.elem.style[a.prop]=("width"===a.prop||"height"===a.prop?Math.max(0,a.now):a.now)+a.unit:a.elem[a.prop]=
a.now}}});h.expr&&h.expr.filters&&(h.expr.filters.animated=function(a){return h.grep(h.timers,function(b){return a===b.elem}).length});var Gb=/^t(?:able|d|h)$/i,pb=/^(?:body|html)$/i;h.fn.offset="getBoundingClientRect"in y.documentElement?function(a){var b=this[0],c;if(a)return this.each(function(b){h.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return h.offset.bodyOffset(b);try{c=Siesta.Util.Role.Dom.meta.methods.getBoundingClientRect.value(b)}catch(d){}var e=
b.ownerDocument,f=e.documentElement;if(!c||!h.contains(f,b))return c?{top:c.top,left:c.left}:{top:0,left:0};b=e.body;e=da(e);return{top:Math.floor(c.top)+(e.pageYOffset||h.support.boxModel&&f.scrollTop||b.scrollTop)-(f.clientTop||b.clientTop||0),left:Math.floor(c.left)+(e.pageXOffset||h.support.boxModel&&f.scrollLeft||b.scrollLeft)-(f.clientLeft||b.clientLeft||0)}}:function(a){var b=this[0];if(a)return this.each(function(b){h.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===
b.ownerDocument.body)return h.offset.bodyOffset(b);h.offset.initialize();var c,d=b.offsetParent,e=b.ownerDocument,f=e.documentElement,g=e.body;c=(e=e.defaultView)?e.getComputedStyle(b,null):b.currentStyle;for(var k=b.offsetTop,l=b.offsetLeft;(b=b.parentNode)&&b!==g&&b!==f&&(!h.offset.supportsFixedPosition||"fixed"!==c.position);)c=e?e.getComputedStyle(b,null):b.currentStyle,k-=b.scrollTop,l-=b.scrollLeft,b===d&&(k+=b.offsetTop,l+=b.offsetLeft,!h.offset.doesNotAddBorder||h.offset.doesAddBorderForTableAndCells&&
Gb.test(b.nodeName)||(k+=parseFloat(c.borderTopWidth)||0,l+=parseFloat(c.borderLeftWidth)||0),d=b.offsetParent),h.offset.subtractsBorderForOverflowNotVisible&&"visible"!==c.overflow&&(k+=parseFloat(c.borderTopWidth)||0,l+=parseFloat(c.borderLeftWidth)||0);if("relative"===c.position||"static"===c.position)k+=g.offsetTop,l+=g.offsetLeft;h.offset.supportsFixedPosition&&"fixed"===c.position&&(k+=Math.max(f.scrollTop,g.scrollTop),l+=Math.max(f.scrollLeft,g.scrollLeft));return{top:k,left:l}};h.offset={initialize:function(){var a=
y.body,b=y.createElement("div"),c,d,e,f=parseFloat(h.css(a,"marginTop"))||0;h.extend(b.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"});b.innerHTML="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";a.insertBefore(b,
a.firstChild);c=b.firstChild;d=c.firstChild;e=c.nextSibling.firstChild.firstChild;this.doesNotAddBorder=5!==d.offsetTop;this.doesAddBorderForTableAndCells=5===e.offsetTop;d.style.position="fixed";d.style.top="20px";this.supportsFixedPosition=20===d.offsetTop||15===d.offsetTop;d.style.position=d.style.top="";c.style.overflow="hidden";c.style.position="relative";this.subtractsBorderForOverflowNotVisible=-5===d.offsetTop;this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==f;a.removeChild(b);h.offset.initialize=
h.noop},bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;h.offset.initialize();h.offset.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(h.css(a,"marginTop"))||0,c+=parseFloat(h.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=h.css(a,"position");"static"===d&&(a.style.position="relative");var e=h(a),f=e.offset(),g=h.css(a,"top"),k=h.css(a,"left"),l={};("absolute"===d||"fixed"===d)&&-1<h.inArray("auto",[g,k])?(k=e.position(),d=k.top,k=k.left):(d=parseFloat(g)||
0,k=parseFloat(k)||0);h.isFunction(b)&&(b=b.call(a,c,f));null!=b.top&&(l.top=b.top-f.top+d);null!=b.left&&(l.left=b.left-f.left+k);"using"in b?b.using.call(a,l):e.css(l)}};h.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=pb.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(h.css(a,"marginTop"))||0;c.left-=parseFloat(h.css(a,"marginLeft"))||0;d.top+=parseFloat(h.css(b[0],"borderTopWidth"))||0;d.left+=parseFloat(h.css(b[0],
"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||y.body;a&&!pb.test(a.nodeName)&&"static"===h.css(a,"position");)a=a.offsetParent;return a})}});h.each(["Left","Top"],function(a,c){var d="scroll"+c;h.fn[d]=function(c){var e,f;return c===b?(e=this[0],e?(f=da(e))?f[a?"pageYOffset":"pageXOffset"]||h.support.boxModel&&f.document.documentElement[d]||f.document.body[d]:e[d]:null):this.each(function(){(f=da(this))?
f.scrollTo(a?h(f).scrollLeft():c,a?c:h(f).scrollTop()):this[d]=c})}});h.each(["Height","Width"],function(a,c){var d=c.toLowerCase();h.fn["inner"+c]=function(){var a=this[0];return a&&a.style?parseFloat(h.css(a,d,"padding")):null};h.fn["outer"+c]=function(a){var b=this[0];return b&&b.style?parseFloat(h.css(b,d,a?"margin":"border")):null};h.fn[d]=function(a){var e=this[0];if(!e)return null==a?null:this;if(h.isFunction(a))return this.each(function(b){var c=h(this);c[d](a.call(this,b,c[d]()))});if(h.isWindow(e)){var f=
e.document.documentElement["client"+c];return"CSS1Compat"===e.document.compatMode&&f||e.document.body["client"+c]||f}return 9===e.nodeType?Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]):a===b?(e=h.css(e,d),f=parseFloat(e),h.isNaN(f)?e:f):this.css(d,"string"===typeof a?a:a+"px")}});a.jQuery=a.$=h;a.jQuery.siesta=!0;a.$.rebindWindowContext=function(b){a=b;y=b.document;rootjQuery=$(y);return function(a,b){return new h.fn.init(a,
b,rootjQuery)}}})(window);jQuery.fn.center=function(){this.css("position","absolute");this.css("top",Math.max(0,($(window).height()-this.outerHeight())/2+$(window).scrollTop())+"px");this.css("left",Math.max(0,($(window).width()-this.outerWidth())/2+$(window).scrollLeft())+"px");return this};
(function(a){function b(a,b,c,d){var e,f,g,k,l,m=b&&b.ownerDocument,n=b?b.nodeType:9;c=c||[];if("string"!==typeof a||!a||1!==n&&9!==n&&11!==n)return c;if(!d&&((b?b.ownerDocument||b:P)!==h&&T(b),b=b||h,M)){if(11!==n&&(k=cb.exec(a)))if(e=k[1])if(9===n)if(f=b.getElementById(e)){if(f.id===e)return c.push(f),c}else return c;else{if(m&&(f=m.getElementById(e))&&Q(b,f)&&f.id===e)return c.push(f),c}else{if(k[2])return ja.apply(c,b.getElementsByTagName(a)),c;if((e=k[3])&&F.getElementsByClassName&&b.getElementsByClassName)return ja.apply(c,
b.getElementsByClassName(e)),c}if(!(!F.qsa||ba[a+" "]||I&&I.test(a))){if(1!==n)m=b,l=a;else if("object"!==b.nodeName.toLowerCase()){(g=b.getAttribute("id"))?g=g.replace(Ga,Pa):b.setAttribute("id",g=G);f=ca(a);for(e=f.length;e--;)f[e]="#"+g+" "+q(f[e]);l=f.join(",");m=Fa.test(a)&&r(b.parentNode)||b}if(l)try{if(!bowser.msie&&!bowser.msedge||!/:nth-of-type\(\d/i.test(l))return ja.apply(c,m.querySelectorAll(l)),c}catch(p){}finally{g===G&&b.removeAttribute("id")}}}return oa(a.replace(ma,"$1"),b,c,d)}function c(){function a(c,
d){b.push(c+" ")>C.cacheLength&&delete a[b.shift()];return a[c+" "]=d}var b=[];return a}function d(a){a[G]=!0;return a}function e(a){var b=h.createElement("fieldset");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b)}}function f(a,b){for(var c=a.split("|"),d=c.length;d--;)C.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function k(a){return function(b){return"input"===
b.nodeName.toLowerCase()&&b.type===a}}function l(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function m(a){return function(b){return"form"in b?b.parentNode&&!1===b.disabled?"label"in b?"label"in b.parentNode?b.parentNode.disabled===a:b.disabled===a:b.isDisabled===a||b.isDisabled!==!a&&Ra(b)===a:b.disabled===a:"label"in b?b.disabled===a:!1}}function n(a){return d(function(b){b=+b;return d(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=
f[g]]&&(c[e]=!(d[e]=c[e]))})})}function r(a){return a&&"undefined"!==typeof a.getElementsByTagName&&a}function p(){}function q(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function t(a,b,c){var d=b.dir,e=b.next,f=e||d,g=c&&"parentNode"===f,k=L++;return b.first?function(b,c,e){for(;b=b[d];)if(1===b.nodeType||g)return a(b,c,e);return!1}:function(b,c,h){var l,m,n=[W,k];if(h)for(;b=b[d];){if((1===b.nodeType||g)&&a(b,c,h))return!0}else for(;b=b[d];)if(1===b.nodeType||g)if(m=b[G]||(b[G]=
{}),m=m[b.uniqueID]||(m[b.uniqueID]={}),e&&e===b.nodeName.toLowerCase())b=b[d]||b;else{if((l=m[f])&&l[0]===W&&l[1]===k)return n[2]=l[2];m[f]=n;if(n[2]=a(b,c,h))return!0}return!1}}function v(a){return 1<a.length?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function z(a,b,c,d,e){for(var f,g=[],k=0,h=a.length,l=null!=b;k<h;k++)if(f=a[k])if(!c||c(f,d,e))g.push(f),l&&b.push(k);return g}function w(a,c,e,f,g,k){f&&!f[G]&&(f=w(f));g&&!g[G]&&(g=w(g,k));return d(function(d,
k,h,l){var m,n,p=[],x=[],w=k.length,q;if(!(q=d)){q=c||"*";for(var r=h.nodeType?[h]:h,A=[],t=0,v=r.length;t<v;t++)b(q,r[t],A);q=A}q=!a||!d&&c?q:z(q,p,a,h,l);r=e?g||(d?a:w||f)?[]:k:q;e&&e(q,r,h,l);if(f)for(m=z(r,x),f(m,[],h,l),h=m.length;h--;)if(n=m[h])r[x[h]]=!(q[x[h]]=n);if(d){if(g||a){if(g){m=[];for(h=r.length;h--;)(n=r[h])&&m.push(q[h]=n);g(null,r=[],m,l)}for(h=r.length;h--;)(n=r[h])&&-1<(m=g?la(d,n):p[h])&&(d[m]=!(k[m]=n))}}else r=z(r===k?r.splice(w,r.length):r),g?g(null,k,r,l):ja.apply(k,r)})}
function x(a){var b,c,d,e=a.length,f=C.relative[a[0].type];c=f||C.relative[" "];for(var g=f?1:0,k=t(function(a){return a===b},c,!0),h=t(function(a){return-1<la(b,a)},c,!0),l=[function(a,c,d){a=!f&&(d||c!==da)||((b=c).nodeType?k(a,c,d):h(a,c,d));b=null;return a}];g<e;g++)if(c=C.relative[a[g].type])l=[t(v(l),c)];else{c=C.filter[a[g].type].apply(null,a[g].matches);if(c[G]){for(d=++g;d<e&&!C.relative[a[d].type];d++);return w(1<g&&v(l),1<g&&q(a.slice(0,g-1).concat({value:" "===a[g-2].type?"*":""})).replace(ma,
"$1"),c,g<d&&x(a.slice(g,d)),d<e&&x(a=a.slice(d)),d<e&&q(a))}l.push(c)}return v(l)}function A(a,c){var e=0<c.length,f=0<a.length,g=function(d,g,k,l,m){var n,p,x,q=0,w="0",r=d&&[],A=[],t=da,v=d||f&&C.find.TAG("*",m),B=W+=null==t?1:Math.random()||.1,y=v.length;for(m&&(da=g===h||g||m);w!==y&&null!=(n=v[w]);w++){if(f&&n){p=0;g||n.ownerDocument===h||(T(n),k=!M);for(;x=a[p++];)if(x(n,g||h,k)){l.push(n);break}m&&(W=B)}e&&((n=!x&&n)&&q--,d&&r.push(n))}q+=w;if(e&&w!==q){for(p=0;x=c[p++];)x(r,A,g,k);if(d){if(0<
q)for(;w--;)r[w]||A[w]||(A[w]=Ua.call(l));A=z(A)}ja.apply(l,A);m&&!d&&0<A.length&&1<q+c.length&&b.uniqueSort(l)}m&&(W=B,da=t);return r};return e?d(g):g}var B,F,C,K,aa,ca,O,oa,da,y,V,T,h,J,M,I,R,U,Q,G="sizzle"+1*new Date,P=a.document,W=0,L=0,Ca=c(),Ia=c(),ba=c(),va=function(a,b){a===b&&(V=!0);return 0},Da={}.hasOwnProperty,ga=[],Ua=ga.pop,Va=ga.push,ja=ga.push,Ja=ga.slice,la=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},Na=RegExp("[\\x20\\t\\r\\n\\f]+","g"),ma=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$",
"g"),Oa=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,xa=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,Ea=RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*?)[\\x20\\t\\r\\n\\f]*\\]","g"),$a=/:((?:\\.|[\w-]|[^\x00-\xa0])+)(?:\((('((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)")|((?:\\.|[^\\()[\]]|\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^\x00-\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^\x00-\xa0])+))|)[\x20\t\r\n\f]*\])*)|.*)\)|)/,ab=/^(?:\\.|[\w-]|[^\x00-\xa0])+$/,
ya={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:/^((?:\\.|[\w-]|[^\x00-\xa0])+|[*])/,ATTR:/^\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^\x00-\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^\x00-\xa0])+))|)[\x20\t\r\n\f]*\]/,PSEUDO:/^:((?:\\.|[\w-]|[^\x00-\xa0])+)(?:\((('((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)")|((?:\\.|[^\\()[\]]|\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^\x00-\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^\x00-\xa0])+))|)[\x20\t\r\n\f]*\])*)|.*)\)|)/,
CHILD:/^:(only|first|last|nth|nth-last)-(child|of-type)(?:\([\x20\t\r\n\f]*(even|odd|(([+-]|)(\d*)n|)[\x20\t\r\n\f]*(?:([+-]|)[\x20\t\r\n\f]*(\d+)|))[\x20\t\r\n\f]*\)|)/i,bool:/^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$/i,needsContext:/^[\x20\t\r\n\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i},Wa=/^(?:input|select|textarea|button)$/i,bb=/^h\d$/i,qa=
/^[^{]+\{\s*\[native \w/,cb=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Fa=/[+~]/,S=RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)","ig"),Z=function(a,b,c){a="0x"+b-65536;return a!==a||c?b:0>a?String.fromCharCode(a+65536):String.fromCharCode(a>>10|55296,a&1023|56320)},Ga=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Pa=function(a,b){return b?"\x00"===a?"\ufffd":a.slice(0,-1)+"\\"+a.charCodeAt(a.length-1).toString(16)+" ":"\\"+a},Qa=function(){T()},Ra=t(function(a){return!0===
a.disabled&&"fieldset"===a.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{ja.apply(ga=Ja.call(P.childNodes),P.childNodes),ga[P.childNodes.length].nodeType}catch(u){ja={apply:ga.length?function(a,b){Va.apply(a,Ja.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}F=b.support={};aa=b.isXML=function(a){return(a=a&&(a.ownerDocument||a).documentElement)?"HTML"!==a.nodeName:!1};T=b.setDocument=function(a){var b;a=a?a.ownerDocument||a:P;if(a===h||9!==a.nodeType||
!a.documentElement)return h;h=a;J=h.documentElement;M=!aa(h);P!==h&&(b=h.defaultView)&&b.top!==b&&(b.addEventListener?b.addEventListener("unload",Qa,!1):b.attachEvent&&b.attachEvent("onunload",Qa));F.attributes=e(function(a){a.className="i";return!a.getAttribute("className")});F.getElementsByTagName=e(function(a){a.appendChild(h.createComment(""));return!a.getElementsByTagName("*").length});F.getElementsByClassName=qa.test(h.getElementsByClassName);F.getById=e(function(a){J.appendChild(a).id=G;return!h.getElementsByName||
!h.getElementsByName(G).length});F.getById?(C.filter.ID=function(a){var b=a.replace(S,Z);return function(a){return a.getAttribute("id")===b}},C.find.ID=function(a,b){if("undefined"!==typeof b.getElementById&&M){var c=b.getElementById(a);return c?[c]:[]}}):(C.filter.ID=function(a){var b=a.replace(S,Z);return function(a){return(a="undefined"!==typeof a.getAttributeNode&&a.getAttributeNode("id"))&&a.value===b}},C.find.ID=function(a,b){if("undefined"!==typeof b.getElementById&&M){var c,d,e,f=b.getElementById(a);
if(f){if((c=f.getAttributeNode("id"))&&c.value===a)return[f];e=b.getElementsByName(a);for(d=0;f=e[d++];)if((c=f.getAttributeNode("id"))&&c.value===a)return[f]}return[]}});C.find.TAG=F.getElementsByTagName?function(a,b){if("undefined"!==typeof b.getElementsByTagName)return b.getElementsByTagName(a);if(F.qsa)return b.querySelectorAll(a)}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f};C.find.CLASS=F.getElementsByClassName&&
function(a,b){if("undefined"!==typeof b.getElementsByClassName&&M)return b.getElementsByClassName(a)};R=[];I=[];if(F.qsa=qa.test(h.querySelectorAll))e(function(a){J.appendChild(a).innerHTML="<a id='"+G+"'></a><select id='"+G+"-\r\\' msallowcapture=''><option selected=''></option></select>";a.querySelectorAll("[msallowcapture^='']").length&&I.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");a.querySelectorAll("[selected]").length||I.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");
a.querySelectorAll("[id~="+G+"-]").length||I.push("~=");a.querySelectorAll(":checked").length||I.push(":checked");a.querySelectorAll("a#"+G+"+*").length||I.push(".#.+[+~]")}),e(function(a){a.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var b=h.createElement("input");b.setAttribute("type","hidden");a.appendChild(b).setAttribute("name","D");a.querySelectorAll("[name=d]").length&&I.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?=");2!==a.querySelectorAll(":enabled").length&&
I.push(":enabled",":disabled");J.appendChild(a).disabled=!0;2!==a.querySelectorAll(":disabled").length&&I.push(":enabled",":disabled");a.querySelectorAll("*,:x");I.push(",.*:")});(F.matchesSelector=qa.test(U=J.matches||J.webkitMatchesSelector||J.mozMatchesSelector||J.oMatchesSelector||J.msMatchesSelector))&&e(function(a){F.disconnectedMatch=U.call(a,"*");U.call(a,"[s!='']:x");R.push("!=",":((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)")});
I=I.length&&new RegExp(I.join("|"));R=R.length&&new RegExp(R.join("|"));Q=(b=qa.test(J.compareDocumentPosition))||qa.test(J.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!!(d&&1===d.nodeType&&(c.contains?c.contains(d):a.compareDocumentPosition&&a.compareDocumentPosition(d)&16))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1};va=b?function(a,b){if(a===b)return V=!0,0;var c=!a.compareDocumentPosition-!b.compareDocumentPosition;
if(c)return c;c=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;return c&1||!F.sortDetached&&b.compareDocumentPosition(a)===c?a===h||a.ownerDocument===P&&Q(P,a)?-1:b===h||b.ownerDocument===P&&Q(P,b)?1:y?la(y,a)-la(y,b):0:c&4?-1:1}:function(a,b){if(a===b)return V=!0,0;var c,d=0;c=a.parentNode;var e=b.parentNode,f=[a],k=[b];if(!c||!e)return a===h?-1:b===h?1:c?-1:e?1:y?la(y,a)-la(y,b):0;if(c===e)return g(a,b);for(c=a;c=c.parentNode;)f.unshift(c);for(c=b;c=c.parentNode;)k.unshift(c);
for(;f[d]===k[d];)d++;return d?g(f[d],k[d]):f[d]===P?-1:k[d]===P?1:0};return h};b.matches=function(a,c){return b(a,null,null,c)};b.matchesSelector=function(a,c){(a.ownerDocument||a)!==h&&T(a);c=c.replace(Ea,"='$1']");if(!(!F.matchesSelector||!M||ba[c+" "]||R&&R.test(c)||I&&I.test(c)))try{var d=U.call(a,c);if(d||F.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return 0<b(c,h,null,[a]).length};b.contains=function(a,b){(a.ownerDocument||a)!==h&&T(a);return Q(a,b)};b.attr=
function(a,b){(a.ownerDocument||a)!==h&&T(a);var c=C.attrHandle[b.toLowerCase()],c=c&&Da.call(C.attrHandle,b.toLowerCase())?c(a,b,!M):void 0;return void 0!==c?c:F.attributes||!M?a.getAttribute(b):(c=a.getAttributeNode(b))&&c.specified?c.value:null};b.escape=function(a){return(a+"").replace(Ga,Pa)};b.unescape=function(a){return(a+"").replace(S,Z)};b.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};b.uniqueSort=function(a){var b,c=[],d=0,e=0;V=!F.detectDuplicates;y=!F.sortStable&&
a.slice(0);a.sort(va);if(V){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}y=null;return a};K=b.getText=function(a){var b,c="",d=0;b=a.nodeType;if(!b)for(;b=a[d++];)c+=K(b);else if(1===b||9===b||11===b){if("string"===typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=K(a)}else if(3===b||4===b)return a.nodeValue;return c};C=b.selectors={cacheLength:50,createPseudo:d,match:ya,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},
"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){a[1]=a[1].replace(S,Z);a[3]=(a[3]||a[4]||a[5]||"").replace(S,Z);"~="===a[2]&&(a[3]=" "+a[3]+" ");return a.slice(0,4)},CHILD:function(a){a[1]=a[1].toLowerCase();"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]);return a},PSEUDO:function(a){var b,c=!a[6]&&a[2];if(ya.CHILD.test(a[0]))return null;a[3]?
a[2]=a[4]||a[5]||"":c&&$a.test(c)&&(b=ca(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b));return a.slice(0,3)}},filter:{TAG:function(a){var b=a.replace(S,Z).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=Ca[a+" "];return b||(b=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+a+"([\\x20\\t\\r\\n\\f]|$)"),Ca(a,function(a){return b.test("string"===typeof a.className&&a.className||"undefined"!==
typeof a.getAttribute&&a.getAttribute("class")||"")}))},ATTR:function(a,c,d){return function(e){e=b.attr(e,a);if(null==e)return"!="===c;if(!c)return!0;e+="";return"="===c?e===d:"!="===c?e!==d:"^="===c?d&&0===e.indexOf(d):"*="===c?d&&-1<e.indexOf(d):"$="===c?d&&e.slice(-d.length)===d:"~="===c?-1<(" "+e.replace(Na," ")+" ").indexOf(d):"|="===c?e===d||e.slice(0,d.length+1)===d+"-":!1}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),k="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:
function(b,c,h){var l,m,n,p,x;c=f!==g?"nextSibling":"previousSibling";var q=b.parentNode,w=k&&b.nodeName.toLowerCase();h=!h&&!k;l=!1;if(q){if(f){for(;c;){for(n=b;n=n[c];)if(k?n.nodeName.toLowerCase()===w:1===n.nodeType)return!1;x=c="only"===a&&!x&&"nextSibling"}return!0}x=[g?q.firstChild:q.lastChild];if(g&&h)for(n=q,m=n[G]||(n[G]={}),m=m[n.uniqueID]||(m[n.uniqueID]={}),l=m[a]||[],l=(p=l[0]===W&&l[1])&&l[2],n=p&&q.childNodes[p];n=++p&&n&&n[c]||(l=p=0)||x.pop();){if(1===n.nodeType&&++l&&n===b){m[a]=
[W,p,l];break}}else if(h&&(n=b,m=n[G]||(n[G]={}),m=m[n.uniqueID]||(m[n.uniqueID]={}),l=m[a]||[],l=p=l[0]===W&&l[1]),!1===l)for(;(n=++p&&n&&n[c]||(l=p=0)||x.pop())&&((k?n.nodeName.toLowerCase()!==w:1!==n.nodeType)||!++l||(h&&(m=n[G]||(n[G]={}),m=m[n.uniqueID]||(m[n.uniqueID]={}),m[a]=[W,l]),n!==b)););l-=e;return l===d||0===l%d&&0<=l/d}}},PSEUDO:function(a,c){var e,f=C.pseudos[a]||C.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[G]?f(c):1<f.length?(e=[a,a,"",c],C.setFilters.hasOwnProperty(a.toLowerCase())?
d(function(a,b){for(var d,e=f(a,c),g=e.length;g--;)d=la(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=O(a.replace(ma,"$1"));return e[G]?d(function(a,b,c,d){d=e(a,null,d,[]);for(var f=a.length;f--;)if(c=d[f])a[f]=!(b[f]=c)}):function(a,d,f){b[0]=a;e(b,null,f,c);b[0]=null;return!c.pop()}}),has:d(function(a){return function(c){return 0<b(a,c).length}}),contains:d(function(a){a=a.replace(S,Z);return function(b){return-1<(b.textContent||b.innerText||
K(b)).indexOf(a)}}),lang:d(function(a){ab.test(a||"")||b.error("unsupported lang: "+a);a=a.replace(S,Z).toLowerCase();return function(b){var c;do if(c=M?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===J},focus:function(a){return a===h.activeElement&&(!h.hasFocus||h.hasFocus())&&
!!(a.type||a.href||~a.tabIndex)},enabled:m(!1),disabled:m(!0),checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(6>a.nodeType)return!1;return!0},parent:function(a){return!C.pseudos.empty(a)},header:function(a){return bb.test(a.nodeName)},input:function(a){return Wa.test(a.nodeName)},button:function(a){var b=
a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:n(function(){return[0]}),last:n(function(a,b){return[b-1]}),eq:n(function(a,b,c){return[0>c?c+b:c]}),even:n(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:n(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:n(function(a,b,c){for(b=0>c?c+b:c;0<=--b;)a.push(b);
return a}),gt:n(function(a,b,c){for(c=0>c?c+b:c;++c<b;)a.push(c);return a})}};C.pseudos.nth=C.pseudos.eq;for(B in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})C.pseudos[B]=k(B);for(B in{submit:!0,reset:!0})C.pseudos[B]=l(B);p.prototype=C.filters=C.pseudos;C.setFilters=new p;ca=b.tokenize=function(a,c){var d,e,f,g,k,h,l;if(k=Ia[a+" "])return c?0:k.slice(0);k=a;h=[];for(l=C.preFilter;k;){if(!d||(e=Oa.exec(k)))e&&(k=k.slice(e[0].length)||k),h.push(f=[]);d=!1;if(e=xa.exec(k))d=e.shift(),f.push({value:d,
type:e[0].replace(ma," ")}),k=k.slice(d.length);for(g in C.filter)!(e=ya[g].exec(k))||l[g]&&!(e=l[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),k=k.slice(d.length));if(!d)break}return c?k.length:k?b.error(a):Ia(a,h).slice(0)};O=b.compile=function(a,b){var c,d=[],e=[],f=ba[a+" "];if(!f){b||(b=ca(a));for(c=b.length;c--;)f=x(b[c]),f[G]?d.push(f):e.push(f);f=ba(a,A(e,d));f.selector=a}return f};oa=b.select=function(a,b,c,d){var e,f,g,k,h="function"===typeof a&&a,l=!d&&ca(a=h.selector||a);c=c||
[];if(1===l.length){f=l[0]=l[0].slice(0);if(2<f.length&&"ID"===(g=f[0]).type&&9===b.nodeType&&M&&C.relative[f[1].type]){b=(C.find.ID(g.matches[0].replace(S,Z),b)||[])[0];if(!b)return c;h&&(b=b.parentNode);a=a.slice(f.shift().value.length)}for(e=ya.needsContext.test(a)?0:f.length;e--;){g=f[e];if(C.relative[k=g.type])break;if(k=C.find[k])if(d=k(g.matches[0].replace(S,Z),Fa.test(f[0].type)&&r(b.parentNode)||b)){f.splice(e,1);a=d.length&&q(f);if(!a)return ja.apply(c,d),c;break}}}(h||O(a,l))(d,b,!M,c,
!b||Fa.test(a)&&r(b.parentNode)||b);return c};F.sortStable=G.split("").sort(va).join("")===G;F.detectDuplicates=!!V;T();F.sortDetached=e(function(a){return a.compareDocumentPosition(h.createElement("fieldset"))&1});e(function(a){a.innerHTML="<a href='#'></a>";return"#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)});F.attributes&&e(function(a){a.innerHTML="<input/>";a.firstChild.setAttribute("value","");
return""===a.firstChild.getAttribute("value")})||f("value",function(a,b,c){if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue});e(function(a){return null==a.getAttribute("disabled")})||f("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(a,b,c){var d;if(!c)return!0===a[b]?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null});var Sa=a.Sizzle;b.noConflict=function(){a.Sizzle===b&&(a.Sizzle=
Sa);return b};"function"===typeof define&&define.amd?define(function(){return b}):"undefined"!==typeof module&&module.exports?module.exports=b:a.Sizzle=b;a.Sizzle=b;b.siesta=!0;b.selectors.pseudos.textEquals=function(a,c,d){c=b.unescape(d[3]);return b.getText([a]).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")===c};a.jQuery&&a.jQuery.siesta&&(B=jQuery.expr,jQuery.find=b,jQuery.expr=b.selectors,jQuery.expr[":"]=jQuery.expr.filters,jQuery.unique=b.uniqueSort,jQuery.text=b.getText,jQuery.isXMLDoc=
b.isXML,jQuery.contains=b.contains,jQuery.expr.filters.hidden=B.filters.hidden,jQuery.expr.filters.visible=B.filters.visible)})(window);Siesta.Sizzle=Sizzle;Sizzle.noConflict();
Object.create&&function(a,b){"function"===typeof define&&define.amd?define([],b):"object"===typeof exports?module.exports=b():a.DeepDiff=b()}(this,function(a){function b(a,b){a.super_=b;a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}function c(a,b){Object.defineProperty(this,"kind",{value:a,enumerable:!0});b&&b.length&&Object.defineProperty(this,"path",{value:b,enumerable:!0})}function d(a,b,c){d.super_.call(this,"E",a);Object.defineProperty(this,
"lhs",{value:b,enumerable:!0});Object.defineProperty(this,"rhs",{value:c,enumerable:!0})}function e(a,b){e.super_.call(this,"N",a);Object.defineProperty(this,"rhs",{value:b,enumerable:!0})}function f(a,b){f.super_.call(this,"D",a);Object.defineProperty(this,"lhs",{value:b,enumerable:!0})}function g(a,b,c){g.super_.call(this,"A",a);Object.defineProperty(this,"index",{value:b,enumerable:!0});Object.defineProperty(this,"item",{value:c,enumerable:!0})}function k(a,b,c){c=a.slice((c||b)+1||a.length);a.length=
0>b?a.length+b:b;a.push.apply(a,c);return a}function l(a){var b=typeof a;return"object"!==b?b:a===Math?"math":null===a?"null":Array.isArray(a)?"array":"[object Date]"===Object.prototype.toString.call(a)?"date":/^\/.*\//.test(a.toString())?"regexp":"object"}function m(b,c,n,p,q,r,t){q=q||[];var v=q.slice(0);if("undefined"!==typeof r){if(p&&p(v,r,{lhs:b,rhs:c}))return;v.push(r)}"regexp"===l(b)&&"regexp"===l(c)&&(b=b.toString(),c=c.toString());q=typeof b;r=typeof c;if("undefined"===q)"undefined"!==r&&
n(new e(v,c));else if("undefined"===r)n(new f(v,b));else if(l(b)!==l(c))n(new d(v,b,c));else if("[object Date]"===Object.prototype.toString.call(b)&&"[object Date]"===Object.prototype.toString.call(c)&&0!==b-c)n(new d(v,b,c));else if("object"===q&&null!==b&&null!==c&&b!==c){if(t=t||[],0>t.indexOf(b)){t.push(b);if(Array.isArray(b)){for(q=0;q<b.length;q++)q>=c.length?n(new g(v,q,new f(a,b[q]))):m(b[q],c[q],n,p,v,q,t);for(;q<c.length;)n(new g(v,q,new e(a,c[q++])))}else{q=Object.keys(b);var z=Object.keys(c);
q.forEach(function(a,d){var e=z.indexOf(a);0<=e?(m(b[a],c[a],n,p,v,a,t),z=k(z,e)):n(new f(v,a))});z.forEach(function(a){n(new e(v,c[a]))})}--t.length}}else b!==c&&("number"===q&&isNaN(b)&&isNaN(c)||n(new d(v,b,c)))}function n(b,c,d,e){e=e||[];m(b,c,function(a){a&&e.push(a)},d);return e.length?e:a}function r(a,b,c){if(c.path&&c.path.length){b=a[b];var d,e=c.path.length-1;for(d=0;d<e;d++)b=b[c.path[d]];switch(c.kind){case "A":r(b[c.path[d]],c.index,c.item);break;case "D":delete b[c.path[d]];break;case "E":case "N":b[c.path[d]]=
c.rhs}}else switch(c.kind){case "A":r(a[b],c.index,c.item);break;case "D":a=k(a,b);break;case "E":case "N":a[b]=c.rhs}return a}function p(a,b,c){if(a&&b&&c&&c.kind){b=-1;for(var d=c.path?c.path.length-1:0;++b<d;)"undefined"===typeof a[c.path[b]]&&(a[c.path[b]]="number"===typeof c.path[b]?[]:{}),a=a[c.path[b]];switch(c.kind){case "A":r(c.path?a[c.path[b]]:a,c.index,c.item);break;case "D":delete a[c.path[b]];break;case "E":case "N":a[c.path[b]]=c.rhs}}}function q(a,b,c){if(c.path&&c.path.length){b=
a[b];var d,e=c.path.length-1;for(d=0;d<e;d++)b=b[c.path[d]];switch(c.kind){case "A":q(b[c.path[d]],c.index,c.item);break;case "D":b[c.path[d]]=c.lhs;break;case "E":b[c.path[d]]=c.lhs;break;case "N":delete b[c.path[d]]}}else switch(c.kind){case "A":q(a[b],c.index,c.item);break;case "D":a[b]=c.lhs;break;case "E":a[b]=c.lhs;break;case "N":a=k(a,b)}return a}var t,v,z=[];t="object"===typeof global&&global?global:"undefined"!==typeof window?window:{};(v=t.DeepDiff)&&z.push(function(){"undefined"!==typeof v&&
t.DeepDiff===n&&(t.DeepDiff=v,v=a)});b(d,c);b(e,c);b(f,c);b(g,c);Object.defineProperties(n,{diff:{value:n,enumerable:!0},observableDiff:{value:m,enumerable:!0},applyDiff:{value:function(a,b,c){a&&b&&m(a,b,function(d){c&&!c(a,b,d)||p(a,b,d)})},enumerable:!0},applyChange:{value:p,enumerable:!0},revertChange:{value:function(a,b,c){if(a&&b&&c&&c.kind){var d;d=c.path.length-1;for(b=0;b<d;b++)"undefined"===typeof a[c.path[b]]&&(a[c.path[b]]={}),a=a[c.path[b]];switch(c.kind){case "A":q(a[c.path[b]],c.index,
c.item);break;case "D":a[c.path[b]]=c.lhs;break;case "E":a[c.path[b]]=c.lhs;break;case "N":delete a[c.path[b]]}}},enumerable:!0},isConflict:{value:function(){return"undefined"!==typeof v},enumerable:!0},noConflict:{value:function(){z&&(z.forEach(function(a){a()}),z=null);return n},enumerable:!0}});return n});
(function(a){var b={vertical:{x:!1,y:!0},horizontal:{x:!0,y:!1},both:{x:!0,y:!0},x:{x:!0,y:!1},y:{x:!1,y:!0}},c={duration:"fast",direction:"both"},d=/^(?:html)$/i,e=function(b){var c=a(window),e=d.test(b[0].nodeName),f;if(e)f={top:0,left:0,bottom:0,right:0};else{var n=b[0],r;r=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(n,null):n.currentStyle;var p=document.defaultView&&document.defaultView.getComputedStyle?!0:!1;f=parseFloat(p?r.borderTopWidth:
a.css(n,"borderTopWidth"))||0;var q=parseFloat(p?r.borderLeftWidth:a.css(n,"borderLeftWidth"))||0,t=parseFloat(p?r.borderBottomWidth:a.css(n,"borderBottomWidth"))||0,n=parseFloat(p?r.borderRightWidth:a.css(n,"borderRightWidth"))||0;f={top:f,left:q,bottom:t,right:n,vertical:f+t,horizontal:q+n}}c={top:(e?c:b).scrollTop(),left:(e?c:b).scrollLeft()};q={right:e?0:b.innerWidth()-b[0].clientWidth,bottom:e?0:b.innerHeight()-b[0].clientHeight};t=b[0].getBoundingClientRect();return{border:f,scroll:c,scrollbar:q,
rect:{top:e?0:t.top,left:e?0:t.left,bottom:e?b[0].clientHeight:t.bottom,right:e?b[0].clientWidth:t.right}}};a.fn.extend({scrollintoview:function(f){f=a.extend({},c,f);f.direction=b["string"===typeof f.direction&&f.direction.toLowerCase()]||b.both;var k="";!0===f.direction.x&&(k="horizontal");!0===f.direction.y&&(k=k?"both":"vertical");var l=this.eq(0),m=l.closest(":scrollable("+k+")");if(0<m.length){var m=m.eq(0),n=e(l),k=e(m),l=n.rect.top-(k.rect.top+k.border.top),r=k.rect.bottom-k.border.bottom-
k.scrollbar.bottom-n.rect.bottom,p=n.rect.left-(k.rect.left+k.border.left),n=k.rect.right-k.border.right-k.scrollbar.right-n.rect.right,q={};!0===f.direction.y&&(0>l?q.scrollTop=k.scroll.top+l:0<l&&0>r&&(q.scrollTop=k.scroll.top+Math.min(l,-r)));!0===f.direction.x&&(0>p?q.scrollLeft=k.scroll.left+p:0<p&&0>n&&(q.scrollLeft=k.scroll.left+Math.min(p,-n)));a.isEmptyObject(q)?a.isFunction(f.complete)&&f.complete.call(m[0]):(d.test(m[0].nodeName)&&(m=a("html,body")),m.animate(q,f.duration).eq(0).queue(function(b){a.isFunction(f.complete)&&
f.complete.call(m[0]);b()}))}return this}});var f={auto:!0,scroll:!0,visible:!1,hidden:!1};a.extend(a.expr[":"],{scrollable:function(a,c,e,m){c=b["string"===typeof e[3]&&e[3].toLowerCase()]||b.both;e=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(a,null):a.currentStyle;var n=f[e.overflowX.toLowerCase()]||!1,r=f[e.overflowY.toLowerCase()]||!1,p=d.test(a.nodeName);if(!n&&!r&&!p)return!1;a={height:{scroll:a.scrollHeight,client:a.clientHeight},width:{scroll:a.scrollWidth,
client:a.clientWidth},scrollableX:function(){return(n||p)&&this.width.scroll>this.width.client},scrollableY:function(){return(r||p)&&this.height.scroll>this.height.client}};return c.y&&a.scrollableY()||c.x&&a.scrollableX()}})})(jQuery);
"undefined"==typeof JooseX||JooseX.SimpleRequest||Class("JooseX.SimpleRequest",{have:{req:null},methods:{initialize:function(){this.req=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},getText:function(a,b,c,d){var e=this.req,f,g;"string"!=typeof a?(f=a.headers,g=a.url,b=b||a.async,c=c||a.callback,d=d||a.scope):g=a;e.open("GET",g,b||!1);f&&Joose.O.eachOwn(f,function(a,b){e.setRequestHeader(b,a)});try{e.onreadystatechange=function(a){b&&4==e.readyState&&(200==e.status||
0==e.status&&0<e.responseText.length?c.call(d||this,!0,e.responseText):c.call(d||this,!1,"File not found: "+g))},e.send(null)}catch(k){throw"File not found: "+g;}if(!b){if(200==e.status||0==e.status&&0<e.responseText.length)return e.responseText;throw"File not found: "+g;}return null}}});
Role("Siesta.Util.Role.CanCalculatePageScroll",{methods:{getElForPageScroll:function(a){a=a||this.global;a=a.document;return a.scrollingElement||(bowser.webkit||bowser.blink||bowser.msedge?a.body:a.documentElement)},getPageScrollX:function(a){a=a||this.global;return null!=window.pageXOffset?a.pageXOffset:(a=this.getElForPageScroll())?a.scrollLeft:0},getPageScrollY:function(a){a=a||this.global;return null!=window.pageYOffset?a.pageYOffset:(a=this.getElForPageScroll())?a.scrollTop:0},viewportXtoPageX:function(a,
b){b=b||this.global;var c=b.document.documentElement;return a+this.getPageScrollX(b)-c.clientLeft},viewportYtoPageY:function(a,b){b=b||this.global;var c=b.document.documentElement;return a+this.getPageScrollY(b)-c.clientTop},pageXtoViewportX:function(a,b){b=b||this.global;var c=b.document.documentElement;return a-this.getPageScrollX(b)+c.clientLeft},pageYtoViewportY:function(a,b){b=b||this.global;var c=b.document.documentElement;return a-this.getPageScrollY(b)+c.clientTop},maintainScrollPositionDuring:function(a,
b){var c=window.parent,d=!!c,e=d&&this.getPageScrollX(c),f=d&&this.getPageScrollY(c);a.call(b||this);d&&(d=this.getElForPageScroll(c),e!==this.getPageScrollX(c)&&(d.scrollLeft=e),f!==this.getPageScrollY(c)&&(d.scrollTop=f))}}});
Role("Siesta.Util.Role.CanInstallCQRootPseudo",{methods:{installRootPseudoCQ:function(a){if(a){var b=a.ComponentQuery;if(b){var c=b.pseudos;if(!c.root||!c.root.__IS_ROOT_PSEUDO_OVERRIDE__){var d=function(a,b){var c=0,d=a.length,e,n=[],r=void 0===b;for(r||(b=Number(b)-1);c<d;c++)(e=a[c].up())&&e.contains&&e.contains(a[c])||n.push(a[c]);r||(n=n[b]?[n[b]]:[]);return n};d.__IS_ROOT_PSEUDO_OVERRIDE__=!0;c.root=d}c["ariadne-nth-child"]||(c["ariadne-nth-child"]=function(a,b){for(var c=[],d=Number(b)-1,e=
a.length,n=0;n<e;n++){var r=a[n],p=r.getRefOwner&&r.getRefOwner()||r.ownerCt,q=p&&p.items;if(q&&q.getCount){var t=q.getCount();d<t?q.getAt(d)===r&&c.push(r):p.getRefItems()[d]===r&&c.push(r)}}return c});if((c=a.getVersion&&a.getVersion("ext"))&&4==c.major&&!b.__CQ4_PATCHED__){a.dom.Query.operators["="]=function(a,b){return a==Siesta.Sizzle.unescape(b)};var e=b.query;b.query=function(a,b){return/\\,/.test(a)?e.call(this,{split:function(){return[a]}},b):e.call(this,a,b)};b.__CQ4_PATCHED__=!0}}}}}});
Role("Siesta.Test.Browser.Role.CanGetElementFromPoint",{requires:["$"],does:[Siesta.Util.Role.CanCalculatePageScroll],has:{},methods:{elementFromPoint:function(a,b,c,d,e){var f=this.global.document,g=f.elementFromPoint(a,b);g||(g=f.elementFromPoint(a,b));g=g||d||f.body;d=a;f=b;if(g&&"IFRAME"==g.nodeName.toUpperCase()&&!c)try{var k=g.contentWindow.document,l=this.$(g).offset();d=a-this.pageXtoViewportX(l.left);var f=b-this.pageYtoViewportY(l.top),m=k.elementFromPoint(d,f);m||(m=k.elementFromPoint(d,
f));m=m||k.body;"HTML"===m.nodeName.toUpperCase()&&(m=k.body);g=m}catch(n){d=a,f=b}return e?{el:g,localXY:[d,f],globalXY:[a,b]}:g}}});
Role("Siesta.Test.Browser.Role.CanWorkWithKeyboard",{has:{},methods:{isTextInput:function(a){var b=a.nodeName&&a.nodeName.toLowerCase();return"textarea"===b?!0:"input"===b?(a=String(a.type).toLowerCase(),"password"===a||"number"===a||"search"===a||"text"===a||"url"===a||"tel"===a||"month"===a||"time"===a||"date"===a||"datetime"===a||"week"===a||"email"===a):!1},isEditableNode:function(a){return"on"===a.ownerDocument.designMode.toLowerCase()||a.isContentEditable},isReadableKey:function(a){var b=Siesta.Test.UserAgent.KeyCodes();
return!b.isNav(a)&&!b.isSpecial(a)},activeElement:function(a,b,c){c=c?c.ownerDocument||c:this.global.document;var d=c.activeElement;if(!d||!d.nodeName||!d.tagName||d===c.body&&a)d=b;if(d&&"iframe"==String(d.tagName).toLowerCase())try{d.contentDocument&&d.contentDocument.body&&(d=this.activeElement(a,b,d.contentDocument))}catch(e){}return d||c.body}}});Role("Siesta.Test.Browser.Role.CanRebindJQueryContext",{methods:{$:function(){return $.rebindWindowContext(this.global).apply(this.global,arguments)}}});
Role("Siesta.Util.Role.Dom",{does:[Siesta.Util.Role.CanCalculatePageScroll],has:{doesNotIncludeMarginInBodyOffset:!1},methods:{isCrossOriginWindow:function(a){try{var b=a.document}catch(c){return!0}return!b},closest:function(a,b,c){c=c||Number.MAX_VALUE;for(var d=a.ownerDocument.documentElement,e=0;e<c&&a&&a!==d;a=a.parentNode){if(Siesta.Sizzle.matchesSelector(a,b))return a;e++}return!1},contains:function(a,b){if(!a)return!1;if(a.contains)return a.contains(b);if(a.compareDocumentPosition)return a===
b||!!(a.compareDocumentPosition(b)&16);throw Error("Can't determine `contains` status");},matches:function(a,b){return Siesta.Sizzle.matchesSelector(a,b)},offset:function(a){if(!a)return null;var b=a.ownerDocument;if(!b)return null;if(a===b.body)return this.bodyOffset(a);a=this.getBoundingClientRect(a);b=b.defaultView||b.parentWindow;return a?{left:this.viewportXtoPageX(Math.floor(a.left),b),top:this.viewportYtoPageY(Math.floor(a.top),b)}:{left:0,top:0}},bodyOffset:function(a){var b=a.offsetTop,c=
a.offsetLeft;this.initializeOffset();this.doesNotIncludeMarginInBodyOffset&&(a=getComputedStyle(a),b+=parseFloat(a.marginTop)||0,c+=parseFloat(a.marginLeft)||0);return{top:b,left:c}},initializeOffset:function(){var a=document.body,b=document.createElement("div"),c=parseFloat(getComputedStyle(a).marginTop)||0,d={position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"},e;for(e in d)b.style[e]=d[e];b.innerHTML="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";
a.insertBefore(b,a.firstChild);d=b.firstChild;e=d.firstChild;e.style.position="fixed";e.style.top="20px";e.style.position=e.style.top="";d.style.overflow="hidden";d.style.position="relative";this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==c;a.removeChild(b);this.initializeOffset=function(){}},getElementWidth:function(a){return this.getBoundingClientRect(a).width},getElementHeight:function(a){return this.getBoundingClientRect(a).height},getWindowSize:function(a){var b=a.document;return{width:a.innerWidth||
b.documentElement.clientWidth||b.body.clientWidth,height:a.innerHeight||b.documentElement.clientHeight||b.body.clientHeight}},isPointWithinElement:function(a,b,c){c=this.getBoundingClientRect(c);return a>=c.left&&a<=c.right&&b>=c.top&&b<=c.bottom},isElementReachableAt:function(a,b,c,d){d=!1!==d;var e=a.ownerDocument,f=e.defaultView||e.parentWindow;return(b=e.elementFromPoint(this.pageXtoViewportX(b,f),this.pageYtoViewportY(c,f)))&&(b===a||d&&this.contains(a,b))},isElementReachableAtCenter:function(a,
b){b=!1!==b;var c=this.offset(a);return this.isElementReachableAt(a,c.left+this.getElementWidth(a)/2,c.top+this.getElementHeight(a)/2,b)},getBoundingClientRect:function(a){var b=a.ownerSVGElement;if(b&&(bowser.msie||bowser.msedge||bowser.gecko)){a=a.getBBox();var c=b.getBoundingClientRect(),b=c.left+a.x,c=c.top+a.y;return{x:b,y:c,left:b,top:c,bottom:c+a.height,height:a.height,width:a.width}}return a.getBoundingClientRect()},nodeIsUnloaded:function(a){try{a&&a.tagName;var b=a.ownerDocument;return!(b&&
(b.defaultView||b.parentWindow))}catch(c){return!0}},nodeIsOrphan:function(a){var b=a.ownerDocument;return!b||!b.body||!a.parentNode||!(a===b.body||$.contains(b.body,a))},getNodeParents:function(a){for(var b=[];a&&a.parentNode;a=a.parentNode)b.unshift(a);return b},getCommonAncestor:function(a,b){var c=this.getNodeParents(a),d=this.getNodeParents(b);if(c[0]!=d[0])return null;for(var e=0;e<c.length;e++)if(c[e]!==d[e])return c[e-1]}}});
Role("Siesta.Test.Action.Role.HasTarget",{has:{target:{required:!1},normalizedTarget:null,cachedTarget:null,passTargetToNext:!0,options:null,offset:null,waitForTarget:!0},after:{initialize:function(){if(this.passTargetToNext){var a=this,b=this.next;this.next=function(){b.call(this,a.normalizedTarget)}}}},methods:{BUILD:function(a){a.el&&!a.target&&(a.target=a.el);return a},getTarget:function(){if(this.cachedTarget)return this.cachedTarget;var a=this.test,b=this.target||a.getCursorPagePosition();"Function"===
a.typeOf(b)&&(b=b.call(a,this));this.normalizedTarget=a.normalizeActionTarget(b,!0);return this.cachedTarget=b}}});Class("Siesta.Test.Action.Swipe",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"swipe",direction:"left"},methods:{process:function(){this.test.swipe(this.getTarget(),this.direction,this.next)}}});Siesta.Test.ActionRegistry().registerAction("swipe",Siesta.Test.Action.Swipe);
Class("Siesta.Test.Action.Pinch",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"pinch",scale:2,target2:null,offset2:null,cachedTarget2:null},methods:{process:function(){this.test.pinch(this.getTarget(),this.getTarget2(),this.scale,this.next,null,this.options,this.offset,this.offset2)},getTarget2:function(){if(this.cachedTarget2)return this.cachedTarget2;var a=this.test,b=this.target2;"Function"===a.typeOf(b)&&(b=b.call(a,this));return this.cachedTarget2=b}}});
Siesta.Test.ActionRegistry().registerAction("pinch",Siesta.Test.Action.Pinch);Class("Siesta.Test.Action.LongPress",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"longPress"},methods:{process:function(){this.test.longpress(this.getTarget(),this.next,null,this.options,this.offset)}}});Siesta.Test.ActionRegistry().registerAction("longpress",Siesta.Test.Action.LongPress);
Class("Siesta.Test.Action.Tap",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"tap"},methods:{process:function(){this.test.tap(this.getTarget(),this.next,null,this.options,this.offset)}}});Siesta.Test.ActionRegistry().registerAction("tap",Siesta.Test.Action.Tap);
Class("Siesta.Test.Action.DoubleTap",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"doubleTap"},methods:{process:function(){this.test.doubleTap(this.getTarget(),this.next,null,this.options,this.offset,this.waitForTarget)}}});Siesta.Test.ActionRegistry().registerAction("doubletap",Siesta.Test.Action.DoubleTap);
Class("Siesta.Test.Action.TouchDrag",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"touchDragTo",to:null,fromOffset:null,toOffset:null,by:null,dragOnly:!1,byOrToMissingText:'Either "to" or "by" configuration option is required for "drag" step',byAndToDefinedText:'Exactly one of "to" or "by" configuration options is required for "drag" step, not both'},override:{BUILD:function(a){a.source&&!a.target&&(a.target=a.source);return this.SUPER(a)}},methods:{initialize:function(){this.SUPER();
if(!this.to&&!this.by)throw this.byOrToMissingText;if(this.to&&this.by)throw this.byAndToDefinedText;},getTo:function(){return"Function"==this.test.typeOf(this.to)?this.to.call(this.test,this):this.to},getBy:function(){return"Function"==this.test.typeOf(this.by)?this.by.call(this.test,this):this.by},process:function(){var a=this.next,b=this.test,c=this.getTarget(),d=b.normalizeActionTarget(c,!0);this.to?b.touchDragTo(c,this.getTo(),function(){a(d||b.normalizeActionTarget(c))},null,this.options,this.dragOnly,
this.fromOffset||this.offset,this.toOffset):b.touchDragBy(c,this.getBy(),function(){a(d||b.normalizeActionTarget(c))},null,this.options,this.dragOnly,this.fromOffset||this.offset)}}});Siesta.Test.ActionRegistry().registerAction("touchdrag",Siesta.Test.Action.TouchDrag);
Class("Siesta.Test.Action.MouseDown",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"mouseDown"},methods:{process:function(){this.test.mouseDown(this.getTarget(),this.options,this.offset,this.next,this,this.waitForTarget)}}});Siesta.Test.ActionRegistry().registerAction("mouseDown",Siesta.Test.Action.MouseDown);Siesta.Test.ActionRegistry().registerAction("fingerDown",Siesta.Test.Action.MouseDown);
Class("Siesta.Test.Action.MouseUp",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"mouseUp"},methods:{process:function(){this.test.mouseUp(this.getTarget(),this.options,this.offset,this.next)}}});Siesta.Test.ActionRegistry().registerAction("mouseUp",Siesta.Test.Action.MouseUp);Siesta.Test.ActionRegistry().registerAction("fingerUp",Siesta.Test.Action.MouseUp);
Class("Siesta.Test.Action.Click",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"click"},methods:{process:function(){this.test.click(this.getTarget(),this.next,null,this.options,this.offset,this.waitForTarget)}}});Siesta.Test.ActionRegistry().registerAction("click",Siesta.Test.Action.Click);
Class("Siesta.Test.Action.DoubleClick",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"doubleClick"},methods:{process:function(){this.test.doubleClick(this.getTarget(),this.next,null,this.options,this.offset,this.waitForTarget)}}});Siesta.Test.ActionRegistry().registerAction("doubleclick",Siesta.Test.Action.DoubleClick);Siesta.Test.ActionRegistry().registerAction("dblclick",Siesta.Test.Action.DoubleClick);
Class("Siesta.Test.Action.RightClick",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"rightClick"},methods:{process:function(){this.test.rightClick(this.getTarget(),this.next,null,this.options,this.offset,this.waitForTarget)}}});Siesta.Test.ActionRegistry().registerAction("rightclick",Siesta.Test.Action.RightClick);Siesta.Test.ActionRegistry().registerAction("contextmenu",Siesta.Test.Action.RightClick);
Class("Siesta.Test.Action.Wheel",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"wheel"},methods:{process:function(){this.test.wheel(this.getTarget(),this.next,null,this.options,this.offset,this.waitForTarget)}}});Siesta.Test.ActionRegistry().registerAction("wheel",Siesta.Test.Action.Wheel);
Class("Siesta.Test.Action.Type",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"type",text:"",options:null,clearExisting:!1},methods:{process:function(){var a=this.waitForTarget||!!this.target;this.target=this.target||this.test.activeElement();this.test.type(this.getTarget(),this.text,this.next,null,this.options,this.clearExisting,a)}}});Siesta.Test.ActionRegistry().registerAction("type",Siesta.Test.Action.Type);
Class("Siesta.Test.Action.Drag",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"dragTo",to:null,fromOffset:null,toOffset:null,by:null,dragOnly:!1,byOrToMissingText:'Either "to" or "by" configuration option is required for "drag" step',byAndToDefinedText:'Exactly one of "to" or "by" configuration options is required for "drag" step, not both'},override:{BUILD:function(a){a.source&&!a.target&&(a.target=a.source);return this.SUPER(a)}},methods:{initialize:function(){this.SUPER();
if(!this.to&&!this.by)throw this.byOrToMissingText;if(this.to&&this.by)throw this.byAndToDefinedText;},getTo:function(){return"Function"===this.test.typeOf(this.to)?this.to.call(this.test,this):this.to},getBy:function(){return"Function"===this.test.typeOf(this.by)?this.by.call(this.test,this):this.by},process:function(){var a=this.next,b=this.test,c=this.getTarget(),d=b.normalizeActionTarget(c,!0);this.to?b.dragTo(c,this.getTo(),function(){a(d||b.normalizeActionTarget(c,!0))},null,this.options,this.dragOnly,
this.fromOffset||this.offset,this.toOffset,this.waitForTarget):b.dragBy(c,this.getBy(),function(){a(d||b.normalizeActionTarget(c,!0))},null,this.options,this.dragOnly,this.fromOffset||this.offset,this.waitForTarget)}}});Siesta.Test.ActionRegistry().registerAction("drag",Siesta.Test.Action.Drag);
Class("Siesta.Test.Action.MonkeyTest",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"monkeyTest",nbrInteractions:10,hasOwnAsyncFrame:!0},methods:{process:function(){this.test.monkeyTest(this.getTarget(),this.nbrInteractions,this.next)}}});Siesta.Test.ActionRegistry().registerAction("monkeyTest",Siesta.Test.Action.MonkeyTest);Siesta.Test.ActionRegistry().registerAction("monkey",Siesta.Test.Action.MonkeyTest);
Class("Siesta.Test.Action.MoveCursor",{isa:Siesta.Test.Action,has:{requiredTestMethod:"moveMouseTo",to:null,by:null,offset:null},methods:{getTo:function(){return"Function"==this.test.typeOf(this.to)?this.to.call(this.test,this):this.to},getBy:function(){return"Function"==this.test.typeOf(this.by)?this.by.call(this.test,this):this.by},process:function(){var a=this.test,b=this.next;if(this.to){var c=this.getTo(),d=a.normalizeActionTarget(c,!1);a.moveMouseTo(c,function(){b(d)},null,this.offset)}else{var c=
this.getBy(),e=a.getCursorPagePosition(),d=a.normalizeActionTarget([e[0]+c[0],e[1]+c[1]]);a.moveMouseBy(c,function(){b(d)})}}}});Siesta.Test.ActionRegistry().registerAction("moveCursor",Siesta.Test.Action.MoveCursor);Siesta.Test.ActionRegistry().registerAction("moveMouse",Siesta.Test.Action.MoveCursor);Siesta.Test.ActionRegistry().registerAction("moveFinger",Siesta.Test.Action.MoveCursor);
Class("Siesta.Test.Action.MoveCursorTo",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"moveMouseTo",target:{required:!0}},methods:{process:function(){this.test.moveMouseTo(this.getTarget(),this.next,null,this.offset,this.waitForTarget,this.options)}}});Siesta.Test.ActionRegistry().registerAction("moveCursorTo",Siesta.Test.Action.MoveCursorTo);Siesta.Test.ActionRegistry().registerAction("moveMouseTo",Siesta.Test.Action.MoveCursorTo);
Siesta.Test.ActionRegistry().registerAction("moveFingerTo",Siesta.Test.Action.MoveCursorTo);Class("Siesta.Test.Action.MoveCursorBy",{isa:Siesta.Test.Action,does:[Siesta.Test.Action.Role.HasTarget,Siesta.Util.Role.CanGetType],has:{requiredTestMethod:"moveMouseBy"},methods:{process:function(){var a=this.test;this.target&&"Array"===this.typeOf(this.target)&&"Array"===this.typeOf(this.target[0])&&(this.target=this.target[0]);a.moveMouseBy(this.getTarget(),this.next,this,this.options)}}});
Siesta.Test.ActionRegistry().registerAction("moveMouseBy",Siesta.Test.Action.MoveCursorBy);Siesta.Test.ActionRegistry().registerAction("moveCursorBy",Siesta.Test.Action.MoveCursorBy);Siesta.Test.ActionRegistry().registerAction("moveFingerBy",Siesta.Test.Action.MoveCursorBy);Class("Siesta.Test.Action.SetUrl",{isa:Siesta.Test.Action,has:{value:null,setUrl:null,requiredTestMethod:"setUrl"},methods:{process:function(){this.test.setUrl(this.setUrl||this.value,this.next)}}});
Siesta.Test.ActionRegistry().registerAction("setUrl",Siesta.Test.Action.SetUrl);Class("Siesta.Test.Action.SetValue",{isa:Siesta.Test.Action,has:{target:null,setValue:null,requiredTestMethod:"setValue"},methods:{process:function(){var a=this.target,b=this.test;"Function"===b.typeOf(a)&&(a=a.call(b,this));b.setValue(a,this.setValue,this.next,null)}}});Siesta.Test.ActionRegistry().registerAction("setValue",Siesta.Test.Action.SetValue);
Role("Siesta.Test.Simulate.Mouse",{requires:["simulateEvent","getSimulateEventsWith","$"],does:[Siesta.Util.Role.Dom,Siesta.Util.Role.CanCalculatePageScroll,Siesta.Test.Browser.Role.CanGetElementFromPoint],has:{currentPosition:{init:function(){return[0,0]}},dragDelay:25,pathBatchSize:bowser.msie?10:5,mouseMovePrecision:1,enableUnreachableClickWarning:!0,overEls:Joose.I.Array,lastMouseOverEl:null,mouseState:"up",lastMouseDownEl:null,pointerEventNamesMap:{lazy:function(){return window.PointerEvent?
{pointerdown:"pointerdown",pointerup:"pointerup",pointerover:"pointerover",pointerout:"pointerout",pointerenter:"pointerenter",pointerleave:"pointerleave",pointermove:"pointermove"}:window.MSPointerEvent?{pointerdown:"MSPointerDown",pointerup:"MSPointerUp",pointerover:"MSPointerOver",pointerout:"MSPointerOut",pointerenter:"MSPointerEnter",pointerleave:"MSPointerLeave",pointermove:"MSPointerMove"}:{}}}},after:{cleanup:function(){this.lastMouseOverEl=this.lastMouseDownEl=this.overEls=null}},override:{normalizeEventName:function(a){return this.getPointerEventNamesMap()[a]||
this.SUPERARG(arguments)},simulateEvent:function(a,b){var c=Siesta.Project.Browser.FeatureSupport().supports.PointerEventsGeneric;if(c?/pointerdown$/i.test(b):"mousedown"==b)this.mouseState="down",this.lastMouseDownEl=a;if(c?/pointerup$/i.test(b):"mouseup"==b)this.mouseState="up",this.lastMouseUpEl=a;c=this.SUPERARG(arguments);/pointerdown$/i.test(b)&&(this.lastPointerDownPrevented=this.isEventPrevented(c));if(this.test&&this.test.mouseVisualizer&&c)this.test.mouseVisualizer.onEventSimulated(c,this.currentPosition);
return c}},methods:{createMouseEvent:function(a,b,c){var d=this.global,e=c.ownerDocument,f,g=a.match(/^(ms)?pointer/i);b=this.prepareMouseEventOptions(a,b,c);!bowser.msie&&d.MouseEvent?"wheel"===a?f=new d.WheelEvent(a,b):g?("pointermove"===a&&(b.button=-1),f=new d.PointerEvent(a,b)):f=new d.MouseEvent(a,b):e.createEvent&&"dispatchEvent"==this.getSimulateEventsWith()?"wheel"===a?(c="",b.ctrlKey&&(c="Control"),b.altKey&&(c+=" Alt"),b.shiftKey&&(c+=" Shift"),f=e.createEvent("WheelEvent"),f.initWheelEvent(a,
b.bubbles,b.cancelable,b.view,b.detail,b.screenX,b.screenY,b.clientX,b.clientY,b.button,b.relatedTarget||e.documentElement,c,b.deltaX||0,b.deltaY||0,b.deltaZ||0,b.deltaMode||0)):(f=e.createEvent(g?(g[1]?"MS":"")+"PointerEvent":"MouseEvents"),f[g?"initPointerEvent":"initMouseEvent"](a,b.bubbles,b.cancelable,b.view,b.detail,b.screenX,b.screenY,b.clientX,b.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,b.button,b.relatedTarget||e.documentElement,null,null,null,null,null,null,null,null,b.pointerId,b.pointerType,
null,null)):e.createEventObject&&(f=e.createEventObject(),$.extend(f,b),f.button={0:1,1:4,2:2}[f.button]||f.button);this.bowser.msedge&&(d.Object.defineProperty(f,"pageX",{value:b.pageX}),d.Object.defineProperty(f,"pageY",{value:b.pageY}));/(mouse|pointer)over$/.test(a)||/(mouse|pointer)out$/.test(a)||(c=e.defaultView||e.parentWindow,a=b.clientX,e=b.clientY,c!==d&&(d=this.$(c.frameElement).offset(),a+=d.left,e+=d.top),b.doNotUpdateCurrentPosition||(this.currentPosition[0]=a,this.currentPosition[1]=
e));return f},prepareMouseEventOptions:function(a,b,c){var d=this.global;b=$.extend({bubbles:!/(ms)?(mouse|pointer)enter/i.test(a)&&!/(ms)?(mouse|pointer)leave/i.test(a),cancelable:!/(ms)?(mouse|pointer)move/i.test(a),view:d,detail:0,screenX:0,screenY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,buttons:0,relatedTarget:void 0,pointerType:bowser.msie?4:"mouse"},b);"clientX"in b&&"clientY"in b||(a=this.test.findCenter(c),b.clientX=a[0],b.clientY=a[1]);b.clientX=Math.round(b.clientX);b.clientY=
Math.round(b.clientY);!this.bowser.msedge||"pageX"in b&&"pageY"in b||(b.pageX=this.viewportXtoPageX(b.clientX),b.pageY=this.viewportYtoPageY(b.clientY));"screenX"in window&&(b.screenX=Math.round(d.screenX+b.clientX),b.screenY=Math.round(d.screenY+b.clientY));return b},simulateMouseMove:function(a,b,c,d){var e=this;d=d||{};var f=d.pathBatchSize,g=d.async,k=d.mouseMovePrecision;"instant"==d.moveKind&&(k=f=1E4);return this.movePointerTemplate({xy:this.currentPosition,xy2:[a,b],options:c,overEls:this.overEls,
interval:!1!==g?this.dragDelay:0,callbackDelay:!1!==g?50:0,pathBatchSize:f||e.pathBatchSize,mouseMovePrecision:k||e.mouseMovePrecision,onVoidOverEls:function(){return e.overEls=[]},onPointerEnter:function(a,b){e.onPointerEnter(a,b)},onPointerLeave:function(a,b){e.onPointerLeave(a,b)},onPointerOver:function(a,b){e.onPointerOver(a,b)},onPointerOut:function(a,b){e.onPointerOut(a,b)},onPointerMove:function(a,b){e.onPointerMove(a,b)}})},movePointerTemplate:function(a){var b=this,c=a.overEls,d=c[c.length-
1];d&&this.nodeIsUnloaded(d)&&(d=null,c=a.onVoidOverEls());var e="down"==b.mouseState?1:a.mouseMovePrecision||b.mouseMovePrecision,c=Math.max(a.pathBatchSize,e),f=a.options||{};Siesta.Project.Browser.FeatureSupport();var g=this.getPathBetweenPoints(a.xy,a.xy2),k=new Siesta.Util.Queue({deferer:this.test.originalSetTimeout,deferClearer:this.test.originalClearTimeout,interval:a.interval,callbackDelay:a.callbackDelay,observeTest:this.test,processor:function(c,k){for(var l=c.sourceIndex,m=c.targetIndex,
t=Math.min(m-l,e)||1;l<=m;l+=t){var v=g[l],z=b.elementFromPoint(v[0],v[1],!1,null,!0),w=z.el;if(w){var x=z.localXY[0],A=z.localXY[1];w!==d&&(b.onElementAtCursorChanged(w,d,x,A,f),d=w);a.onPointerMove(w,$.extend({clientX:x,clientY:A},f),l<m)}}if(v&&(z=b.elementFromPoint(v[0],v[1],!1,null,!0),z.el&&z.el!==d))b.onElementAtCursorChanged(z.el,d,x,A,f)}}),l=g.length;if(l<=c&&e>=c)k.addStep({sourceIndex:0,targetIndex:Math.min(1,l-1)}),3<=l&&k.addStep({sourceIndex:l-2,targetIndex:l-1});else for(var m=0;m<
l;m+=c)k.addStep({sourceIndex:m,targetIndex:Math.min(m+c-1,l-1)});k.addStep({processor:function(){b.afterMouseInteraction()}});return new Promise(function(a,b){k.run(a)})},onPointerEnter:function(a,b){Siesta.Project.Browser.FeatureSupport().supports.PointerEventsGeneric&&this.simulateEvent(a,"pointerenter",b);this.simulateEvent(a,"mouseenter",b)},onPointerLeave:function(a,b){Siesta.Project.Browser.FeatureSupport().supports.PointerEventsGeneric&&this.simulateEvent(a,"pointerleave",b);this.simulateEvent(a,
"mouseleave",b)},onPointerOver:function(a,b){Siesta.Project.Browser.FeatureSupport().supports.PointerEventsGeneric&&this.simulateEvent(a,"pointerover",b);this.simulateEvent(a,"mouseover",b)},onPointerOut:function(a,b){Siesta.Project.Browser.FeatureSupport().supports.PointerEventsGeneric&&this.simulateEvent(a,"pointerout",b);this.simulateEvent(a,"mouseout",b)},onPointerMove:function(a,b){var c=Siesta.Project.Browser.FeatureSupport().supports.PointerEventsGeneric;b.buttons="up"==this.mouseState?0:1;
c&&this.simulateEvent(a,"pointermove",b);this.simulateEvent(a,"mousemove",b)},onElementAtCursorChanged:function(a,b,c,d,e){var f=Siesta.Project.Browser.FeatureSupport().supports,g=this.overEls;if(b&&!this.nodeIsOrphan(b)&&!this.nodeIsUnloaded(b))this.onPointerOut(b,$.extend({clientX:c,clientY:d,relatedTarget:a},e));for(var k=g.length-1;0<=k;k--){var l=g[k];if(this.nodeIsUnloaded(l)||this.nodeIsOrphan(l))g.splice(k,1);else if(l!==a&&0===this.$(l).has(a).length){if(f.mouseEnterLeave)this.onPointerLeave(l,
$.extend({clientX:c,clientY:d,relatedTarget:a},e));g.splice(k,1)}}this.onPointerOver(a,$.extend({clientX:c,clientY:d,relatedTarget:b},e));if(f.mouseEnterLeave&&-1==jQuery.inArray(a,g)){f=[];for(k=a.ownerDocument.documentElement;a&&a!=k;)f.unshift(a),a=a.parentNode;for(k=0;k<f.length;k++)-1==jQuery.inArray(f[k],g)&&(this.onPointerEnter(f[k],$.extend({clientX:c,clientY:d,relatedTarget:b},e)),g.push(f[k]))}},afterMouseInteraction:function(){},simulateMouseDown:function(a,b){var c=Siesta.Project.Browser.FeatureSupport().supports.PointerEventsGeneric;
return this.processMouseActionSteps(a,b,[c?{event:"pointerdown",interval:0}:null,{event:"mousedown",focus:!0}])},simulateMouseUp:function(a,b){var c=a.el,c=!(this.lastMouseDownEl&&c!==this.lastMouseDownEl&&!$.contains(c,this.lastMouseDownEl)&&!$.contains(this.lastMouseDownEl,c))||!(this.bowser.safari||this.bowser.gecko),d=Siesta.Project.Browser.FeatureSupport().supports.PointerEventsGeneric;return this.processMouseActionSteps(a,b,[d?{event:"pointerup",interval:0}:null,{event:"mouseup"}].concat(c?
[{event:"click"}]:[]))},mouseOver:function(a,b){var c=this.test.getNormalizedTopElementInfo(a,!0);c&&(b=b||{},b.clientX=null!=b.clientX?b.clientX:c.localXY[0],b.clientY=null!=b.clientY?b.clientY:c.localXY[1],Siesta.Project.Browser.FeatureSupport().supports.PointerEventsGeneric&&this.simulateEvent(a,"pointerover",b),this.simulateEvent(a,"mouseover",b))},mouseOut:function(a,b){var c=this.test.getNormalizedTopElementInfo(a,!0);c&&(b=b||{},b.clientX=null!=b.clientX?b.clientX:c.localXY[0],b.clientY=null!=
b.clientY?b.clientY:c.localXY[1],Siesta.Project.Browser.FeatureSupport().supports.PointerEventsGeneric&&this.simulateEvent(a,"pointerout",b),this.simulateEvent(a,"mouseout",b))},processMouseActionSteps:function(a,b,c){a.originalEl&&this.enableUnreachableClickWarning&&this.test.getNormalizedTopElementInfo(a.originalEl,!1,a.method,a.offset);var d=this,e=a.globalXY[0],f=a.globalXY[1],g="option"===a.el.nodeName.toLowerCase(),k=d.global.document,l=this.getPageScrollY(),m=g?a.el:d.elementFromPoint(e,f,
!1,a.el),n=m.parentNode,r=!1,p=new Siesta.Util.Queue({deferer:this.test.originalSetTimeout,deferClearer:this.test.originalClearTimeout,interval:10,callbackDelay:d.afterActionDelay,observeTest:this.test,processor:function(a){if(!d.lastPointerDownPrevented||!/mouse/i.test(a.event)){var c=k.body?d.getPageScrollY()-l:0,p=g?m:d.elementFromPoint(e,f-c,!1,m),z=p;!g&&a.recaptureTarget&&(m=p,r=!1);g||p===m||$.contains(p,m)||$.contains(m,p)||(r=!0);if(!g&&"click"===a.event){if(p===m&&p.parentNode!==n||d.nodeIsOrphan(m)||
d.lastMouseDownEl&&d.nodeIsOrphan(d.lastMouseDownEl))return;var w;!d.lastMouseDownEl||p===d.lastMouseDownEl||$.contains(p,d.lastMouseDownEl)||$.contains(d.lastMouseDownEl,p)?d.lastMouseUpEl&&d.lastMouseUpEl!==p&&!$.contains(p,d.lastMouseUpEl)&&(w=!0,z=d.getCommonAncestor(p,d.lastMouseUpEl)):(w=!0,z=d.getCommonAncestor(p,d.lastMouseDownEl));if(w&&(d.bowser.gecko||d.bowser.safari||!z))return}if(!r||!a.cancelIfTargetChanged)if(z=d.simulateEvent(z,a.event,b),!d.lastPointerDownPrevented&&a.focus&&d.mimicFocusOnMouseDown(p,
z),!g&&(a=d.elementFromPoint(e,f-c,!1,m),a!==p))d.onElementAtCursorChanged(a,p,e,f-c,b)}}});Joose.A.each(c,function(a){a&&p.addStep(a)});return new Promise(function(a,b){p.run(function(){d.afterMouseInteraction();a()})})},simulateMouseClick:function(a,b){var c=Siesta.Project.Browser.FeatureSupport().supports.PointerEventsGeneric;return this.processMouseActionSteps(a,b,[c?{event:"pointerdown",interval:0}:null,{event:"mousedown",focus:!0},c?{event:"pointerup",interval:0}:null,{event:"mouseup",interval:0},
{event:"click",cancelIfTargetChanged:!0}])},simulateRightClick:function(a,b){var c=-1<navigator.platform.indexOf("Mac"),d=Siesta.Project.Browser.FeatureSupport().supports.PointerEventsGeneric;b=b||{};b.button=b.buttons=2;return this.processMouseActionSteps(a,b,[d?{event:"pointerdown",interval:0}:null,{event:"mousedown",focus:!0}].concat(c?[]:[d?{event:"pointerup",interval:0}:null,{event:"mouseup",interval:0}]).concat([{event:"contextmenu"}]))},simulateDoubleClick:function(a,b){var c=Siesta.Project.Browser.FeatureSupport().supports.PointerEventsGeneric;
return this.processMouseActionSteps(a,b,[c?{event:"pointerdown",interval:0}:null,{event:"mousedown",focus:!0},c?{event:"pointerup",interval:0}:null,{event:"mouseup",interval:0},{event:"click",cancelIfTargetChanged:!0},c?{event:"pointerdown",interval:0}:null,{event:"mousedown",recaptureTarget:!0,focus:!0},c?{event:"pointerup",interval:0}:null,{event:"mouseup",interval:0},{event:"click",cancelIfTargetChanged:!0,interval:0},{event:"dblclick",cancelIfTargetChanged:!0}])},mimicFocusOnMouseDown:function(a,
b){if(!this.isEventPrevented(b)){var c=this.test;if(c.isElementFocusable(a))c.focus(a,!0);else{var d=a.ownerDocument,e=d.body;if(e){for(;a&&a!=e&&a!=d;){if(bowser.msie&&"on"==a.getAttribute("unselectable"))return;if(c.isElementFocusable(a)){c.focus(a,!0);return}a=a.parentNode}c.focus(e||d.documentElement,!0)}}}},simulateMouseWheel:function(a,b){var c="wheel";a.el.ownerDocument.createEvent&&"dispatchEvent"===this.getSimulateEventsWith()||(c="mousewheel");return this.processMouseActionSteps(a,b,[{event:c}])},
getPathBetweenPoints:function(a,b){if("number"!==typeof a[0]||"number"!==typeof a[1]||"number"!==typeof b[0]||"number"!==typeof b[1]||isNaN(a[0])||isNaN(a[1])||isNaN(b[0])||isNaN(b[1]))throw Error("Incorrect arguments passed to getPathBetweenPoints: "+a+", "+b);var c=[],d=Math.floor(a[0]),e=Math.floor(b[0]),f=Math.floor(a[1]),g=Math.floor(b[1]),k=Math.abs(e-d),l=Math.abs(g-f),m,n,r,p;m=d<e?1:-1;n=f<g?1:-1;for(r=k-l;d!==e||f!==g;)p=2*r,p>-l&&(r-=l,d+=m),p<k&&(r+=k,f+=n),c.push([d,f]);d=c[c.length-
1];0<c.length&&(d[0]!==b[0]||d[1]!==b[1])&&c.push(b.slice());return c}}});
Singleton("Siesta.Test.UserAgent.KeyCodes",{methods:{isNav:function(a){var b=this.keys;return 33<=a&&40>=a||a==b.RETURN||a==b.TAB||a==b.ESCAPE},isSpecial:function(a){return a===this.keys.BACKSPACE||16<=a&&20>=a||44<=a&&46>=a||112<=a&&123>=a||91===a},isModifier:function(a){return a===this.keys.SHIFT||a===this.keys.CTRL||a===this.keys.ALT||a===this.keys.CMD},fromCharCode:function(a,b){var c=this.keys,d;for(d in c)if(c[d]===a&&(!b||1<d.length))return d}},has:{keys:{init:{"\b":8,BACKSPACE:8,"\t":9,TAB:9,
"\r":13,RETURN:13,ENTER:13,SPACE:32,SHIFT:16,CTRL:17,ALT:18,CMD:91,"PAUSE-BREAK":19,CAPS:20,ESCAPE:27,ESC:27,"NUM-LOCK":144,"SCROLL-LOCK":145,PRINT:44,"PAGE-UP":33,PAGEUP:33,"PAGE-DOWN":34,PAGEDOWN:34,END:35,HOME:36,LEFT:37,ARROWLEFT:37,UP:38,ARROWUP:38,RIGHT:39,ARROWRIGHT:39,DOWN:40,ARROWDOWN:40,INSERT:45,DELETE:46," ":32,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,
NUM0:96,NUM1:97,NUM2:98,NUM3:99,NUM4:100,NUM5:101,NUM6:102,NUM7:103,NUM8:104,NUM9:105,"*":106,"+":107,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123}},keyNameMap:{init:{8:"Backspace",9:"Tab",13:"Enter",32:"Space",16:"Shift",17:"Control",18:"Alt",91:"Meta",20:"CapsLock",27:"Escape",144:"NumLock",145:"ScrollLock",44:"Print",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",
38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",106:"Multiply",107:"Add",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12"}}}});
Role("Siesta.Test.Simulate.Keyboard",{requires:["$","simulateEvent","isEventPrevented"],does:[Siesta.Util.Role.CanFormatStrings,Siesta.Test.Browser.Role.CanWorkWithKeyboard],has:{keyboardEventName:"KeyboardEvent"in window&&bowser.gecko?"KeyboardEvent":"KeyEvent"in window?"KeyEvents":null},methods:{createKeyboardEvent:function(a,b,c){var d;c=c.ownerDocument;b=$.extend({bubbles:!0,cancelable:!0,view:this.global,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:0,charCode:0,key:b.key||""},b);if(c.createEvent&&
"dispatchEvent"==this.getSimulateEventsWith()){try{"KeyboardEvent"===this.keyboardEventName&&(d=new KeyboardEvent(a,b))}catch(e){d=null}d||(d=c.createEvent("Events"),d.initEvent(a,b.bubbles,b.cancelable),$.extend(d,{view:b.view,ctrlKey:b.ctrlKey,altKey:b.altKey,shiftKey:b.shiftKey,metaKey:b.metaKey,keyCode:b.keyCode,charCode:b.charCode,key:b.key||"",code:b.code}))}else c.createEventObject&&(d=c.createEventObject(),$.extend(d,b));if(bowser.msie||bowser.opera)d.keyCode=0<b.charCode?b.charCode:b.keyCode,
d.charCode=void 0;return d},createTextEvent:function(a,b,c){c=c.ownerDocument;var d=null;if(c.createEvent)try{if((d=c.createEvent("TextEvent"))&&d.initTextEvent)return d.initTextEvent(a,!0,!0,this.global,b.text,0,window.navigator.userLanguage||window.navigator.language),d}catch(e){}return null},findNextFocusable:function(a,b){var c=this.$(a),d=this.$(":focus, :input, a[href], [tabindex], body",a.ownerDocument).not(":disabled").not(":hidden").not("a[href]:empty"),e=!1,f;"INPUT"===a.tagName&&"radio"===
a.type&&""!==a.name&&(e=!0,f="input[type=radio][name="+a.name.replace(/(!"#$%&'\(\)\*\+,\.\/:;<=>\?@\[\]^`\{\|\}~)/g,"\\\\$1")+"]");for(var g=[],k=0;k<d.length;k++){var l=d[k];l!=a&&-1==l.getAttribute("tabIndex")||e&&$(l).is(f)||g.push(l)}var m=a.ownerDocument.body,n=a.getAttribute("tabIndex"),r=function(b){return b==a&&-1==n||b==m?0:b.getAttribute("tabIndex")||0};g.sort(function(a,b){var c=r(a),d=r(b);return c<d?-1:c>d?1:a==m?1:b==m?-1:0});c=$(g).index(c);return-1==c?null:g[(c+b)%g.length]},emulateTab:function(a,
b){var c=this.findNextFocusable(a,b||1);c?this.test.focus(c):a.blur();return c},simulateType:function(a,b,c){if(null==a)throw"Must supply a string to type";var d=this,e=c.el;if(e.disabled)return Promise.resolve();"value"in e&&e.setAttribute("__lastValue",e.value);var f=this.extractKeysAndSpecialKeys(a+""),g=new Siesta.Util.Queue({deferer:this.test.originalSetTimeout,deferClearer:this.test.originalClearTimeout,interval:this.actionDelay,callbackDelay:0,observeTest:this.test,processor:function(a,c){var f=
d.activeElement(!0,e,e);d.simulateKeyPress(f,a.key,b)}});c.focus&&(g.addStep({processor:function(){d.nodeIsOrphan(e)||d.focus(e)}}),bowser.msie&&g.addStep({processor:function(){d.nodeIsOrphan(e)||d.focus(e)}}));Joose.A.each(f,function(a,b){a=1==a.length?a:a.substring(1,a.length-1);f[b]=a;g.addStep({key:a})});if(!e.readOnly&&f.length&&(a=Siesta.Test.UserAgent.KeyCodes().keys[f[0].toUpperCase()],this.isReadableKey(a)&&(a=this.test.getSelectedText(e))&&"value"in e&&"selectionStart"in e)){var k;try{k=
e.selectionStart}catch(l){}null!=k&&(this.silentSetValue(e,e.value.substr(0,k)+e.value.substr(k+a.length),"value"),this.test.setCaretPosition(e,k))}return new Promise(function(a,b){g.run(a)})},simulateKeyPress:function(a,b,c){var d=bowser.mac,e=Siesta.Test.UserAgent.KeyCodes().keys,f=Siesta.Test.UserAgent.KeyCodes().keyNameMap,g=e[b.toUpperCase()]||0,k=a=this.test.normalizeElement(a);c=c||{};c.readableKey=b;var d=d&&c.metaKey||!d&&c.ctrlKey,l=this.isReadableKey(g),m=l&&!d?b.charCodeAt(0):0;c.key=
l?b:f[g]||"";c.code=f[g];var f=this.isTextInput(a),n=this.isEditableNode(a),r=f||n,p="value"in a?"value":"innerHTML",q=a[p].length,t=this.simulateEvent(a,"keydown",Joose.O.extend({charCode:0,keyCode:g},c)),v=this.isEventPrevented(t);if(!r||!this.mimicTextSelection(t,a)){var z=!1,t=Siesta.Project.Browser.FeatureSupport().supports;a=this.activeElement(!0,a,a);d||v||(m=this.simulateEvent(a,"keypress",Joose.O.extend({charCode:m,keyCode:l?0:g},c)),(z=this.isEventPrevented(m))||g!==e.TAB||(a=this.emulateTab(a,
c.shiftKey?-1:1)||a));!v&&r&&g!=e.TAB&&(!l||d||z?this.mimicCaretMovement(a,g):(n&&bowser.msie&&(d=a.innerHTML,0===d.indexOf("&nbsp;")?(a.innerHTML=d.substring(6),q=a.innerHTML.length):0===d.indexOf("<br>")&&(a.innerHTML=d.substring(4),q=a.innerHTML.length)),n&&!bowser.msie?(d=a.innerHTML,8203===d.charCodeAt(d.length-1)&&(a.innerHTML=d.substring(0,d.length-1)),a.ownerDocument.execCommand("insertText",!1,c.readableKey)):this.simulateEvent(a,bowser.msie?"textinput":"textInput",{text:c.readableKey}),
this.mimicCharacterInsertion(a,b,c,q)),(g===e.BACKSPACE||g===e.DELETE)&&!t.canSimulateBackspace&&0<a[p].length&&this.mimicCharacterDeletion(a,g,c),"value"!==p||g!==e.ENTER||z||(f&&this.maybeMimicChangeEvent(k),t.enterSubmitsForm||this.mimicFormSubmit(a)))}this.mimicClickOnEnter(a,g);this.simulateEvent(a,"keyup",$.extend({charCode:0,keyCode:g},c));return Promise.resolve()},mimicCharacterInsertion:function(a,b,c,d){var e="value"in a?"value":"innerHTML",f=a.getAttribute("maxlength")||Infinity,g=this.isTextInput(a),
k=Siesta.Project.Browser.FeatureSupport().supports;null!=f&&(f=Number(f));!a.readOnly&&(g||bowser.msie)&&!k.canSimulateKeyCharacters&&d===a[e].length&&d<f&&(d=a[e],f=this.test.getCaretPosition(a),void 0==f&&(f=d.length),this.silentSetValue(a,d.substr(0,f)+b+d.substr(f),e),this.test.setCaretPosition(a,f+1),this.simulateEvent(a,"input",c))},silentSetValue:function(a,b,c){var d=this.global.Object;d.getOwnPropertyDescriptor&&"value"==c?d.getOwnPropertyDescriptor(a.constructor.prototype,c).set.call(a,
b):a[c]=b},mimicTextSelection:function(a,b){var c=bowser.mac,d=Siesta.Test.UserAgent.KeyCodes().keys,e=!1,c=!c&&a.ctrlKey||a.metaKey&&c;switch(a.keyCode){case d.A:c&&(this.test.selectText(b),e=!0);break;case d.LEFT:case d.HOME:a.shiftKey&&(this.test.selectText(b,0,this.test.getCaretPosition(b)),e=!0);break;case d.RIGHT:case d.END:a.shiftKey&&(this.test.selectText(b,this.test.getCaretPosition(b)),e=!0)}return e},mimicClickOnEnter:function(a,b){var c=a.nodeName&&a.nodeName.toLowerCase(),d=Siesta.Project.Browser.FeatureSupport().supports,
e=Siesta.Test.UserAgent.KeyCodes().keys;"a"!=c&&"button"!=c||b!==e.ENTER||d.enterOnAnchorTriggersClick||this.simulateEvent(a,"click",{doNotUpdateCurrentPosition:!0})},mimicCaretMovement:function(a,b){var c=a.nodeName&&a.nodeName.toLowerCase();if("input"==c||"textarea"==c)switch(c=Siesta.Test.UserAgent.KeyCodes().keys,b){case c.HOME:this.test.setCaretPosition(a,0);break;case c.LEFT:if(c=this.test.getSelectedText(a)){var d=this.test.getCaretPosition(a);this.test.selectText(a,d,d)}else this.test.moveCaretPosition(a,
-1);break;case c.RIGHT:(c=this.test.getSelectedText(a))?(d=this.test.getCaretPosition(a),this.test.selectText(a,d+c.length,d+c.length)):this.test.moveCaretPosition(a,1);break;case c.END:this.test.setCaretPosition(a,a.value.length)}},mimicFormSubmit:function(a){a=this.$(a).closest("form");if(a.length){var b=a.find(":submit")[0],c=1===a.find("input").length;b?b.click():c&&(this.isEventPrevented(this.simulateEvent(a[0],"submit",{}))||a[0].submit())}},mimicCharacterDeletion:function(a,b,c){var d=this.isTextInput(a);
if(!a.readOnly)if(d||bowser.msie){var d="value"in a?"value":"innerHTML",e=a[d],f=this.test.getSelectedText(a)||"",g=this.test.getCaretPosition(a),k=!1;null!=g&&f?(this.silentSetValue(a,e.substring(0,g)+e.substring(g+f.length),d),k=!0):(f=Siesta.Test.UserAgent.KeyCodes().keys,g=null==g?e.length:g,b===f.BACKSPACE?0<g&&(k=!0,this.silentSetValue(a,e.substring(0,g-1)+e.substring(g),d),--g):(g<e.length&&(k=!0),this.silentSetValue(a,(0<g?e.substring(0,g+1):"")+e.substring(g+1),d)));this.test.setCaretPosition(a,
g);k&&this.simulateEvent(a,"input",c)}else a.ownerDocument.execCommand("delete")},maybeMimicChangeEvent:function(a){a.getAttribute("__lastValue")!==a.value&&(this.simulateEvent(a,"change"),a.setAttribute("__lastValue",a.value))}}});
Role("Siesta.Test.Simulate.Event",{does:[JooseX.Observable],requires:["$","typeOf","createTextEvent","createMouseEvent","createKeyboardEvent"],has:{bowser:function(){return bowser},browser:function(){return bowser},actionDelay:100,afterActionDelay:100,simulateEventsWith:{is:"rw",lazy:function(){return"dispatchEvent"}}},methods:{normalizeEventName:function(a){return a},simulateEvent:function(a,b,c){c=c||{};"Array"==this.typeOf(a)&&(0==a.length&&(a=this.currentPosition.slice()),"clientX"in c||(c.clientX=
a[0]),"clientY"in c||(c.clientY=a[1]));a=this.test.normalizeElement(a);b=this.normalizeEventName(b);var d=this.createEvent(b,c,a);d&&this.maintainScrollPositionDuring(function(){d.synthetic=!0;this.mimicBrowserBehaviorBefore(d,b,a);this.dispatchEvent(a,b,d);!this.isEventPrevented(d)&&this.mimicBrowserBehaviorAfter(d,b,a)});this.fireEvent("eventsimulated",d,a,b,c);return d},createEvent:function(a,b,c){if((a=/^textinput$/i.test(a)?this.createTextEvent(a,b,c):/^mouse(over|out|down|up|move|enter|leave)|contextmenu|wheel|(dbl)?click$/.test(a)||
/^(ms)?pointer/i.test(a)?this.createMouseEvent(a,b,c):/^key(up|down|press)$/.test(a)?this.createKeyboardEvent(a,b,c):/^change$|^input$|^submit/.test(a)?this.createGenericEvent(a,b,c):this.createHtmlEvent(a,b,c))&&bowser.msie&&9<=bowser.version){var d=a.preventDefault;a.preventDefault=function(){arguments.callee.$prevented=!0;this.returnValue=!1;return d&&d.apply(this,arguments)}}return a},isEventPrevented:function(a){return a.preventDefault&&"Boolean"==this.typeOf(a.preventDefault.$prevented)?a.preventDefault.$prevented:
"Boolean"==this.typeOf(a.defaultPrevented)?a.defaultPrevented:!1===a.returnValue},createGenericEvent:function(a,b,c){var d=c.ownerDocument;if(d.createEvent&&"dispatchEvent"==this.getSimulateEventsWith())return b=d.createEvent("Events"),b.initEvent(a,!0,!0),b;if(d.createEventObject)return d=d.createEventObject(),d.srcElement=c,d.bubbles=b.bubbles,d.cancelBubble=!b.bubbles,d.type=a,d},createHtmlEvent:function(a,b,c){b=c.ownerDocument;if(b.createEvent&&"dispatchEvent"==this.getSimulateEventsWith())return b=
b.createEvent("HTMLEvents"),b.initEvent(a,!1,!1),b;if(b.createEventObject)return b.createEventObject()},dispatchEvent:function(a,b,c){if(a.dispatchEvent&&"dispatchEvent"==this.getSimulateEventsWith())a.dispatchEvent(c);else if(a.fireEvent)try{a.fireEvent("on"+b.toLowerCase(),c)}catch(d){}else throw"Can't dispatch event: "+b;return c},mimicBrowserBehaviorBefore:function(a,b,c){},mimicBrowserBehaviorAfter:function(a,b,c){var d=c.tagName.toLowerCase();switch(b){case "mousedown":this.isTextInput(c)&&
this.mimicClearTextSelection(c);break;case "click":bowser.msie&&11>bowser.version&&"a"===d&&c.getAttribute("href")?this.mimicHashUpdate(c):"option"!==d||c.getAttribute("disabled")||this.mimicOptionSelect(c);break;case "dblclick":this.isTextInput(c)&&this.mimicDblClickTextSelection(c);break;case "keydown":b=Siesta.Test.UserAgent.KeyCodes().keys,a.keyCode===b.BACKSPACE&&this.mimicHistoryChangeAfterBackspace(a,c)}},mimicClearTextSelection:function(a){var b=this.global.Ext&&this.global.Ext.versions,b=
b&&b.extjs&&b.extjs.equals("5.1.0.107");if(!bowser.msie||!b||9<bowser.version)this.test.selectText(a,a.value.length-1,a.value.length),this.test.setCaretPosition(a,a.value.length)},mimicDblClickTextSelection:function(a){this.test.selectText(a)},mimicHashUpdate:function(a){if(a=a.getAttribute("href").match(/#(.*)/))this.global.location.hash=a[1]},mimicHistoryChangeAfterBackspace:function(a,b){if(!bowser.webkit&&!bowser.blink){var c=b.ownerDocument;b.isContentEditable||"on"===c.designMode.toLowerCase()||
this.isTextInput(b)||(c=b.ownerDocument.defaultView||b.ownerDocument.parentWindow,a.shiftKey?this.mimicNextHistory(c):this.mimicPreviousHistory(c))}},mimicPreviousHistory:function(a){a.history.back()},mimicNextHistory:function(a){a.history.forward()},mimicOptionSelect:function(a){var b=this.$(a).closest("select")[0],c=b.value;b.value=a.value;c!==a.value&&this.simulateEvent(b,"change")}}});
Role("Siesta.Test.Simulate.Touch",{requires:[],has:{touchEventNamesMap:{lazy:"this.buildTouchEventNamesMap"},currentTouchId:1,activeTouches:Joose.I.Object,longPressDelay:{init:1500,is:"rw"},forceTouchEvents:bowser.chrome},methods:{simulateTap:function(a,b){var c=new Siesta.Util.Queue({deferer:this.test.originalSetTimeout,deferClearer:this.test.originalClearTimeout,interval:30,observeTest:this.test}),d=this,e;c.addStep({processor:function(){e=d.touchStart(null,null,b,a)}});c.addStep({processor:function(){d.touchEnd(e,
b)}});return new Promise(function(a,b){c.run(a)})},simulateDoubleTap:function(a,b){var c=new Siesta.Util.Queue({deferer:this.test.originalSetTimeout,deferClearer:this.test.originalClearTimeout,interval:30,observeTest:this.test}),d=this,e;c.addStep({processor:function(){e=d.touchStart(null,null,b,a)}});c.addStep({processor:function(){d.touchEnd(e,b)}});c.addStep({processor:function(){e=d.touchStart(null,null,b,a)}});c.addStep({processor:function(){d.touchEnd(e,b)}});return new Promise(function(a,b){c.run(a)})},
simulateLongPress:function(a,b){var c=new Siesta.Util.Queue({deferer:this.test.originalSetTimeout,deferClearer:this.test.originalClearTimeout,interval:30,observeTest:this.test}),d=this,e;c.addStep({processor:function(){e=d.touchStart(null,null,b,a)}});c.addDelayStep(this.getLongPressDelay());c.addStep({processor:function(){d.touchEnd(e,b)}});return new Promise(function(a,b){c.run(a)})},simulatePinch:function(a,b,c){var d=new Siesta.Util.Queue({deferer:this.test.originalSetTimeout,deferClearer:this.test.originalClearTimeout,
interval:30,observeTest:this.test}),e,f,g=a.localXY[0]-b.localXY[0],k=a.localXY[1]-b.localXY[1],l=Math.sqrt(g*g+k*k);1>l&&(l=1);var l=(l*scale-l)/2,g=Math.atan(k/g),m=Math.round(a.localXY[0]-l*Math.cos(g)),n=Math.round(a.localXY[1]-l*Math.sin(g)),r=Math.round(b.localXY[0]+l*Math.cos(g)),p=Math.round(b.localXY[1]+l*Math.sin(g)),q=Joose.O.extend({},c);d.addStep({processor:function(){e=me.touchStart(null,null,c,a);f=me.touchStart(null,null,q,b)}});d.addAsyncStep({processor:function(a){var b=!1,d=!1;
me.touchMove(e,m,n,function(){(b=!0,d)&&a.next()},null,c);me.touchMove(f,r,p,function(){d=!0;b&&d&&a.next()},null,q)}});d.addStep({processor:function(){me.touchEnd(e,c);me.touchEnd(f,q)}});return new Promise(function(a,b){d.run(a)})},simulateTouchDrag:function(a,b,c,d){var e=this;c=c||{};e.elementFromPoint(a[0],a[1],!0);e.elementFromPoint(b[0],b[1],!0);var f=new Siesta.Util.Queue({deferer:this.test.originalSetTimeout,deferClearer:this.test.originalClearTimeout,interval:e.dragDelay,callbackDelay:e.afterActionDelay,
observeTest:this.test}),g;f.addStep({processor:function(){g=e.touchStart(a,null,c)}});f.addAsyncStep({processor:function(a){e.touchMove(g,b[0],b[1],c).then(a.next)}});f.addStep({processor:function(){d||e.touchEnd(g,c)}});return new Promise(function(a,b){f.run(function(){d?a(g):a()})})},touchStart:function(a,b,c,d){d||(d=this.test.getNormalizedTopElementInfo(a,!0,"touchStart",b));c=Joose.O.extend({clientX:d.localXY[0],clientY:d.localXY[1]},c||{});a=this.simulateTouchEventGeneric(d.el,"start",c);return a.pointerId||
a.changedTouches[0].identifier},touchEnd:function(a,b){var c=this.activeTouches[a];if(!c)throw"Can't find active touch: "+a;b=Joose.O.extend({clientX:c.clientX,clientY:c.clientY},b||{});this.test.isInDom(c.target)||(c.target=this.global.document.body);this.simulateTouchEventGeneric(c.currentEl||c.target,"end",b,{touchId:a})},touchMove:function(a,b,c,d){var e=this.activeTouches[a];if(!e)throw"Can't find active touch: "+a;var f=this,g=[];return this.movePointerTemplate({xy:[e.clientX,e.clientY],xy2:[b,
c],options:d||{},overEls:g,interval:f.dragDelay,callbackDelay:f.afterActionDelay,pathBatchSize:f.pathBatchSize,onVoidOverEls:function(){return g=[]},onPointerEnter:function(a,b){},onPointerLeave:function(a,b){},onPointerOver:function(a,b){},onPointerOut:function(a,b){},onPointerMove:function(b,c){e.clientX=c.clientX;e.clientY=c.clientY;e.pageX=f.viewportXtoPageX(c.clientX);e.pageY=f.viewportYtoPageY(c.clientY);e.currentEl=b;f.simulateTouchEventGeneric(b,"move",c,{touchId:a})}})},touchCancel:function(a,
b){var c=this.activeTouches[a];if(!c)throw"Can't find active touch: "+a;this.simulateTouchEventGeneric(c.currentEl||c.target,"cancel",b,{touchId:a})},simulatePointerEventModern:function(a,b,c,d){a=this.test.normalizeElement(a);if(!a)return!1;Siesta.Project.Browser.FeatureSupport();c=c||{};if(/pointerdown$/i.test(b)&&!("clientX"in c&&"clientY"in c)){var e=this.test.findCenter(a);c=Joose.O.extend({clientX:e[0],clientY:e[1]},c)}e=this.global.document;b=new PointerEvent(b,{bubbles:!0,cancelable:!0,view:this.global,
detail:c.detail,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY,ctrlKey:c.ctrlKey||!1,altKey:c.altKey||!1,shiftKey:c.shiftKey||!1,metaKey:c.metaKey||!1,button:c.button,relatedTarget:c.relatedTarget||e.documentElement,pointerId:d.touchId||this.currentTouchId++,pointerType:4});a.dispatchEvent(b);return b},simulatePointerEvent:function(a,b,c,d){var e=Siesta.Project.Browser.FeatureSupport().supports;if(e.PointerEvents&&this.bowser.chrome)return this.simulatePointerEventModern(a,
b,c,d);a=this.test.normalizeElement(a);if(!a)return!1;c=c||{};var f=this.global.document,g=f.createEvent(e.PointerEvents?"PointerEvent":e.MSPointerEvents?"MSPointerEvent":"MouseEvents");if(/pointerdown$/i.test(b)&&!("clientX"in c&&"clientY"in c)){var k=this.test.findCenter(a);c=Joose.O.extend({clientX:k[0],clientY:k[1]},c)}g[e.MSPointerEvents||e.PointerEvents?"initPointerEvent":"initMouseEvent"](b,!0,!0,this.global,c.detail,c.screenX,c.screenY,c.clientX,c.clientY,c.ctrlKey||!1,c.altKey||!1,c.shiftKey||
!1,c.metaKey||!1,c.button,c.relatedTarget||f.documentElement,null,null,null,null,null,null,null,null,d.touchId||this.currentTouchId++,4,null,null);e.MSPointerEvents||e.PointerEvents||(g.pointerId=d.touchId||this.currentTouchId++);a.dispatchEvent(g);return g},simulateTouchEvent:function(a,b,c,d){c=c||{};b=new this.global.CustomEvent(b,{bubbles:!0,cancelable:!0});a=this.test.normalizeElement(a);"clientX"in c&&"clientY"in c||this.test.findCenter(a);var e=this.activeTouches;d=d.touch;var f=[],g=[],k;
for(k in e){var l=e[k];f.push(l);l.target==a&&g.push(l)}Joose.O.extend(b,{target:a,changedTouches:this.createTouchList([d]),touches:this.createTouchList(f),targetTouches:this.createTouchList(g),altKey:c.altKey,metaKey:c.metaKey,ctrlKey:c.ctrlKey,shiftKey:c.shiftKey});a.dispatchEvent(b);return b},createTouchList:function(a){var b=this.global.document;if(b.createTouch){for(var c=[],d=0;d<a.length;d++){var e=a[d];c.push(b.createTouch(b.defaultView||b.parentWindow,e.target,e.identifier||this.currentTouchId++,
e.pageX,e.pageY,e.screenX||e.pageX,e.screenY||e.pageY,e.clientX,e.clientY))}return b.createTouchList.apply(b,c)}return a},createTouch:function(a,b,c){return{identifier:this.currentTouchId++,target:a,clientX:b,clientY:c,screenX:0,screenY:0,pageX:b,pageY:c}},buildTouchEventNamesMap:function(){var a=Siesta.Project.Browser.FeatureSupport().supports;return a.PointerEvents&&!this.forceTouchEvents?{start:"pointerdown",move:"pointermove",end:"pointerup",cancel:"pointercancel"}:a.MSPointerEvents?{start:"MSPointerDown",
move:"MSPointerMove",end:"MSPointerUp",cancel:"MSPointerCancel"}:{start:"touchstart",move:"touchmove",end:"touchend",cancel:"touchcancel"}},simulateTouchEventGeneric:function(a,b,c,d){d=d||{};a=this.test.normalizeElement(a);var e,f;"clientX"in c&&"clientY"in c?(e=c.clientX,f=c.clientY):(f=this.test.findCenter(a),e=f[0],f=f[1]);var g=this.activeTouches,k;"end"===b||"cancel"===b?(k=g[d.touchId],a=k.currentEl||k.target,delete g[d.touchId]):"start"==b?(k=this.createTouch(a,e,f),g[k.identifier]=k):"move"==
b&&(k=g[d.touchId],k.clientX=c.clientX,k.clientY=c.clientY);if(!k)throw"Can't find active touch"+(d.touchId?": "+d.touchId:"");d.touchId||(d.touchId=k.identifier);d.touch=k;b=this.getTouchEventNamesMap()[b];e=Siesta.Project.Browser.FeatureSupport().supports;return!e.PointerEvents&&!e.MSPointerEvents||this.forceTouchEvents?this.simulateTouchEvent(a,b,c,d):this.simulatePointerEvent(a,b,c,d)}}});
Class("Siesta.Test.Simulator",{does:[Siesta.Util.Role.CanGetType,Siesta.Test.Browser.Role.CanRebindJQueryContext,Siesta.Test.Simulate.Event,Siesta.Test.Simulate.Mouse,Siesta.Test.Simulate.Keyboard,Siesta.Test.Simulate.Touch],has:{type:"synthetic",test:null,global:null},methods:{initialize:function(){this.SUPER();this.onBlur=this.onBlur.bind(this)},onTestLaunch:function(a){this.test=a;this.global=a.global;"synthetic"===this.type&&(Siesta.Project.Browser.FeatureSupport().supports.inputFiresChangeAfterLosingFocus||
this.global.document.documentElement.addEventListener("blur",this.onBlur,!0))},onBlur:function(a){a.target&&this.test.isTextInput(a.target)&&this.maybeMimicChangeEvent(a.target)},cleanup:function(){this.global&&this.global.document.documentElement.removeEventListener("blur",this.onBlur,!0);this.global=this.test=null}}});
Class("Siesta.Test.SimulatorExtJS",{isa:Siesta.Test.Simulator,has:{simulateEventsWith:{is:"rw",lazy:function(){var a=navigator.userAgent.match(/MSIE 9.0;/),b=this.global.Ext;if(!b||!b.getVersion)return"dispatchEvent";b=b.getVersion("extjs");b=!!(b&&b.isLessThan&&b.isLessThan("4.2.1.883"));return document.createElement("div").attachEvent&&(a||b)?"fireEvent":"dispatchEvent"}}},methods:{simulateMouseClick:function(a,b){var c=this,d=a.el,e=this.global.Ext,e=e&&e.getVersion&&e.getVersion("extjs")&&5==
e.getVersion("extjs").major;if("fireEvent"!==this.getSimulateEventsWith()&&!e||"checkbox"!==d.type&&"radio"!==d.type||d.disabled||d.readOnly)return this.SUPERARG(arguments);var f=d.checked;return this.SUPER(a,b).then(function(){if(d.checked===f){d.checked=!f;var a=Joose.O.copy(b);a.bubbles=!0;c.simulateEvent(d,"change",a)}})}}});
Role("Siesta.Test.UserAgent.Mouse",{requires:[],has:{currentPosition:null,moveCursorBetweenPoints:!0,enableUnreachableClickWarning:!0,autoScrollElementsIntoView:!0,delayAfterScrollIntoView:200},methods:{setCursorPosition:function(a,b,c){this.doMouseMove(this.simulator.currentPosition,[a,b],c,null,null,{moveKind:"instant"})},moveMouseAlongPath:function(){return this.moveCursorAlongPath.apply(this,arguments)},moveCursorAlongPath:function(a,b){var c=this,d=new Siesta.Util.Queue({deferer:this.originalSetTimeout,
deferClearer:this.originalClearTimeout,interval:0,processor:function(a){var b=a.pathPoint,d,k,l;"Array"==c.typeOf(b)?"Array"==c.typeOf(b[0])?d=b[0]:"String"==c.typeOf(b[0])?(d=b[0],k=3==b.length?[b[1],b[2]]:null):(l=!0,d=b):b.by?(l=!0,d=b.by):(d=b.t||b.target,k=b.o||b.offset);l?c.moveMouseBy(d,a.next,c):c.moveMouseTo(d,a.next,c,k)}});Joose.A.each(a,function(a){d.addStep({isAsync:!0,pathPoint:a})});return new Promise(function(a,f){d.run(function(){c.processCallbackFromTest(b,null,c);a()})})},moveMouseTo:function(a,
b,c,d,e,f){if(!a)throw Error("Trying to call `moveMouseTo` without a target");if(!1!==e)return this.waitForTargetAndSyncMousePosition(a,d,function(){b.call(c||this)},[],!1,void 0,f);var g=this;return new Promise(function(e,l){var m=g.getNormalizedTopElementInfo(a,!0,"moveMouseTo",d);m?g.syncCursor(m.globalXY,function(){b&&b.call(c||g);e()},f):(b&&b.call(c||g),e())})},moveCursorTo:function(a,b,c,d){this.moveMouseTo.apply(this,arguments)},moveMouseBy:function(a,b,c,d){this.moveCursorBy.apply(this,arguments)},
moveCursorBy:function(a,b,c,d){if(!a)throw"Trying to call moveCursorBy without relative distances";return this.doMouseMove(this.simulator.currentPosition,[this.simulator.currentPosition[0]+a[0],this.simulator.currentPosition[1]+a[1]],b,c,void 0,d)},doMouseMove:function(a,b,c,d,e,f){a=this.simulator.simulateMouseMove(b[0],b[1],f,e);return this.runPromiseAsync(a,"mousemove",c,d)},syncCursor:function(a,b,c){var d=this.simulator.currentPosition;a[0]!==d[0]||a[1]!==d[1]?this.doMouseMove(d,a,b,this,void 0,
c):b&&b()},runPromiseAsync:function(a,b,c,d,e){var f=this,g=this.beginAsync(null,function(){f.fail(f.formatString("Action `{actionDesc}` failed to complete within {time}ms",{actionDesc:b,time:this.defaultTimeout}));return!0});return a.then(function(a){f.endAsync(g);f.processCallbackFromTest(c,void 0!==a?[a]:[],d||f)},function(a){f.endAsync(g);e?e(a):f.isFinished()||(f.fail("Command failed: "+a),f.processCallbackFromTest(c,[],d||f))})},waitForTargetAndSyncMousePosition:function(a,b,c,d,e,f,g){var k,
l="Array"!=this.typeOf(a),m=this.suppressPassedWaitForAssertion;this.suppressPassedWaitForAssertion=!0;var n=this;return new Promise(function(r,p){n.chain({waitForAnimations:[]},l&&{waitForElementVisible:a},n.autoScrollElementsIntoView?function(c){!0===n.scrollTargetIntoView(a,b)?n.waitFor(n.delayAfterScrollIntoView,c):c()}:null,function(d){var e=n.getNormalizedTopElementInfo(a,!0,c.toString(),b);e?(k=e.globalXY,n.moveCursorBetweenPoints&&!1!==f?n.syncCursor(k,d,g):d()):n.waitForTarget(a,function(){k=
n.getNormalizedTopElementInfo(a,!0,c.toString(),b).globalXY;n.moveCursorBetweenPoints&&!1!==f?n.syncCursor(k,d,g):d()})},!1!==e&&l&&function(c){n.waitForTarget(a,c,n,null,b)},function(g){var t=(g=n.getNormalizedTopElementInfo(a,!0,c.toString(),b))&&g.globalXY;!l||g&&k[0]===t[0]&&k[1]===t[1]?(n.suppressPassedWaitForAssertion=m,c&&c.apply&&c.apply(n,d),r()):(n.diag(Siesta.Resource("Siesta.Test.Browser","targetMoved")),n.waitFor(100,function(){n.waitForTargetAndSyncMousePosition(a,b,c,d,e,f).then(r,
p)}))})})},getCursorPagePosition:function(){return[this.viewportXtoPageX(this.simulator.currentPosition[0]),this.viewportYtoPageY(this.simulator.currentPosition[1])]},genericMouseAction:function(a,b,c,d,e,f,g){var k=this;"Function"==this.typeOf(a)&&(c=b,b=a,a=null);a=a||this.getCursorPagePosition();g=!1!==g?this.waitForTargetAndSyncMousePosition(a,f,e,void 0,void 0,void 0,d):Promise.resolve();return k.runPromiseAsync(g.then(function(){d=d?Joose.O.copy(d):{};var b=k.getNormalizedTopElementInfo(a,!0,
e,f);if(b)return b.originalEl=a,b.method=e,b.offset=f,d.clientX=null!=d.clientX?d.clientX:b.localXY[0],d.clientY=null!=d.clientY?d.clientY:b.localXY[1],d.testUniqueId=k.uniqueId,k.simulator[e](b,d)}),"generic click",b,c)},click:function(a,b,c,d,e,f){return this.genericMouseAction(a,b,c,d,"simulateMouseClick",e,f)},rightClick:function(a,b,c,d,e,f){return this.genericMouseAction(a,b,c,d,"simulateRightClick",e,f)},doubleClick:function(a,b,c,d,e,f){return this.genericMouseAction(a,b,c,d,"simulateDoubleClick",
e,f)},mouseDown:function(a,b,c,d,e,f){return this.genericMouseAction(a,d,e,b,"simulateMouseDown",c,f)},mouseUp:function(a,b,c,d,e){return this.genericMouseAction(a,d,e,b,"simulateMouseUp",c,!0)},dragTo:function(a,b,c,d,e,f,g,k){var l=this;if(!b)throw Error("No drag target defined");a=a||l.getCursorPagePosition();return new Promise(function(m,n){l.chain({mouseDown:a,offset:g,options:e},function(a){b=l.getNormalizedTopElementInfo(b,!0,"dragTo",k).globalXY;a()},{moveCursorTo:function(){return b},options:e},
f?null:{mouseUp:null,options:e},function(){l.processCallbackFromTest(c,null,d||l);m()})})},dragBy:function(a,b,c,d,e,f,g){var k=this;if(!b)throw Error("No drag delta defined");a=a||this.getCursorPagePosition();return new Promise(function(l,m){k.chain({mouseDown:a,offset:g,options:e},{moveCursorBy:b,options:e},f?null:{mouseUp:null,options:e},function(){k.processCallbackFromTest(c,null,d||k);l()})})},wheel:function(a,b,c,d,e,f){return this.genericMouseAction(a,b,c,d,"simulateMouseWheel",e,f)}}});
Role("Siesta.Test.UserAgent.Keyboard",{requires:["normalizeElement","runPromiseAsync","activeElement"],does:[Siesta.Util.Role.CanFormatStrings,Siesta.Test.Browser.Role.CanWorkWithKeyboard],has:{},methods:{type:function(a,b,c,d,e,f,g){if(null==b)throw"Must supply a string to type";a||(g=!1);a=a||this.activeElement();g=!1!==g?this.waitForTargetAndSyncMousePosition(a,null,"Type: "+b,[],!1,!1):Promise.resolve();var k=this;return k.runPromiseAsync(g.then(function(){if((a=k.normalizeElement(a))&&!a.disabled){f&&
(a.value="");var c=new Siesta.Util.Queue({deferer:k.originalSetTimeout,deferClearer:k.originalClearTimeout,interval:k.simulator.actionDelay,callbackDelay:k.simulator.afterActionDelay,observeTest:k});c.addStep({processor:function(){k.focus(a)}});bowser.msie&&c.addStep({processor:function(){k.focus(a)}});c.addStep({isAsync:!0,processor:function(c){var d=k.simulator.simulateType(b,e,{el:a});k.runPromiseAsync(d,"",c.next)}});return new Promise(function(a,b){c.run(function(){a()})})}}),"type : `"+b+"`",
c,d)},keyPress:function(a,b,c,d,e){"function"===typeof c&&(d=c,c=void 0);return this.type(a,b,d,e,c)}}});
Role("Siesta.Test.UserAgent.Touch",{requires:["normalizeElement"],has:{notSupportedWarned:!1},methods:{checkTouchEventsSupport:function(){var a=Siesta.Project.Browser.FeatureSupport().supports,b=this.getRootTest();a.TouchEvents||a.PointerEvents||a.MSPointerEvents||b.notSupportedWarned||(b.notSupportedWarned=!0,this.warn("Touch events are not supported by browser. For Chrome, you can enable them, by launching it with: --args --touch-events"))},tap:function(a,b,c,d,e,f){this.checkTouchEventsSupport();
a=a||this.getCursorPagePosition();!1!==f&&b?this.waitForTargetAndSyncMousePosition(a,e,this.tap,[a,b,c,d,e,!1]):(a=this.getNormalizedTopElementInfo(a,!0,"tap",e))?this.runPromiseAsync(this.simulator.simulateTap(a,d),"tap",b,c):b&&b.call(c||this)},doubleTap:function(a,b,c,d,e,f){this.checkTouchEventsSupport();a=a||this.getCursorPagePosition();!1!==f&&b?this.waitForTargetAndSyncMousePosition(a,e,this.doubleTap,[a,b,c,d,e,!1]):(a=this.getNormalizedTopElementInfo(a,!0,"doubleTap",e))?this.runPromiseAsync(this.simulator.simulateDoubleTap(a,
d),"doubleTap",b,c):b&&b.call(c||this)},longpress:function(){return this.longPress.apply(this,arguments)},longPress:function(a,b,c,d,e,f){this.checkTouchEventsSupport();a=a||this.getCursorPagePosition();!1!==f&&b?this.waitForTargetAndSyncMousePosition(a,e,this.longPress,[a,b,c,d,e,!1]):(a=this.getNormalizedTopElementInfo(a,!0,"longPress",e))?this.runPromiseAsync(this.simulator.simulateLongPress(a,d),"longPress",b,c):b&&b.call(c||this)},pinch:function(a,b,c,d,e,f,g,k){this.checkTouchEventsSupport();
var l=this;"Number"==this.typeOf(b)&&(k=g,g=f,f=e,e=d,d=c,c=b,b=a);null==b&&(b=a);a!=b||g||k||(g=["25%","50%"],k=["75%","50%"]);c=this.getNormalizedTopElementInfo(a,!0,"pinch: target1",g);var m=this.getNormalizedTopElementInfo(b,!0,"pinch: target2",k);c&&m?this.runPromiseAsync(this.simulator.simulatePinch(c,m,f),"pinch",d,e):(c=Siesta.Resource("Siesta.Test.Browser"),this.waitFor({method:function(){var c=l.normalizeElement(a,!0),d=l.normalizeElement(b,!0);return c&&l.elementIsTop(c,!0,offset)&&d&&
l.elementIsTop(d,!0,offset)},callback:function(){l.pinch(a,b,e,d,e,f,g,k)},assertionName:"waitForTarget",description:" "+c.get("target")+' "'+a+'" and "'+b+'" '+c.get("toAppear")}))},touchDragTo:function(a,b,c,d,e,f,g,k){var l=this,m=this.getNormalizedTopElementInfo(a,!0,"touchDragTo: source",g),n=this.getNormalizedTopElementInfo(b,!0,"touchDragTo: target",k);m&&n?this.runPromiseAsync(this.simulator.simulateTouchDrag(m.localXY,n.localXY,e,f),"touchDragTo",c,d):(m=Siesta.Resource("Siesta.Test.Browser"),
this.waitFor({method:function(){var c=l.normalizeElement(a,!0),d=l.normalizeElement(b,!0);return c&&l.elementIsTop(c,!0,g)&&d&&l.elementIsTop(d,!0,k)},callback:function(){l.touchDragTo(a,b,c,d,e,f,g,k)},assertionName:"waitForTarget",description:" "+m.get("target")+' "'+a+'" and "'+b+'" '+m.get("toAppear")}))},touchDragBy:function(a,b,c,d,e,f,g){var k=this.getNormalizedTopElementInfo(a,!0,"touchDragBy",g);k?(k=k.globalXY,this.runPromiseAsync(this.simulator.simulateTouchDrag(k,[k[0]+b[0],k[1]+b[1]],
e,f),"touchDragBy",c,d)):this.waitForTarget(a,function(){this.touchDragBy(a,b,c,d,e,f,g)},this,null,g)},swipe:function(a,b,c,d,e,f){this.checkTouchEventsSupport();a=a||this.getCursorPagePosition();if(!1!==f&&c)this.waitForTargetAndSyncMousePosition(a,null,this.swipe,[a,b,c,d,e,!1]);else if(f=this.getNormalizedTopElementInfo(a,!0,"swipe")){var g=this.Ext();a=Siesta.Resource("Siesta.Test.SenchaTouch");var k=g.fly(f.el).getBox();f=k.x;var g=k.y,l=k.width,k=k.height,m=f+l/2,n=g+k/2;switch(b){case "u":case "up":b=
[m,g+.9*k];a=[m,g+.1*k];a[1]=Math.min(b[1]-100,a[1]);break;case "d":case "down":b=[m,g+.1*k];a=[m,g+.9*k];a[1]=Math.max(b[1]+100,a[1]);break;case "r":case "right":b=[f+.1*l,n];a=[f+.9*l,n];a[0]=Math.max(b[0]+100,a[0]);break;case "l":case "left":b=[f+.9*l,n];a=[f+.1*l,n];a[0]=Math.min(b[0]-100,a[0]);break;default:throw a.get("invalidSwipeDir")+": "+b;}this.touchDragTo(b,a,c,d,e)}else c&&c.call(d||this)}}});
Role("Siesta.Test.TextSelection",{methods:{getSelectedText:function(a){a=this.normalizeElement(a);if("selectionStart"in a)try{return a.value.substring(a.selectionStart,a.selectionEnd)}catch(c){}a=this.global;var b=a.document;if(a.getSelection)return a.getSelection().toString();if(b.getSelection)return b.getSelection();if(b.selection)return b.selection.createRange().text},selectText:function(a,b,c,d){if((a=this.normalizeElement(a,!0))&&this.elementSupportsSelection(a)){var e=a.value||a.innerHTML,f=
!0;if(0<e.length){b=void 0===b?0:b;c=void 0===c?e.length:c;if(a.setSelectionRange)try{a.setSelectionRange(b,c)}catch(g){}else a.createTextRange&&(f=a.createTextRange(),f.moveStart("character",b),f.moveEnd("character",c-e.length),f.select());f=bowser.gecko||bowser.opera}f&&this.focus(a)}d&&d.call(this)},getCaretPosition:function(a){var b,c=this.global,d=c.document;if("selectionStart"in a)try{b=a.selectionStart}catch(e){b=null}else c.getSelection&&this.isEditableNode(a)?(c=c.getSelection(),c.rangeCount&&
(c=c.getRangeAt(0),c.commonAncestorContainer.parentNode==a&&(b=c.endOffset))):d.selection&&(this.focus(a),b=d.selection.createRange(),b.moveStart("character",-a.value.length),b=b.text.length);return b},setCaretPosition:function(a,b){if(a.createTextRange)try{var c=a.createTextRange();c.move("character",b);c.select()}catch(d){}else if(a.setSelectionRange){this.focus(a);try{a.setSelectionRange(b,b)}catch(d){}}else this.focus(a)},moveCaretPosition:function(a,b){var c=Math.min(Math.max(0,this.getCaretPosition(a)+
b),a.value.length);this.setCaretPosition(a,c)},elementSupportsSelection:function(a){var b=a.tagName.toLowerCase(),c=/^text|password|tel|url|search$/i;return"textarea"===b||"input"===b&&c.test(a.getAttribute("type"))}}});
Role("Siesta.Test.Element",{does:[Siesta.Util.Role.CanCalculatePageScroll],requires:["typeOf","chain","normalizeElement"],has:{allowMonkeyToClickOnAnchors:!1,allowedCharacters:function(){return{special:"ENTER/ESCAPE/PAGE-UP/PAGE-DOWN/END/HOME/UP/RIGHT/DOWN/LEFT/INSERT/DELETE",punctuation:".,/()[]{}\\\"'`~!?@#$%^&_=+-",normal:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"}}},methods:{findCenter:function(a,b){return this.getTargetCoordinate(a,b)},isInDom:function(a){var b=a.ownerDocument;
if(!b)return!1;for(;a&&a!=b.body;)a=a.parentNode;return!!a},normalizeOffset:function(a,b){var c;"Function"==this.typeOf(a)&&(a=a.call(this));a=a&&a.slice()||["50%","50%"];c=this.getBoundingClientRect(b[0]);var d=Math.floor(c.width);d--;var e=Math.floor(c.height);e--;"string"===typeof a[0]&&(c=a[0].split("%"),a[0]=parseInt(a[0].match(/\d+/)[0],10)*d/100,c[1]&&(a[0]+=parseInt(c[1])));a[0]=Math.round(a[0]);"string"===typeof a[1]&&(c=a[1].split("%"),a[1]=parseInt(a[1].match(/\d+/)[0],10)*e/100,c[1]&&
(a[1]+=parseInt(c[1])));a[1]=Math.round(a[1]);return a},getTargetCoordinate:function(a,b,c){var d=this.normalizeElement(a);a=this.$(d);var e=a.offset(),d=d.ownerDocument,d=d.defaultView||d.parentWindow,e=[this.pageXtoViewportX(e.left,d),this.pageYtoViewportY(e.top,d)];c=this.normalizeOffset(c,a);e[0]+=c[0];e[1]+=c[1];!1===b&&d!==this.global&&(b=this.$(d.frameElement).offset(),e[0]+=this.pageXtoViewportX(b.left),e[1]+=this.pageYtoViewportY(b.top));return e},isElementVisible:function(a){(a=this.normalizeElement(a))&&
"option"===a.nodeName.toLowerCase()&&(a=this.$(a).closest("select")[0]);if(a){try{if(window.SVGElement&&a instanceof this.global.SVGElement)return"none"!==a.style.display&&"hidden"!==a.style.visibility}catch(b){}return this.$(a).is(":visible")&&"hidden"!==this.$(a).css("visibility")}return!1},assertTextPresent:function(a,b){this.like(this.global.document.body.innerText,a,b)},contentLike:function(a,b,c){a=this.normalizeElement(a);this.like(a.innerHTML,b,c)},contentNotLike:function(a,b,c){a=this.normalizeElement(a);
this.unlike(a.innerHTML,b,c)},waitForContentLike:function(a,b,c,d,e){var f=Siesta.Resource("Siesta.Test.Element");a=this.normalizeElement(a);return this.waitFor({method:function(){return a.innerHTML.match(b)},callback:c,scope:d,timeout:e,assertionName:"waitForContentLike",description:" "+f.get("elementContent")+' "'+b+'" '+f.get("toAppear")})},waitForContentNotLike:function(a,b,c,d,e){var f=Siesta.Resource("Siesta.Test.Element");a=this.normalizeElement(a);return this.waitFor({method:function(){return!a.innerHTML.match(b)},
callback:c,scope:d,timeout:e,assertionName:"waitForContentNotLike",description:" "+f.get("elementContent")+' "'+b+'" '+f.get("toDisappear")})},getRandomTypeString:function(a){for(var b=this.allowedCharacters,c=b.special.split("/"),d=b.punctuation,b=b.normal,e=c.length+d.length+b.length,f="",g=0;g<a;g++){var k=this.randomBetween(0,e-1);k<b.length?f+=b.substr(k,1):(k-=b.length,k<d.length?f+=d.substr(k,1):(k-=d.length,f+="["+c[k]+"]"))}return f},monkeyTest:function(a,b,c,d,e,f){a=this.normalizeElement(a,
!1,!0);this.suppressPassedWaitForAssertion=!0;"function"===typeof b?(d=b,e=c,c=""):"function"===typeof c&&(d=c,c="");b="number"===typeof b?b:30;var g=this.global,k=a==g.document.body,l=this,m=l.$(a).offset(),n=m.left+l.$(k?g:a).width(),r=m.top+l.$(k?g:a).height(),p=[],q=Siesta.Resource("Siesta.Test.Element"),t=new Siesta.Util.Queue({deferer:l.originalSetTimeout,deferClearer:l.originalClearTimeout,interval:50,observeTest:this,processor:function(a){if(l.nbrExceptions||l.failed)w(),t.abort();else{var b=
l.beginAsync(null,function(a){a.fail(c||q.get("monkeyNoExceptions"),q.get("monkeyActionLog")+":"+JSON.stringify(p));return!0}),d=a.next;a.next=function(){f&&f(a);l.endAsync(b);d()};a.action(a)}}});a=[];a.length=b;var v=function(a,b){var c=l.normalizeElement(a.dragFrom||a.xy),d=a.dragTo&&l.normalizeElement(a.dragTo);return c&&("a"==c.tagName.toLowerCase()||0<$(c).closest("a").length)||d&&("a"==d.tagName.toLowerCase()||0<$(d).closest("a").length)?(a.next(),!0):!1};Joose.A.each(a,function(a,b){t.addAsyncStep({action:function(a){l.waitForSelector("body",
a.next)}});var c=[l.randomBetween(m.left,n),l.randomBetween(m.top,r)];switch(l.randomBetween(0,4)){case 0:t.addAsyncStep({action:function(a){v(a)||(p.push({click:c}),l.click(a.xy,a.next))},xy:c});break;case 1:t.addAsyncStep({action:function(a){v(a)||(p.push({doubleclick:c}),l.doubleClick(a.xy,a.next))},xy:c});break;case 2:t.addAsyncStep({action:function(a){"native"!=l.simulator.type&&"oncontextmenu"in window?(p.push({rightclick:c}),l.rightClick(a.xy,a.next)):v(a)||(p.push({click:c}),l.click(a.xy,
a.next))},xy:c});break;case 3:var d=[l.randomBetween(m.left,n),l.randomBetween(m.top,r)];t.addAsyncStep({action:function(a){v(a)||(p.push({action:"drag",target:c,to:d}),l.dragTo(a.dragFrom,a.dragTo,a.next))},dragFrom:c,dragTo:d});break;case 4:var e=l.getRandomTypeString(15);t.addAsyncStep({action:function(a){v(a)||(p.push({click:c}),l.click(a.xy,function(){l.waitForSelector("body",function(){p.push({type:e.replace("'","\\'")});l.type(null,e,a.next)})}))},xy:c})}});var z=!1,w=function(){z=!0;l.nbrExceptions||
l.failed?l.fail(c||q.get("monkeyNoExceptions"),q.get("monkeyActionLog")+":"+JSON.stringify(p)):l.pass(c||q.get("monkeyNoExceptions"))};this.on("beforetestfinalizeearly",w);t.run(function(){z||(l.un("beforetestfinalizeearly",w),w());this.suppressPassedWaitForAssertion=!1;l.processCallbackFromTest(d,[p],e||l)})},hasCls:function(a,b,c){var d=Siesta.Resource("Siesta.Test.Element");a=this.normalizeElement(a);this.$(a).hasClass(b)?this.pass(c,{descTpl:d.get("elementHasClass")+" {cls}",cls:b}):this.fail(c,
{assertionName:"hasCls",got:a.className,gotDesc:d.get("elementClasses"),need:b,needDesc:d.get("needClass")})},hasNotCls:function(a,b,c){var d=Siesta.Resource("Siesta.Test.Element");a=this.normalizeElement(a);this.$(a).hasClass(b)?this.fail(c,{assertionName:"hasNotCls",got:a.className,gotDesc:d.get("elementClasses"),annotation:d.get("elementHasClass")+" ["+b+"]"}):this.pass(c,{descTpl:d.get("elementHasNoClass")+" {cls}",cls:b})},hasStyle:function(a,b,c,d){var e=Siesta.Resource("Siesta.Test.Element");
a=this.normalizeElement(a);this.$(a).css(b)===c?this.pass(d,{descTpl:e.get("hasStyleDescTpl"),value:c,property:b}):this.fail(d,{assertionName:"hasStyle",got:this.$(a).css(b),gotDesc:e.get("elementStyles"),need:c,needDesc:e.get("needStyle")})},hasNotStyle:function(a,b,c,d){var e=Siesta.Resource("Siesta.Test.Element");a=this.normalizeElement(a);this.$(a).css(b)!==c?this.pass(d,{descTpl:e.get("hasNotStyleDescTpl"),value:c,property:b}):this.fail(d,{assertionName:"hasNotStyle",got:a.style.toString(),gotDesc:e.get("elementStyles"),
annotation:e.get("hasTheStyle")+" ["+b+"]"})},waitForSelectorAt:function(a,b,c,d,e){var f=Siesta.Resource("Siesta.Test.Element");if(!b)throw f.get("noCssSelector");var g=this;return this.waitFor({method:function(){var c=g.elementFromPoint(a[0],a[1],!0);if(c&&g.$(c).is(b))return c},callback:c,scope:d,timeout:e,assertionName:"waitForSelectorAt",description:" "+f.get("selector")+' "'+b+'" '+f.get("toAppearAt")+": ["+a.toString()+"]"})},waitForSelectorAtCursor:function(a,b,c,d){return this.waitForSelectorAt(this.simulator.currentPosition,
a,b,c,d)},waitForSelector:function(a,b,c,d,e){var f=Siesta.Resource("Siesta.Test.Element"),g=this;if(!a)throw f.get("noCssSelector");"Function"==this.typeOf(b)&&(e=d,d=c,c=b,b=null);b&&(b=this.normalizeElement(b));return this.waitFor({method:function(){var c=g.$(a,b);if(0<c.length)return c},callback:c,scope:d,timeout:e,assertionName:"waitForSelector",description:" "+f.get("selector")+' "'+a+'" '+f.get("toAppear")})},waitForSelectors:function(a,b,c,d,e){var f=Siesta.Resource("Siesta.Test.Element");
if(1>a.length)throw f.get("waitForSelectorsBadInput");"Function"==this.typeOf(b)&&(e=d,d=c,c=b,b=null);b&&(b=this.normalizeElement(b));var g=this;return this.waitFor({method:function(){var c=!0;Joose.A.each(a,function(a){if(0===g.$(a,b).length)return c=!1});return c},callback:c,scope:d,timeout:e,assertionName:"waitForSelectors",description:" "+f.get("selectors")+' "'+a+'" '+f.get("toAppear")})},waitForSelectorNotFound:function(a,b,c,d,e){var f=Siesta.Resource("Siesta.Test.Element"),g=this;if(!a)throw"A CSS selector must be supplied";
"Function"==this.typeOf(b)&&(e=d,d=c,c=b,b=null);b&&(b=this.normalizeElement(b));return this.waitFor({method:function(){return 0===g.$(a,b).length},callback:c,scope:d,timeout:e,assertionName:"waitForSelectorNotFound",description:" "+f.get("selector")+' "'+a+'" '+f.get("toDisappear")})},waitForElementVisible:function(a,b,c,d){var e=Siesta.Resource("Siesta.Test.Element");return this.waitFor({method:function(){var b=this.normalizeElement(a,!0);if(b&&this.isElementVisible(b))return b},callback:b,scope:c,
timeout:d,assertionName:"waitForElementVisible",description:" "+e.get("element")+' "'+a.toString()+'" '+e.get("toAppear")})},waitForElementNotVisible:function(a,b,c,d){a=this.normalizeElement(a);var e=Siesta.Resource("Siesta.Test.Element"),f=this;return this.waitFor({method:function(){return!f.isElementVisible(a)&&a},callback:b,scope:c,timeout:d,assertionName:"waitForElementNotVisible",description:" "+e.get("element")+' "'+a.toString()+'" '+e.get("toDisappear")})},waitForElementTop:function(a,b,c,
d){var e=Siesta.Resource("Siesta.Test.Element");return this.waitFor({method:function(){var b=this.normalizeElement(a,!0);if(b&&this.elementIsTop(b,!0))return b},callback:b,scope:c,timeout:d,assertionName:"waitForElementTop",description:" "+e.get("element")+' "'+a.toString()+'" '+e.get("toBeTopEl")})},waitForElementNotTop:function(a,b,c,d){a=this.normalizeElement(a);var e=Siesta.Resource("Siesta.Test.Element"),f=this;return this.waitFor({method:function(){if(!f.elementIsTop(a,!0)){var b=f.findCenter(a);
return f.elementFromPoint(b[0],b[1],!0)}},callback:b,scope:c,timeout:d,assertionName:"waitForElementNotTop",description:" "+e.get("element")+' "'+a.toString()+'" '+e.get("toNotBeTopEl")})},elementIsVisible:function(a,b){a=this.normalizeElement(a,!0,!1,!1,{ignoreNonVisible:!1});this.ok(a&&this.isElementVisible(a),b)},elementIsNotVisible:function(a,b){a=this.normalizeElement(a,!1,!1,!1,{ignoreNonVisible:!1});this.notOk(this.isElementVisible(a),b)},elementIsTop:function(a,b,c){(a=this.normalizeElement(a))&&
"option"===a.nodeName.toLowerCase()&&(a=this.$(a).closest("select")[0]);var d=a.ownerDocument;c=this.getTargetCoordinate(a,!0,c);return(d=d.elementFromPoint(c[0],c[1]))&&(d===a||b&&0<this.$(d).closest(a).length)},isOffsetInsideElementBox:function(a,b){if(!b)return!0;var c=this.$(this.normalizeElement(a)),d=c.outerWidth(),e=c.outerHeight();b=this.normalizeOffset(b,c);return 0<=b[0]&&b[0]<d&&0<=b[1]&&b[1]<e},elementIsAt:function(a,b,c,d){a=this.normalizeElement(a);var e=this.elementFromPoint(b[0],b[1],
!0),f=Siesta.Resource("Siesta.Test.Element");e?c?e===a||0<this.$(e).closest(a).length?this.pass(d,{descTpl:f.get("elementIsAtDescTpl"),x:b[0],y:b[1]}):this.fail(d,{assertionName:"elementIsAt",got:e,gotDesc:f.get("topElement"),need:a,needDesc:f.get("allowChildrenDesc"),annotation:f.get("allowChildrenAnnotation")}):e===a?this.pass(d,{descTpl:f.get("elementIsAtPassTpl"),x:b[0],y:b[1]}):this.fail(d,{assertionName:"elementIsAt",got:e,gotDesc:f.get("topElement"),need:a,needDesc:"Should be",annotation:f.get("noChildrenFailAnnotation")}):
this.fail(d,{assertionName:"elementIsAt",got:{x:b[0],y:b[1]},gotDesc:f.get("Position"),annotation:f.get("noElementAtPosition")})},elementIsTopElement:function(a,b,c,d){a=this.normalizeElement(a);if(d){var e=this.$(a).offset();d=Siesta.Resource("Siesta.Test.Element");var f=e.top,g=e.left+this.$(a).outerWidth(),k=e.top+this.$(a).outerHeight(),e=e.left;this.elementIsAt(a,[e+1,f+1],b,c+" "+d.get("topLeft"));this.elementIsAt(a,[e+1,k-1],b,c+" "+d.get("bottomLeft"));this.elementIsAt(a,[g-1,f+1],b,c+" "+
d.get("topRight"));this.elementIsAt(a,[g-1,k-1],b,c+" "+d.get("bottomRight"))}else this.elementIsAt(a,this.findCenter(a),b,c)},elementIsNotTopElement:function(a,b,c){a=this.normalizeElement(a);var d=this.findCenter(a);(d=this.elementFromPoint(d[0],d[1],!0))?b?this.ok(d!==a&&0===this.$(d).closest(a).length,c):this.isnt(d,a,c):(a=Siesta.Resource("Siesta.Test.Element"),this.pass(c,{descTpl:a.get("elementIsNotTopElementPassTpl")}))},selectorIsAt:function(a,b,c){var d=Siesta.Resource("Siesta.Test.Element");
if(!a)throw d.get("noCssSelector");var e=this.$(this.elementFromPoint(b[0],b[1],!0));0<e.has(a).length||0<e.closest(a).length?this.pass(c,{descTpl:d.get("selectorIsAtPassTpl"),selector:a,xy:b}):this.fail(c,{got:e[0].outerHTML?e[0].outerHTML:e[0].innerHTML,need:d.get("elementMatching")+" "+a,assertionName:"selectorIsAt",annotation:d.get("selectorIsAtFailAnnotation")+" ["+b+"]"})},selectorExists:function(a,b){var c=Siesta.Resource("Siesta.Test.Element");if(!a)throw c.get("noCssSelector");0>=this.$(a).length?
this.fail(b,c.get("selectorExistsFailTpl")+" : "+a):this.pass(b,{descTpl:c.get("selectorExistsPassTpl"),selector:a})},selectorNotExists:function(a,b){var c=Siesta.Resource("Siesta.Test.Element"),d=this.$(a);0<d.length?this.fail(b,{descTpl:c.get("selectorNotExistsFailTpl")+": "+a,annotation:$.map(d,function(a,b){return b+1+". "+a.cloneNode().outerHTML}).join("\r\n")}):this.pass(b,{descTpl:c.get("selectorNotExistsPassTpl"),selector:a})},waitForScrollChange:function(a,b,c,d,e){a=this.normalizeElement(a);
var f="scroll"+Joose.S.uppercaseFirst(b),g=a[f];b=Siesta.Resource("Siesta.Test.Element");return this.waitFor({method:function(){if(a[f]!==g)return a[f]},callback:c,scope:d,timeout:e,assertionName:"waitForScrollChange",description:" "+f+" "+b.get("toChangeForElement")+" "+a.toString()})},waitForScrollLeftChange:function(a,b,c,d){return this.waitForScrollChange(this.normalizeElement(a),"left",b,c,d)},waitForScrollTopChange:function(a,b,c,d){return this.waitForScrollChange(this.normalizeElement(a),"top",
b,c,d)},scrollTo:function(a,b,c,d,e,f){if(a=this.normalizeElement(a,f)){var g=this,k=this.originalSetTimeout;f=a.ownerDocument;f=this.waitForEvent(a==this.getElForPageScroll()?f:a,"scroll",function(){if(0<e){var a=g.beginAsync(e+100);k(function(){g.endAsync(a);g.processCallbackFromTest(d)},e)}else g.processCallbackFromTest(d)});var l=a.scrollTop,m=a.scrollLeft;a.scrollLeft=b;a.scrollTop=c;a.scrollTop==l&&a.scrollLeft==m&&f.force();return{scrollLeft:a.scrollLeft,scrollTop:a.scrollTop}}this.processCallbackFromTest(d)},
scrollVerticallyTo:function(a,b,c,d){a=this.normalizeElement(a);"Number"!=this.typeOf(c)&&(d=c,c=null);var e=this,f=this.originalSetTimeout,g=a.ownerDocument,g=this.waitForEvent(a==this.getElForPageScroll()?g:a,"scroll",function(){if(0<c){var a=e.beginAsync(c+100);f(function(){e.endAsync(a);e.processCallbackFromTest(d)},c)}else e.processCallbackFromTest(d)}),k=a.scrollTop;a.scrollTop=b;a.scrollTop==k&&g.force();return a.scrollTop},scrollHorizontallyTo:function(a,b,c,d){a=this.normalizeElement(a);
"Number"!=this.typeOf(c)&&(d=c,c=null);var e=this,f=this.originalSetTimeout,g=a.ownerDocument,g=this.waitForEvent(a==this.getElForPageScroll()?g:a,"scroll",function(){if(0<c){var a=e.beginAsync(c+100);f(function(){e.endAsync(a);e.processCallbackFromTest(d)},c)}else e.processCallbackFromTest(d)}),k=a.scrollLeft;a.scrollLeft=b;a.scrollLeft==k&&g.force();return a.scrollLeft},clickAll:function(){var a=Array.prototype.concat.apply([],arguments),b;"Function"==this.typeOf(a[a.length-1])&&(b=a.pop());var a=
Array.prototype.concat.apply([],a),c=[];Joose.A.each(a,function(a){c.push({action:"click",target:a})});var d=this;b&&c.push(function(){d.processCallbackFromTest(b)});this.chain.apply(this,c)},chainClick:function(){return this.clickAll.apply(this,arguments)},clickSelector:function(a,b,c,d){1<arguments.length&&"Function"==this.typeOf(arguments[1])&&(d=c,c=b,b=null);b&&(b=this.normalizeElement(b));var e=Joose.A.map(this.sizzle(a,b),function(a){return a});this.clickAll(e,function(){c&&c.call(d||this,
e)})},selectorCountIs:function(a,b,c,d){var e=Siesta.Resource("Siesta.Test.Element");if(!a)throw e.get("noCssSelector");"Number"==this.typeOf(b)?(d=c,c=b,b=null):b=this.normalizeElement(b);b=this.$(a,b).length;b!=c?this.fail(d,{assertionName:"selectorCountIs",descTpl:e.get("selectorCountIsFailTpl"),selector:a,got:b,need:c}):this.pass(d,{descTpl:e.get("selectorCountIsPassTpl"),count:c,selector:a})},isInView:function(a,b){if(this.elementIsInView(a)){var c=Siesta.Resource("Siesta.Test.Element");this.pass(b,
{descTpl:c.get("isInViewPassTpl")})}else this.fail(b,{assertionName:"isInView"})},elementIsInView:function(a){a=this.normalizeElement(a);var b=!1,c=this.$(a).offset();if(c)var b=$(this.global).scrollTop(),d=b+$(this.global).height(),c=c.top,b=c+$(a).height()>=b&&c<=d;return b},waitUntilInView:function(a,b,c,d){var e=this,f=Siesta.Resource("Siesta.Test.Element");this.waitFor({method:function(){var b=this.normalizeElement(a,!0);if(b&&e.elementIsInView(b))return b},callback:b,scope:c,timeout:d,assertionName:"waitUntilInView",
description:a.toString+" "+f.get("toAppearInTheViewport")})},findScrolledParent:function(a){var b=a.ownerDocument.body;for(a=this.$(a);a=a.parent(),a.length&&a[0]!=b;)if(0<a[0].scrollTop||0<a[0].scrollLeft)return a[0]},focus:function(a,b){var c=a.getAttribute("tabIndex"),d;if(this.activeElement()!==a)try{null==c&&a.setAttribute("tabIndex",-1);if(b){var e,f,g,k;if(d=this.findScrolledParent(a))e=d.scrollLeft,f=d.scrollTop;g=this.getPageScrollX();k=this.getPageScrollY()}this.maintainScrollPositionDuring(function(){a.focus({preventScroll:b});
b&&(d&&(e!==d.scrollLeft&&(d.scrollLeft=e),f!==d.scrollTop&&(d.scrollTop=f)),g==this.getPageScrollX()&&k==this.getPageScrollY()||this.global.scrollTo(g,k))})}catch(l){}finally{null==c?a.removeAttribute("tabIndex"):a.setAttribute("tabIndex",c)}},elementIsEmpty:function(a,b){if((a=this.normalizeElement(a))&&this.isElementEmpty(a)){var c=Siesta.Resource("Siesta.Test.Element");this.pass(b,{descTpl:c.get("elementIsEmptyPassTpl")})}else this.fail(b,{got:a.innerHTML,need:"",assertionName:"elementIsEmpty"})},
elementIsNotEmpty:function(a,b){if((a=this.normalizeElement(a))&&!this.isElementEmpty(a)){var c=Siesta.Resource("Siesta.Test.Element");this.pass(b,{descTpl:c.get("elementIsNotEmptyPassTpl")})}else this.fail(b,{assertionName:"elementIsNotEmpty"})},waitForElementEmpty:function(a,b,c,d){var e=this,f=Siesta.Resource("Siesta.Test.Element");a=this.normalizeElement(a);return this.waitFor({method:function(){return e.isElementEmpty(a)},callback:b,scope:c,timeout:d,assertionName:"waitForElementEmpty",description:" "+
f.get("elementToBeEmpty")})},waitForElementNotEmpty:function(a,b,c,d){var e=this,f=Siesta.Resource("Siesta.Test.Element");a=this.normalizeElement(a);return this.waitFor({method:function(){return!e.isElementEmpty(a)},callback:b,scope:c,timeout:d,assertionName:"waitForElementNotEmpty",description:" "+f.get("elementToNotBeEmpty")})},isElementEmpty:function(a){return!a.innerHTML.replace(/^\s+|\s+$/g,"")},hasAttributeValue:function(a,b,c,d){a=this.normalizeElement(a);a=a.getAttribute(b);this.is(a,c,d)},
hasValue:function(a,b,c){a=this.normalizeElement(a);this.is(a.value,b,c)},hasSameWidth:function(a,b,c){a=this.normalizeElement(a);b=this.normalizeElement(b);this.is(a.offsetWidth,b.offsetWidth,c)},hasSameHeight:function(a,b,c){a=this.normalizeElement(a);b=this.normalizeElement(b);this.is(a.offsetHeight,b.offsetHeight,c)},isElementFocusable:function(a){var b="true"===a.getAttribute("disabled"),c=a.nodeName.toLowerCase(),d={a:1,area:1,button:1,object:1,select:1};return!b&&(this.isTextInput(a)||a.isContentEditable||
"input"===a.nodeName.toLowerCase()&&"file"===a.type||c in d||null!=a.getAttribute("tabIndex")&&(!bowser.msie||"on"!=String(a.getAttribute("unselectable")).toLowerCase()))}}});
Role("Siesta.Test.Observable",{does:[Siesta.Util.Role.CanGetType],requires:"addListenerToObservable removeListenerFromObservable getSourceLine pass fail processCallbackFromTest".split(" "),has:{},methods:{waitForEvent:function(a,b,c,d,e){var f=!1,g=Siesta.Resource("Siesta.Test.Browser");this.addListenerToObservable(a,b,function(){f=!0});return this.waitFor({method:function(){return f},callback:c,scope:d,timeout:e,assertionName:"waitForEvent",description:" "+g.get("waitForEvent")+' "'+b+'" '+g.get("event")})},
firesOk:function(a,b,c,d,e,f,g){var k=this,l=k.getSourceLine(),m=Siesta.Resource("Siesta.Test.Browser"),n=arguments.length,r;if(1==n)r=a.observable,b=a.events,n=a.during,f=a.desc||a.description,g=a.callback,d="Number"==this.typeOf(n)?n:null,e="Function"==this.typeOf(n)?n:null;else if(5<=n)r=a,"String"==this.typeOf(b)&&(n={},n[b]=c,b=n);else if(3>=n&&"Object"==this.typeOf(b))r=a,f=c;else if(4>=n&&"String"==this.typeOf(b))r=a,n={},n[b]=c,b=n,f=d,d=null;else throw Error(m.get("unrecognizedSignature"));
var p={},q={};Joose.O.each(b,function(a,b){p[b]=0;var c=q[b]=function(){p[b]++};k.addListenerToObservable(r,b,c)});var t=function(){Joose.O.each(b,function(a,b){k.removeListenerFromObservable(r,b,q[b]);var c=p[b];k.verifyExpectedNumber(c,a)?k.pass(f,{descTpl:m.get("observableFired")+" "+c+" `"+b+"` "+m.get("events")}):k.fail(f,{assertionName:"firesOk",sourceLine:l,descTpl:m.get("observableFiredOk")+" `"+b+"` "+m.get("events"),got:c,gotDesc:m.get("actualNbrEvents"),need:a,needDesc:m.get("expectedNbrEvents")})})};
if(d){var v=this.beginAsync(d+100),n=this.originalSetTimeout;n(function(){k.endAsync(v);t();k.processCallbackFromTest(g)},d)}else if(e)e(),t(),k.processCallbackFromTest(g);else this.on("beforetestfinalizeearly",t)},willFireNTimes:function(a,b,c,d,e){this.firesOk(a,b,e?">="+c:c,d)},getObjectWithExpectedEvents:function(a,b){var c={};"Array"==this.typeOf(a)?Joose.A.each(a,function(a){c[a]=b}):c[a]=b;return c},wontFire:function(a,b,c){this.firesOk({observable:a,events:this.getObjectWithExpectedEvents(b,
0),desc:c})},firesOnce:function(a,b,c){this.firesOk({observable:a,events:this.getObjectWithExpectedEvents(b,1),desc:c})},isntFired:function(){this.wontFire.apply(this,arguments)},firesAtLeastNTimes:function(a,b,c,d){this.firesOk(a,b,">="+c,d)},isFiredWithSignature:function(a,b,c,d){var e,f=this,g=f.getSourceLine(),k=Siesta.Resource("Siesta.Test.ExtJS.Observable"),l=function(){f.removeListenerFromObservable(a,b,m);e||f.fail("The ["+b+"] "+k.get("isFiredWithSignatureNotFired"))};f.on("beforetestfinalizeearly",
l);var m=function(){f.un("beforetestfinalizeearly",l);var n=c.apply(f,arguments);!e&&n&&f.pass(d||k.get("observableFired")+" "+b+" "+k.get("correctSignature"),{sourceLine:g});n||(f.fail(d||k.get("observableFired")+" "+b+" "+k.get("incorrectSignature"),{sourceLine:g}),f.removeListenerFromObservable(a,b,m));e=!0};f.addListenerToObservable(a,b,m)}}});
Role("Siesta.Test.ExtJSCore",{does:Siesta.Util.Role.CanInstallCQRootPseudo,has:{waitForExtReady:!0,waitForAppReady:!1,waitForExtComponentQueryReady:!0,loaderPath:null,requires:null,isExtOnReadyDone:!1,onReadyWaitingStarted:!1,isAppReadyDone:!1,loaderWaitingStarted:!1,requiringWaitingStarted:!1,isRequiringDone:!1,modelsDefinedInPreload:Joose.I.Object},override:{onTestStart:function(){var a=this.sharedSandboxState;!this.reusingSandbox&&a&&(a.modelsDefinedInPreload||(a.modelsDefinedInPreload={}),this.forEachModelInAllSchemas(function(b,
c,d,e){a.modelsDefinedInPreload[d]=!0}))},cleanupContextBeforeStartDom:function(){var a=this.getExt();if(!a)return this.SUPER();var b=this;if(a.ComponentQuery){var c={},d=a.MessageBox;d&&(c[d.id]=!0);d=a.ComponentQuery.query("{ownerCt == null}");d.sort(function(b,c){b=b instanceof a.Container?0:1;c=c instanceof a.Container?0:1;return b-c});Joose.A.each(d,function(a){c[a.id]||a.isDestroyed||a.destroy()})}if(a.ClassManager&&a.undefine){var e={};Joose.O.each(a.ClassManager.classes,function(c,d){var f=
d.split(".")[0];b.isGlobalExpected(f,e)||a.undefine(d)})}if(a.data&&a.data.StoreManager){var f=[];a.data.StoreManager.each(function(a){"ext-empty-store"!==a.storeId&&f.push(a)});a.data.StoreManager.unregister.apply(a.data.StoreManager,f)}var g=(d=this.sharedSandboxState)&&d.modelsDefinedInPreload;g&&b.forEachModelInAllSchemas(function(b,c,d,e){g[d]||(a.undefine(d),delete e.entityClasses[d],delete e.entities[c])});a.resumeLayouts&&a.resumeLayouts()},processSubTestConfig:function(a){a=this.SUPER(a);
a.waitForAppReady=!1;a.waitForExtReady=!1;return a},isReady:function(){var a=this.SUPERARG(arguments);if(!a.ready)return a;var b=this,a=this.getExt(),c=Siesta.Resource("Siesta.Test.ExtJSCore"),d=this.loaderPath,e=this.global.StartTest;d&&a&&a.Loader&&!e.loaderPathHookInstalled&&this.project.generateLoaderPathHook()(e,a,d);(d=this.requires)&&!this.requiringWaitingStarted&&a&&a.require&&(this.requiringWaitingStarted=!0,a.require(d,function(){b.isRequiringDone=!0}));this.waitForExtReady&&!this.onReadyWaitingStarted&&
a&&a.onReady&&(this.onReadyWaitingStarted=!0,a.onReady(function(){b.isExtOnReadyDone=!0}));if(this.waitForExtComponentQueryReady&&a&&(a.getVersion||a.blink||a.manifest||a.microloaded)&&!a.ComponentQuery)return{ready:!1,reason:c.get("waitedForComponentQuery")};if(d&&!this.isRequiringDone)return{ready:!1,reason:c.get("waitedForRequires")};if(this.waitForExtReady&&this.onReadyWaitingStarted&&!this.isExtOnReadyDone)return{ready:!1,reason:c.get("waitedForExt")};if(this.waitForAppReady&&!this.isAppReadyDone&&
a){d=a.manifest.name;e=!1;try{e=b.global[d].getApplication().launched}catch(f){}if(e)this.isAppReadyDone=e;else return{ready:!1,reason:c.get("waitedForApp")}}a&&a.ComponentQuery&&this.installRootPseudoCQ(a);return{ready:!0}}},methods:{initialize:function(){this.expectGlobals("Ext","id");this.SUPER()},getSimulatorClass:function(){return Siesta.Test.SimulatorExtJS},forEachModelInAllSchemas:function(a){var b=this.getExt();b&&b.data&&b.data.schema&&b.data.schema.Schema&&b.undefine&&Joose.O.each(b.data.schema.Schema.instances,
function(b,d){b.eachEntity(function(d){var f=b.getEntity(d);a(f,d,f.$className,b)})})},doStart:function(){var a=this.getExt();a?(a.isReady=!0,a.manifest&&a.manifest.name||(this.waitForAppReady=!1)):(this.waitForExtReady=this.waitForAppReady=!1,this.requires=null);this.SUPERARG(arguments)},getExt:function(){return this.global.Ext},Ext:function(){return this.global.Ext},isExtJSComponentQueryTarget:function(a){var b=this.getExt();return!!(a&&b&&(b.Component&&a instanceof b.Component||a.isWidget))},componentQuery:function(a,
b,c){c=c||{};var d=this.Ext();if(!a||!d||!d.ComponentQuery)return[];a=this.trimString(a.replace(/^(\s*>>)?/,""));a=d.ComponentQuery.query(a,b);if(c.ignoreNonVisible){var e=this,f=[];Joose.A.each(a,function(a){e.componentIsHidden(a)||f.push(a)});a=f}return a},normalizeComponent:function(a,b,c){c=c||{};this.Ext();var d=!1;if("String"===this.typeOf(a)){var e=this.componentQuery(a,null,{ignoreNonVisible:c.ignoreNonVisible}),f=Siesta.Resource("Siesta.Test.ExtJSCore");!b&&1>e.length&&this.warn(f.get("noComponentMatch").replace("{component}",
a));1<e.length&&(d=!0,a=f.get("multipleComponentMatch").replace("{component}",a),this.project.failOnMultipleComponentMatches?this.fail(a):this.warn(a));a=e[0]}return c.detailed?{comp:a,matchingMultiple:d}:a},compToEl:function(a,b){if(!a)return null;var c=this.Ext();b=!1!==b;c.Editor&&a instanceof c.Editor&&a.field&&(a=a.field);if(c&&c.form&&c.form.Field&&b){if((c.form.Checkbox&&a instanceof c.form.Checkbox||c.form.Radio&&a instanceof c.form.Radio)&&a.el){var d=a.displayEl;return d&&a.boxLabel?d:(c=
c.ComponentQuery.query("checkboxinput",a)[0])?this.compToEl(c):a.el.down(".x-form-field")||a.el.down(".x-field-input")||a.el.down(".x-input-el")||a.inputEl||a.el}if(a instanceof c.form.Field&&a.inputEl)return(c=a.el.down(".x-form-field"))&&c.dom?c:a.inputEl;if(c.form.HtmlEditor&&a instanceof c.form.HtmlEditor)return a.iframe||a.inputEl}if(c&&c.field&&c.field.Slider&&a instanceof c.field.Slider)return this.compToEl(c.ComponentQuery.query("slider",a)[0]);if(c&&c.field&&c.field.Field&&a instanceof c.field.Field&&
b&&a.getComponent){a=a.getComponent();if(a.getUseMask&&!0===a.getUseMask()&&a.mask)return a.mask;if(b&&a.input)return a.input;if(a.bodyElement)return a.bodyElement}return a.getEl&&!a.element?a.getEl():b&&a.input||a.el||a.element},normalizeElement:function(a,b,c,d,e){if(!a)return null;if(a.nodeName)return a;var f=!1;this.getExt();var g=a,k,l=e&&e.stopAtComponentLevel;e=e&&e.hasOwnProperty("ignoreNonVisible")?e.ignoreNonVisible:!0;if("string"===typeof a){f=a.split("->");if(2===f.length&&(k=this.adjustScope(a),
a=this.trimString(f[1]),!k||(a.match(/^\s*>>/)||a.match(/=>/))&&!this.Ext()))return this.resetScope(),null;if(a.match(/=>/))f=this.compositeQuery(a,null,b,e),a=f[0],f=1<f.length;else if(a.match(/^\s*>>/))f=this.normalizeComponent(a,b,{ignoreNonVisible:e,detailed:!0}),a=f.comp,f=f.matchingMultiple;else return d=this.SUPER(a,b,c,d),k&&this.resetScope(),d;if(!b&&!a)throw d=Siesta.Resource("Siesta.Test.ExtJSCore").get("noComponentFound")+": "+g,this.warn(d),k&&this.resetScope(),d;}g=!1;this.isExtJSComponentQueryTarget(a)&&
(l?g=!0:a=this.compToEl(a));a&&a.dom&&(l?g=!0:a=a.dom);a=g?a:this.SUPER(a,b,c);k&&this.resetScope();return d?{el:a,matchingMultiple:f}:a},normalizeActionTarget:function(a,b,c){return this.normalizeElement(a,b,!1,!1,{ignoreNonVisible:!1!==c,stopAtComponentLevel:!0})},knownBugIn:function(a,b,c){var d=this.getExt(),d=d.versions.extjs||d.versions.touch,e=Siesta.Resource("Siesta.Test.ExtJSCore");this.project.failKnownBugIn||d.isGreaterThan(a)?b.call(this.global,this):this.todo(e.get("knownBugIn")+" "+
a+": "+(c||""),b)},requireOk:function(){var a=this,b=this.getExt(),c=Array.prototype.concat.apply([],arguments),d=Siesta.Resource("Siesta.Test.ExtJSCore"),e;"Function"==this.typeOf(c[c.length-1])&&(e=c.pop());var f=function(){a.endAsync(k);Joose.A.each(c,function(c){var e=b.ClassManager,f=e.get(c);e.overrideMap&&e.overrideMap[c]||f&&("Function"==a.typeOf(f)||"Function"==a.typeOf(f.self))?a.pass(d.get("Class")+": "+c+" "+d.get("wasLoaded")):a.fail(d.get("Class")+": "+c+" "+d.get("wasNotLoaded"))});
a.processCallbackFromTest(e)},g=this.defaultTimeout,k=this.beginAsync(g+100),l=!1,m=this.originalSetTimeout,n=this.originalClearTimeout,r=m(function(){l=!0;f()},g);b.Loader.setConfig({enabled:!0});b.require(c,function(){n(r);l||f()})},clickComponentQuery:function(a,b,c){2==arguments.length&&"Function"==this.typeOf(arguments[1])&&(c=b,b=this.Ext().ComponentQuery);1==arguments.length&&(b=this.Ext().ComponentQuery);var d=b.query(a);this.chainClick(d,function(){c&&c.call(this,d)})},clickCQ:function(){this.clickComponentQuery.apply(this,
arguments)},compositeQuery:function(a,b,c,d){c=!1!==c;var e=this.Ext(),f=Siesta.Resource("Siesta.Test.ExtJSCore"),g=a.split("=>");b=b||e&&e.ComponentQuery;if(!b)return[];if(2>g.length)throw f.get("invalidCompositeQuery")+": "+a;e=g[0];g=g[1];if(e.match(/\.\w+\(/)){for(var k,l=/(.+?)\.(\w+)\(\)/g;b&&null!=(k=l.exec(e));)(b=b.query(k[1])[0])&&k[2]&&(b=b[k[2]]());if(!b&&!c)throw f.get("invalidCompositeQuery")+": "+a;b=[b]}else b=b.query(e);if(!b.length){if(c)return[];throw f.get("ComponentQuery")+" "+
e+" "+f.get("matchedNoCmp");}for(e=0;e<b.length;e++)if(k=b[e],k.rendered&&(!d||k.isWidget||(k.isVisible?k.isVisible():!k.isHidden()))&&(k=this.compToEl(k,!1),k=this.sizzle(g,k.dom),0<k.length))return k;if(c)return[];throw f.get("CompositeQuery")+" "+a+" matched no DOM elements";},cq:function(a){return this.Ext().ComponentQuery.query(a.replace(/^(\s*>>)?/,""))},cq1:function(a){return this.Ext().ComponentQuery.query(a.replace(/^(\s*>>)?/,""))[0]},waitForTarget:function(a,b,c,d,e){var f=this.SUPER;this.waitForAnimations(function(){f.call(this,
a,b,c,d,e)},this,d)},messageBoxIsVisible:function(a){return this.notOk(this.Ext().Msg.isHidden(),a||Siesta.Resource("Siesta.Test.ExtJSCore","messageBoxVisible"))},messageBoxIsHidden:function(a){return this.ok(this.Ext().Msg.isHidden(),a||Siesta.Resource("Siesta.Test.ExtJSCore","messageBoxHidden"))},cqExists:function(a,b){this.ok(this.cq1(a),b)},cqNotExists:function(a,b){this.notOk(this.cq1(a),b)},componentQueryExists:function(){this.cqExists.apply(this,arguments)},setValue:function(a,b,c,d){a=this.normalizeComponent(a);
(a.setChecked||a.setRawValue||a.setValue).call(a,b);c&&this.processCallbackFromTest(c,null,d)},waitForAnimations:function(a,b,c){var d=Siesta.Resource("Siesta.Test.ExtJS"),e=this;return this.waitFor({method:function(){return!e.areAnimationsRunning()},callback:a,scope:b,timeout:c,assertionName:"waitForAnimations",description:" "+d.get("animationsToFinalize")})},query:function(a){var b=this;a.match(/=>/)?a=this.compositeQuery(a,null,!0,!1):a.match(/^\s*>>/)?(a=this.componentQuery(a,null,{ignoreNonVisible:!1}),
a=Joose.A.map(a,function(a){return b.compToEl(a).dom})):a=this.sizzle(a);return a}}});
Role("Siesta.Test.ExtJS.Ajax",{has:{responses:Joose.I.Array,urlMatchers:Joose.I.Array},methods:{isAjaxLoading:function(a,b){var c=this.Ext();this.ok(c.Ajax.isLoading(a),b||Siesta.Resource("Siesta.Test.ExtJS.Ajax","ajaxIsLoading"))},ajaxRequestAndThen:function(a,b,c){var d=this.Ext(),e=a;"string"===typeof a&&(e={url:a,callback:b,scope:c});d.Ajax.request(e)},waitForAjaxRequest:function(a,b,c,d){var e=this.Ext(),f;"function"===typeof a?(f=" "+Siesta.Resource("Siesta.Test.ExtJS.Ajax","allAjaxRequestsToComplete"),
d=c,c=b,b=a,a=void 0):f=" "+Siesta.Resource("Siesta.Test.ExtJS.Ajax","ajaxRequest")+' "'+a.options.url+'" '+Siesta.Resource("Siesta.Test.ExtJS.Ajax","toComplete");return this.waitFor({method:function(){return a?!e.Ajax.isLoading(a)&&a:!e.Ajax.isLoading()},callback:b,scope:c,timeout:d,assertionName:"waitForAjaxRequest",description:f})}}});
Role("Siesta.Test.ExtJS.Store",{methods:{waitForStoresToLoad:function(){var a=this.getExt(),b=Array.prototype.concat.apply([],arguments),c=this,d=Siesta.Resource("Siesta.Test.ExtJS.Store"),e=a.data.AbstractStore||a.data.Store,f,g;Joose.A.each(b,function(a,b){if("Function"==c.typeOf(a))return f=a,g=b,!1});var k=0,a=c.waitFor({method:function(){return k==g},callback:f,name:"waitForStoresToLoad",description:g+" "+d.get("storesToLoad")});Joose.A.each(b,function(a){var b=a.proxy||a.getProxy&&a.getProxy();
if(!(a instanceof e))return!1;if(b){a.on("load",function(){k++;b.un("exception",f)},null,{single:!0});var f=function(a,b,e){a=a.api&&a.api.read||a.url;c.fail(d.get("failedToLoadStore"),d.get("URL")+": "+a)};b.on("exception",f)}else g--});return a},loadStoresAndThen:function(){this.getExt();this.waitForStoresToLoad.apply(this,arguments);var a=Array.prototype.concat.apply([],arguments);"Function"==this.typeOf(a[a.length-1])&&a.pop();Joose.A.each(a,function(a){(a.proxy||a.getProxy&&a.getProxy())&&a.load&&
a.load()})},isStoreEmpty:function(a,b){this.is(a.getCount(),0,b)}}});
Role("Siesta.Test.ExtJS.Observable",{methods:{addListenerToObservable:function(a,b,c,d){if(this.Ext()){a=this.normalizeActionTarget(a,!1,!1);if(a.nodeName&&a.tagName){var e=a.ownerDocument.parentWindow||a.ownerDocument.defaultView;e.Ext&&(a=e.Ext.get(a))}if(a.on&&a.un)a.on(b,c,null,{single:d});else this.SUPERARG(arguments)}else this.SUPERARG(arguments)},removeListenerFromObservable:function(a,b,c){if(this.Ext()){if(a=this.normalizeActionTarget(a,!0,!1)){if(a&&a.nodeName&&a.tagName){var d=a.ownerDocument.parentWindow||
a.ownerDocument.defaultView;d.Ext&&(a=d.Ext.get(a))}a.on&&a.un?a.un(b,c):this.SUPERARG(arguments)}}else this.SUPERARG(arguments)},hasListener:function(a,b,c){var d=Siesta.Resource("Siesta.Test.ExtJS.Observable");(a=this.normalizeActionTarget(a,!0,!1))&&a.hasListener?a.hasListener(b)?this.pass(c,{descTpl:d.get("hasListenerPass"),eventName:b}):this.fail(c,{assertionName:"hasListener",annotation:d.get("hasListenerFail")+": "+b}):this.fail(c,{assertionName:"hasListener",annotation:d.get("hasListenerInvalid")})}}});
Role("Siesta.Test.ExtJS.Component",{requires:["waitFor"],methods:{componentIsHidden:function(a){var b=this.compToEl(a);return b?a.isHidden&&a.isHidden()||a.isVisible&&!a.isVisible()||!this.isElementVisible(b):!0},waitForComponentVisible:function(a,b,c,d){var e=Siesta.Resource("Siesta.Test.ExtJS.Component"),f=this;if("String"!=this.typeOf(a)&&!this.isExtJSComponentQueryTarget(a))throw e.get("badInputText")+": "+a;return this.waitFor({method:function(){var b=f.normalizeComponent(a,!0);if(!b)return!1;
var c=f.compToEl(b);return c&&f.elementIsTop(c,!0)&&b},callback:b,scope:c,timeout:d,assertionName:"waitForComponentVisible",description:" "+e.get("component")+' "'+("String"==f.typeOf(a)?a:a.id)+'" '+e.get("toBeVisible")})},waitForComponentNotVisible:function(a,b,c,d){var e=Siesta.Resource("Siesta.Test.ExtJS.Component"),f=this;if("String"!=this.typeOf(a)&&!this.isExtJSComponentQueryTarget(a))throw e.get("badInputText")+": "+a;return this.waitFor({method:function(){var b=f.normalizeComponent(a,!0);
return b?f.componentIsHidden(b)&&b:!1},callback:b,scope:c,timeout:d,assertionName:"waitForComponentNotVisible",description:" "+e.get("component")+' "'+("String"==f.typeOf(a)?a:a.id)+'" '+e.get("toNotBeVisible")})},waitForComponentQuery:function(a,b,c,d,e){"Function"==this.typeOf(b)&&(e=d,d=c,c=b,b=this.getExt()&&this.getExt().ComponentQuery);return this.waitFor({method:function(){var c=b&&b.query(a)||this.getExt()&&this.getExt().ComponentQuery.query(a);return c&&0<c.length?c:!1},callback:c,scope:d,
timeout:e,assertionName:"waitForComponentQuery",description:" "+Siesta.Resource("Siesta.Test.ExtJS.Component","componentQuery")+' "'+a+'"'})},waitForCompositeQuery:function(a,b,c,d,e){"Function"==this.typeOf(b)&&(e=d,d=c,c=b,b=this.getExt().ComponentQuery);var f=this;return f.waitFor({method:function(){var c=f.compositeQuery(a,b,!0);return 0<c.length?c:!1},callback:c,scope:d,timeout:e,assertionName:"waitForCompositeQuery",description:" "+Siesta.Resource("Siesta.Test.ExtJS.Component","compositeQuery")+
' "'+a+'"'})},waitForCompositeQueryNotFound:function(a,b,c,d,e){"Function"==this.typeOf(b)&&(e=d,d=c,c=b,b=this.getExt().ComponentQuery);var f=this;return f.waitFor({method:function(){return 0<f.compositeQuery(a,b,!0).length?!1:!0},callback:c,scope:d,timeout:e,assertionName:"waitForCompositeQueryNotFound",description:" "+Siesta.Resource("Siesta.Test.ExtJS.Component","compositeQuery")+' "'+a+'" '+Siesta.Resource("Siesta.Test.ExtJS.Component","toReturnEmptyArray")})},waitForCQ:function(){return this.waitForComponentQuery.apply(this,
arguments)},waitForCQNotFound:function(){return this.waitForComponentQueryNotFound.apply(this,arguments)},waitForComponentQueryNotFound:function(a,b,c,d,e){var f=Siesta.Resource("Siesta.Test.ExtJS.Component");"Function"==this.typeOf(b)&&(e=d,d=c,c=b,b=this.getExt().ComponentQuery);return this.waitFor({method:function(){var c=b.query(a);return 0===c.length&&c},callback:c,scope:d,timeout:e,assertionName:"waitForComponentQueryNotFound",description:f.get("componentQuery")+": "+a+" "+f.get("toReturnEmpty")})},
waitForCQVisible:function(){return this.waitForComponentQueryVisible.apply(this,arguments)},waitForCQNotVisible:function(){return this.waitForComponentQueryNotVisible.apply(this,arguments)},waitForComponentQueryVisible:function(a,b,c,d,e){var f=this,g=Siesta.Resource("Siesta.Test.ExtJS.Component"),k=f.getExt();"Function"==this.typeOf(b)&&(e=d,d=c,c=b,b=k.ComponentQuery);var l,m;return this.waitFor({method:function(){l=null;var c=b.query(a),d=!0;m=c.length;return 0<m?(Joose.A.each(c,function(a){if(!a.rendered||
!f.isElementVisible(a))return d=!1,l=a.id,!1}),d&&c):!1},callback:c,scope:d,timeout:e,assertionName:"waitForComponentQueryVisible",description:" "+g.get("componentQuery")+": "+a+" to return a non-empty set of visible components",annotation:function(){if(0===m)return"No matching components";if(0<m&&null==l)return"";if(0<m&&null!=l)return"The matching component [id="+l+"] is not visible"}})},waitForComponentQueryNotVisible:function(a,b,c,d,e){var f=this,g=Siesta.Resource("Siesta.Test.ExtJS.Component"),
k=f.getExt();"Function"==this.typeOf(b)&&(e=d,d=c,c=b,b=k.ComponentQuery);var l,m;return this.waitFor({method:function(){l=null;var c=b.query(a),d=!0;m=c.length;return 0<m?(Joose.A.each(c,function(a){if(!f.componentIsHidden(a))return l=a.id,d=!1}),d&&c):!0},callback:c,scope:d,timeout:e,assertionName:"waitForComponentQueryVisible",description:" "+g.get("componentQuery")+": "+a+" "+g.get("toReturnHiddenCmp"),annotation:function(){if(0===m||null==l)return"";if(null!=l)return"The matching component [id="+
l+"] is visible"}})},waitForXType:function(a,b,c,d,e){return this.waitForComponentQuery(a,b,c,d,e)},waitForComponent:function(a,b,c,d,e){var f=this.getExt();a=f.isString(a)?f.ClassManager.get(a).xtype:a.xtype;b&&(a+="[rendered]");return this.waitForXType(a,c,d,e)},hasSize:function(a,b,c,d){a=this.normalizeComponent(a);this.isDeeply(a.getSize(),{width:b,height:c},d)},hasPosition:function(a,b,c,d){a=this.normalizeComponent(a);this.isDeeply(a.getPosition(),[b,c],d)},destroysOk:function(a,b){var c=this.Ext(),
d=Siesta.Resource("Siesta.Test.ExtJS.Component");"Array"!=this.typeOf(a)&&(a="String"==this.typeOf(a)?this.Ext().ComponentQuery.query(a):[a]);if(a.length){var e,f=this.getExceptionCatcher()(function(){Joose.A.each(a,function(a){e=a;a.destroy()})});if(void 0!==f)this.fail(b,{assertionName:"destroysOk",got:f,gotDesc:d.get("exception"),annotation:d.get("exceptionAnnotation")+" "+e.id});else{var g=this;!1!==Joose.A.each(a,function(a){if(!a.isDestroyed&&a.destroy!=c.emptyFn)return g.fail(b,{assertionName:"destroysOk",
annotation:d.get("Component")+" ["+a.id+"] "+d.get("destroyFailed")}),!1})&&this.pass(b,{descTpl:d.get("destroyPassed")})}}else this.fail(b,{assertionName:"destroysOk",annotation:d.get("invalidDestroysOkInput")})}}});
Role("Siesta.Test.ExtJS.Grid",{requires:["waitFor","pass","fail","typeOf"],methods:{waitForRowsVisible:function(a,b,c,d){"function"===typeof a&&(d=c,c=b,b=a,a=this.Ext()&&this.cq1("tableview")||"tableview");var e=this.Ext()&&this.normalizeComponent(a,!0),f=this;if(e||"string"!==typeof a){var g;if(e.normalGrid){var k=e.normalGrid.getView().itemSelector;g=function(){if(e.rendered&&e.normalGrid.rendered&&e.lockedGrid.rendered){var a=this.$(k,e.lockedGrid.getView().getEl().dom),b=this.$(k,e.normalGrid.getView().getEl().dom);
if(0<a.length&&0<b.length)return{lockedRows:a,normalRows:b}}}}else a=e.getView&&e.getView()||e,k=a.itemSelector||a.rowSelector,g=function(){if(e.rendered){var b=this.$(k,a.el.dom);if(0<b.length)return b}};return this.waitFor({method:g,callback:function(){var a=f.beginAsync();f.global.setTimeout(function(){f.endAsync(a);b.call(c||f)},100)},timeout:d,assertionName:"waitForRowsVisible",description:" "+Siesta.Resource("Siesta.Test.ExtJS.Grid").get("waitForRowsVisible")+' "'+e.id+'"'})}return this.waitForCQ(a,
function(a){this.waitForRowsVisible(a[0],b,c,d)},this)},getFirstRow:function(a){a=this.normalizeComponent(a);return this.getRow(a,0)},getFirstCell:function(a){a=this.normalizeComponent(a);return this.getCell(a,0,0)},getRow:function(a,b){var c=this.Ext();a=this.normalizeComponent(a);var d;if(c.grid.Grid&&a instanceof c.grid.Grid)d=(d=a.getViewItems()[b])&&d.element;else if(a=a.lockedGrid||a,a.getView().bufferedRenderer){var e=a.getStore().getRange(b,b+1)[0];e&&(d=a.getView().getNode(e))}else d=a&&
this.$(a.getView().itemSelector,a.getView().getEl().dom)[b];return d&&c.get(d)},getCell:function(a,b,c){return(a=(b=(a=this.normalizeComponent(a))&&this.getRow(a,b))&&this.$(a.view.cellSelector,b.dom)[c])&&this.Ext().get(a)},getLastCellInRow:function(a,b){a=this.normalizeComponent(a);return this.getCell(a,b,a.headerCt.getColumnCount()-1)},matchGridCellContent:function(a,b,c,d,e){a=this.normalizeComponent(a);a.getView();var f=this.Ext();a=this.getCell(a,b,c).child("."+f.baseCSSPrefix+"grid-cell-inner");
var f="RegExp"==this.typeOf(d),g=a.dom.innerHTML;(f?d.test(g):-1!=g.indexOf(d))?this.pass(e,{descTpl:f?"Cell content {content} matches regexp {string}":"Cell content {content} has a string {string}",content:g,string:d}):this.fail(e,{assertionName:"matchGridCellContent",got:a.dom.innerHTML,gotDesc:"Cell content",need:d,needDesc:"String matching",annotation:"Row index: "+b+", column index: "+c})},clickToEditCell:function(a,b,c,d,e){var f=this.getExt(),g=(a=this.normalizeComponent(a))&&a.editingPlugin;
if(g&&g instanceof f.grid.plugin.CellEditing){var k=this;this[2==g.clicksToEdit?"doubleClick":"click"](this.getCell(a,b,c),function(){g.getActiveEditor()||g.startEditByPosition({row:b,column:c});k.waitForSelectorAtCursor(e||".x-editor,input",d)})}else this.fail("No grid, or grid has no editing plugin, or its not a Ext.grid.plugin.CellEditing plugin"),d&&d(null)},getTrimmedCellContent:function(a,b,c){a=this.getCell(a,b,c);return $.trim(this.$(a.dom).text())},assertCellIsEmpty:function(a,b,c,d){this.is(this.getTrimmedCellContent(a,
b,c),"",d)},waitForCellEmpty:function(a,b,c,d,e,f){"function"===typeof d?f=d:"function"===typeof e&&(f=e);this.waitFor({method:function(){return 0===this.getTrimmedCellContent(a,b,c).length},callback:function(){f.call(d||this)},timeout:e,assertionName:"waitForCellEmpty",description:" "+Siesta.Resource("Siesta.Test.ExtJS.Grid").get("waitForCellEmpty")})}}});
Role("Siesta.Test.ExtJS.DataView",{requires:["waitFor","getExt"],methods:{waitForViewRendered:function(a,b,c,d){var e=(a=this.normalizeComponent(a))&&a.store&&0<a.store.getCount(),f=Siesta.Resource("Siesta.Test.ExtJS.DataView");return this.waitFor({method:function(){return e?!!a.getNode(0):a.rendered},callback:b,scope:c,timeout:d,assertionName:"waitForViewRendered",description:" "+f.get("view")+" "+a.id+" "+f.get("toRender")})},getFirstItem:function(a){var b=this.getExt();a=this.normalizeComponent(a);
return b.get(a.getNode(0))}}});Role("Siesta.Test.ExtJS.Element",{methods:{hasRegion:function(a,b,c){a=a.getRegion();var d=Siesta.Resource("Siesta.Test.ExtJS.Element");this.is(a.top,b.top,c+" "+d.get("top")+")");this.is(a.right,b.right,c+" "+d.get("right")+")");this.is(a.bottom,b.bottom,c+" "+d.get("bottom")+")");this.is(a.left,b.left,c+" "+d.get("left")+")")}}});
Role("Siesta.Test.ExtJS.FormField",{methods:{fieldHasValue:function(a,b,c){a=this.normalizeComponent(a);this.is(a.getValue(),b,c)},isFieldEmpty:function(a,b){a=this.normalizeComponent(a);var c=a.getValue();this.ok(null===c||""===c,b)}}});
Class("Siesta.Test.Browser",{isa:Siesta.Test,does:[Siesta.Util.Role.CanParseBrowser,Siesta.Util.Role.CanCalculatePageScroll,Siesta.Util.Role.Dom,Siesta.Test.Browser.Role.CanGetElementFromPoint,Siesta.Test.Browser.Role.CanWorkWithKeyboard,Siesta.Test.Browser.Role.CanRebindJQueryContext,Siesta.Test.UserAgent.Mouse,Siesta.Test.UserAgent.Keyboard,Siesta.Test.UserAgent.Touch,Siesta.Test.Element,Siesta.Test.TextSelection,Siesta.Test.Observable],has:{bowser:null,browser:null,forceDOMVisible:!1,isDOMForced:!1,
browserInfo:{lazy:function(){return this.parseBrowser(window.navigator.userAgent)}},nextConfirmValue:null,nextPromptReturnValue:null,realAlert:null,realConfirm:null,realPrompt:null,realPrint:null,realOpen:null,previousConfirm:null,previousPrompt:null,blurListener:null,restartOnBlur:!1,blurWindow:null,mouseVisualizer:null,popups:Joose.I.Array,simulator:null,simulatorConfig:null,isHandlingThrowAsync:!1,initialCursorPosition:null},override:{cleanup:function(){this.mouseVisualizer&&(this.mouseVisualizer.destroy(),
this.mouseVisualizer=null);this.SUPERARG(arguments);this.blurListener=this.previousPrompt=this.previousConfirm=this.realAlert=this.realConfirm=this.realPrompt=this.realPrint=this.realOpen=this._global=this.bowser=this.browser=null;this.blurWindow&&this.blurWindow.close();this.blurWindow=null;Joose.A.each(this.popups,function(a){a.popup.closed||a.popup.close()});this.popups.length=0;this.popups=null;this.simulator.cleanup()},attachSimulator:function(){var a=this,b=this.simulator,c=!this.parent;if(c)b.onTestLaunch(this);
if("synthetic"==b.type)c&&a.initialCursorPosition&&(b.currentPosition[0]=a.initialCursorPosition[0],b.currentPosition[1]=a.initialCursorPosition[1]);else return Promise.resolve().then(function(){if(c)return b.simulateMouseMove(a.initialCursorPosition?a.initialCursorPosition[0]:0,a.initialCursorPosition?a.initialCursorPosition[1]:0,null,{moveKind:"instant"})}).then(function(){if(!a.project.browserWindowHasFocus()){var c=b.currentPosition.slice();return b.simulateMouseMove(-1,-1,null,{moveKind:"instant"}).then(function(){return b.simulateMouseClick({globalXY:[]})}).then(function(){return b.simulateMouseMove(c[0],
c[1],null,{moveKind:"instant"})})}})},launch:function(a){var b=this,c=this.SUPER,d=this.attachSimulator();d?d.then(function(){c.call(b,a)},function(a){c.call(b,a)}):this.SUPER(a)}},methods:{initialize:function(){this.simulator||(this.simulator=new (this.getSimulatorClass())(this.simulatorConfig||{}));this.currentPosition=this.simulator.currentPosition;this.SUPERARG(arguments)},onBeforeTestFinalize:function(){this.global.alert.__EXPECTED_ALERT__&&this.fail(Siesta.Resource("Siesta.Test.Browser","alertMethodNotCalled"));
this.SUPERARG(arguments)},getSimulatorClass:function(){return Siesta.Test.Simulator},earlySetup:function(a,b){var c=this.simulator;"synthetic"==c.type?a():c.doFullSimulationReset().then(a,b)},launch:function(a){var b=this,c=this.global;b.parent||(b.realAlert=c.alert,b.realConfirm=c.confirm,b.realPrompt=c.prompt,b.realPrint=c.print,b.realOpen=c.open,this.maintainScrollPositionDuring(function(){if(!b.project.browserWindowHasFocus()&&!bowser.safari)b.onWindowBlur();c.focus&&c.focus()}),bowser.msie||
!b.project.showCursor||c.opener||(b.mouseVisualizer=new Siesta.Project.Browser.UI.MouseVisualizer({currentContainer:b.global.frameElement.parentElement})));b.previousConfirm=c.confirm;b.previousPrompt=c.prompt;c.alert=c.print=function(){};c.confirm=function(){var a="boolean"===typeof b.nextConfirmValue?b.nextConfirmValue:!0;b.nextConfirmValue=null;return a};c.prompt=function(){var a=b.nextPromptReturnValue||"";b.nextPromptReturnValue=null;return a};c.open=function(a){var e=b.realOpen.apply(c,arguments);
e?b.popups.push({url:a,popup:e}):b.fail(Siesta.Resource("Siesta.Test.Browser","popupsDisabled",{url:a}));return e};this.SUPERARG(arguments)},onTestFinalize:function(){var a=this.global;a&&(this.parent?(a.confirm=this.realConfirm,a.prompt=this.realPrompt,a.alert=a.print=function(){}):(a.confirm=this.previousConfirm,a.prompt=this.previousPrompt,a.print=this.realPrint,a.alert=this.realAlert,a.open=this.realOpen));this.SUPERARG(arguments)},onWindowBlur:function(a,b){this.restartOnBlur?this.fireEvent("focuslost"):
this.warn(Siesta.Resource("Siesta.Test.Browser").get("focusLostWarning",{url:this.url}))},sizzle:function(a,b){return Siesta.Sizzle(a,b||this.global.document)},isEventPrevented:function(a){return a.preventDefault&&"Boolean"==this.typeOf(a.preventDefault.$prevented)?a.preventDefault.$prevented:"Boolean"==this.typeOf(a.defaultPrevented)?a.defaultPrevented:!1===a.returnValue},cleanupContextBeforeStart:function(){this.cleanupContextBeforeStartDom();this.SUPER()},cleanupContextBeforeStartDom:function(){this.global.document.body.innerHTML=
""},getElementPageRect:function(a,b){b=b||this.$(a);var c=b.offset();return new Siesta.Util.Rect({left:c.left,top:c.top,width:b.outerWidth(),height:b.outerHeight()})},hasForcedIframe:function(){return!!((this.isDOMForced||this.forceDOMVisible)&&this.scopeProvider instanceof Scope.Provider.IFrame&&this.scopeProvider.iframe)},getDivBox:function(a,b,c,d,e){a=a.createElement("div");a.style.cssText="position: absolute !important; left: "+b+"px !important; top: "+c+"px !important;border-width: 0 !important; padding: 0 !important; margin: 0 !important;width: "+
d+"px !important; height: "+e+"px !important;";return a},elementIsScrolledOut:function(a,b){for(var c=a.ownerDocument,d=c.defaultView||c.parentWindow,e=c.body,c=[],f=a;f&&f!=e;f=f.parentNode)c.push(f);d=new Siesta.Util.Rect({left:this.getPageScrollX(d),top:this.getPageScrollY(d),width:this.$(d).width(),height:this.$(d).height()});for(e=c.length-1;0<=e;e--){var f=c[e],g=this.$(f).css("overflow-x"),k=this.$(f).css("overflow-y");if("visible"!=g||"visible"!=k)if(f=this.getElementPageRect(f),"visible"!=
g&&(d=d.cropLeftRight(f),d.isEmpty())||"visible"!=k&&(d=d.cropTopBottom(f),d.isEmpty()))return!0}c=this.$(a);f=this.getElementPageRect(c[0],c);b=this.normalizeOffset(b,c);return!d.contains(f.left+b[0],f.top+b[1])},scrollTargetIntoView:function(a,b){var c=this.global,d=c.document;if("Array"!=this.typeOf(a)){if(a=this.normalizeElement(a,!0,null,!1),b=this.normalizeOffset(b,this.$(a)),d=this.isOffsetInsideElementBox(a,b),a&&this.isElementVisible(a)&&d&&this.elementIsScrolledOut(a,b)){this.maintainScrollPositionDuring(function(){a.scrollIntoView()});
if(this.elementIsScrolledOut(a,b)&&(d=this.$(a).closest(":scrollable")[0])){var e=this.getBoundingClientRect(d),f=this.getBoundingClientRect(a);d.scrollLeft=Math.max(0,d.scrollLeft+f.left-e.left+b[0]-1);d.scrollTop=Math.max(0,d.scrollTop+f.top-e.top+b[1]-1)}return!0}}else{var e=this.getPageScrollX(),f=e+this.$(c).width(),g=this.getPageScrollY(),c=g+this.$(c).height();if(e<=a[0]&&a[0]<=f&&g<=a[1]&&a[1]<=c)return!1;var k=this.getDivBox(d,a[0],a[1],1,1);d.body.appendChild(k);this.maintainScrollPositionDuring(function(){k.scrollIntoView()});
d.body.removeChild(k);return!0}},processSubTestConfig:function(a){var b=this.SUPER(a),c=this;Joose.A.each("currentPosition mouseVisualizer simulator simulatorConfig bowser browser moveCursorBetweenPoints realAlert realConfirm realPrompt realPrint realOpen popups".split(" "),function(a){b[a]=c[a]});return b},normalizeElement:function(a,b,c,d){if(a&&a.nodeName)return a;c=!1;if("String"===this.typeOf(a)){var e=a;c=this.adjustScope(a);var f=this.$(0<=a.indexOf("->")?a.split("->")[1]:a);c&&this.resetScope();
a=f[0];c=1<f.length;if(!b&&!a)throw d=Siesta.Resource("Siesta.Test.Browser","noDomElementFound")+": "+e,this.warn(d),Error(d);}"Array"==this.typeOf(a)&&(2>a.length?(b=this.simulator.currentPosition[0],a=this.simulator.currentPosition[1]):(b=this.pageXtoViewportX(Math.round(a[0])),a=this.pageYtoViewportY(Math.round(a[1]))),a=this.elementFromPoint(b,a));return d?{el:a,matchingMultiple:c}:a},normalizeActionTarget:function(a,b){return this.normalizeElement(a,b)},randomBetween:function(a,b){return Math.floor(a+
Math.random()*(b-a+1))},getElementAtCursor:function(){var a=this.simulator.currentPosition;return this.elementFromPoint(a[0],a[1])},addListenerToObservable:function(a,b,c,d){this.$(a).bind(b,c)},removeListenerFromObservable:function(a,b,c){this.$(a).unbind(b,c)},getNormalizedTopElementInfo:function(a,b,c,d){var e,f;"Array"==this.typeOf(a)&&0==a.length&&(a=null);var g=!a||"Array"==this.typeOf(a);g?(a?(e=this.pageXtoViewportX(Math.round(a[0])),a=this.pageYtoViewportY(Math.round(a[1]))):(e=this.simulator.currentPosition[0],
a=this.simulator.currentPosition[1]),f=[e,a],e=this.elementFromPoint(e,a,!1,null,!0),a=e.el,e=e.localXY):a=this.normalizeElement(a,b);if(a||!b){if(!g){var k=Siesta.Resource("Siesta.Test.Browser");c="getNormalizedTopElementInfo: "+(c?k.get("targetElementOfAction")+" ["+c+"]":k.get("targetElementOfSomeAction"))+" "+k.get("isNotVisible")+": "+(a.id?"#"+a.id:a);if(this.isElementVisible(a))b||!this.isOffsetInsideElementBox(a,d)||this.elementIsTop(a,!0,d)||this.warn(c);else{this.fail(c);return}}if(b=a&&
"option"===a.nodeName.toLowerCase())e=this.simulator.currentPosition.slice(),f=this.simulator.currentPosition.slice();else if(!g&&(g=a.ownerDocument,k=Siesta.Resource("Siesta.Test.Browser"),e=this.getTargetCoordinate(a,!0,d),f=this.getTargetCoordinate(a,!1,d),a=g.elementFromPoint(e[0],e[1])||g.elementFromPoint(e[0],e[1])||g.body,!a)){this.fail("getNormalizedTopElementInfo: "+k.get("noElementFound")+" ["+e+"]");return}return{el:a,localXY:e,globalXY:f,offset:b?[0,0]:this.getOffsetRelativeToEl(a,e)}}},
getOffsetRelativeToEl:function(a,b){var c=this.getElementPageRect(a);return[b[0]-c.left,b[1]-c.top]},waitForTextPresent:function(a,b,c,d){var e=Siesta.Resource("Siesta.Test.Browser");return this.waitFor({method:function(){var b=this.global.document.body,c=":contains("+a+")";return 0<this.$(c,b).length||this.$(b).is(c)},callback:b,scope:c,timeout:d,assertionName:"waitForTextPresent",description:" "+e.get("text")+' "'+a+'" '+e.get("toBePresent")})},waitForTextNotPresent:function(a,b,c,d){var e=Siesta.Resource("Siesta.Test.Browser");
return this.waitFor({method:function(){var b=this.global.document.body,c=":contains("+a+")";return 0===this.$(c,b).length&&!this.$(b).is(c)},callback:b,scope:c,timeout:d,assertionName:"waitForTextNotPresent",description:" "+e.get("text")+' "'+a+'" '+e.get("toNotBePresent")})},waitForTarget:function(a,b,c,d,e){var f=this,g=Siesta.Resource("Siesta.Test.Browser");return this.waitFor({method:function(){var b=f.normalizeElement(a,!0,!0,!1,{offset:e});return b&&e&&f.isElementVisible(b)&&!f.isOffsetInsideElementBox(b,
e)?!0:b&&f.elementIsTop(b,!0,e)},callback:b,scope:c,timeout:d,assertionName:"waitForTarget",description:" "+g.get("target")+' "'+a+'" '+g.get("toAppear")})},setWindowSize:function(a,b,c){this.scopeProvider.setViewportSize(a,b);c&&c.call(this)},getJUnitClass:function(){var a=this.getBrowserInfo(),a=a.name+a.version;return a+":"+this.SUPER()},adjustScope:function(a){if("String"==this.typeOf(a)&&(a=a.split("->"),2===a.length)){a=this.$(this.trimString(a[0]))[0];if(!a||!a.contentWindow)return!1;this._global=
this.global;this.setGlobal(a.contentWindow);return!0}return!1},resetScope:function(){this.setGlobal(this._global||this.global);this._global=null},screenshot:function(a,b){this.diag("Command: `screenshot` skipped - not running in Standard Package");this.processCallbackFromTest(b,["skipped"],this)},screenshotElement:function(a,b,c){this.diag("Command: `screenshot` skipped - not running in Standard Package");this.processCallbackFromTest(c,["skipped"],this)},setUrl:function(a,b,c){if(!a)throw Error("Must provide a valid URL");
this.global.location.href!==a?(a=this.project.absolutizeURL(a,this.scopeProvider.sourceURL||this.project.baseUrl),this.waitForPageLoad(b,c),this.global.location.href=a):b.call(c||this)},setHash:function(a,b,c){this.global.location.hash=a;b&&b(c||this)},expectAlertMessage:function(a,b){var c=this,d=this.global,e=d.alert;d.alert=function(b){("RegExp"==c.typeOf(a)?a.test(b):a==b)?c.pass("Expected alert message has been shown"):c.fail("Wrong alert message has been shown",{assertionName:"expectAlertMessage",
got:b,gotDesc:"Message shown",need:a,needDesc:"Expected message"});d.alert=e};d.alert.__EXPECTED_ALERT__=!0;this.processCallbackFromTest(b,null,this)},setNextConfirmReturnValue:function(a,b){this.nextConfirmValue=a;this.processCallbackFromTest(b,null,this)},setNextPromptReturnValue:function(a,b){this.nextPromptReturnValue=a;this.processCallbackFromTest(b,null,this)},waitForAnimations:function(a){a.call(this)},popupHasStartedLoading:function(a,b){return"about:blank"!=String(b).toLowerCase()&&"about:blank"==
a.location.href?!1:!0},switchTo:function(a,b){var c=this;this.waitFor({method:function(){for(var a=0;a<c.popups.length;a++)if(!c.popupHasStartedLoading(c.popups[a].popup,c.popups[a].url))return!1;return!0},suppressAssertion:!0,callback:function(){var c;a||(Joose.A.each(this.popups,function(a){if(!a.popup.closed)return c=a.popup,!1}),a=c);"String"==this.typeOf(a)&&(a={title:a});if("Object"==this.typeOf(a)){c=null;var e=a.title||a.url;"String"==this.typeOf(e)&&(e=new RegExp("^"+this.escapeRegExp(e)+
"$"));Joose.A.each(this.popups,function(b){b=b.popup;if(!b.closed&&(a.url&&e.test(b.location.href)||a.title&&e.test(b.document&&b.document.title||"")))return c=b,!1});a=c}a&&a.self==a?(this.setGlobal(a),this.waitFor({suppressAssertion:!0,method:function(){return a.document&&"complete"==a.document.readyState},callback:b})):(this.fail("Can't resolve target win: "+a),this.processCallbackFromTest(b,null,this))}});return this.global},setGlobal:function(a){this.global=a;this.simulator.global=a},switchToMain:function(a){this.switchTo(this.scopeProvider.scope,
a)},waitForPageLoad:function(a,b){var c=this,d=this.global,e=!1,f=Siesta.Resource("Siesta.Test.More").get("pageToLoad"),g=function(){d.removeEventListener("unload",g);e=!0};d.addEventListener("unload",g);this.chain({description:f,waitFor:function(){return e||"complete"!=c.global.document.readyState}},function(a){d.removeEventListener("unload",g);g=d=null;a()},{description:f,waitFor:function(){return"complete"==c.global.document.readyState}},{waitFor:50},function(){c.processCallbackFromTest(a,[c.global],
b||c)})},setTimeout:function(a,b){var c=this.global.setTimeout;c(a,b)},clearTimeout:function(a){var b=this.global.clearTimeout;b(a)},simulateDeactivateWindow:function(a){this.blurWindow=this.global.open("about:blank");a&&a.call(this)},simulateActivateWindow:function(a){this.blurWindow&&this.blurWindow.close();this.global.focus();this.blurWindow=null;a&&a.call(this)},query:function(a){return this.sizzle(a)},throwsOkAsync:function(a,b,c){var d=Siesta.Resource("Siesta.Test.More"),e=this,f=!1,g=!1,k=
this.global.onerror,l=function(){if(!g)return g=!0,e.endAsync(m),f||e.fail(b,{assertionName:"throwsOkAsync",annotation:d.get("didntThrow")}),e.isHandlingThrowAsync=!1,e.global.onerror=k,!0};this.on("beforetestfinalize",function(){g||l()},null,{single:!0});var m=this.beginAsync(c,l);this.isHandlingThrowAsync=!0;this.global.onerror=function(c,g,k,l,m){f=!0;c=String(m?m:c);"RegExp"==e.typeOf(a)?c.match(a)?e.pass(b,{descTpl:d.get("exMatchesRe"),expected:a}):e.fail(b,{assertionName:"throwsOkAsync",got:c,
gotDesc:d.get("exceptionStringifiesTo"),need:a,needDesc:d.get("needStringMatching")}):-1!=c.indexOf(a)?e.pass(b,{descTpl:d.get("exContainsSubstring"),expected:a}):e.fail(b,{assertionName:"throwsOkAsync",got:c,gotDesc:d.get("exceptionStringifiesTo"),need:a,needDesc:d.get("needStringContaining")});return!0};return l},livesOkAsync:function(a,b){var c=Siesta.Resource("Siesta.Test.More"),d=this,e=!1,f=!1,g=this.global.onerror,k=function(){if(!f)return f=!0,d.endAsync(l),e||d.pass(a,{descTpl:c.get("fnDoesntThrow")}),
d.isHandlingThrowAsync=!1,d.global.onerror=g,!0};this.on("beforetestfinalize",function(){f||k()},null,{single:!0});var l=this.beginAsync(b,k);this.isHandlingThrowAsync=!0;this.global.onerror=function(b,f,g,k,l){e=!0;b=String(l?l:b);d.fail(a,{assertionName:"livesOk",annotation:c.get("fnThrew")+": "+b});return!0};return k},onException:function(){if(this.isHandlingThrowAsync)return!0}}});
Class("Siesta.Test.ExtJS",{isa:Siesta.Test.Browser,does:[Siesta.Test.ExtJSCore,Siesta.Test.ExtJS.Component,Siesta.Test.ExtJS.Element,Siesta.Test.ExtJS.FormField,Siesta.Test.ExtJS.Observable,Siesta.Test.ExtJS.Store,Siesta.Test.ExtJS.Grid,Siesta.Test.ExtJS.DataView,Siesta.Test.ExtJS.Ajax],has:{globalExtOverrides:null,extPathRegex1:/(.*ext(?:js)?(?:-\d\.\d+\.\d+)?.*?)\/(?:build\/)?ext(?:-all)?(?:-debug|-dev)?\.js/,extPathRegex2:/(.*ext(?:js)?-\d\.\d+(?:\.\d+)?.*?)\/ext-all(?:-debug|-dev)?\.js/,extPathRegex3:/(.*ext(?:js)?\/gpl\/\d\.\d+(?:\.\d+)?.*?)\/ext-all(?:-debug|-dev)?\.js/},
methods:{getExtBundlePath:function(){for(var a,b=this.project.getScriptDescriptor(this.url),c=this;b&&!a;)b.preload&&Joose.A.each(b.preload,function(b){if(b.match&&(b.match(c.extPathRegex1)||b.match(c.extPathRegex2)||c.extPathRegex3.exec(b)))return a=b,!1}),b=b.parent;return a},getExtBundleFolder:function(){for(var a,b=this.project.getScriptDescriptor(this.url),c=this;b&&!a;)b.preload&&Joose.A.each(b.preload,function(b){(b=c.extPathRegex1.exec(b)||c.extPathRegex2.exec(b)||c.extPathRegex3.exec(b))&&
(a=b[1]);return!1}),b=b.parent;return a},getNumberOfGlobalExtOverrides:function(a){var b=this.globalExtOverrides;if(null!=b)a&&a.call(this,b.length,b);else{var c=this,d=this.getExt();if(b=c.getExtBundlePath()){this.expectGlobal("0");var e=d.core.DomHelper.append(d.getBody(),{tag:"iframe",style:"width:1024px;height:768px;position:absolute;left:-10000px;top:-10000px",src:"about:blank"},!1),f=e.contentWindow;f.document.open();f.document.write('<!DOCTYPE html><html><head><script type="text/javascript" src="'+
b+'">\x3c/script></head><body></body></html>');f.document.close();var g=function(a,b){for(var c=b.split("."),d=a,e=0;e<c.length;e++)d=d[c[e]];return d},k=[/Ext\.data\.Store\.ImplicitModel|collectorThreadId|Ext\.dom\.GarbageCollector\.lastTime/,/Ext.globalEvents.cur/i,/Ext\.dd\.(DragDropManager|DragDropMgr|DDM)\.(currentPoint|offsetX|offsetY)/],l=function(a,b,c){var e=[],f;for(f in b)try{if(b.hasOwnProperty(f)){var g=b[f],l=a[f];if(!a.hasOwnProperty(f)&&"undefined"==typeof l||String(l)!=String(g)&&
("function"==typeof g||d.isPrimitive(g))){var z;a:{for(var w=c+"."+f,x=0;x<k.length;x++)if(k[x].test(w)){z=!0;break a}z=!1}z||e.push(c+"."+f)}}}catch(A){}return e};c.waitFor(function(){return f.Ext&&f.Ext.isReady},function(){var b=c.global,k=[];d.iterate(d.ClassManager.classes,function(a){if(a.match(/^Ext\./)){var c=g(f,a),d=g(b,a);if(c&&"undefined"!==typeof d){var e=l(c,d,a);k.push.apply(k,e);d.prototype&&(a=l(c.prototype,d.prototype,a+".prototype"),k.push.apply(k,a))}}});c.globalExtOverrides=k;
d.destroy(e);a&&a.call(c,k.length,k)})}else c.fail(Siesta.Resource("Siesta.Test.ExtJS","bundleUrlNotFound")),a&&a.call(c,null,null)}},assertNoGlobalExtOverrides:function(a,b){this.getNumberOfGlobalExtOverrides(function(c,d){var e=Siesta.Resource("Siesta.Test.ExtJS");null==c?this.fail(e.get("assertNoGlobalExtOverridesInvalid")):(c?this.fail(a,{assertionName:"assertNoGlobalExtOverrides",descTpl:e.get("assertNoGlobalExtOverridesPassTpl"),got:c,gotDesc:e.get("assertNoGlobalExtOverridesGotDesc"),annotation:e.get("foundOverridesFor")+
": `"+d.join("`, `")+"`"}):this.pass(a,{descTpl:e.get("assertNoGlobalExtOverridesPassTpl")}),b&&b.call(this))})},assertMaxNumberOfGlobalExtOverrides:function(a,b,c){var d=Siesta.Resource("Siesta.Test.ExtJS");this.getNumberOfGlobalExtOverrides(function(e,f){null==e?this.fail(d.get("extOverridesInvalid")):(e>a?this.fail(b,{assertionName:"assertNoGlobalExtOverrides",descTpl:d.get("foundLessOrEqualThan")+" "+a+" "+d.get("globalOverrides"),got:e,gotDesc:d.get("nbrOverridesFound"),annotation:d.get("foundOverridesFor")+
": `"+f.join("`, `")+"`"}):this.pass(b,{descTpl:d.get("foundLessOrEqualThan")+" "+a+" "+d.get("globalOverrides"),annotation:d.get("nbrOverridesFound")+": "+e}),c&&c.call(this))})},getTotalLayoutCounter:function(){var a=0;this.Ext().each(this.cq("container"),function(b){a+=b.layoutCounter});return a},assertNoLayoutTriggered:function(a,b,c){var d=this.getTotalLayoutCounter();a.call(b||this);this.is(this.getTotalLayoutCounter(),d,c)},areAnimationsRunning:function(){var a=this.Ext();return a&&a.fx&&a.fx.Manager&&
a.fx.Manager.items&&0<a.fx.Manager.items.getCount()}}});
Class("Siesta.Test.SenchaTouch",{isa:Siesta.Test.Browser,does:[Siesta.Test.ExtJSCore,Siesta.Test.ExtJS.Component,Siesta.Test.ExtJS.Element,Siesta.Test.ExtJS.Observable,Siesta.Test.ExtJS.Store,Siesta.Test.ExtJS.Ajax,Siesta.Test.ExtJS.FormField],has:{performSetup:!0,isSTSetupDone:!1,moveCursorBetweenPoints:!1},override:{isReady:function(){var a=this.SUPERARG(arguments),b=Siesta.Resource("Siesta.Test.SenchaTouch");return a.ready?this.parent||!this.performSetup||this.isSTSetupDone?{ready:!0}:{ready:!1,
reason:b.get("STSetupFailed")}:a},doStart:function(){var a=this,b=this.getExt();b&&this.performSetup&&!this.parent&&b.setup({onReady:function(){a.isSTSetupDone=!0}});this.SUPERARG(arguments)}},methods:{initialize:function(){this.parent||(this.simulator=null);this.SUPERARG(arguments)},getTouchBundlePath:function(){for(var a,b=this.project.getScriptDescriptor(this.url);b&&!a;)b.preload&&Joose.A.each(b.preload,function(b){if(b.match&&b.match(/(.*sencha-touch-\d\.\d+\.\d+.*?)\/sencha-touch(.*)\.js/))return a=
b,!1}),b=b.parent;return a},getTouchBundleFolder:function(){for(var a,b=this.project.getScriptDescriptor(this.url);b&&!a;)b.preload&&Joose.A.each(b.preload,function(b){(b=/(.*sencha-touch-\d\.\d+\.\d+.*?)\/sencha-touch(.*)\.js/.exec(b))&&(a=b[1])}),b=b.parent;return a},getExtBundleFolder:function(){var a;this.project.mainPreset.eachResource(function(b){b=b.asDescriptor();(b=/(.*sencha-touch-\d\.\d+\.\d+.*?)\/sencha-touch-all(?:-debug)?\.js/.exec(b.url))&&(a=b[1])});return a},moveFingerTo:function(a,
b,c,d){this.moveCursorTo.apply(this,arguments)},moveFingerBy:function(a,b,c){if(!a)throw Siesta.Resource("Siesta.Test.SenchaTouch").get("moveFingerByInvalidInput");this.moveCursorBy.apply(this,arguments)},scrollUntil:function(a,b,c,d,e){var f=this,g=new Date,k=b,l=Siesta.Resource("Siesta.Test.SenchaTouch");switch(k){case "u":case "up":b="down";break;case "d":case "down":b="up";break;case "l":case "left":b="right";break;case "r":case "right":b="left";break;default:throw l.get("invalidSwipeDir")+": "+
b;}var m=function(){c.call(e||f,a)?f.processCallbackFromTest(d,null,e||f):f.swipe(a,b,function(){if(new Date-g<this.waitForTimeout){var a=f.beginAsync();setTimeout(function(){f.endAsync(a);m()},1E3)}else f.fail(l.get("scrollUntilFailed"))})};m()},scrollUntilElementVisible:function(a,b,c,d,e){var f=this;c&&a?this.scrollUntil(a,b,function(){var a=f.normalizeElement(c,!0);return f.elementIsInView(a)},d,e):(a=Siesta.Resource("Siesta.Test.SenchaTouch"),this.fail(a.get("scrollUntilElementVisibleInvalid")))},
waitForScrollerPosition:function(a,b,c,d,e){return this.waitFor({method:function(){return(!("x"in b)||b.x===a.position.x)&&(!("y"in b)||b.y===a.position.y)},callback:c,scope:d,timeout:e,assertionName:"waitForScrollerPosition",description:" "+Siesta.Resource("Siesta.Test.SenchaTouch","scrollerReachPos")+" "+Siesta.Util.Serializer.stringify(b)})},areAnimationsRunning:function(){var a=this.Ext();return a&&a.Anim&&!Joose.O.isEmpty(a.Anim.running)}}});
Class("Siesta.Test.jQuery",{isa:Siesta.Test.Browser,methods:{initialize:function(){this.expectGlobals("$","jQuery");this.SUPER()},get$:function(){return this.global.$},normalizeElement:function(a){return a.jquery?a.get(0):this.SUPERARG(arguments)}}});
Class("Siesta.Content.Manager.Browser",{isa:Siesta.Content.Manager,has:{baseHost:function(){return window.location.host},baseProtocol:function(){return window.location.protocol}},methods:{load:function(a,b,c){var d=/^((?:https?|file):)?\/\/([^/]*)/i.exec(a);if(d&&(d[1]&&d[1]!=this.baseProtocol||d[2]!=this.baseHost))c("cross-domain access");else{d=new JooseX.SimpleRequest;try{d.getText(a,!0,function(a,d){a?b(d):c(this+" not found")})}catch(e){c(e)}}}}});
Class("Siesta.Content.Manager.Browser.ExtJSCore",{isa:Siesta.Content.Manager.Browser});
Class("Siesta.Project.Browser",{isa:Siesta.Project,has:{id:null,testClass:Siesta.Test.Browser,viewportClass:"Siesta.Project.Browser.UI.Viewport",viewport:null,autoRun:!1,viewDOM:!1,scaleToFit:!0,scaleToFitMode:"full",domContainerRegion:"east",showCursor:!0,showTestDurationColumn:!1,speedRun:!0,superSpeedRun:!1,mouseMovePrecision:1,failOnResourceLoadError:!1,failOnPromiseRejection:!0,contentManagerClass:Siesta.Content.Manager.Browser,scopeProvider:"Scope.Provider.IFrame",disableCaching:!1,baseUrl:window.location.href.replace(/(\?|#).*$/,
"").replace(/\/[^/]*$/,"/"),baseHost:window.location.host,baseProtocol:window.location.protocol,forceDOMVisible:bowser.msie||bowser.msedge,observerMode:!1,runInPopup:!1,pageUrl:null,useStrictMode:!0,innerHtmlHead:null,innerHtmlBody:null,runCore:"parallel",forcedRunCore:null,simulateEventsWith:{is:"rw",init:"dispatchEvent"},testOfForcedIFrame:null,autoScrollElementsIntoView:!0,enableUnreachableClickWarning:!0,maintainViewportSize:!0,viewportWidth:1024,viewportHeight:768,recorderClass:function(){return Siesta.Recorder&&
Siesta.Recorder.Recorder},recorderConfig:null,needUI:!0,stateful:!0,uiMask:null,uiMaskActive:!1,hostPageUrlStopsInheriting:function(){return this.buildHostPageUrlStopsInheriting()},rerunHotKey:"E",observerModeHotKey:"O",restartOnBlur:!1,focusChecker:{lazy:function(){var a=document.createElement("input");a.setAttribute("style","position : absolute; left : -1000px; top : -1000px");a.type="text";document.body.appendChild(a);return a}},supportEcmaModules:function(){return"noModule"in document.createElement("script")}},
after:{onBeforeScopePreload:function(a,b){if(this.viewport)this.viewport.onBeforeScopePreload(a,b)},onTestSuiteStart:function(a,b,c){if(this.viewport)this.viewport.onTestSuiteStart(a,b)},onTestSuiteEnd:function(a,b){if(this.viewport)this.viewport.onTestSuiteEnd(a,b);delete this.testOfForcedIFrame;this.uiMaskActive&&this.hideUiMask()},onTestStart:function(a){if(this.viewport)this.viewport.onTestStart(a);a.hasForcedIframe()?(this.testOfForcedIFrame&&this.hideForcedIFrame(this.testOfForcedIFrame),this.showForcedIFrame(a),
this.testOfForcedIFrame=a):this.uiMaskActive&&this.hideUiMask()},onTestUpdate:function(a,b,c){if(this.viewport)this.viewport.onTestUpdate(a,b,c);b instanceof Siesta.Result.Diagnostic&&b.isWarning&&this.needUI&&"undefined"!=typeof console&&console.warn&&console.warn(b+"")},onTestEnd:function(a){a.hasForcedIframe()&&this.hideForcedIFrame(a);a==this.testOfForcedIFrame&&(this.testOfForcedIFrame=null);if(this.viewport)this.viewport.onTestEnd(a);if(a=a.scopeProvider&&a.scopeProvider.wrapper)a.scrollLeft=
a.scrollTop=0;document.body.scrollLeft=document.body.scrollTop=0},onTestFail:function(a,b,c){if(this.viewport)this.viewport.onTestFail(a,b,c)}},methods:{setObserverMode:function(a){this.forcedRunCore=a?"sequential":null;this.observerMode=a},buildHostPageUrlStopsInheriting:function(){return{preload:[],innerHtmlHead:null,innerHtmlBody:null}},buildConfigSynonyms:function(){return Joose.O.extend(this.SUPER(),{pageUrl:"hostPageUrl",enablePageRedirect:"separateContext"})},createViewport:function(a){return Ext.create(this.viewportClass,
a)},configure:function(){this.SUPERARG(arguments);this.id=this.title||window.location.href},start:function(){bowser.opera&&(this.autoCheckGlobals=!1);bowser.msie&&!this.hasOwnProperty("runCore")&&(this.runCore="sequential");this.SUPERARG(arguments)},populateCleanScopeGlobals:function(a,b){this.disableGlobalsCheck||bowser.msie&&9>bowser.version?(this.disableGlobalsCheck=!0,b()):this.SUPER("Scope.Provider.IFrame",b)},onUnload:function(){Joose.O.each(this.scopesByURL,function(a,b){a.cleanup()})},launch:function(){Siesta.Project.Browser.FeatureSupport();
this.SUPERARG(arguments)},setup:function(a){var b=this,c=this.SUPER;window.onunload=function(){b.onUnload()};window.parent||window.focus();this.title&&(document.title=this.title);$(function(){var d=b.hasOwnProperty("needUI")||!b.isAutomated?b.needUI:!1;"undefined"!=typeof Ext&&d?(b.autoLaunchTests=!1,Ext.onReady(function(){c.call(b,function(){var c=b.getQueryParam("filter");b.viewport=b.createViewport({filter:c?decodeURIComponent(c):null,autoLaunch:b.getQueryParam("autolaunch"),title:b.title,project:b});
a&&a()})})):c.call(b,a)})},getDescriptorConfig:function(a,b,c){if(!(b in this.hostPageUrlStopsInheriting))return this.SUPERARG(arguments);var d=this.hostPageUrlStopsInheriting[b],e=!1,f=!1;do{e=e||this.descriptorHasOwnValueFor(a,"pageUrl");if(this.descriptorHasOwnValueFor(a,b))if(f=this.getConfigValueFromDescriptor(a,b),"inherit"==f)f=!0;else return f;if(e&&!f)return d;a=a.parent}while(a&&a!=this);return c?void 0:this.getConfigValueFromDescriptor(this,b)},normalizeScopeProvider:function(a){this.SUPERARG(arguments);
this.getDescriptorConfig(a,"runInPopup")&&(a.scopeProvider="Scope.Provider.Window")},getScopeProviderConfigFor:function(a,b){var c=this,d=this.SUPERARG(arguments);d.cleanupDelay=0;d.name=a.title||a.url.replace(/(.*\/)?(.*)/,"$2");d.cls="tr-iframe";d.performWrap=!0;var e=document.createElement("div");e.className="tr-iframe-wrapper";e.innerHTML="<div class='tr-close fa fa-close'>&nbsp;</div><div class='tr-iframe-wrapper-scroll-canvas'><div class='tr-iframe-wrapper-inner'></div></div>";e.childNodes[0].onclick=
function(){var b=c.getTestByURL(a.url);if(b){if(c.hideForcedIFrame(b),c.viewport)c.viewport.onManualCloseOfForcedIframe(b)}else this.parentElement.style.left="-10000px",this.parentElement.style.top="-10000px"};d.wrapper=e;d.iframeParentEl=e.childNodes[1].childNodes[0];d.sourceURL=d.sourceURL||this.getDescriptorConfig(a,"pageUrl");d.minViewportSize=d.minViewportSize||{width:this.getDescriptorConfig(a,"viewportWidth"),height:this.getDescriptorConfig(a,"viewportHeight")};d.innerHtmlHead=this.getDescriptorConfig(a,
"innerHtmlHead");d.innerHtmlBody=this.getDescriptorConfig(a,"innerHtmlBody");d.failOnResourceLoadError=this.getDescriptorConfig(a,"failOnResourceLoadError");d.failOnPromiseRejection=this.getDescriptorConfig(a,"failOnPromiseRejection");d.hasOwnProperty("useStrictMode")||(d.useStrictMode=this.getDescriptorConfig(a,"useStrictMode"));return d},getNewTestConfiguration:function(a,b,c,d){var e=this,f=this.SUPERARG(arguments);f.simulatorConfig=this.getSimulatorConfigForNewTest(a);Joose.A.each(["forceDOMVisible",
"autoScrollElementsIntoView","restartOnBlur"],function(b){f[b]=e.getDescriptorConfig(a,b)});this.observerMode&&(f.forceDOMVisible=!0);f.browser=f.bowser=bowser;return f},getSimulatorConfigForNewTest:function(a){var b=this,c={};this.hasOwnProperty("simulateEventsWith")&&(c.simulateEventsWith=this.simulateEventsWith);Joose.A.each(["mouseMovePrecision","enableUnreachableClickWarning"],function(d){c[d]=b.getDescriptorConfig(a,d)});this.superSpeedRun&&!this.descriptorHasOwnValueFor(a,"mouseMovePrecision")&&
(c.mouseMovePrecision=Infinity);this.getDescriptorConfig(a,"speedRun")&&Joose.O.extend(c,{actionDelay:1,dragDelay:10,pathBatchSize:30});return c},testMustRunSequential:function(a){return this.getDescriptorConfig(a,"forceDOMVisible")},runCoreGeneral:function(a,b,c,d){var e=this,f=this.sortDescriptors(a,this.forcedRunCore,!1);e.runCoreSharedContext(f.sharedContextGroups,b,c,function(){e.runCoreParallel(f.canRunParallel,b,c,function(){e.runCoreSequential(f.mustRunSequential,b,c,d)})})},runCoreSharedContext:function(a,
b,c,d){var e=this,f=function(d,l,m,n,r){var p=d.items;if(!p.length||c.needToStop)g(a);else{var q=p.shift(),p=0<p.length;l?e.processURL(q,q.index,b,c,function(a){f(d,!1,e.scopesByURL[q.url],q,a)},p,d):e.processUrlShared(q,q.index,b,c,function(){f(d,!1,m,n,r)},p,d,m,n,r)}},g=function(a){!a.length||c.needToStop?d():(a=a.shift(),f(a,!0))};g(a)},processUrlShared:function(a,b,c,d,e,f,g,k,l,m){function n(){function b(){r.launchTest({testHolder:m,desc:a,scopeProvider:k,contentManager:c,launchState:d,preloadErrors:p,
startTestAnchor:k.scope.StartTest,noCleanup:f,cleanupUrl:l.url,reusingSandbox:!0},e)}if(k.scope){var n=r.getDescriptorConfig(a,"testClass");"String"==r.typeOf(n)&&(n=Joose.S.strToClass(n));var v=r.getNewTestConfiguration(a,k,c,d,g);(m.test=new n(v)).earlySetup(function(){b()},function(a){p.push({isException:!1,message:a});b()})}else e()}var r=this;if(a.isMissing)e();else{var p=[];this.getDescriptorConfig(a,"transparentEx");delete k.scope.describe.called;a.testCode||this.cachePreload&&c.hasContentOf(a.url)?
k.runCode(a.testCode||c.getContentOf(a.url),n):k.runScript(this.resolveURL(a.url,k,a),n)}},normalizeURL:function(a){/^jsan:/.test(a)&&(a="/jsan/"+a.replace(/^jsan:/,"").replace(/\./g,"/")+".js");/\.js$/.test(a)||/\//.test(a)||/\.css(\?.*)?$/i.test(a)||(a="../lib/"+a.replace(/\./g,"/")+".js");return a},normalizeDescriptor:function(a,b,c,d){a=this.SUPERARG(arguments);!a.group&&a.jasmine&&(a.pageUrl=a.url,a.testCode=this.getJasmineTestCode(),a.preload=[],a.sandbox=!0);return a},resolveURL:function(a,
b,c){b&&b.sourceURL&&(a=this.absolutizeURL(a));this.disableCaching&&(/\?./.test(a)?a+="&disableCaching="+(new Date).getTime():/\?$/.test(a)||(a+="?disableCaching="+(new Date).getTime()));return a},absolutizeURL:function(a,b){if(/^((https?|file):)?\/\//.test(a))return a;if(/^\//.test(a))return this.baseProtocol+"//"+this.baseHost+a;b=b||this.baseUrl;b=b.replace(/\?.*$/,"").replace(/\/[^/]*$/,"/");var c=this.absolutizeURL(b,this.baseUrl),c=c.replace(/\/?$/,"/");return c+a},getUiMask:function(){if(this.uiMask)return this.uiMask;
var a=this.uiMask=document.createElement("div");a.className="tr-ui-mask";a.style.display="none";document.body.appendChild(a);return a},showUiMask:function(){this.getUiMask().style.display="block";this.uiMaskActive=!0},hideUiMask:function(){this.getUiMask().style.display="none";this.uiMaskActive=!1},showForcedIFrame:function(a){$.rebindWindowContext(window);a.isDOMForced=!0;var b=a.scopeProvider.wrapper;$(b).addClass("tr-iframe-forced");$(b).removeClass("tr-iframe-hidden");$(b).center();b.style.top=
this.roundNumericStyleValue(b.style.top);b.style.left=this.roundNumericStyleValue(b.style.left);a.fireEvent("testframeshow");a=b.getBoundingClientRect();document.elementFromPoint(a.left,a.top)},roundNumericStyleValue:function(a){a=/(.*?)([^\d\.-]*)$/.exec(a);return String(Math.round(Number(a[1])))+a[2]},hideForcedIFrame:function(a){$.rebindWindowContext(window);a.isDOMForced=!1;a.forceDOMVisible=!1;var b=a.scopeProvider.wrapper;$(b).removeClass("tr-iframe-forced");$(b).addClass("tr-iframe-hidden");
a.fireEvent("testframehide")},showForcedIFrameScreenshot:function(a){this.showUiMask();$.rebindWindowContext(window);a=a.scopeProvider.wrapper;$(a).addClass("tr-iframe-forced-screenshot");$(a).removeClass("tr-iframe-forced");$(a).removeClass("tr-iframe-hidden")},hideForcedIFrameScreenshot:function(a){this.hideUiMask();$.rebindWindowContext(window);var b=a.scopeProvider.wrapper;$(b).removeClass("tr-iframe-forced-screenshot");a.isDOMForced&&($(b).addClass("tr-iframe-forced"),$(b).center())},stopCurrentLaunch:function(a){if(!0===
this.SUPER(a)){if(this.viewport)this.viewport.onTestSuiteStop(a);return!0}},getQueryParam:function(a){return this.my.getQueryParam(a,!0)},getJasmineTestCode:function(){return";("+function(){StartTest(function(a){a.expectGlobals("getJasmineRequireObj","jasmineRequire","jasmine","xdescribe","describe","xdescribe","fdescribe","it","xit","fit","spyOn","fail","jsApiReporter","beforeEach","afterEach","beforeAll","afterAll","expect","pending");window.jasmine?jasmine.SiestaReporter?jasmine.SiestaReporter.importResults(a):
a.fail(a.resource("Siesta.Project.Browser","noJasmineSiestaReporter")):a.fail(a.resource("Siesta.Project.Browser","noJasmine"))})}.toString()+")();"},isStandardPackage:function(){return this.my.isStandardPackage(!0)},browserWindowHasFocus:function(){window.focus();var a=this.getFocusChecker();a.focus({preventScroll:!0});$.rebindWindowContext(window);return $(a).is(":focus")},getSelectedTest:function(){var a=this.viewport.slots.filesTree.getSelectionModel().getSelection()[0];if(a)return this.getTestByURL(a.get("url"))}},
my:{methods:{isStandardPackage:function(a){a||this.staticDeprecationWarning("isStandardPackage");return!!Siesta.Project.Browser.Automation},getQueryParam:function(a,b){b||this.staticDeprecationWarning("getQueryParam");var c=(new RegExp("(?:\\?|&)"+a+"=(.*?)(?:\\?|&|$)","i")).exec(window.location.search);return c?c[1]:null}}}});Class("Siesta.Harness.Browser",{isa:Siesta.Project.Browser});
Singleton("Siesta.Project.Browser.FeatureSupport",{does:[Siesta.Util.Role.CanCalculatePageScroll],has:{isConfigured:!1,supports:Joose.I.Object,simulator:{lazy:"this.buildWebSimulator"},tests:{init:[{id:"TouchEvents",fn:function(){return this.isEventSupported("touchend",window)}},{id:"PointerEvents",fn:function(){return!!window.PointerEvent}},{id:"MSPointerEvents",fn:function(){return!!window.MSPointerEvent}},{id:"PointerEventsGeneric",fn:function(){return!(!window.PointerEvent&&!window.MSPointerEvent)}},
{id:"mouseEnterLeave",fn:function(){var a=document.createElement("div");return"onmouseenter"in a&&"onmouseleave"in a}},{id:"enterOnAnchorTriggersClick",fn:function(){var a=this.getSimulator(),b=Siesta.Test.UserAgent.KeyCodes().keys.ENTER,c=!1,d=$('<a href="foo" style="display:none">test me</a>');$("body").append(d);d.focus({preventScroll:!0});d.click(function(a){c=!0;return!1});a.simulateEvent(d,"keypress",{keyCode:b,charCode:0});d.remove();return c}},{id:"canSimulateKeyCharacters",fn:function(){var a=
this.getSimulator(),b=$('<input class="siesta-hidden" type="text" />'),c=Siesta.Test.UserAgent.KeyCodes().keys.A;$("body").append(b);b.focus({preventScroll:!0});a.simulateEvent(b,"keypress",{keyCode:c,charCode:c});a.simulateEvent(b,"textInput",{text:"A"});a="A"===b.val();b.remove();return a}},{id:"canSimulateBackspace",fn:function(){var a=this.getSimulator(),b=$('<input class="siesta-hidden" type="text" />'),c=Siesta.Test.UserAgent.KeyCodes().keys.BACKSPACE,d=Siesta.Test.UserAgent.KeyCodes().keys.A;
$("body").append(b);b.focus({preventScroll:!0});a.simulateEvent(b,"keypress",{keyCode:d,charCode:d});a.simulateEvent(b,"keypress",{keyCode:d,charCode:d});a.simulateEvent(b,"keypress",{keyCode:c,charCode:c});a="A"===b.val();b.remove();return a}},{id:"enterSubmitsForm",fn:function(){var a=this.getSimulator(),b=Siesta.Test.UserAgent.KeyCodes().keys.ENTER,c=!1,d=$('<form method="post"><input type="text"/></form>'),e=$(d).find("input");$("body").append(d);d[0].onsubmit=function(a){c=!0;return!1};e.focus({preventScroll:!0});
a.simulateEvent(e,"keypress",{keyCode:b,charCode:0});d.remove();return c}},{id:"imageWithIdCreatesGlobalEnumerable",fn:function(){var a=$('<img id="test_img_id"/>');$("body").append(a);var b=!1,c;for(c in window)"test_img_id"==c&&(b=!0);a.remove();return b}},{id:"inputFiresChangeAfterLosingFocus",fn:function(){var a=this.getSimulator(),b=document.createElement("input"),c=!1,d=Siesta.Test.UserAgent.KeyCodes().keys.A;b.className="siesta-hidden";document.body.appendChild(b);b.addEventListener("change",
function(a){c=a.isTrusted});b.focus({preventScroll:!0});a.simulateEvent(b,"keydown",{keyCode:d,charCode:d});a.simulateEvent(b,"keypress",{keyCode:d,charCode:d});a.simulateEvent(b,"keyup",{keyCode:d,charCode:d});a.simulateEvent(b,"textInput",{text:"A"});b.blur();document.body.removeChild(b);return c}}]}},methods:{buildWebSimulator:function(){return new Siesta.Test.Simulator({global:window,test:{normalizeElement:function(a){return a[0]||a}}})},configure:function(){this.isConfigured||(this.isConfigured=
!0,this.maintainScrollPositionDuring(function(){for(var a=0;a<this.tests.length;a++){var b=this.tests[a],c=b.id,b=b.fn;try{this.supports[c]=b.call(this)}catch(d){this.supports[c]=!1}}}))},isEventSupported:function(a,b){var c;if(!a)return!1;b&&"string"!==typeof b||(b=document.createElement(b||"div"));a="on"+a;c=a in b;c||(b.setAttribute||(b=document.createElement("div")),b.setAttribute(a,""),c="function"===typeof b[a],void 0!==b[a]&&(b[a]=void 0),b.removeAttribute(a));return c}}});
Role("Siesta.Project.Browser.ExtJSCore",{has:{loaderPath:null,requires:null,waitForExtComponentQueryReady:!0,failKnownBugIn:!1,recorderClass:function(){return Siesta.Recorder.ExtJS}},override:{getNewTestConfiguration:function(a,b,c,d){var e=this.SUPERARG(arguments);e.loaderPath=this.getDescriptorConfig(a,"loaderPath");e.requires=this.getDescriptorConfig(a,"requires");e.waitForExtComponentQueryReady=this.getDescriptorConfig(a,"waitForExtComponentQueryReady");return e},buildSandboxHashStructure:function(){var a=
this.SUPERARG(arguments);a.push("loaderPath","requires");return a},buildHostPageUrlStopsInheriting:function(){var a=this.SUPER();a.loaderPath=!0;return a}},methods:{createViewport:function(a){return Ext.create("Siesta.Project.Browser.UI.Viewport",a)},generateLoaderPathHook:function(){return function(a,b,c){c&&!a.loaderPathHookInstalled&&b&&b.Loader&&b.Loader.setPath&&(a.loaderPathHookInstalled=!0,b.Loader.setPath(c))}},getLoaderPathHook:function(){return";("+function(a){var b=(window.opener||window.parent).Siesta.my.activeHarness;
eval("("+a+")")(StartTest,Ext,b.getDescriptorConfig(b.getScriptDescriptor(StartTest.id),"loaderPath"))}.toString()+")("+JSON.stringify(this.generateLoaderPathHook().toString())+")"}}});
Class("Siesta.Project.Browser.ExtJS",{isa:Siesta.Project.Browser,does:[Siesta.Project.Browser.ExtJSCore],has:{testClass:Siesta.Test.ExtJS,waitForExtReady:!0,waitForAppReady:!1,extVersion:null,failOnMultipleComponentMatches:!1,extVersionRegExp:/ext(?:js)?-(\d\.\d+\.\d+.*?)\//,contentManagerClass:Siesta.Content.Manager.Browser.ExtJSCore,innerHtmlHead:'<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">'},methods:{setup:function(a){Function.prototype.$extIsFunction=
!0;this.SUPER(function(){a()})},getNewTestConfiguration:function(a,b,c,d){var e=this.SUPERARG(arguments);e.waitForExtReady=this.getDescriptorConfig(a,"waitForExtReady");e.waitForAppReady=this.getDescriptorConfig(a,"waitForAppReady");return e},findExtVersion:function(){var a=this,b;this.mainPreset.eachResource(function(c){if(c=a.extVersionRegExp.exec(c.url))return b=c[1],!1});return b}}});Class("Siesta.Harness.Browser.ExtJS",{isa:Siesta.Project.Browser.ExtJS});
Class("Siesta.Project.Browser.SenchaTouch",{isa:Siesta.Project.Browser,does:[Siesta.Project.Browser.ExtJSCore],has:{testClass:Siesta.Test.SenchaTouch,transparentEx:!0,keepNLastResults:0,performSetup:!0,forcedRunCore:"sequential",isRunningOnMobile:!0,contentManagerClass:Siesta.Content.Manager.Browser.ExtJSCore},methods:{setup:function(){this.isRunningOnMobile="undefined"!==typeof Ext&&Ext.getVersion&&Ext.getVersion("touch");this.isRunningOnMobile||(this.keepNLastResults=2);this.SUPERARG(arguments)},
getNewTestConfiguration:function(a,b,c,d){var e=this.SUPERARG(arguments),f=this.getDescriptorConfig(a,"pageUrl");!a.hasOwnProperty("performSetup")&&f?e.performSetup=!1:e.performSetup=this.getDescriptorConfig(a,"performSetup");return e}}});Class("Siesta.Harness.Browser.SenchaTouch",{isa:Siesta.Project.Browser.SenchaTouch});
Class("Siesta.Project.Browser.UI.MouseVisualizer",{has:{cursorEl:null,currentContainer:{required:!0},clickEvents:function(){return{click:null,touchend:null,contextmenu:null}},mouseDownEvents:function(){return{touchstart:null,mousedown:null}},mouseUpEvents:function(){return{touchend:null,mouseup:null}}},methods:{initialize:function(a){this.onEventSimulated=this.onEventSimulated.bind(this)},getCursorEl:function(){if(this.cursorEl)return this.cursorEl;var a=this.currentContainer;if(!a)throw"Need container for cursor";
var b=document.createElement("div");b.className="ghost-cursor fa fa-mouse-pointer";return this.cursorEl=a.appendChild(b)},destroy:function(){var a=this.cursorEl;a&&(a.parentElement.removeChild(a),this.cursorEl=null);this.currentContainer=null},onEventSimulated:function(a,b){"number"===typeof a.clientX&&this.updatePointer(a.type,b)},updatePointer:function(a,b){var c=b[0],d=b[1];this.updateGhostCursor(c,d);a in this.clickEvents?this.showClickIndicator(a,c,d):a in this.mouseDownEvents&&this.getCursorEl().classList.add("ghost-cursor-press");
(a in this.mouseUpEvents||a in this.clickEvents)&&this.getCursorEl().classList.remove("ghost-cursor-press")},showClickIndicator:function(a,b,c){a=document.createElement("div");a.className="ghost-cursor-click-indicator ";a.style.setProperty("left",b+"px");a.style.setProperty("top",c+"px");a.addEventListener("animationend",this.afterAnimation);a.addEventListener("webkitAnimationEnd",this.afterAnimation);this.currentContainer.appendChild(a)},afterAnimation:function(){this.parentElement&&this.parentElement.removeChild(this)},
updateGhostCursor:function(a,b){var c=this.getCursorEl(),d=bowser.opera?"translate("+a+"px,"+b+"px)":"translate3d("+a+"px, "+b+"px, 0)";c.style.setProperty("-webkit-transform",d);c.style.setProperty("transform",d)}}});"undefined"!=typeof module&&(module.exports=Siesta);
Class("Siesta.Util.Throttler",{has:{lastActivationTime:null,func:{required:!0},scope:{required:!0},buffer:null,throttle:null,bufferTimeoutId:null,args:null},methods:{tick:function(){var a=new Date-0;this.args=arguments;null!=this.throttle&&(this.lastActivationTime||(this.lastActivationTime=a),a-this.lastActivationTime>this.throttle&&this.activate());if(null!=this.buffer){var b=this;this.bufferTimeoutId&&clearTimeout(this.bufferTimeoutId);this.bufferTimeoutId=setTimeout(function(){b.activate()},this.buffer)}},
activate:function(){this.lastActivationTime=new Date-0;this.bufferTimeoutId&&clearTimeout(this.bufferTimeoutId);this.bufferTimeoutId=null;var a=this.args;this.args=null;this.func.apply(this.scope,a)},cancel:function(){this.bufferTimeoutId&&clearTimeout(this.bufferTimeoutId);this.args=this.bufferTimeoutId=null},flush:function(){null!=this.bufferTimeoutId&&this.activate()}}});
Role("Siesta.Util.Role.CanCalculatePageScroll",{methods:{getElForPageScroll:function(a){a=a||this.global;a=a.document;return a.scrollingElement||(bowser.webkit||bowser.blink||bowser.msedge?a.body:a.documentElement)},getPageScrollX:function(a){a=a||this.global;return null!=window.pageXOffset?a.pageXOffset:(a=this.getElForPageScroll())?a.scrollLeft:0},getPageScrollY:function(a){a=a||this.global;return null!=window.pageYOffset?a.pageYOffset:(a=this.getElForPageScroll())?a.scrollTop:0},viewportXtoPageX:function(a,
b){b=b||this.global;var c=b.document.documentElement;return a+this.getPageScrollX(b)-c.clientLeft},viewportYtoPageY:function(a,b){b=b||this.global;var c=b.document.documentElement;return a+this.getPageScrollY(b)-c.clientTop},pageXtoViewportX:function(a,b){b=b||this.global;var c=b.document.documentElement;return a-this.getPageScrollX(b)+c.clientLeft},pageYtoViewportY:function(a,b){b=b||this.global;var c=b.document.documentElement;return a-this.getPageScrollY(b)+c.clientTop},maintainScrollPositionDuring:function(a,
b){var c=window.parent,d=!!c,e=d&&this.getPageScrollX(c),f=d&&this.getPageScrollY(c);a.call(b||this);d&&(d=this.getElForPageScroll(c),e!==this.getPageScrollX(c)&&(d.scrollLeft=e),f!==this.getPageScrollY(c)&&(d.scrollTop=f))}}});
Role("Siesta.Util.Role.Dom",{does:[Siesta.Util.Role.CanCalculatePageScroll],has:{doesNotIncludeMarginInBodyOffset:!1},methods:{isCrossOriginWindow:function(a){try{var b=a.document}catch(c){return!0}return!b},closest:function(a,b,c){c=c||Number.MAX_VALUE;for(var d=a.ownerDocument.documentElement,e=0;e<c&&a&&a!==d;a=a.parentNode){if(Siesta.Sizzle.matchesSelector(a,b))return a;e++}return!1},contains:function(a,b){if(!a)return!1;if(a.contains)return a.contains(b);if(a.compareDocumentPosition)return a===
b||!!(a.compareDocumentPosition(b)&16);throw Error("Can't determine `contains` status");},matches:function(a,b){return Siesta.Sizzle.matchesSelector(a,b)},offset:function(a){if(!a)return null;var b=a.ownerDocument;if(!b)return null;if(a===b.body)return this.bodyOffset(a);a=this.getBoundingClientRect(a);b=b.defaultView||b.parentWindow;return a?{left:this.viewportXtoPageX(Math.floor(a.left),b),top:this.viewportYtoPageY(Math.floor(a.top),b)}:{left:0,top:0}},bodyOffset:function(a){var b=a.offsetTop,c=
a.offsetLeft;this.initializeOffset();this.doesNotIncludeMarginInBodyOffset&&(a=getComputedStyle(a),b+=parseFloat(a.marginTop)||0,c+=parseFloat(a.marginLeft)||0);return{top:b,left:c}},initializeOffset:function(){var a=document.body,b=document.createElement("div"),c=parseFloat(getComputedStyle(a).marginTop)||0,d={position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"},e;for(e in d)b.style[e]=d[e];b.innerHTML="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";
a.insertBefore(b,a.firstChild);d=b.firstChild;e=d.firstChild;e.style.position="fixed";e.style.top="20px";e.style.position=e.style.top="";d.style.overflow="hidden";d.style.position="relative";this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==c;a.removeChild(b);this.initializeOffset=function(){}},getElementWidth:function(a){return this.getBoundingClientRect(a).width},getElementHeight:function(a){return this.getBoundingClientRect(a).height},getWindowSize:function(a){var b=a.document;return{width:a.innerWidth||
b.documentElement.clientWidth||b.body.clientWidth,height:a.innerHeight||b.documentElement.clientHeight||b.body.clientHeight}},isPointWithinElement:function(a,b,c){c=this.getBoundingClientRect(c);return a>=c.left&&a<=c.right&&b>=c.top&&b<=c.bottom},isElementReachableAt:function(a,b,c,d){d=!1!==d;var e=a.ownerDocument,f=e.defaultView||e.parentWindow;return(b=e.elementFromPoint(this.pageXtoViewportX(b,f),this.pageYtoViewportY(c,f)))&&(b===a||d&&this.contains(a,b))},isElementReachableAtCenter:function(a,
b){b=!1!==b;var c=this.offset(a);return this.isElementReachableAt(a,c.left+this.getElementWidth(a)/2,c.top+this.getElementHeight(a)/2,b)},getBoundingClientRect:function(a){var b=a.ownerSVGElement;if(b&&(bowser.msie||bowser.msedge||bowser.gecko)){a=a.getBBox();var c=b.getBoundingClientRect(),b=c.left+a.x,c=c.top+a.y;return{x:b,y:c,left:b,top:c,bottom:c+a.height,height:a.height,width:a.width}}return a.getBoundingClientRect()},nodeIsUnloaded:function(a){try{a&&a.tagName;var b=a.ownerDocument;return!(b&&
(b.defaultView||b.parentWindow))}catch(c){return!0}},nodeIsOrphan:function(a){var b=a.ownerDocument;return!b||!b.body||!a.parentNode||!(a===b.body||$.contains(b.body,a))},getNodeParents:function(a){for(var b=[];a&&a.parentNode;a=a.parentNode)b.unshift(a);return b},getCommonAncestor:function(a,b){var c=this.getNodeParents(a),d=this.getNodeParents(b);if(c[0]!=d[0])return null;for(var e=0;e<c.length;e++)if(c[e]!==d[e])return c[e-1]}}});
Role("Siesta.Util.Role.CanParseOs",{methods:{parseOS:function(a){return/Win/i.test(a)?"Windows":/Mac/.test(a)||/darwin/i.test(a)?"MacOS":/Linux/i.test(a)?"Linux":"unknown"}}});Role("Siesta.Util.Role.CanGetType",{methods:{typeOf:function(a){return Object.prototype.toString.call(a).slice(8,-1)}}});
Role("Siesta.Util.Role.CanMergeArrayAttributeFromClassHierarchy",{methods:{mergeArrayAttributeFromClassHierarchy:function(a,b){for(var c=[],d=this.meta;d.hasAttribute(a);d=d.superClass.meta)c.push(d.getAttribute(a).init());b.hasOwnProperty(a)&&this[a]&&c.unshift(this[a]);var e=[];c.forEach(function(a){e.push.apply(e,a)});return e}}});
Role("Siesta.Recorder.Role.CanSwallowException",{does:[JooseX.Observable],has:{swallowExceptions:!1},methods:{safeBind:function(a,b){var c=this;b=b||c;return c.swallowExceptions?function(){try{return a.apply(b,arguments)}catch(d){c.fireEvent("exception",d)}}:a.bind(b)}}});
Class("Siesta.Recorder.Target",{has:{targets:Joose.I.Array,activeTarget:null},methods:{initialize:function(){this.targets||(this.targets=[]);var a=this.targets[0];a&&!this.activeTarget&&(this.activeTarget=a.type)},clear:function(){this.targets=[]},getTargets:function(){var a=this.getTarget();return a&&a.targets||null},getTargetAsQueryString:function(){var a=this.getTarget();return"xy"==a.type?a.target:("cq"==a.type?">>":"")+a.target},getTarget:function(){return this.getTargetByType(this.activeTarget)},
clearOffset:function(){this.setOffset(null)},setOffset:function(a){var b=this.getTarget();b&&(a?b.offset=a:delete b.offset)},getOffset:function(){var a=this.getTarget();if(a)return a.offset},getTargetByType:function(a){var b;Joose.A.each(this.targets,function(c){if(c.type==a)return b=c,!1});return b},setUserTarget:function(a,b){var c=this.getTargetByType("user");c?(c.target=a,b?c.offset=b:delete c.offset):(c={type:"user",target:a},b&&(c.offset=b),this.targets.unshift(c));this.activeTarget="user"},
isTooGeneric:function(){var a=this.targets;if(!a||0===a.length||1===a.length&&"xy"==a[0].type)return!0;if(2===a.length){var a=this.getTargetByType("xy"),b=this.getTargetByType("css");if(a&&b&&"body"==b.target)return!0}return!1}}});
!function(){var a=1;Class("Siesta.Recorder.Event",{has:{id:function(){return a++},type:null,timestamp:function(){return Date.now()},options:null,x:null,y:null,target:null,charCode:null,keyCode:null,button:null,rawEvent:null},methods:{},my:{has:{HOST:null},methods:{fromDomEvent:function(a){var c={};["altKey","ctrlKey","metaKey","shiftKey"].forEach(function(d){a[d]&&(c[d]=!0)});var d=a.target,e={type:a.type,target:d,options:c,rawEvent:a};if(a.type.match(/^key/))e.charCode=a.charCode||a.keyCode,e.keyCode=
a.keyCode;else if("number"===typeof a.clientX){var f=d&&d.ownerDocument,d=f&&f.documentElement,g=(f=f&&f.body)?a.clientY+(f.scrollTop||d.scrollTop):a.pageY;e.x=f?a.clientX+(f.scrollLeft||d.scrollLeft):a.pageX;e.y=g;e.button=a.button}return new this.HOST(e)}}}})}();
!function(){var a=1;Class("Siesta.Recorder.Action",{has:{id:function(){return a++},action:null,value:null,target:null,toTarget:null,by:null,waitForPageLoad:!1,options:null,sourceEvent:null,sourceEventTargetReachableAtCenter:!1,timestamp:function(){return(new Date).getTime()}},methods:{initialize:function(){var a=this.target;!a||a instanceof Siesta.Recorder.Target||(this.target=new Siesta.Recorder.Target({targets:a}));!(a=this.toTarget)||a instanceof Siesta.Recorder.Target||(this.toTarget=new Siesta.Recorder.Target({targets:a}))},
setAction:function(a){this.action=a;this.hasTarget()||(this.target&&this.target.clear(),this.toTarget&&this.toTarget.clear())},hasTarget:function(){var a=this.action||"";return this.isMouseAction()||"selectText"==a},getTarget:function(a){var c=this.target;return a?c:c&&c.getTarget()},getTimestamp:function(){return this.sourceEvent&&this.sourceEvent.timestamp||this.timestamp},isMouseAction:function(){return(this.action||"").toLowerCase()in{click:1,contextmenu:1,dblclick:1,drag:1,mousedown:1,mouseup:1,
movecursorto:1}},resetValues:function(){this.sourceEvent=this.options=this.by=this.toTarget=this.value=this.target=null;this.waitForPageLoad=!1},parseOffset:function(a){a=a.split(",");if(!(2>a.length))return!a[0].match("%")&&(a[0]=parseInt(a[0],10),isNaN(a[0]))||!a[1].match("%")&&(a[1]=parseInt(a[1],10),isNaN(a[1]))?void 0:a},clearTargetOffset:function(a){this.setTargetOffset(null,a)},restoreTargetOffset:function(){var a=this.target;a&&a.__SAVED_OFFSET__&&(a.setOffset(a.__SAVED_OFFSET__),delete a.__SAVED_OFFSET__)},
setTargetOffset:function(a,c){var d=this.target;if(d){if(c){var e=d.getTarget();d.__SAVED_OFFSET__=e.offset}d.setOffset(a)}},getTargetOffset:function(){var a=this.target;if(a)return a.getOffset()},objectToSource:function(a){var c=this,d="",e,f=function(d,e){e=e||a[d];return e instanceof Array?d+" : "+JSON.stringify(e):e&&"object"===typeof e?d+" : "+c.objectToSource(e):d+" : "+("string"===typeof e?'"'+e+'"':e)};"type"==a.action?(d=f("type",a.text),e=!0,delete a.action,delete a.text):a.target&&(d=f(a.action,
a.target),e=!0,delete a.target,delete a.action);var g=Object.keys(a);0<g.length&&(d=d+(e?", ":"")+g.map(function(a){return f(a)}).join(", "));return"{ "+d+" }"},asCode:function(){var a=this.asStep();return a?"function"==typeof a?a:this.objectToSource(a):null},asStep:function(a){a=this.action;if(!a)return null;var c={action:this.action},d=this.getTarget(),e=this.value;if(this.hasTarget()||"type"==a||"scrollTo"==a){if(d)if("cq"==d.type){var f=d.target.indexOf("->");c.target=0<f?d.target.split("->").splice(1,
0,">>").join():">>"+d.target}else c.target=d.target;else c.target="";d&&d.offset&&(c.offset=d.offset.slice())}this.options&&!Joose.O.isEmpty(this.options)&&(c.options=this.options);if(a.match(/^waitFor/))switch(a){case "waitForFn":return{waitFor:eval("(function() {\n        "+e.replace(/\n/g,"\n        ")+"\n    })")};case "waitForMs":return{waitForMs:parseInt(e,10)};default:return c={},c[a]=e||[],c}else switch(a){case "click":case "dblclick":case "contextmenu":case "mousedown":case "mouseup":case "moveCursorTo":break;
case "scrollTo":return{scrollTo:[c.target,e[0],e[1]]};case "moveCursorAlongPath":case "moveMouseAlongPath":return c={},c[a]=[e],c;case "screenshot":c={screenshot:e};break;case "moveCursorBy":a=this.value.split(",");a[0]=parseInt(a[0],10);a[1]=parseInt(a[1],10);c={action:"moveCursor",by:a};break;case "type":c.text=e;break;case "drag":if((a=this.toTarget)&&!a.isTooGeneric()){c.to=a.target;a.offset&&(c.toOffset=a.offset);break}c.by=this.by;break;case "fn":return eval("(function(next) {\n        "+e.replace(/\n/g,
"\n        ")+"\n        next();\n    })");default:return c={},c[a]=e,c}return this.waitForPageLoad?{waitForPageLoad:[],trigger:c}:c}}})}();Role("Ariadne.QueryFinder.TreeWalker",{methods:{getParent:function(a){throw Error("Abstract method called: `getParent`");},contains:function(a,b){throw Error("Abstract method called: `contains`");}}});
Class("Ariadne.QueryFinder.Identifier",{does:Siesta.Util.Role.CanMergeArrayAttributeFromClassHierarchy,has:{finder:{required:!0},priority:100},methods:{identify:function(a,b,c){return[]}}});
Class("Ariadne.QueryFinder.Combinator",{has:{elements:{required:!0},currentCombLen:null,combination:null},methods:{forAllCombinations:function(a){for(var b=this.elements.length,c=this.combination,d=c?c.length:1;d<=b;d++)if(this.combination=c=this.forAllCombinationsOfLength(d,a,c))return!1},forAllCombinationsOfLength:function(a,b,c){var d=this.elements,e=d.length;if(!(a>e)){if(!c){c=Array(a);for(var f=0;f<a;f++)c[f]={current:f,max:e-a+f}}if(c.length!=a)throw Error("Wrong combination state");do{f=[];
for(e=0;e<a;e++)f.push(d[c[e].current]);if(!1===b(f))return c;e=!0;for(f=a-1;0<=f;f--){var g=c[f];if(g.current<g.max){g.current++;e=!1;for(f+=1;f<a;f++)c[f].current=c[f-1].current+1;break}}}while(!e)}}}});
Role("Ariadne.QueryFinder.PathFinder",{has:{weightOptions:Joose.I.Array,weightOptionsByWeight:Joose.I.Object},methods:{extendPathVariants:function(a,b,c){0==a.length&&(a=[{segmentsById:{},hash:"",weight:0,ids:[]}]);for(var d=a.length,e=b.length,f=[],g={},k=0;k<d;k++)for(var l=a[k],m=0;m<e;m++){var n=b[m];if(null==c||n.indicies[c]){for(var n=n.variant,r=l,p=!1,q=0;q<n.length;q++){var t=n[q];r.segmentsById[t.id]||(p||(p=!0,r=this.clonePathVariant(l)),r.segmentsById[t.id]=t,r.weight+=t.weight,r.ids.push(t.id))}p&&
(r.ids.sort(function(a,b){return a-b}),r.hash=r.ids.join(""));g[r.hash]||(g[r.hash]=!0,f.push(r))}}return f},clonePathVariant:function(a){a=Object.assign?Object.assign({},a):Joose.O.copy(a);a.segmentsById=Object.assign?Object.assign({},a.segmentsById):Joose.O.copy(a.segmentsById);a.ids=a.ids.slice();return a},collectAllSimplePathsOfWeight:function(a,b,c){b=b?b.slice():[""];for(var d=b.length,e=0;e<d;e++)b[e]+=(c?"_+":"_")+this.index;c=this.weightOptionsByWeight[a];if(!c)throw Error("Incorrect path weight");
c=c.minFromEdgesById;if(Joose.O.isEmpty(c))return b;var d=[],f;for(f in c)e=c[f],d.push.apply(d,e.fromNode.collectAllSimplePathsOfWeight(a-e.weight,b,e.isDirectChild));return d},collectFullSimplePathCollection:function(){for(var a=[],b=0;b<this.weightOptions.length;b++){var c=this.weightOptions[b];a.push({weight:c.weight,simplePaths:this.collectAllSimplePathsOfWeight(c.weight)})}return a}}});
Class("Ariadne.QueryFinder.Edge",{does:Siesta.Util.Role.HasUniqueGeneratedId,has:{finder:{required:!0},maze:{required:!0},fromNode:{required:!0},toNode:{required:!0},segmentVariants:Joose.I.Array,segmentVariantsHashes:Joose.I.Object,isDirectChild:!1,weight:Infinity},methods:{register:function(){var a=this.fromNode,b=this.toNode;if(a.edgesToByIndex[b.index])throw Error("Edge already exists");if(b.edgesFromByIndex[a.index])throw Error("Edge already exists");a.edgesToByIndex[b.index]=this;b.edgesFromByIndex[a.index]=
this},consumeVariant:function(a,b){1==arguments.length&&(b=this.finder.combineSegments(a));var c=b.weight,d=b.hash;this.weight>c&&(this.weight=c,this.segmentVariants=[],this.segmentVariantsHashes={});if(this.weight==c&&!this.segmentVariantsHashes[d])return c={},c[a[0].index]=!0,this.segmentVariantsHashes[d]=!0,this.segmentVariants.push({variant:a,hash:d,indicies:c}),!0},relax:function(){var a=this.fromNode,b=this.toNode;if(a.isReachedWithDirectChildEdge()){for(var c=a.index,d=this.segmentVariants,
e=!1,f=0;f<d.length;f++)if(d[f].indicies[c]){e=!0;break}if(!e)return!1}a=this.weight+a.weightOptions[0].weight;if((f=b.weightOptionsByWeight[a])&&!f.minFromEdgesById[this.id])return f.minFromEdgesById[this.id]=this,!0;if(!f){f={};f[this.id]=this;c={weight:a,minFromEdgesById:f};b.weightOptionsByWeight[a]=c;b=b.weightOptions;for(f=0;f<b.length;f++)if(a<b[f].weight)return b.splice(f,0,c),!0;b.push(c);return!0}}}});
Class("Ariadne.QueryFinder.Node",{does:[Siesta.Util.Role.HasUniqueGeneratedId,Ariadne.QueryFinder.PathFinder],has:{finder:{required:!0},maze:{required:!0},el:{required:!0},index:null,segments:null,combinator:null,upNode:null,downNode:null,queryCache:Joose.I.Object,edgesToByIndex:Joose.I.Object,edgesFromByIndex:Joose.I.Object,directChildUpEdge:null},methods:{contains:function(a){return this.finder.contains(this.el,a.el)},setSegments:function(a){var b=this;a.sort(function(a,b){return a.weight-b.weight});
a.forEach(function(a){b.adoptSegment(a)});this.segments=a;this.combinator=new Ariadne.QueryFinder.Combinator({elements:a})},adoptSegment:function(a){a.index=this.index;a.id=this.maze.segmentsIdGen++},isReachedWithDirectChildEdge:function(){var a=this.weightOptions[0].minFromEdgesById,b;for(b in a)if(a[b].isDirectChild)return!0;return!1},addEdgeTo:function(a,b,c){2==arguments.length&&(c=this.finder.combineSegments(b));var d=this.edgesToByIndex[a.index];d||(d=new Ariadne.QueryFinder.Edge({finder:this.finder,
maze:this.maze,fromNode:this,toNode:a}),d.register());if(d.weight>=c.weight)return d.consumeVariant(b,c)},addAllEdgesTo:function(a,b,c){if(a==this||this.contains(a))throw Error("Invalid nodes for edge");2==arguments.length&&(c=this.finder.combineSegments(b));for(var d=this;d&&d!=a;d=d.upNode)for(var e=d.upNode;e&&e!=a.upNode;e=e.upNode)d.addEdgeTo(e,b,c)},buildEdges3:function(a){var b=this,c=this.el,d=this.finder,e=this.maze,f=e.getRoot(),g=!1;this.combinator.forAllCombinationsOfLength(a,function(a){var l=
d.combineSegments(a);if(l)for(var m=l.query,n=f;n&&n!=b;){var r=b.edgesToByIndex[n.index];if(!(r&&l.weight>r.weight))if(r=e.doQuery(m,n),1==r.length&&r[0]==c){b.addAllEdgesTo(n,a,l);if(n==f&&l.hasId)return g=!0,!1;break}else if(0<r.length){for(var p=n.downNode,q=null;p&&p!=b;){for(var t=!0,v=0;v<r.length;v++)if(p.el==r[v]||!d.contains(p.el,r[v])){t=!1;break}if(t)q=p;else break;p=p.downNode}q&&(q.addAllEdgesTo(n,a,l),n=q)}n=n.downNode}});return!g}}});
Class("Ariadne.QueryFinder.Maze",{does:[Siesta.Util.Role.CanGetType],has:{finder:{required:!0},nodes:Joose.I.Array,segmentsIdGen:1,encounteredMandatoryId:!1},methods:{getRoot:function(){return this.nodes[this.nodes.length-1]},doQuery:function(a,b){var c=b.queryCache;return c[a]?c[a]:c[a]=this.finder.doQuery(a,b.el)},buildVertices:function(a,b){for(var c=this.nodes=[],d=a,e,f=this.finder,g=f.identifiers,k=f.directChildIdentifier;d;){var l=new Ariadne.QueryFinder.Node({finder:f,maze:this,el:d,index:c.length});
if(e&&(e.upNode=l,l.downNode=e,k)){var m=k.identify(e.el,b,this);if(m){var m=this.normalizeIdentifierResult(m)[0],n=new Ariadne.QueryFinder.Edge({finder:f,maze:this,isDirectChild:!0,fromNode:e,toNode:l});e.directChildUpEdge=n;e.adoptSegment(m);n.consumeVariant([m],f.combineSegments([m],!0))}}e=l;c.push(l);if(d==b)break;m=[];for(n=0;n<g.length;n++){var r=g[n].identify(d,b,this);r&&m.push.apply(m,this.normalizeIdentifierResult(r))}l.setSegments(m);d=f.getParent(d)}c[0].weightOptions=[{weight:0,minFromEdgesById:{}}];
c[0].weightOptionsByWeight[0]=c[0].weightOptions[0]},normalizeIdentifierResult:function(a){var b=this;"Array"!=this.typeOf(a)&&(a=[a]);return a.map(function(a){if("String"==b.typeOf(a))return{query:a,weight:1E3};a.hasOwnProperty("weight")||(a.weight=1E3);return a})},computePath:function(a){var b=this.nodes;this.getRoot();var c=0;a||(a={},a[b[0].id]=b[0]);do{c++;var d={},e=!1,f;for(f in a){var g=a[f];if(0!==g.weightOptions.length){for(var k in g.edgesToByIndex){var l=g.edgesToByIndex[k],m=l.toNode;
l.relax()&&(d[m.id]=m,e=!0)}(g=g.directChildUpEdge)&&g.relax()&&(m=g.toNode,d[m.id]=m,e=!0)}}a=d}while(e&&c<b.length)},buildEdges:function(){for(var a=this.finder.recognizers,b=0;b<a.length;b++)a[b].recognize(this);a=this.nodes;for(b=0;b<a.length-1&&!1!==a[b].buildEdges3(1);b++)a[b].buildEdges3(2),a[b].buildEdges3(3)},expandSimplePaths:function(a){for(var b=this.nodes,c={},d=[],e=0;e<a.length;e++){for(var f=a[e].split("_"),g=[],k=f.length-1;1<k;k--)var l=b[Number(f[k])],g=l.extendPathVariants(g,("+"==
f[k][0]?l.directChildUpEdge:l.edgesToByIndex[Number(f[k-1])]).segmentVariants,k<f.length-1&&"+"==f[k+1][0]?l.index:null);for(f=0;f<g.length;f++)k=g[f],c[k.hash]||(d.push(k),c[k.hash]=!0)}d.sort(function(a,b){return a.weight-b.weight});return d},findAllPaths:function(a){this.computePath();for(var b=this.getRoot().collectFullSimplePathCollection(),c=0;c<b.length;c++){var d=this.verifySimplePathGroup(b[c].simplePaths,a);if(d.length)return a&&a.detailed?d:d.map(function(a){return a.query})}return[]},
verifySimplePathGroup:function(a,b){for(var c=this.getRoot(),d=this.finder,e=this.expandSimplePaths(a),f=[],g=this.nodes[0].el,c=c.el,k=0;k<e.length;k++){var l=e[k],m=[],n;for(n in l.segmentsById)m.push(l.segmentsById[n]);if((l=d.combineSegments(m))&&d.verifyQuery(l.query,g,c)&&(f.push(l),b&&b.singleOnly))break}return f},countEdges:function(a){var b=0;this.nodes.forEach(function(c){for(var d in c.edgesToByIndex){var e=c.edgesToByIndex[d];b+=e.segmentVariants.length;a&&e.segmentVariants.forEach(function(a){console.log("Edge from: "+
e.fromNode.index+"["+e.fromNode.el.tagName+"] to "+e.toNode.index+"["+e.toNode.el.tagName+"] query: "+e.finder.combineSegments(a.variant).query)})}});return b}}});
Class("Ariadne.QueryFinder",{does:[Ariadne.QueryFinder.TreeWalker],has:{recognizers:Joose.I.Array,identifiers:Joose.I.Array,directChildIdentifier:null,enableMandatoryId:!0},methods:{initialize:function(){this.initRecognizers();this.initIdentifiers();this.recognizers.sort(function(a,b){return b.priority-a.priority});this.identifiers.sort(function(a,b){return b.priority-a.priority})},addRecognizer:function(a){this.recognizers.push(a);return a},addIdentifier:function(a){this.identifiers.push(a);return a},
initRecognizers:function(){},initIdentifiers:function(){},findQuery:function(a,b){return this.findQueries(a,b,{singleOnly:!0})[0]},findQueries:function(a,b,c){if(!a)throw Error("No target");if(!b)throw Error("No root");if(a==b)throw Error("Can't find query - target and root are the same");if(this.contains(a,b))throw Error("Can't find query - root is contained within target, need to swap the arguments?");var d=new Ariadne.QueryFinder.Maze({finder:this});d.buildVertices(a,b);d.buildEdges();return d.findAllPaths(c)},
forAllCombinations:function(a,b){return(new Ariadne.QueryFinder.Combinator({elements:a})).forAllCombinations(b)},bisect:function(a,b,c){for(;a<=b;){var d=Math.round((a+b)/2),e=c(d);if(!1===e)return!1;if(a==b)break;if(null==e)throw Error("Unknown bisect direction");0>e&&(b=d-1);0<e&&(a=d+1)}},combineSegments:function(a,b){for(var c=[],d=0,e=[],f={},g=!1,k=0;k<a.length;k++){var l=a[k],m=l.id;if(!f[m]){f[m]=!0;e.push(m);var n=l.index;(m=c[n])||(m=c[n]={segments:[],hasLeading:!1,child:!1});d+=l.weight;
if(l.leading){if(m.hasLeading)return null;m.hasLeading=!0;m.segments.unshift(l.query)}else m.segments.push(l.query);l.child&&(m.child=!0);l.isId&&(g=!0)}}f="";for(k=c.length-1;0<=k;k--)if(m=c[k]){if(!b&&m.child&&(k==c.length-1||!c[k+1]))throw Error("Invalid direct child component");l=m.segments.join("");f=f?f+((m.child?" > ":" ")+l):l}e.sort(function(a,b){return a-b});return{query:f,weight:d,hasId:g,hash:e.join("")}},doQuery:function(a,b){throw Error("Abstract method called: `doQuery`");},verifyQuery:function(a,
b,c){a=this.doQuery(a,c);return 1==a.length&&a[0]==b}}});
Role("Ariadne.DomQueryFinder.Role.DomHelper",{does:[Siesta.Util.Role.CanGetType],methods:{ignoreCssClass:function(a,b){return!1},getCssClasses:function(a){for(var b="String"==this.typeOf(a.className)?a.className.trim():"",c=[],d={},b=b&&b.split(/\s+/)||[],e=0;e<b.length;e++){var f=b[e];d[f]||(this.ignoreCssClass(f,a)||c.push(f),d[f]=!0)}return c},escapeDomSelector:function(a,b){return b?Siesta.Sizzle.escape(a):Siesta.Sizzle.escape("L"+a).substring(1).replace(/\\ /g," ")},unEscapeDomSelector:function(a){return Siesta.Sizzle.unescape(a)}}});
Role("Ariadne.DomQueryFinder.TreeWalker",{methods:{getParent:function(a){return a.parentNode},contains:function(a,b){if(a.contains)return a.contains(b);if(a.compareDocumentPosition)return a===b||!!(a.compareDocumentPosition(b)&16);throw Error("Can't determine `contains` status");}}});
Class("Ariadne.DomQueryFinder.Identifier.AttributeValue",{isa:Ariadne.QueryFinder.Identifier,does:Ariadne.DomQueryFinder.Role.DomHelper,has:{attributes:function(){return["name","title"]}},methods:{initialize:function(a){this.attributes=this.mergeArrayAttributeFromClassHierarchy("attributes",a)},ignoreAttribute:function(a,b){return!1},identify:function(a,b,c){b=this.attributes;c=[];for(var d=0;d<b.length;d++){var e=b[d];a.hasAttribute(e)&&!this.ignoreAttribute(a,e)&&c.push("["+e+"='"+this.escapeDomSelector(a.getAttribute(e))+
"']")}return c}}});Class("Ariadne.DomQueryFinder.Identifier.TagName",{isa:Ariadne.QueryFinder.Identifier,does:Ariadne.DomQueryFinder.Role.DomHelper,methods:{identify:function(a,b,c){b=a.ownerDocument;c=(!c.nodes.length||a==c.nodes[0].el)&&(a==b.body||a==b.documentElement);return{query:this.escapeDomSelector(a.tagName.toLowerCase()),leading:!0,weight:c?900:1E3}}}});
Class("Ariadne.DomQueryFinder.Identifier.Contains",{isa:Ariadne.QueryFinder.Identifier,does:Ariadne.DomQueryFinder.Role.DomHelper,has:{maxCharsForContainsSelector:30},methods:{identify:function(a,b,c){b=a.children||a.childNodes;if(0==b.length||1==b.length&&!b[0].innerHTML)if(a=a.textContent.trim(),1<a.length)return a.length<=this.maxCharsForContainsSelector?{query:":textEquals("+this.escapeDomSelector(a)+")"}:{query:":contains("+this.escapeDomSelector(a.substr(0,this.maxCharsForContainsSelector))+
")"};return null}}});
Class("Ariadne.DomQueryFinder.Identifier.CssClass",{isa:Ariadne.QueryFinder.Identifier,does:Ariadne.DomQueryFinder.Role.DomHelper,has:{ignoreCssClasses:function(){return["^null$","^undefined$"]},ignoreCssClassesRegExp:null},methods:{initialize:function(a){a=this.mergeArrayAttributeFromClassHierarchy("ignoreCssClasses",a);this.ignoreCssClassesRegExp=a.length?new RegExp(a.join("|")):/\0/},identify:function(a,b,c){b=this.processCssClasses(this.getCssClasses(a),a);c=[];for(var d=0;d<b.length;d++)c.push({query:"."+
this.escapeDomSelector(b[d],!0),weight:this.getWeightForCssClass(b[d],a)});return c},getWeightForCssClass:function(a,b){return 1E3},ignoreCssClass:function(a,b){return this.ignoreCssClassesRegExp.test(a)},processCssClasses:function(a,b){return a}}});
Class("Ariadne.DomQueryFinder.Identifier.Id",{isa:Ariadne.QueryFinder.Identifier,does:Ariadne.DomQueryFinder.Role.DomHelper,has:{uniqueDomNodeProperty:null,shouldIgnoreDomElementId:null},methods:{identify:function(a,b,c){b=this.uniqueDomNodeProperty||"id";var d=a.getAttribute(b),e=this.shouldIgnoreDomElementId;if(!d||this.ignoreDomId(d,a)||e&&e(d,a))return null;a=c.encounteredMandatoryId||!this.finder.enableMandatoryId?1E3:-1E5;c.encounteredMandatoryId=!0;return{query:"id"==b?"#"+this.escapeDomSelector(d,
!0):"["+b+"='"+this.escapeDomSelector(d)+"']",weight:a,isId:!0}},ignoreDomId:function(){return!1}}});Class("Ariadne.DomQueryFinder.Identifier.NthOfType",{isa:Ariadne.QueryFinder.Identifier,methods:{identify:function(a,b,c){b=a.parentElement;if(!b)return null;b=b.children||b.childNodes;c=0;for(var d=a.tagName.toLowerCase(),e=0;e<b.length&&(b[e].tagName.toLowerCase()!=d||(c++,b[e]!=a));e++);return{query:":nth-of-type("+c+")",weight:1E6}}}});
Class("Ariadne.DomQueryFinder.Identifier.DirectChild",{isa:Ariadne.DomQueryFinder.Identifier.NthOfType,methods:{identify:function(a,b,c){if(!a.parentElement||a.parentElement==b)return null;var d=this.SUPERARG(arguments);d.query=a.tagName.toLowerCase()+d.query;d.leading=!0;d.child=!0;d.weight*=10;return d}}});
Class("Ariadne.DomQueryFinder",{isa:Ariadne.QueryFinder,does:Ariadne.DomQueryFinder.TreeWalker,has:{uniqueDomNodeProperty:null,shouldIgnoreDomElementId:null,ignoreCssClasses:null},methods:{initRecognizers:function(){},initIdentifiers:function(){this.addIdentifier(new Ariadne.DomQueryFinder.Identifier.Id({uniqueDomNodeProperty:this.uniqueDomNodeProperty,shouldIgnoreDomElementId:this.shouldIgnoreDomElementId,finder:this,priority:1E4}));this.addIdentifier(new Ariadne.DomQueryFinder.Identifier.CssClass({ignoreCssClasses:this.ignoreCssClasses,
finder:this,priority:1E3}));this.addIdentifier(new Ariadne.DomQueryFinder.Identifier.Contains({finder:this,priority:1E3}));this.addIdentifier(new Ariadne.DomQueryFinder.Identifier.AttributeValue({finder:this,priority:1E3}));this.addIdentifier(new Ariadne.DomQueryFinder.Identifier.TagName({finder:this,priority:100}));this.addIdentifier(new Ariadne.DomQueryFinder.Identifier.NthOfType({finder:this,priority:10}));this.directChildIdentifier=new Ariadne.DomQueryFinder.Identifier.DirectChild({finder:this})},
doQuery:function(a,b){return/:contains\(/.test(a)||/:textEquals\(/.test(a)||/:nth-of-type\(\d/.test(a)?Siesta.Sizzle(a,b):(b||document).querySelectorAll(a)},findQueries:function(a,b,c){if(!a)throw Error("No target");b||(b=a.ownerDocument);return this.SUPER(a,b,c)}}});
Class("Siesta.Recorder.TargetExtractor",{does:[Siesta.Util.Role.Dom,Siesta.Recorder.Role.CanSwallowException],has:{ariadneDomFinder:null,shouldIgnoreDomElementId:null,ignoreCssClasses:null,uniqueDomNodeProperty:"id",recorder:null},methods:{initialize:function(){this.ariadneDomFinder=new Ariadne.DomQueryFinder({uniqueDomNodeProperty:this.uniqueDomNodeProperty,shouldIgnoreDomElementId:this.shouldIgnoreDomElementId,ignoreCssClasses:this.ignoreCssClasses});this.swallowExceptions&&(this.findDomQueryFor=
this.safeBind(this.findDomQueryFor))},getBubbleTarget:function(){return this.recorder},findOffset:function(a,b,c){c=this.offset(c);c.left=c.left;c.top=c.top;return[a-c.left,b-c.top]},findDomQueryFor:function(a,b){return this.ariadneDomFinder.findQuery(a,b)},getTargets:function(a,b,c,d){var e=[];c=c||a.target;var f=null!=a.x&&null!=a.y;if(d&&!f)return e;d||c==c.ownerDocument.body&&f||(d=this.findDomQueryFor(c))&&e.push({type:"css",target:d,offset:!f||!b&&this.isElementReachableAtCenter(c,!1)?null:
this.findOffset(a.x,a.y,c)});f&&e.push({type:"xy",target:[a.x,a.y]});return e}}});
Role("Siesta.Recorder.Role.CanRecordMouseMove",{does:[Siesta.Util.Role.CanCalculatePageScroll,Siesta.Recorder.Role.CanSwallowException],has:{recordMouseMove:!0,cursorPosition:Joose.I.Array,lastMoveTimestamp:null,lastMouseMoveEvent:null},override:{initialize:function(){this.SUPERARG(arguments);this.onBodyMouseMove=this.safeBind(this.onBodyMouseMove);this.onBodyMouseOver=this.safeBind(this.onBodyMouseOver);this.onBodyMouseOut=this.safeBind(this.onBodyMouseOut)},onStart:function(){this.SUPERARG(arguments);
var a=this.window.document.body;this.recordMouseMove&&(a.addEventListener("mouseover",this.onBodyMouseOver,!0),a.addEventListener("mouseout",this.onBodyMouseOut,!0),a.addEventListener("mousemove",this.onBodyMouseMove,!0))},onStop:function(){this.SUPERARG(arguments);var a=this.window.document.body;this.recordMouseMove&&(a.removeEventListener("mouseover",this.onBodyMouseOver,!0),a.removeEventListener("mouseout",this.onBodyMouseOut,!0),a.removeEventListener("mousemove",this.onBodyMouseMove,!0),this.lastMouseMoveEvent=
null)}},methods:{saveMouseMoveData:function(a){this.lastMoveTimestamp=new Date-0;this.cursorPosition[0]=this.viewportXtoPageX(a.clientX,this.window);this.cursorPosition[1]=this.viewportYtoPageY(a.clientY,this.window);this.lastMouseMoveEvent=a},onBodyMouseMove:function(a){this.ignoreSynthetic&&a.synthetic||a.target.ownerDocument!==this.window.document||(this.saveMouseMoveData(a),this.processBodyMouseMove(a))},processBodyMouseMove:function(a){},onBodyMouseOver:function(a){this.ignoreSynthetic&&a.synthetic||
a.target.ownerDocument!==this.window.document||(this.saveMouseMoveData(a),this.processBodyMouseOver(a))},processBodyMouseOver:function(a){},onBodyMouseOut:function(a){this.ignoreSynthetic&&a.synthetic||a.target.ownerDocument!==this.window.document||(this.saveMouseMoveData(a),this.processBodyMouseOut(a))},processBodyMouseOut:function(a){},targetToPathPoint:function(a){var b=[a.getTargetAsQueryString()];a.getTarget().offset&&b.push.apply(b,a.getTarget().offset);b.xy=a.getTargetByType("xy").target;return b},
addPathPoint:function(a,b){if(3===b.length)a.push(b);else{var c=a[a.length-1];if(1===b.length&&"Array"==this.typeOf(b[0])){if(c=[b[0][0]-c.xy[0],b[0][1]-c.xy[1]],0!==c[0]||0!==c[1])c.xy=b[0],a.push(c)}else a.push(b)}},addMoveCursorAction:function(a,b,c){a instanceof Siesta.Recorder.Event||(a=Siesta.Recorder.Event.fromDomEvent(a));var d=this.getLastAction(),e=d&&("moveCursorTo"==d.action||"moveCursorAlongPath"==d.action);if(d&&e&&this.recordMouseMovePath)a=new Siesta.Recorder.Target({targets:this.getPossibleTargets(a,
!0,b,c)}),"moveCursorTo"==d.action&&(d.action="moveCursorAlongPath",d.value=[this.targetToPathPoint(d.target)],d.target=null),this.addPathPoint(d.value,this.targetToPathPoint(a)),this.fireEvent("actionupdate",d);else{if(d&&d.hasTarget()&&d.target&&(d=d.target.getTargetByType("xy"))&&(d=d.target,a.x==d[0]&&a.y==d[1]))return;b=this.getPossibleTargets(a,!0,b,c);this.addAction({action:"moveCursorTo",target:b,sourceEvent:a,options:a.options})}}}});
Role("Siesta.Recorder.Role.CanRecordMouseMoveOnIdle",{has:{idleTimeout:3E3,recordMouseMoveOnIdle:!0,idleMouseMoveThrottler:null},override:{initialize:function(){this.recordMouseMoveOnIdle&&(this.recordMouseMove=!0);this.SUPERARG(arguments);this.recordMouseMoveOnIdle&&(this.idleMouseMoveThrottler=new Siesta.Util.Throttler({func:this.onBodyMouseMoveIdle,scope:this,buffer:this.idleTimeout}),this.resetMouseMoveListener=this.resetMouseMoveListener.bind(this))},onDomEvent:function(a){this.SUPERARG(arguments);
this.resetMouseMoveListener()},clear:function(){this.recordMouseMoveOnIdle&&this.resetMouseMoveListener();this.SUPERARG(arguments)},onStart:function(){this.SUPERARG(arguments);var a=this.window.document.body;this.recordMouseMoveOnIdle&&a.addEventListener("mouseleave",this.resetMouseMoveListener)},onStop:function(){this.SUPERARG(arguments);var a=this.window.document.body;this.recordMouseMoveOnIdle&&(a.removeEventListener("mouseleave",this.resetMouseMoveListener),this.resetMouseMoveListener())},processBodyMouseMove:function(a){this.SUPERARG(arguments);
this.recordMouseMoveOnIdle&&this.idleMouseMoveThrottler.tick(a)}},methods:{resetMouseMoveListener:function(){this.idleMouseMoveThrottler&&this.idleMouseMoveThrottler.cancel()},onBodyMouseMoveIdle:function(a){this.addMoveCursorAction(a)}}});
Role("Siesta.Recorder.Role.CanRecordPointOfInterest",{does:Siesta.Util.Role.CanMergeArrayAttributeFromClassHierarchy,has:{moveCursorToSelectors:Joose.I.Array,pointOfInterestSelector:null,recordPointsOfInterest:!0,lastPointOfInterestEl:null},override:{initialize:function(a){this.moveCursorToSelectors=this.mergeArrayAttributeFromClassHierarchy("moveCursorToSelectors",a);if(this.pointOfInterestSelector=this.recordPointsOfInterest?this.moveCursorToSelectors.join(","):null)this.recordMouseMove=!0;this.SUPERARG(arguments)},
onStart:function(){this.SUPERARG(arguments);this.pointOfInterestSelector&&(this.lastPointOfInterestEl=null)},onStop:function(){this.SUPERARG(arguments);this.pointOfInterestSelector&&(this.lastPointOfInterestEl=null)},processBodyMouseOver:function(a){this.SUPERARG(arguments);var b=this.pointOfInterestSelector;if(b){var c=a.target;(this.matches(c,b)||(c=this.closest(a.target,b,10)))&&c!==this.lastPointOfInterestEl&&(this.lastPointOfInterestEl=c,this.addMoveCursorAction(a))}},processBodyMouseOut:function(a){this.SUPERARG(arguments);
this.pointOfInterestSelector&&this.lastPointOfInterestEl&&!this.contains(this.lastPointOfInterestEl,a.target)&&(this.lastPointOfInterestEl=null)}}});
Role("Siesta.Recorder.Role.CanRecordWindowResize",{requires:["getWindowSize"],does:[Siesta.Recorder.Role.CanSwallowException],has:{recordWindowResize:!0,recordInitialWindowSize:!1},override:{initialize:function(){this.SUPERARG(arguments);this.onWindowResize=this.safeBind(this.onWindowResize)},onStart:function(){this.SUPERARG(arguments);var a=this.window;this.recordWindowResize&&a.addEventListener("resize",this.onWindowResize);this.recordInitialWindowSize&&(this.recordInitialWindowSize=!1,a=this.getWindowSize(this.window),
this.addAction({action:"setWindowSize",value:[a.width,a.height]}))},onStop:function(){this.SUPERARG(arguments);var a=this.window;this.recordWindowResize&&a.removeEventListener("resize",this.onWindowResize)}},methods:{onWindowResize:function(a){var b=this.getWindowSize(this.window),c=this.getLastAction();c&&"setWindowSize"==c.action?(c.value=[b.width,b.height],this.fireEvent("actionupdate",c)):this.addAction({action:"setWindowSize",value:[b.width,b.height],sourceEvent:Siesta.Recorder.Event.fromDomEvent(a)})}}});
Role("Siesta.Recorder.Role.CanRecordMouseMovePath",{has:{recordMouseMovePath:!1,lastMouseOutTarget:null},after:{onStart:function(){this.lastMouseOutTarget=null},onStop:function(){this.lastMouseOutTarget=null}},override:{initialize:function(){this.recordMouseMovePath&&(this.recordMouseMoveOnIdle=this.recordPointsOfInterest=!1);this.SUPERARG(arguments);!0===this.recordMouseMovePath&&(this.recordMouseMovePath="coordinate")},processBodyMouseOver:function(a){this.SUPERARG(arguments);this.recordMouseMovePath&&
a.target!=this.lastMouseOutTarget&&this.addMoveCursorAction(a,null,"coordinate"==this.recordMouseMovePath||"down"==this.mouseState);this.lastMouseOutTarget=null},processBodyMouseOut:function(a){this.SUPERARG(arguments);this.lastMouseOutTarget=a.relatedTarget;this.recordMouseMovePath&&this.addMoveCursorAction(a,a.relatedTarget,"coordinate"==this.recordMouseMovePath||"down"==this.mouseState)}}});
Role("Siesta.Recorder.Role.CanRecordMouseDownUp",{has:{mouseState:"up",eventNameMap:{lazy:"this.buildEventNameMap"},needToCaptureInitialMouseState:!0},override:{initialize:function(){this.SUPERARG(arguments);this.onDocMouseDown=this.safeBind(this.onDocMouseDown);this.onDocMouseUp=this.safeBind(this.onDocMouseUp);this.onInitialMouseMove=this.safeBind(this.onInitialMouseMove)},onStart:function(){this.SUPERARG(arguments);var a=this.getEventNameMap(),b=this.window.document;b.addEventListener(a.mousedown,
this.onDocMouseDown,!0);b.addEventListener(a.mouseup,this.onDocMouseUp,!0);b.body.addEventListener("mousemove",this.onInitialMouseMove,!0);this.needToCaptureInitialMouseState=!0},onStop:function(){this.SUPERARG(arguments);var a=this.getEventNameMap(),b=this.window.document;b.removeEventListener(a.mousedown,this.onDocMouseDown,!0);b.removeEventListener(a.mouseup,this.onDocMouseUp,!0);if(this.needToCaptureInitialMouseState)this.onInitialStateCaptured()}},methods:{onInitialMouseMove:function(a){null!=
a.buttons&&a.buttons&1&&(this.mouseState="down");this.onInitialStateCaptured()},onInitialStateCaptured:function(){this.window.document.body.removeEventListener("mousemove",this.onInitialMouseMove,!0);this.needToCaptureInitialMouseState=!1},onDocMouseDown:function(a){if(!(this.ignoreSynthetic&&a.synthetic||a.target.ownerDocument!==this.window.document)){if(this.needToCaptureInitialMouseState)this.onInitialStateCaptured();this.processDocMouseDown(a)}},processDocMouseDown:function(a){this.mouseState=
"down"},onDocMouseUp:function(a){if(!(this.ignoreSynthetic&&a.synthetic||a.target.ownerDocument!==this.window.document)){if(this.needToCaptureInitialMouseState)this.onInitialStateCaptured();this.processDocMouseUp(a)}},processDocMouseUp:function(a){this.mouseState="up"},isPointerDownEvent:function(a){return/(ms)?(pointer|mouse)down/i.test(a.type)},isPointerUpEvent:function(a){return/(ms)?(pointer|mouse)up/i.test(a.type)},buildEventNameMap:function(){var a={};window.PointerEvent?(a.mousedown="pointerdown",
a.mouseup="pointerup"):window.MSPointerEvent?(a.mousedown="MSPointerDown",a.mouseup="MSPointerUp"):(a.mousedown="mousedown",a.mouseup="mouseup");return a}}});
Role("Siesta.Recorder.Role.CanRecordScroll",{has:{recordScroll:!1},override:{initialize:function(){this.SUPERARG(arguments);this.onScrollEvent=this.onScrollEvent.bind(this)},onStart:function(){this.SUPERARG(arguments);var a=this.window.document;this.recordScroll&&a.addEventListener("scroll",this.onScrollEvent,!0)},onStop:function(){this.SUPERARG(arguments);var a=this.window.document;this.recordScroll&&a.removeEventListener("scroll",this.onScrollEvent,!0)},onScrollEvent:function(a){var b=a.target,
c=this.window,d=c.document,e=this.getLastAction();if(e&&"scrollTo"==e.action&&b==e.sourceEvent.target)b===d&&(b=this.getElForPageScroll(c)),e.value=[b.scrollLeft,b.scrollTop],this.fireEvent("actionupdate",e);else{var f;b===d&&(f=!0,b=this.getElForPageScroll(c));d=this.cursorPosition;if(2===d.length&&!f&&(f=this.pageXtoViewportX(d[0],c),c=this.pageYtoViewportY(d[1],c),!this.isPointWithinElement(f,c,b)))return;this.addAction({action:"scrollTo",target:this.getPossibleTargets(a,!1,b),value:[b.scrollLeft,
b.scrollTop],sourceEvent:Siesta.Recorder.Event.fromDomEvent(a)})}}}});
Class("Siesta.Recorder.Recorder",{does:[JooseX.Observable,Siesta.Util.Role.Dom,Siesta.Util.Role.CanParseOs,Siesta.Util.Role.CanGetType,Siesta.Recorder.Role.CanSwallowException,Siesta.Recorder.Role.CanRecordMouseDownUp,Siesta.Recorder.Role.CanRecordMouseMove,Siesta.Recorder.Role.CanRecordMouseMoveOnIdle,Siesta.Recorder.Role.CanRecordPointOfInterest,Siesta.Recorder.Role.CanRecordWindowResize,Siesta.Recorder.Role.CanRecordScroll,Siesta.Recorder.Role.CanRecordMouseMovePath],has:{active:null,extractor:null,
extractorClass:Siesta.Recorder.TargetExtractor,extractorConfig:null,uniqueComponentProperty:null,uniqueDomNodeProperty:"id",shouldIgnoreDomElementId:null,ignoreCssClasses:Joose.I.Array,recordOffsets:!1,ignoreSynthetic:!0,window:null,clickMergeThreshold:200,debugMode:!1,eventsToRecord:{lazy:"this.buildEventsToRecord"},events:Joose.I.Array,processingEvent:null,actions:Joose.I.Array,actionsByEventId:Joose.I.Object,dragPixelThreshold:3,actionClass:Siesta.Recorder.Action,warnAboutIframeMissingId:!0},methods:{buildEventsToRecord:function(){var a=
"keydown keypress keyup click dblclick contextmenu".split(" ");window.PointerEvent?a.push("pointerdown","pointerup"):window.MSPointerEvent?a.push("MSPointerDown","MSPointerUp"):a.push("mousedown","mouseup");return a},initialize:function(){this.onUnload=this.onUnload.bind(this);this.onFrameLoad=this.onFrameLoad.bind(this);this.onDomEvent=this.safeBind(this.onDomEvent);var a=this.extractorConfig||{};a.recorder=this;a.uniqueComponentProperty=a.uniqueComponentProperty||this.uniqueComponentProperty;a.uniqueDomNodeProperty=
a.uniqueDomNodeProperty||this.uniqueDomNodeProperty;a.swallowExceptions=this.swallowExceptions;a.shouldIgnoreDomElementId=this.shouldIgnoreDomElementId;a.ignoreCssClasses=this.ignoreCssClasses;this.extractor=new this.extractorClass(a)},isSamePoint:function(a,b){return Math.abs(Math.round(a.x)-Math.round(b.x))<=this.dragPixelThreshold&&Math.abs(Math.round(a.y)-Math.round(b.y))<=this.dragPixelThreshold},isSameTarget:function(a,b){return a.target==b.target||this.contains(a.target,b.target)||this.contains(b.target,
a.target)},clear:function(){this.events=[];this.actions=[];this.actionsByEventId={};this.fireEvent("clear",this)},onUnload:function(){var a=this.actions;(a=a.length&&a[a.length-1])&&a.target&&(a.waitForPageLoad=!0);this.stop(!0)},onFrameLoad:function(a){try{var b=a.target.contentWindow}catch(c){b=null}b&&(this.attach(b),this.start())},attach:function(a){this.window!==a&&this.stop();this.events=[];this.window=a},start:function(){this.active||(this.ignoreSynthetic||this.hasOwnProperty("clickMergeThreshold")||
(this.clickMergeThreshold=Infinity),this.stop(),this.active=Date.now(),this.onStart(),this.fireEvent("start",this))},stop:function(a){this.active&&(this.active=null,this.onStop(a),this.fireEvent("stop",this))},getRecordedEvents:function(){return this.events},getRecordedActions:function(){return this.actions},getRecordedActionsAsSteps:function(){return Joose.A.map(this.actions,function(a){return a.asStep()})},onDomEvent:function(a){var b=a.target;this.processingEvent=a;this.debugMode&&this.window.console&&
"function"===typeof this.window.console.log&&console.log("[EVENT] : ",a.type,b,a.keyIdentifier||a.key);b&&(!this.ignoreSynthetic||!a.synthetic&&a.isTrusted)&&(a=Siesta.Recorder.Event.fromDomEvent(a),this.convertToAction(a),this.events.push(a),10<this.events.length&&this.events.shift(),this.fireEvent("domevent",a))},eventToAction:function(a,b){var c=a.type,c={action:c.match(/^key/)?"type":this.isPointerDownEvent(a)?"mousedown":this.isPointerUpEvent(a)?"mouseup":c,target:this.getPossibleTargets(a,!0,
null,b),options:a.options,sourceEvent:a,sourceEventTargetReachableAtCenter:this.isElementReachableAtCenter(a.target,!1)},d=a.target.ownerDocument.defaultView;if(d!==this.window&&!b){if(!d.frameElement.id&&this.warnAboutIframeMissingId)throw Error('To record events in a nested iframe, please set an "id" property on your frames');c.target=c.target.filter(function(a){return"string"===typeof a.target?(a.target="#"+d.frameElement.id+" -> "+a.target,!0):!1})}return new this.actionClass(c)},recordAsAction:function(a,
b){var c=this.eventToAction(a,b);if(c)return this.addAction(c),c},addAction:function(a){a instanceof this.actionClass||(a=new this.actionClass(a));this.beforeAddAction(a);this.actions.push(a);a.sourceEvent&&(this.actionsByEventId[a.sourceEvent.id]=a);this.debugMode&&this.window.console&&"function"===typeof this.window.console.log&&console.log("[ACTION] : "+a.action,a.getTarget()&&a.asStep().target||"",a);this.fireEvent("actionadd",a)},removeAction:function(a){for(var b=this.actions,c=0;c<b.length;c++){var d=
b[c];if(d==a){b.splice(c,1);d.sourceEvent&&delete this.actionsByEventId[d.sourceEvent.id];this.fireEvent("actionremove",a);break}}},removeActionByEventId:function(a){this.removeAction(this.getActionByEventId(a))},removeActionByEvent:function(a){this.removeAction(this.getActionByEventId(a.id))},getActionByEvent:function(a){return this.actionsByEventId[a.id]},getActionByEventId:function(a){return this.actionsByEventId[a]},getLastAction:function(){return this.actions[this.actions.length-1]},getLastEvent:function(){return this.events[this.events.length-
1]},canCombineTypeActions:function(a,b){return a.ctrlKey==b.ctrlKey&&a.metaKey==b.metaKey&&a.shiftKey==b.shiftKey&&a.altKey==b.altKey},finalizeDragAction:function(a,b){var c=this.eventToAction(a,!0);c.target=new Siesta.Recorder.Target({targets:[{target:[a.x,a.y],type:"xy"}]});this.addAction(c)},convertToAction:function(a){var b=a.type,c=this.getRecordedEvents(),d=c.length,e=this.getLastEvent(),c=2<=d?c[d-2]:null;if(!this.shouldIgnoreEvent(a,e,c))if("keypress"==b||"keyup"==b||"keydown"==b)this.convertKeyEventToAction(a);
else if(d)if("dblclick"==b)1<this.getRecordedActions().length&&this.removeAction(this.getLastAction()),this.getLastAction().action="dblclick",this.fireEvent("actionupdate",this.getLastAction());else if(this.isPointerDownEvent(e)&&this.isPointerUpEvent(a)&&a.button==e.button&&!this.isSamePoint(a,e))this.finalizeDragAction(a,e);else if(e&&this.isPointerUpEvent(a)&&this.isPointerDownEvent(e)&&a.button==e.button&&this.isSamePoint(a,e)&&!bowser.gecko)this.recordAsAction(a,!0);else if(d=bowser.gecko&&bowser.windows,
c&&"click"===b)this.isPointerUpEvent(e)&&a.button==e.button&&a.button==c.button&&this.isSamePoint(a,e)&&this.isPointerDownEvent(c)&&this.isSameTarget(a,e)&&this.isSameTarget(a,c)&&this.isSamePoint(a,c)&&(b=this.getActionByEvent(c),Date.now()-b.getTimestamp()>this.clickMergeThreshold||(this.removeActionByEvent(e),a.target==e.target&&e.target==c.target&&!this.recordOffsets&&b.sourceEventTargetReachableAtCenter&&b.clearTargetOffset(d),b.action="click",this.fireEvent("actionupdate",b)));else{if("contextmenu"===
b){b=this.getLastAction();if(d&&"click"==e.type&&"click"==b.action){b.action="contextmenu";b.restoreTargetOffset();this.fireEvent("actionupdate",b);return}(this.isPointerUpEvent(e)||this.isPointerDownEvent(e))&&a.button==e.button&&this.isSamePoint(a,e)&&this.removeActionByEvent(e);this.isPointerUpEvent(e)&&this.isPointerDownEvent(c)&&this.isSameTarget(a,e)&&this.isSameTarget(a,c)&&this.isSamePoint(a,c)&&this.removeActionByEvent(c)}this.recordAsAction(a)}else this.recordAsAction(a)},shouldIgnoreEvent:function(a,
b,c){var d=a.type.match(/^key/),e=a.keyCode,f=Siesta.Test.UserAgent.KeyCodes().keys;if(d&&(e===f.SHIFT||e===f.CTRL||e===f.ALT||e===f.CMD)||this.isPointerUpEvent(a)&&b&&"contextmenu"===b.type||"keypress"==a.type&&b&&"keydown"==b.type&&c&&"keydown"==c.type&&a.rawEvent.key==b.rawEvent.key&&"Control"==c.rawEvent.key&&3>a.rawEvent.timeStamp-b.rawEvent.timeStamp||"click"==a.type&&b&&"click"==b.type&&"label"===b.target.nodeName.toLowerCase())return!0},convertKeyEventToAction:function(a){var b=a.type,c=this.getLastEvent(),
d=Siesta.Test.UserAgent.KeyCodes(),e="keydown"==b&&(d.isSpecial(a.keyCode)||d.isNav(a.keyCode)),f=d.isModifier(a.keyCode),g=a.options,k=c&&c.type,c="keypress"==b&&"keydown"==k&&(d.isSpecial(c.keyCode)||d.isNav(c.keyCode));this.parseOS(navigator.platform);k="MacOS"===this.parseOS(navigator.platform);if("keypress"==b&&!e&&!c||"keydown"==b&&(e||f||!k&&g.ctrlKey||k&&g.metaKey))b=this.getLastAction(),f=a.rawEvent.key?a.rawEvent.key:e?d.fromCharCode(a.charCode,!0):String.fromCharCode(a.charCode),f=e?"["+
f.toUpperCase()+"]":f,b&&"type"===b.action&&this.canCombineTypeActions(b.options,a.options)?d.isModifier(a.keyCode)||(b.value+=f,this.fireEvent("actionupdate",b)):this.addAction({action:"type",target:this.getPossibleTargets(a),value:f,sourceEvent:a,options:a.options})},onStart:function(){var a=this,b=a.window,c=this.getNestedFrames().map(function(a){return a.contentWindow});[b].concat(c).forEach(function(b){a.registerWindowListeners(b)});b.frameElement&&b.frameElement.addEventListener("load",this.onFrameLoad);
b.addEventListener("unload",this.onUnload);b.focus()},onStop:function(a){var b=this,c=b.window,d=this.getNestedFrames().map(function(a){return a.contentWindow});[c].concat(d).forEach(function(a){b.deregisterWindowListeners(a)});a||c.frameElement&&c.frameElement.removeEventListener("load",b.onFrameLoad);c.removeEventListener("unload",this.onUnload)},registerWindowListeners:function(a){if(!this.isCrossOriginWindow(a)){var b=this;b.getEventsToRecord().forEach(function(c){a.document.addEventListener(c,
b.onDomEvent,!0)})}},deregisterWindowListeners:function(a){if(!this.isCrossOriginWindow(a)){var b=this;b.getEventsToRecord().forEach(function(c){a.document.removeEventListener(c,b.onDomEvent,!0)})}},getNestedFrames:function(){var a=this;return Array.prototype.slice.apply(this.window.document.getElementsByTagName("iframe")).filter(function(b){return!a.isCrossOriginWindow(b.contentWindow)})},beforeAddAction:function(a){},getPossibleTargets:function(a,b,c,d){"HTMLDocument"==this.typeOf(a.target)&&(a.target=
a.target.body);return this.extractor.getTargets(a,b,c,d)}}});
Role("Ariadne.ExtJSDomQueryFinder.Role.ExtJSHelper",{methods:{getComponentOfDomElement:function(a){var b=a.ownerDocument,c=b.body,b=(b.defaultView||b.parentWindow).Ext;if(!b||!b.getCmp)return null;for(;a&&a!=c;){var d=a.getAttribute("id");if(d&&b.getCmp(d))return b.getCmp(d);a=a.parentElement}return null},getExtByDomElement:function(a){a=a.ownerDocument;return(a.defaultView||a.parentWindow).Ext},getExtCssClassPrefixRegexp:function(a){return(a=this.getExtByDomElement(a))?new RegExp("^"+(a.baseCSSPrefix||
"x")):null},valueIsAutoGeneratedByComponent:function(a,b){if(!a.up)return!1;b=String(b);var c=a.autoGenId?[a]:[],d=a.up("[autoGenId=true]");d&&c.push(d);(d=d&&d.query&&d.query("[autoGenId=true]"))&&c.push.apply(c,d);return c.some(function(a){return 0<=b.indexOf(a.id)})},componentHasAutoGeneratedId:function(a,b){var c=a.id;return/^ext-gen\d+|^ext-comp\d+/.test(c)||b&&this.idIsGeneratedByExtDotIdCall(c,b)?!0:a.isWidget?c.replace(/\d+$/,"")==a.identifiablePrefix:a.autoGenId||this.valueIsAutoGeneratedByComponent(a,
c)},idIsGeneratedByExtDotIdCall:function(a,b,c){b=b||this.getExtByDomElement(c);if(!b)return!1;a=/^(.+?)\d+$/.exec(a);return!(!a||a[1]!=b.idPrefix)},domElementHasAutoGeneratedId:function(a){var b=a.getAttribute("id")||"";return/^ext-/.test(b)||this.idIsGeneratedByExtDotIdCall(b,null,a)?!0:(a=this.getComponentOfDomElement(a))&&(b!==a.id&&-1<b.indexOf(a.id)||this.componentHasAutoGeneratedId(a))?!0:!1}}});
Class("Ariadne.ExtJSDomQueryFinder.Identifier.CssClass",{isa:Ariadne.DomQueryFinder.Identifier.CssClass,does:Ariadne.ExtJSDomQueryFinder.Role.ExtJSHelper,has:{ignoreCssClasses:function(){return"-focus$ -focused$ -over$ -hover$ -selected$ -active$ -default$ x-form-dirty x-grid-dirty-cell x-unselectable -toolbar-item$ -item-disabled x-form-empty-field x-grid-item-alt".split(" ")},lessRelevantCssClasses:function(){return"x-form-field x-form-required-field -layout -inner$ -default$ -box- ^x-tree-elbow".split(" ")}},
methods:{initialize:function(){this.SUPERARG(arguments);var a=this.lessRelevantCssClasses;a.forEach(function(b,c){a[c]=new RegExp(b)})},getWeightForCssClass:function(a,b){var c=this.getExtCssClassPrefixRegexp(b);return this.lessRelevantCssClasses.some(function(b){return b.test(a)})?1E3:!c||c.test(a)?995:950},ignoreCssClass:function(a,b){var c=this.getComponentOfDomElement(b);return c&&this.valueIsAutoGeneratedByComponent(c,a)?!0:this.SUPER(a,b)},processCssClasses:function(a,b){var c=this.getExtCssClassPrefixRegexp(b);
if(!c)return a;a.sort(function(a,b){var f=c.test(a),g=c.test(b);return f&&!g?1:!f&&g?-1:0});return a}}});Class("Ariadne.ExtJSDomQueryFinder.Identifier.Id",{isa:Ariadne.DomQueryFinder.Identifier.Id,does:Ariadne.ExtJSDomQueryFinder.Role.ExtJSHelper,methods:{ignoreDomId:function(a,b){return this.domElementHasAutoGeneratedId(b)}}});
Class("Ariadne.ExtJSDomQueryFinder.Identifier.AttributeValue",{isa:Ariadne.DomQueryFinder.Identifier.AttributeValue,does:Ariadne.ExtJSDomQueryFinder.Role.ExtJSHelper,has:{attributes:function(){return["data-ref","aria-label"]}},methods:{ignoreAttribute:function(a,b){var c=a.getAttribute(b),d=this.getComponentOfDomElement(a);return d&&this.valueIsAutoGeneratedByComponent(d,c)?!0:this.SUPERARG(arguments)}}});
Class("Ariadne.ExtJSDomQueryFinder",{isa:Ariadne.DomQueryFinder,has:{},methods:{initIdentifiers:function(){this.addIdentifier(new Ariadne.ExtJSDomQueryFinder.Identifier.Id({shouldIgnoreDomElementId:this.shouldIgnoreDomElementId,uniqueDomNodeProperty:this.uniqueDomNodeProperty,finder:this,priority:1E6}));this.addIdentifier(new Ariadne.ExtJSDomQueryFinder.Identifier.CssClass({finder:this,priority:1E5}));this.addIdentifier(new Ariadne.DomQueryFinder.Identifier.Contains({finder:this,priority:1E4}));this.addIdentifier(new Ariadne.ExtJSDomQueryFinder.Identifier.AttributeValue({finder:this,
priority:1E3}));this.addIdentifier(new Ariadne.DomQueryFinder.Identifier.TagName({finder:this,priority:100}));this.addIdentifier(new Ariadne.DomQueryFinder.Identifier.NthOfType({finder:this,priority:10}));this.directChildIdentifier=new Ariadne.DomQueryFinder.Identifier.DirectChild({finder:this})},findQueries:function(a,b,c){a&&a.dom&&a.dom.tagName&&(a=a.dom);return this.SUPER(a,b,c)}}});
Role("Ariadne.ExtJSComponentQueryFinder.Role.ExtJSComponentHelper",{does:Ariadne.DomQueryFinder.Role.DomHelper,has:{},methods:{getComponentXType:function(a){var b=this.getComponentOwnXType(a);if(b)return b;b=a.getXTypes&&a.getXTypes();if(!b)return null;b=b.split("/");return b[b.length-1]},getComponentOwnXType:function(a){return a.getXType&&a.getXType()||a.xtype||a.xtypes[0]},escapeCQSelector:function(a){return this.escapeDomSelector(a)},getExt4ProofXtype:function(a,b){var c=this.getComponentXType(a),
d=this.escapeCQSelector(c),e=b.getVersion("ext");return e&&4==e.major&&c!=d?{query:"[xtype="+d+"]",leading:!1}:{query:d,leading:!0}}}});Role("Ariadne.ExtJSComponentQueryFinder.TreeWalker",{methods:{getParent:function(a){return a.getRefOwner&&a.getRefOwner()||a.ownerCt||this.Ext.ComponentQuery},contains:function(a,b){var c=this.Ext.ComponentQuery;if(a==c)return!0;if(b==c)return!1;for(;b&&b!=c;){if(b==a)return!0;b=this.getParent(b)}return!1}}});
Class("Ariadne.ExtJSComponentQueryFinder.Identifier.XType",{isa:Ariadne.QueryFinder.Identifier,does:[Ariadne.ExtJSComponentQueryFinder.Role.ExtJSComponentHelper],methods:{identify:function(a,b,c){b=this.getComponentXType(a);b=this.escapeCQSelector(b);return[this.getExt4ProofXtype(a,this.finder.Ext),{query:b+"(true)",leading:!0,weight:1010}]}}});
Class("Ariadne.ExtJSComponentQueryFinder.Identifier.NthChild",{isa:Ariadne.QueryFinder.Identifier,does:[Ariadne.ExtJSComponentQueryFinder.Role.ExtJSComponentHelper],methods:{identify:function(a,b,c){c=this.finder.getParent(a);if(!c||c==b||!c.items)return null;b=c.items.indexOf(a);if(-1==b){c=c.getRefItems&&c.getRefItems();if(!c)return null;for(var d=c.length,e=0;e<d;e++)if(c[e]===a){b=e;break}if(e>=d)return null}return{query:":ariadne-nth-child("+(b+1)+")",weight:1E6}}}});
Class("Ariadne.ExtJSComponentQueryFinder.Identifier.DirectChild",{isa:Ariadne.ExtJSComponentQueryFinder.Identifier.NthChild,methods:{identify:function(a,b,c){var d=this.finder.getParent(a);if(d&&d!=b||!b.query){if(d=this.SUPERARG(arguments))d.child=!0;return d}var d=this.getExt4ProofXtype(a,this.finder.Ext),e=d.query+(d.leading?"(true)":""),f=b.query(e+":root").indexOf(a);if(0<=f)return{query:e+":root("+(f+1)+")",leading:d.leading,weight:1E7}}}});
Class("Ariadne.ExtJSComponentQueryFinder.Identifier.PropertyValue",{isa:Ariadne.QueryFinder.Identifier,does:[Ariadne.ExtJSComponentQueryFinder.Role.ExtJSComponentHelper,Ariadne.ExtJSDomQueryFinder.Role.ExtJSHelper],has:{properties:function(){return"name text dataIndex iconCls type title inputType boxLabel fieldLabel".split(" ")}},methods:{initialize:function(a){this.properties=this.mergeArrayAttributeFromClassHierarchy("properties",a)},ignoreProperty:function(a,b){return this.valueIsAutoGeneratedByComponent(a,
a[b])},identify:function(a,b,c){b=this.finder.Ext;c=this.properties;for(var d=[],e=this.getExt4ProofXtype(a,b),f=0;f<c.length;f++){var g=c[f],k=a[g];!k||"string"!==typeof k||this.ignoreProperty(a,g)||"inputType"==g&&b.slider&&b.slider.Multi&&a instanceof b.slider.Multi||"inputType"==g&&b.form&&b.form.field&&b.form.field.ComboBox&&a instanceof b.form.field.ComboBox||"&#160;"==k||d.push({query:e.query+"["+g+"="+this.escapeCQSelector(k)+"]",leading:e.leading})}return d}}});
Class("Ariadne.ExtJSComponentQueryFinder.Identifier.Id",{isa:Ariadne.QueryFinder.Identifier,does:[Ariadne.ExtJSComponentQueryFinder.Role.ExtJSComponentHelper,Ariadne.ExtJSDomQueryFinder.Role.ExtJSHelper],methods:{identify:function(a,b,c){return(b=a.id)&&!this.ignoreComponentId(b,a,c.finder.Ext)?(a=c.encounteredMandatoryId||!this.finder.enableMandatoryId?1E3:-1E5,c.encounteredMandatoryId=!0,{query:"#"+this.escapeCQSelector(b),weight:a,isId:!0}):null},ignoreComponentId:function(a,b,c){return this.componentHasAutoGeneratedId(b,
c)}}});Class("Ariadne.ExtJSComponentQueryFinder.Identifier.ItemId",{isa:Ariadne.QueryFinder.Identifier,methods:{identify:function(a,b,c){if(a=a.itemId)return{query:"#"+a,weight:-1E3}}}});
Class("Ariadne.ExtJSComponentQueryFinder",{isa:Ariadne.QueryFinder,does:[Siesta.Util.Role.CanInstallCQRootPseudo,Ariadne.ExtJSComponentQueryFinder.TreeWalker,Ariadne.ExtJSDomQueryFinder.Role.ExtJSHelper],has:{Ext:null,uniqueComponentProperty:null},methods:{setExtByDomElement:function(a){this.Ext=this.getExtByDomElement(a)},setExt:function(a){this.Ext=a},initRecognizers:function(){},initIdentifiers:function(){this.addIdentifier(new Ariadne.ExtJSComponentQueryFinder.Identifier.Id({finder:this,priority:1E4}));
this.addIdentifier(new Ariadne.ExtJSComponentQueryFinder.Identifier.ItemId({finder:this,priority:1E4}));this.addIdentifier(new Ariadne.ExtJSComponentQueryFinder.Identifier.PropertyValue({properties:this.uniqueComponentProperty,finder:this,priority:1E3}));this.addIdentifier(new Ariadne.ExtJSComponentQueryFinder.Identifier.XType({finder:this,priority:100}));this.addIdentifier(new Ariadne.ExtJSComponentQueryFinder.Identifier.NthChild({finder:this,priority:10}));this.directChildIdentifier=new Ariadne.ExtJSComponentQueryFinder.Identifier.DirectChild({finder:this})},
doQuery:function(a,b){var c=this.Ext.ComponentQuery;b==c&&(b=null);return c.query(a,b)},findQueries:function(a,b,c){if(!a)throw Error("No target");var d=this.Ext;if(!d||!d.ComponentQuery)return[];var e=d.ComponentQuery;this.installRootPseudoCQ(d);b||(b=e);d=this.getParent(a);if(d!=b&&!d.items){var e=this.SUPER(d,b,c),f=this.SUPER(a,d,c);if(e.length&&f.length){var g=[];e.forEach(function(a){f.forEach(function(b){g.push(a+" "+b)})});return g}}return this.SUPER(a,b,c)}}});
Class("Siesta.Recorder.TargetExtractor.ExtJS",{isa:Siesta.Recorder.TargetExtractor,does:[Ariadne.ExtJSDomQueryFinder.Role.ExtJSHelper],has:{Ext:null,skipDomQuery:!1,uniqueComponentProperty:null},methods:{initialize:function(){this.SUPER();this.ariadneDomFinder=new Ariadne.ExtJSDomQueryFinder({uniqueDomNodeProperty:this.uniqueDomNodeProperty,shouldIgnoreDomElementId:this.shouldIgnoreDomElementId});var a=this.uniqueComponentProperty;a&&(a=a instanceof Array?a:[a]);this.ariadneCQFinder=new Ariadne.ExtJSComponentQueryFinder({uniqueComponentProperty:a});
this.swallowExceptions&&(this.findComponentQueryFor=this.safeBind(this.findComponentQueryFor),this.findCompositeQueryFor=this.safeBind(this.findCompositeQueryFor))},setExt:function(a){a=a.ownerDocument;this.Ext=(a.defaultView||a.parentWindow).Ext;this.ariadneCQFinder.setExt(this.Ext)},getTargets:function(a,b,c,d){if(d)return this.SUPER(a,b,c,d);d=c||a.target;var e;this.setExt(d);var f=this.Ext&&this.Ext.ComponentQuery&&this.Ext.versions&&!this.Ext.versions.touch;f&&(e=this.getComponentOfDomElement(d));
var g=e&&(e.el||e.element),g=g&&g.dom;if(!f||g&&!g.contains(d))return this.SUPER(a,b,c);var f=[],k=null!=a.x&&null!=a.y;if(e){var l=this.findComponentQueryFor(e);l&&(f.unshift({type:"cq",target:l,offset:!k||!b&&this.isElementReachableAtCenter(g,!1)?null:this.findOffset(a.x,a.y,g)}),g!=d&&(e=this.findCompositeQueryFor(d,l,e))&&f.unshift({type:"csq",target:e,offset:!k||!b&&this.isElementReachableAtCenter(d,!1)?null:this.findOffset(a.x,a.y,d)}))}return f.concat(this.SUPER(a,b,c,this.skipDomQuery&&f.length))},
findCompositeQueryFor:function(a,b,c){if(!b){c=this.getComponentOfDomElement(a);if(!c)return null;b=this.findComponentQueryFor(c);if(!b)return null}c=(c.el||c.element).dom;return a!=c&&c.contains(a)?(a=this.findDomQueryFor(a,c))?b+" => "+a:null:null},findComponentQueryFor:function(a,b){return this.ariadneCQFinder.findQuery(a,b)}}});
Class("Siesta.Recorder.ExtJS",{isa:Siesta.Recorder.Recorder,has:{extractorClass:Siesta.Recorder.TargetExtractor.ExtJS,moveCursorToSelectors:function(){return[".x-menu-item:not(.x-menu-item-separator)",".x-column-header"]}},methods:{addMoveCursorAction:function(a){a.target&&this.closest(a.target,"[class*=-dd-drag-proxy]",10)?this.addAction({action:"moveCursorTo",target:[{type:"xy",target:[a.x,a.y]}],sourceEvent:a,options:a.options}):this.SUPERARG(arguments)}}});
