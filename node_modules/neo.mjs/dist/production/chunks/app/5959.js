"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[5959],{2281:(e,t,r)=>{r.d(t,{Z:()=>s});var o=r(9375);class a extends o.Z{static getConfig(){return{className:"Neo.data.Model",ntype:"model",fields:null,keyProperty_:"id",storeId:null,trackModifiedFields:!1}}getField(e){let t=this,r=0,o=t.fields?.length||0;for(;r<o;r++)if(t.fields[r].name===e)return t.fields[r];return null}}Neo.applyClassConfig(a);const s=a},5959:(e,t,r)=>{r.d(t,{Z:()=>f});var o=r(6351),a=r(395),s=r(2281),i=(r(2544),r(9375)),l=r(8041);let n;class d extends i.Z{static getConfig(){return{className:"Neo.data.RecordFactory",singleton:!0,ovPrefix:"ov_",recordNamespace:"Neo.data.record."}}createRecord(e,t){let r=Neo.ns(this.recordNamespace+e.className);return r||(r=this.createRecordClass(e)),new r(t)}createRecordClass(e){if(e instanceof s.Z){let t,r,o=this.recordNamespace+e.className,a=Neo.ns(o);return a||(r=o.split("."),t=r.pop(),a=Neo.ns(r,!0),a[t]=class{constructor(t){let r,o=this;Object.defineProperties(o,{_isModified:{value:!1,writable:!0}}),Array.isArray(e.fields)&&e.fields.forEach((a=>{let s=n.parseRecordValue(a,t[a.name]),i=Symbol.for(a.name);r={[Symbol.for("isRecord")]:{value:!0},[i]:{value:s,writable:!0},[a.name]:{configurable:!0,enumerable:!0,get(){return this[i]},set(t){let r=this,o=r[i];Neo.isEqual(t,o)||(t=n.parseRecordValue(a,t),r[i]=t,r._isModified=!0,r._isModified=n.isModified(r,e.trackModifiedFields),n.onRecordChange({fields:[{name:a.name,oldValue:o,value:t}],model:e,record:r}))}}},e.trackModifiedFields&&(r[n.ovPrefix+a.name]={value:s}),Object.defineProperties(o,r)}))}set(t){n.setRecordFields(e,this,t)}setSilent(t){n.setRecordFields(e,this,t,!0)}},a[t].isClass=!0,a[t])}}isModified(e,t){if(t){let t,r=Object.keys(e),o=0,a=r.length;for(;o<a;o++)if(t=r[o],!Neo.isEqual(e[t],e[this.ovPrefix+t]))return!0;return!1}return e._isModified}isModifiedField(e,t){e.hasOwnProperty(t)||l.Z.logError("The record does not contain the field",t,e);let r=this.ovPrefix+t;return e.hasOwnProperty(r)?!Neo.isEqual(e[t],e[r]):null}isRecord(e){return e?.[Symbol.for("isRecord")]||!1}onRecordChange(e){Neo.get(e.model.storeId)?.onRecordChange(e)}parseRecordValue(e,t){const r=e?.type.toLowerCase();return"date"===r?new Date(t):t}setRecordFields(e,t,r,o=!1){let a,s=[];Object.entries(r).forEach((([e,r])=>{a=t[e],Neo.isEqual(a,r)||(t[Symbol.for(e)]=r,s.push({name:e,oldValue:a,value:r}))})),!o&&Object.keys(s).length>0&&Neo.get(e.storeId)?.onRecordChange({fields:s,model:e,record:t})}}Neo.applyClassConfig(d),n=Neo.create(d),Neo.applyToGlobalNs(n);const c=n;class u extends o.Z{static getStaticConfig(){return{observable:!0}}static getConfig(){return{className:"Neo.data.Store",ntype:"store",api_:null,autoLoad:!1,currentPage_:1,data_:null,initialData_:null,isGrouped:!1,isLoaded:!1,isLoading:!1,model_:null,pageSize_:0,remoteFilter:!1,remoteSort:!1,totalCount:0,url:null}}construct(e){super.construct(e);let t=this;t.on({mutate:t.onCollectionMutate,sort:t.onCollectionSort,scope:t})}add(e){return super.add(this.beforeSetData(e))}afterSetCurrentPage(e,t){t&&this.load()}afterSetData(e,t){let r=this;r.configsApplied&&e&&(t?r.clear():r.initialData=[...e],r.add(e))}afterSetFilters(e,t){super.afterSetFilters(e,t);let r=this;r._currentPage=1,t&&r.remoteFilter&&r.load()}afterSetInitialData(e,t){}afterSetModel(e,t){e&&(e.storeId=this.id,c.createRecordClass(e))}afterSetPageSize(e,t){t&&(this._currentPage=1,this.load())}afterSetSorters(e,t){super.afterSetSorters(e,t);let r=this;r._currentPage=1,t&&r.remoteSort&&r.load()}beforeSetApi(e,t){return"String"===Neo.typeOf(e)&&(e={create:e+".create",destroy:e+".destroy",read:e+".read",update:e+".update"}),e}beforeSetData(e,t){let r=this;return e&&(Array.isArray(e)||(e=[e]),(e=Neo.clone(e,!0)).forEach(((t,o)=>{c.isRecord(t)||(e[o]=c.createRecord(r.model,t))}))),e}beforeSetInitialData(e,t){return!e&&t?t:e}beforeSetModel(e,t){return t?.destroy(),a.Z.beforeSetInstance(e,s.Z)}createRecord(e){c.createRecord(e)}load(){let e=this,t={page:e.currentPage,pageSize:e.pageSize};if(e.remoteFilter&&(t.filters=e.exportFilters()),e.remoteSort&&(t.sorters=e.exportSorters()),e.api){let r=e.api.read.split("."),o=r.pop(),a=Neo.ns(r.join("."));a?a[o](t).then((t=>{t.success&&(e.totalCount=t.totalCount,e.data=t.data)})):console.log("Api is not defined",this)}else t.url=e.url,Neo.Xhr.promiseJson({url:t.url}).catch((t=>{console.log("Error for Neo.Xhr.request",t,e.id)})).then((t=>{e.data=Array.isArray(t.json)?t.json:t.json.data}))}onCollectionMutate(e){let t=this;t.configsApplied&&t.fire("load",t.items)}onCollectionSort(){this.configsApplied}onConstructed(){super.onConstructed();let e=this;e.data&&e.afterSetData(e.data),e.autoLoad&&setTimeout((()=>{e.load()}),100)}onFilterChange(e){let t=this;t.remoteFilter?(t._currentPage=1,t.load()):super.onFilterChange(e)}onRecordChange(e){this.fire("recordChange",{...e,index:this.indexOf(e.record)})}sort(e={}){let t=this;t._currentPage=1,t.configsApplied&&(e.direction?t.sorters=[{direction:e.direction,property:e.property}]:(t.remoteSort||(t.startUpdate(),t.clear()),t.sorters=[],t.remoteSort||(t.add([...t.initialData]),t.endUpdate(),t.fire("sort"))))}}Neo.applyClassConfig(u);const f=u}}]);