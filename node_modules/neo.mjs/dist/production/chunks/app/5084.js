"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[5084],{5084:(e,t,o)=>{o.d(t,{Z:()=>f});var s=o(7984),r=o(395),i=o(2381),n=o(5959),l=o(4022);class d extends l.Z{static getConfig(){return{className:"Neo.grid.View",ntype:"grid-view",cls:["neo-grid-view"]}}createViewData(e){let t,o,s,r,i,n,l,d,c,a,h,g,u,m,p=this,w=e.length,f=Neo.getComponent(p.parentId),C=f.items[0].items,v=C.length,S=[],y=0,N=p.vdom;for(p.recordVnodeMap={},"selection-grid-rowmodel"===f.selectionModel?.ntype&&(u=f.selectionModel.items||[]);y<w;y++){for(h=e[y],l=p.getRowId(h,y),p.recordVnodeMap[l]=y,m=p.getTrClass(h,y),u?.includes(l)&&(m.push("neo-selected"),Neo.getComponent(p.containerId).fire("select",{record:h})),S.push({id:l,cls:m,cn:[],tabIndex:"-1"}),i=0,n=0,c=0;c<v;c++)r=C[c],g=h[r.field],void 0===g&&(g=""),a=r.renderer.call(r.rendererScope||f,{field:r.field,index:y,record:h,value:g}),t=a?.cls||["neo-grid-cell"],"left"!==r.align&&t.push("neo-"+r.align),Neo.isObject(a)||(a={cls:t,html:a?.toString()}),o=a.style||{},r.width&&(o.minWidth=`${r.width}px`),s={id:p.getCellId(h,r.field),cls:a.cls||["neo-grid-cell"],innerHTML:a.html||"",style:o,tabIndex:"-1"},r.dock&&(s.cls=["neo-locked",...s.cls||[]],"left"===r.dock&&(s.style.left=i+"px",i+=r.width)),r.flex&&(s.style.width="100%"),S[y].cn.push(s);for(c=0;c<v;c++)d=v-c-1,r=C[d],"right"===r.dock&&(S[y].cn[d].style.right=n+"px",n+=r.width+1)}N.cn=S,f.dockLeftMargin=i,f.dockRightMargin=n,p.promiseVdomUpdate().then((()=>{u?.length>0&&Neo.main.DomAccess.scrollToTableRow({id:u[0]})}))}destroy(e,t){this.store=null,super.destroy(e,t)}getCellId(e,t){return this.id+"__"+e[this.store.keyProperty]+"__"+t}getRecordByRowId(e){return this.store.getAt(this.recordVnodeMap[e])}getRowId(e,t){return`${this.id}__tr__${e[this.store.keyProperty]}`}getTrClass(e,t){return["neo-grid-row"]}onStoreRecordChange(e){let t,o,s=this,r=[];e.fields.forEach((i=>{t=s.getCellId(e.record,i.name),o=s.getVdomChild(t),o.innerHTML=i.value,r.push({id:t,innerHTML:i.value})})),r.length>0&&Neo.applyDeltas(s.appName,r)}}Neo.applyClassConfig(d);const c=d;var a=o(1509),h=o(5328);class g extends a.Z{defaultSortDirection="ASC";field=null;static getStaticConfig(){return{alignValues:["left","center","right"]}}static getConfig(){return{className:"Neo.grid.header.Button",ntype:"grid-header-button",align_:"left",cls:["neo-grid-header-button"],iconCls:"fa fa-arrow-circle-up",iconPosition:"right",isSorted_:null}}construct(e){super.construct(e);let t=this,o=t.domListeners;o.push({click:t.onButtonClick,scope:t}),t.domListeners=o}afterSetIsSorted(e,t){let o=this,s=o.cls;switch(e){case null:h.Z.add(s,"neo-sort-hidden");break;case"ASC":h.Z.remove(s,"neo-sort-desc"),h.Z.remove(s,"neo-sort-hidden"),h.Z.add(s,"neo-sort-asc");break;case"DESC":h.Z.remove(s,"neo-sort-asc"),h.Z.remove(s,"neo-sort-hidden"),h.Z.add(s,"neo-sort-desc")}o.cls=s,o.mounted&&o.fire("sort",{direction:e,property:o.field})}beforeSetAlign(e,t){return this.beforeSetEnumValue(e,t,"align","alignValues")}onButtonClick(){let e,t=this;e="DESC"===t.defaultSortDirection?{ASC:null,DESC:"ASC",null:"DESC"}:{ASC:"DESC",DESC:null,null:"ASC"},t.isSorted=e[t.isSorted+""]}removeSortingCss(){let e=this,t=e.cls;h.Z.add(t,"neo-sort-hidden"),e.cls=t,e._isSorted=null}renderer(e){return e.value}}Neo.applyClassConfig(g);var u=o(5031);class m extends u.Z{static getConfig(){return{className:"Neo.grid.header.Toolbar",ntype:"grid-header-toolbar",cls:["neo-grid-header-toolbar","neo-toolbar"],itemDefaults:{ntype:"grid-header-button"}}}createItems(){let e=this;e.itemDefaults.showHeaderFilter=e.showHeaderFilters,super.createItems();let t,o=0,s=0,r=e.items,i=r.length,n=e.vdom;r.forEach(((e,n)=>{t=e.wrapperStyle,e.maxWidth&&(t.maxWidth=e.maxWidth+"px"),e.minWidth&&(t.minWidth=e.minWidth+"px"),e.width&&(t.width=e.width+"px"),e.dock&&(e.vdom.cls.push("neo-locked"),"left"===e.dock&&(t.left=o+"px"),o+=e.width+1),e.wrapperStyle=t,"right"===(e=r[i-n-1]).dock&&(t=e.wrapperStyle,t.right=s+"px",e.wrapperStyle=t,s+=e.width+1)})),e.vdom=n}}Neo.applyClassConfig(m);const p=m;class w extends s.Z{headerToolbarConfig=null;headerToolbarId=null;viewConfig=null;viewId=null;static getConfig(){return{className:"Neo.grid.Container",ntype:"grid-container",cls:["neo-grid-container"],columns_:[],keys:{},layout:"base",selectionModel_:null,store_:null,_vdom:{cls:["neo-grid-wrapper"],cn:[{cn:[]}]}}}construct(e){super.construct(e);let t=this;t.headerToolbarId=Neo.getId("grid-header-toolbar"),t.viewId=Neo.getId("grid-view"),t.items=[{module:p,id:t.headerToolbarId,showHeaderFilters:t.showHeaderFilters,...t.headerToolbarConfig},{module:c,containerId:t.id,id:t.viewId,store:t.store,...t.viewConfig}],t.vdom.id=t.id+"wrapper",t.createColumns(t.columns)}afterSetSelectionModel(e,t){this.rendered&&e.register(this)}beforeSetColumns(e,t){return this.configsApplied?this.createColumns(e):e}beforeSetSelectionModel(e,t){return t?.destroy(),r.Z.beforeSetInstance(e,i.Z)}beforeSetStore(e,t){if(t?.destroy(),e){let t=this,o={filter:t.onStoreFilter,load:t.onStoreLoad,recordChange:t.onStoreRecordChange,scope:t};e instanceof n.Z?(e.on(o),e.getCount()>0&&t.onStoreLoad(e.items)):e=r.Z.beforeSetInstance(e,n.Z,{listeners:o}),t.view&&(t.view.store=e)}return e}createColumns(e){let t=this,o=t.columnDefaults,s=t.store?.sorters;return e&&e.length||Neo.logError("Attempting to create a grid.Container without defined columns",t.id),e.forEach((e=>{o&&Neo.assignDefaults(e,o),e.dock&&!e.width&&Neo.logError("Attempting to create a docked column without a defined width",e,t.id),s?.[0]&&e.field===s[0].property&&(e.isSorted=s[0].direction),e.listeners={sort:t.onSortColumn,scope:t}})),t.items[0].items=e,e}createViewData(e){this.getView().createViewData(e)}getVdomRoot(){return this.vdom.cn[0]}getVdomItemsRoot(){return this.vdom.cn[0]}getView(){return Neo.getComponent(this.viewId)||Neo.get(this.viewId)}getVnodeRoot(){return this.vnode.childNodes[0]}onConstructed(){super.onConstructed(),this.selectionModel?.register(this)}onSortColumn(e){let t=this;t.store.sort(e),t.removeSortingCss(e.property),t.onStoreLoad(t.store.items)}onStoreFilter(){this.onStoreLoad(this.store.items)}onStoreLoad(e){let t,o=this;o.rendered?(o.createViewData(e),o.store.sorters.length<1&&o.removeSortingCss()):t=o.on("rendered",(()=>{o.un("rendered",t),setTimeout((()=>{o.createViewData(e)}),50)}))}onStoreRecordChange(e){this.getView().onStoreRecordChange(e)}removeSortingCss(e){this.items[0].items.forEach((t=>{t.field!==e&&t.removeSortingCss()}))}}Neo.applyClassConfig(w);const f=w},6020:(e,t,o)=>{o.d(t,{Z:()=>n});var s=o(9375),r=o(5328);o(2544);class i extends s.Z{static getStaticConfig(){return{observable:!0}}static getConfig(){return{className:"Neo.selection.Model",ntype:"selection-model",cls:null,items_:null,selectedCls:"neo-selected",singleSelect:!0,view_:null}}beforeGetItems(e){return e||(this._items=e=[]),e}beforeGetView(e){return Neo.getComponent(this._view)}beforeSetView(e){return e&&e.id}addDomListener(){}deselect(e,t,o,s){let i,n=this,l=n.view,d=l.vdom,c=l.getVdomChild(e);c&&(i=c.cls||[],r.Z.remove(i,s||n.selectedCls),c.cls=i),r.Z.remove(o||n.items,e),t||(l.vdom=d)}deselectAll(e){let t=this,o=[...t.items],s=t.view,r=s.vdom;o.forEach((e=>{t.deselect(e,!0)})),!e&&o.length>0&&(s.vdom=r)}destroy(){this.unregister(),super.destroy()}getSelection(){return this.items}hasSelection(){return this.items.length>0}isSelected(e){return this.items.includes(e)}register(e){let t=this,o=e.cls||[];t.cls&&!o.includes(t.cls)&&(o.push(t.cls),e.cls=o),t.view=e,t.addDomListener()}removeDomListeners(){let e=this,t=e.view,o=[...t.domListeners];t.domListeners.forEach((t=>{t.scope===e&&r.Z.remove(o,t)})),t.domListeners=o}select(e,t,o){e=Array.isArray(e)?e:[e];let s,i=this,n=i.view,l=n.vdom;t=t||i.items,Neo.isEqual(t,e)||(i.singleSelect&&i.deselectAll(!0),e.forEach((e=>{"string"==typeof e&&(e=n.getVdomChild(e)),e&&(s=e.cls||[],r.Z.add(s,o||i.selectedCls),e.cls=s)})),r.Z.add(t,e),n[n.silentSelect?"_vdom":"vdom"]=l,n.onSelect?.(e))}toggleSelection(e){let t=this;t.isSelected(e)?t.deselect(e):t.select(e)}unregister(){let e=this,t=e.view.cls||[];e.cls&&t.includes(e.cls)&&(r.Z.remove(t,e.cls),e.view.cls=t),e.deselectAll(),e.removeDomListeners()}}Neo.applyClassConfig(i);const n=i},2381:(e,t,o)=>{o.d(t,{Z:()=>n});var s=o(6020),r=o(6500);class i extends s.Z{static getConfig(){return{className:"Neo.selection.grid.RowModel",ntype:"selection-grid-rowmodel",cls:"neo-selection-rowmodel"}}addDomListener(){let e=this,t=e.view,o=t.domListeners;o.push({click:e.onRowClick,delegate:".neo-grid-row",scope:e}),t.domListeners=o}getRowId(e){return e<0||this.view.store.getCount()<e?null:this.view.vdom.cn[0].cn[1].cn[e].id}static getRowNode(e){let t=0,o=e.length,s=null;for(;t<o;t++)e[t].cls.includes("neo-grid-row")&&(s=e[t]);return s}onKeyDownDown(e){this.onNavKeyRow(e,1)}onKeyDownUp(e){this.onNavKeyRow(e,-1)}onNavKeyRow(e,t){let o,s=i.getRowNode(e.path),n=this.view,l=n.store,d=r.Z.findVdomChild(n.vdom,s.id),c=(d.index+t)%l.getCount(),a=d.parentNode;for(;c<0;)c+=l.getCount();o=a.cn[c].id,o&&(this.select(o),n.focus(o),n.fire("select",{record:l.getAt(c)}))}onRowClick(e){let t,o,s=this,n=i.getRowNode(e.path)?.id,l=s.view;n&&(s.toggleSelection(n),t=s.isSelected(n),o=l.store.getAt(r.Z.findVdomChild(l.vdom,n).index),!t&&l.onDeselect?.(o),l.fire(t?"select":"deselect",{record:o}))}register(e){super.register(e);let t=this.id;this.view.keys?._keys.push({fn:"onKeyDownDown",key:"Down",scope:t},{fn:"onKeyDownUp",key:"Up",scope:t})}unregister(){let e=this.id;this.view.keys?.removeKeys([{fn:"onKeyDownDown",key:"Down",scope:e},{fn:"onKeyDownUp",key:"Up",scope:e}]),super.unregister()}}Neo.applyClassConfig(i);const n=i}}]);