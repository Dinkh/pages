(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[4673],{4673:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>D});var i=a(7875),r=a(2680),l=a(6593),o=a(231);class s extends o.Z{static getConfig(){return{className:"Covid.model.HistoricalData",fields:[{name:"active",type:"int"},{name:"cases",type:"int"},{name:"date",type:"string"},{name:"dailyActive",type:"int"},{name:"dailyCases",type:"int"},{name:"dailyDeaths",type:"int"},{name:"dailyRecovered",type:"int"},{name:"deaths",type:"int"},{name:"recovered",type:"int"}]}}}Neo.applyClassConfig(s);var n=a(7816);class d extends n.Z{static getConfig(){return{className:"Covid.store.HistoricalData",keyProperty:"date",model:s,sorters:[{property:"date",direction:"DESC"}]}}}Neo.applyClassConfig(d);var c=a(3908);class h extends l.Z{static getConfig(){return{className:"Covid.view.country.HistoricalDataTable",cls:["covid-historical-data-table","neo-table-container"],columnDefaults:{align:"right",defaultSortDirection:"DESC",renderer:c.Z.formatNumber},columns:[{align:"left",dataField:"date",dock:"left",text:"Date",width:100,renderer:function(e){return{cls:["neo-date-column","neo-table-cell"],html:new Intl.DateTimeFormat("default",{day:"numeric",month:"numeric",year:"numeric"}).format(new Date(e.value))}}},{dataField:"cases",text:"Cases",renderer:e=>c.Z.formatNumber(e)},{dataField:"active",text:"Active",renderer:e=>c.Z.formatNumber(e,"#64B5F6")},{dataField:"recovered",text:"Recovered",renderer:e=>c.Z.formatNumber(e,"#28ca68")},{dataField:"deaths",text:"Deaths",renderer:e=>c.Z.formatNumber(e,"#fb6767")},{dataField:"dailyCases",text:"Daily C",renderer:e=>c.Z.formatNumber(e)},{dataField:"dailyActive",text:"Daily A",renderer:e=>c.Z.formatNumber(e,"#64B5F6")},{dataField:"dailyRecovered",text:"Daily R",renderer:e=>c.Z.formatNumber(e,"#28ca68")},{dataField:"dailyDeaths",text:"Daily D",renderer:e=>c.Z.formatNumber(e,"#fb6767")}],store:d}}}Neo.applyClassConfig(h);var u=a(8636);class f extends u.Z{static getConfig(){return{className:"Covid.view.country.LineChartComponent",cls:["covid-line-chart"],chartConfig:{cursor:{maxTooltipDistance:-1},legend:{labels:{template:{fill:"#bbb"}}},xAxes:[{type:"DateAxis",renderer:{minGridDistance:60,labels:{template:{fill:"#bbb"}}}}],yAxes:[{type:"ValueAxis",logarithmic:!0,numberFormatter:{numberFormat:"#.0a",bigNumberPrefixes:[{number:1e3,suffix:"K"},{number:1e6,suffix:"M"},{number:1e9,suffix:"B"}]},renderer:{minGridDistance:60,labels:{template:{fill:"#bbb"}}}}],series:[{type:"LineSeries",dataFields:{dateX:"date",valueY:"active"},fill:"#64b5f6",name:"Active",stroke:"#64b5f6",strokeWidth:3,tooltip:{background:{fill:"#fff"},getFillFromObject:!1,label:{fill:"#000"}}},{type:"LineSeries",dataFields:{dateX:"date",valueY:"cases"},fill:"#bbb",name:"Cases",stroke:"#bbb",strokeWidth:3,tooltip:{background:{fill:"#fff"},getFillFromObject:!1,label:{fill:"#000"}}},{type:"LineSeries",dataFields:{dateX:"date",valueY:"deaths"},fill:"#fb6767",name:"Deaths",stroke:"#fb6767",strokeWidth:3,tooltip:{background:{fill:"#fff"},getFillFromObject:!1,label:{fill:"#000"}}},{type:"LineSeries",dataFields:{dateX:"date",valueY:"recovered"},fill:"#28ca68",name:"Recovered",stroke:"#28ca68",strokeWidth:3,tooltip:{background:{fill:"#fff"},getFillFromObject:!1,label:{fill:"#000"}}}]},combineSeriesTooltip:!0,fitParentHeight:!0}}}Neo.applyClassConfig(f);var m=a(3415),p=a(7584),b=a(2138),g=a(5666);class y extends l.Z{static getConfig(){return{className:"Covid.view.country.Table",cls:["covid-country-table","neo-table-container"],columnDefaults:{align:"right",defaultSortDirection:"DESC",renderer:c.Z.formatNumber},columns:[{cls:["neo-index-column","neo-table-header-button"],dataField:"index",dock:"left",minWidth:40,text:"#",renderer:c.Z.indexRenderer,width:40},{align:"left",dataField:"country",defaultSortDirection:"ASC",dock:"left",text:"Country",width:200,renderer:e=>({cls:["neo-country-column","neo-table-cell"],html:['<div style="display: flex; align-items: center">','<img style="height:20px; margin-right:10px; width:20px;" src="'+c.Z.getCountryFlagUrl(e.value)+'">'+e.value,"</div>"].join("")})},{dataField:"cases",text:"Cases"},{dataField:"casesPerOneMillion",text:"Cases / 1M"},{dataField:"infected",text:"Infected",renderer:e=>c.Z.formatInfected(e)},{dataField:"active",text:"Active",renderer:e=>c.Z.formatNumber(e,"#64B5F6")},{dataField:"recovered",text:"Recovered",renderer:e=>c.Z.formatNumber(e,"#28ca68")},{dataField:"critical",text:"Critical",renderer:e=>c.Z.formatNumber(e,"orange")},{dataField:"deaths",text:"Deaths",renderer:e=>c.Z.formatNumber(e,"#fb6767")},{dataField:"todayCases",text:"Cases today"},{dataField:"todayDeaths",text:"Deaths today",renderer:e=>c.Z.formatNumber(e,"#fb6767")},{dataField:"tests",text:"Tests"},{dataField:"testsPerOneMillion",text:"Tests / 1M"}],store:g.Z}}}Neo.applyClassConfig(y);var C=a(5354),v=a(3501);class x extends C.Z{static getConfig(){return{className:"Covid.view.TableContainerController",apiBaseUrl:"https://disease.sh/",apiHistoricalDataEndpoint:"v3/covid-19/historical/",apiHistoricalDataTimeRange:"all",removeEmptyRecords:!0,selectedRecord:null,table_:null}}onConstructed(){super.onConstructed();let e=this;e.component.on("countrySelect",e.onTableSelect,e)}addStoreItems(e){let t,a=this,i=[],r={},l=e&&e.timeline;e&&!e.timeline&&(l=e),l&&(Object.entries(l.cases||{}).forEach((([e,t])=>{r[e]={date:new Date(e).toISOString(),cases:t}})),Object.entries(l.deaths||{}).forEach((([e,t])=>{r.hasOwnProperty(e)?r[e].deaths=t:r[e]={date:new Date(e).toISOString(),deaths:t}})),Object.entries(l.recovered||{}).forEach((([e,t])=>{r.hasOwnProperty(e)?r[e].recovered=t:r[e]={date:new Date(e).toISOString(),recovered:t}})),Object.entries(r).forEach((([e,t])=>{t.active=t.cases-t.deaths-t.recovered,i.push(t)})),a.removeEmptyRecords&&[...i].forEach((e=>{0===e.cases&&v.Z.remove(i,e)})),Object.assign(i[0],{dailyActive:i[0].active,dailyCases:i[0].cases,dailyDeaths:i[0].deaths,dailyRecovered:i[0].recovered}),i.forEach(((e,a)=>{t=i[a+1],t&&Object.assign(t,{dailyActive:t.active-e.active,dailyCases:t.cases-e.cases,dailyDeaths:t.deaths-e.deaths,dailyRecovered:t.recovered-e.recovered})})),a.getReference("historical-data-table").store.data=i,a.updateLineChart(i))}static assignFieldsOrNull(e){return{active:e.active||null,cases:e.cases||null,deaths:e.deaths||null,dailyActive:e.dailyActive||null,dailyCases:e.dailyCases||null,dailyDeaths:e.dailyDeaths||null,dailyRecovered:e.dailyRecovered||null,recovered:e.recovered||null}}beforeGetTable(e){return e||(this._table=e=this.getReference("table")),e}loadHistoricalData(e){const t=this,a=t.apiBaseUrl+t.apiHistoricalDataEndpoint+e+"?lastdays="+t.apiHistoricalDataTimeRange;fetch(a).then((e=>e.json())).catch((e=>console.log("Canâ€™t access "+a,e))).then((e=>t.addStoreItems(e)))}on520pxButtonClick(e){this.getReference("controls-panel").width=520}on800pxButtonClick(e){this.getReference("controls-panel").width=800}onCollapseButtonClick(e){const t=this.getReference("controls-panel"),a=40===t.width;t.width=a?this.component.historyPanelWidth:40,e.component.text=a?"X":"+"}onDailyValuesChange(e){const t=this.getReference("line-chart").id,a=this.getReference("logarithmic-scale-checkbox"),i=e.value;i?a.set({checked:!1,disabled:e.value}):a.disabled=!1,Neo.main.addon.AmCharts.setProperties({id:t,properties:{"series.values.0.dataFields.valueY":i?"dailyActive":"active","series.values.1.dataFields.valueY":i?"dailyCases":"cases","series.values.2.dataFields.valueY":i?"dailyDeaths":"deaths","series.values.3.dataFields.valueY":i?"dailyRecovered":"recovered"}}),Neo.main.addon.AmCharts.callMethod({id:t,path:"invalidateData"})}onLogarithmicScaleChange(e){Neo.main.addon.AmCharts.setProperty({id:this.getReference("line-chart").id,path:"yAxes.values.0.logarithmic",value:e.value})}onTableSelect(e){const t=this,a=e.record;e.record?t.selectedRecord={...a}:t.selectedRecord=null,t.loadHistoricalData(a&&a.countryInfo&&a.countryInfo.iso2||"all"),t.getReference("historical-data-label").html="Historical Data ("+(a&&a.country||"World")+")"}updateLineChart(e){let t=this,a=t.selectedRecord,i=t.getReference("line-chart");e.forEach((e=>Object.assign(e,x.assignFieldsOrNull(e)))),a||(a=t.getParent().summaryData),a&&e.push({date:(new Date).toISOString(),...x.assignFieldsOrNull(a)}),i.data=e}}Neo.applyClassConfig(x);class D extends r.Z{static getConfig(){return{className:"Covid.view.TableContainer",autoMount:!0,controller:x,historyPanelWidth:520,table:null,tableConfig:null,layout:{ntype:"hbox",align:"stretch"},items:[{ntype:"container",flex:1,layout:"fit",items:[]},{module:p.Z},{module:m.Z,cls:["neo-configuration-panel","neo-panel","neo-container"],layout:{ntype:"vbox",align:"stretch"},reference:"controls-panel",style:{backgroundColor:"#2b2b2b"},width:"@config:historyPanelWidth",containerConfig:{flex:null,style:{overflowY:"scroll"}},headers:[{dock:"top",items:[{ntype:"button",handler:"onCollapseButtonClick",text:"X"},{ntype:"label",reference:"historical-data-label",text:"Historical Data"},"->",{ntype:"button",handler:"on520pxButtonClick",text:"520px"},{ntype:"button",handler:"on800pxButtonClick",text:"800px"}]}],items:[{module:b.Z,style:{marginTop:"10px"},items:[{ntype:"container",layout:{ntype:"vbox",align:"stretch"},items:[{ntype:"toolbar",flex:"0 1 auto",items:[{module:i.Z,checked:!0,labelText:"Logarithmic Scale",labelWidth:135,reference:"logarithmic-scale-checkbox",listeners:{change:"onLogarithmicScaleChange"}},{module:i.Z,labelText:"Daily Values",style:{marginLeft:"30px"},labelWidth:95,listeners:{change:"onDailyValuesChange"}}]},{module:f,flex:1,reference:"line-chart"}],tabButtonConfig:{iconCls:"fa fa-chart-line",text:"Chart"}}]}]}]}}constructor(e){super(e);let t=this;t.historicalDataTable=Neo.create({module:h,reference:"historical-data-table",tabButtonConfig:{iconCls:"fa fa-table",text:"Table"},...t.historicalDataTableConfig||{}}),t.items[2].items[0].items.push(t.historicalDataTable),t.table=Neo.create({module:y,reference:"table",...t.tableConfig||{}}),t.items[0].items.push(t.table)}}Neo.applyClassConfig(D)},8636:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var i=a(7478),r=a(3949);class l extends i.Z{static getConfig(){return{className:"Neo.component.wrapper.AmChart",ntype:"am-chart",chartConfig:null,chartType:"XYChart",combineSeriesTooltip:!1,data_:null,dataPath:"",package:"am4charts",_vdom:{style:{position:"relative",height:"100%",width:"100%"},cn:[{style:{position:"absolute",height:"100%",width:"100%"},cn:[{style:{color:"red",height:"100%"}}]}]}}}afterSetData(e,t){let a=this;e&&Neo.main.addon.AmCharts.updateData({appName:a.appName,data:e,dataPath:a.dataPath,id:a.id})}afterSetMounted(e,t){let a=this;if(!1===e&&void 0!==t&&Neo.main.addon.AmCharts.destroy({appName:a.appName,id:a.id}),super.afterSetMounted(e,t),e){const e={appName:a.appName,combineSeriesTooltip:a.combineSeriesTooltip,config:a.chartConfig,data:a.data,id:a.id,package:a.package,type:a.chartType};a.data&&(e.data=a.data,e.dataPath=a.dataPath),setTimeout((()=>{Neo.main.addon.AmCharts.create(e).then(a.onChartMounted)}),50)}}getVdomRoot(){return this.vdom.cn[0].cn[0]}getVnodeRoot(){return this.vnode.childNodes[0].childNodes[0]}onChartMounted(){}onConstructed(){super.onConstructed();const e=this;e.chartConfig||r.Z.logError("wrapper.AmChart defined without a chartConfig",e.id),e.parseChartConfig(e.chartConfig)}parseChartConfig(e){const t=this;Neo.isArray(e)?e.forEach((e=>{t.parseChartConfig(e)})):Object.entries(e).forEach((([a,i])=>{Neo.isArray(i)||Neo.isObject(i)?t.parseChartConfig(i):Neo.isString(i)&&i.startsWith("@config:")&&(i=i.substr(8),t[i]?e[a]=t[i]:r.Z.logError("The used @config does not exist:",i,t))}))}}Neo.applyClassConfig(l)},3415:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var i=a(2680);a(4959);class r extends i.Z{static getConfig(){return{className:"Neo.container.Panel",ntype:"panel",cls:["neo-panel","neo-container"],containerConfig:null,headerDefaults:null,headers:null,_layout:{ntype:"vbox",align:"stretch"},verticalHeadersFirst:!1}}constructor(e){super(e),(e&&!0===e.verticalHeadersFirst||!0===this.verticalHeadersFirst)&&(this.layout={ntype:"hbox",align:"stretch"})}static createHeaderConfig(e){let t={ntype:"toolbar",cls:["neo-panel-header-toolbar","neo-toolbar"],flex:"0 1 auto"};return e.text&&(t.items=[{ntype:"label",cls:["neo-panel-header-text","neo-label"],text:e.text}],delete e.text),Neo.isArray(e.items)&&e.items.forEach((e=>{"label"===e.ntype&&(e.cls=["neo-panel-header-text","neo-label"])})),{...t,...e}}createItems(){let e,t=this,a=!1===t.verticalHeadersFirst,i=t.headers||[],l=i.filter((e=>e.dock===(a?"bottom":"right"))),o=i.filter((e=>e.dock===(a?"left":"top"))),s=i.filter((e=>e.dock===(a?"right":"bottom"))),n=i.filter((e=>e.dock===(a?"top":"left"))),d=l.length>0||n.length>0,c=o.length>0||s.length>0,h=t.items,u=[],f=[];i.length<1&&Neo.error("Panel without headers, please use a Container instead",t.id),n.forEach((e=>{f.push(r.createHeaderConfig(e))})),c&&(a&&d||!a&&d)?(o.forEach((e=>{u.push(r.createHeaderConfig(e))})),e={ntype:"container",flex:1,items:h,itemDefaults:t.itemDefaults,...t.containerConfig||{}},u.push({...t.headerDefaults,...e}),s.forEach((e=>{u.push(r.createHeaderConfig(e))})),f.push({ntype:"container",items:u,layout:{ntype:a?"hbox":"vbox",align:"stretch"}})):(e={ntype:"container",flex:1,items:h,itemDefaults:t.itemDefaults,...t.containerConfig||{}},f.push({...t.headerDefaults,...e})),l.forEach((e=>{f.push(r.createHeaderConfig(e))})),t.items=f,t.itemDefaults=null,super.createItems()}}Neo.applyClassConfig(r)}}]);